---
title: Classe CMFCToolBarButton | Documenti Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7c0827bea8669743f8e0512ce2c6b1f82d978c46
ms.sourcegitcommit: 76b7653ae443a2b8eb1186b789f8503609d6453e
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/04/2018
---
# <a name="cmfctoolbarbutton-class"></a>Classe CMFCToolBarButton
Fornisce funzionalità di pulsante alle barre degli strumenti.  
  
## <a name="syntax"></a>Sintassi  
  
```  
class CMFCToolBarButton : public CObject  
```  
  
## <a name="members"></a>Membri  
  
### <a name="public-constructors"></a>Costruttori pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|Costruisce e inizializza un oggetto `CMFCToolBarButton`.|  
|`CMFCToolBarButton::~CMFCToolBarButton`|Distruttore.|  
  
### <a name="public-methods"></a>Metodi pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|Specifica se un utente è possibile posizionare un pulsante in una barra degli strumenti o menu durante la personalizzazione.|  
|[CMFCToolBarButton::CanBeStored](#canbestored)|Specifica se il pulsante può essere archiviato.|  
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|Specifica se un utente consente di estendere il pulsante di personalizzazione.|  
|[CMFCToolBarButton::CompareWith](#comparewith)|Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` oggetto.|  
|[CMFCToolBarButton::CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti al pulsante corrente.|  
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|Crea un `CMFCToolBarButton` oggetto forniti `COleDataObject` oggetto.|  
|`CMFCToolBarButton::CreateObject`|Usato dal framework per creare un'istanza dinamica di questo tipo di classe.|  
|[CMFCToolBarButton::EnableWindow](#enablewindow)|Abilita o disabilita l'input da mouse e tastiera.|  
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|Copia il testo dal pulsante della barra degli strumenti a un menu.|  
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|Recupera il formato degli Appunti globale per l'applicazione.|  
|[CMFCToolBarButton::GetHwnd](#gethwnd)|Recupera l'handle di finestra associata con il pulsante della barra degli strumenti.|  
|[CMFCToolBarButton::GetImage](#getimage)|Recupera l'indice dell'immagine del pulsante.|  
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|Recupera l'area dell'area client del pulsante che deve essere ridisegnato.|  
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|Recupera la finestra padre del pulsante.|  
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|Recupera l'elenco di comandi che l'utente non è possibile personalizzare.|  
|[CMFCToolBarButton::GetTextSize](#gettextsize)|Recupera la dimensione del testo del pulsante.|  
|[CMFCToolBarButton::HasFocus](#hasfocus)|Determina se il pulsante ha lo stato attivo di input corrente.|  
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante.|  
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|Determina se un'immagine viene visualizzata sul pulsante.|  
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|Determina se un'etichetta di testo viene visualizzata sul pulsante.|  
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|Determina se il pulsante consente di visualizzare un sottomenu.|  
|[CMFCToolBarButton::IsEditable](#iseditable)|Determina se il pulsante può essere personalizzato.|  
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|Determina se è possibile visualizzare il pulsante con un bordo esteso.|  
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|Determina se il pulsante è nella prima posizione in un gruppo pulsante.|  
|[CMFCToolBarButton::IsHidden](#ishidden)|Determina se il pulsante è nascosto.|  
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|Determina se il pulsante si trova su una barra orizzontale.|  
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|Specifica se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.|  
|[CMFCToolBarButton::IsLocked](#islocked)|Determina se il pulsante è presente una barra degli strumenti (non personalizzabile) bloccato.|  
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|Determina se il pulsante è il proprietario dell'handle di finestra specificato.|  
|[CMFCToolBarButton::IsVisible](#isvisible)|Determina se il pulsante della barra degli strumenti è visibile.|  
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|Determina se l'handle di finestra sottostante del pulsante è visibile.|  
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|Specifica se il pulsante elabora il [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) messaggio.|  
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|Chiamato dal framework quando il pulsante viene aggiunto a un **Personalizza** la finestra di dialogo.|  
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|Specifica se è possibile trascinare il pulsante.|  
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|Specifica se un utente è possibile rilasciare il pulsante nella barra degli strumenti di destinazione.|  
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.|  
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|Chiamato dal framework per gestire il [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) messaggio.|  
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.|  
|[CMFCToolBarButton::OnClick](#onclick)|Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.|  
|[CMFCToolBarButton::OnClickUp](#onclickup)|Chiamato dal framework quando l'utente rilascia il pulsante del mouse.|  
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|Chiamato dal framework quando la barra degli strumenti padre gestisce un `WM_HELPHITTEST` messaggio.|  
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|Chiamato dal framework quando la barra degli strumenti padre gestisce un `WM_CTLCOLOR` messaggio.|  
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|Consente il pulsante modificare il menu specificato quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.|  
|[CMFCToolBarButton::OnDblClk](#ondblclk)|Chiamato dal framework quando la barra degli strumenti padre gestisce un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) messaggio.|  
|[CMFCToolBarButton::OnDraw](#ondraw)|Chiamato dal framework per disegnare il pulsante utilizzando le opzioni e gli stili specificati.|  
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Chiamato dal framework per disegnare il pulsante di **comandi** riquadro del **Personalizza** la finestra di dialogo.|  
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|Chiamato dal framework per recuperare il testo della descrizione comando personalizzato per il pulsante.|  
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|Chiamato dal framework quando viene modificato il tipo di carattere globale.|  
|[CMFCToolBarButton::OnMove](#onmove)|Chiamato dal framework quando si sposta la barra degli strumenti padre.|  
|[CMFCToolBarButton::OnShow](#onshow)|Chiamato dal framework quando il pulsante diventa visibile o invisibile.|  
|[CMFCToolBarButton::OnSize](#onsize)|Chiamato dal framework quando la barra degli strumenti padre cambia la dimensione o posizione e la modifica richiede il pulsante per modificare le dimensioni.|  
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|Chiamato dal framework quando la barra degli strumenti padre è necessario determinare se un punto si trova il rettangolo di delimitazione del pulsante.|  
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.|  
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento e rilascio.|  
|[CMFCToolBarButton::Rect](#rect)|Recupera il rettangolo di delimitazione del pulsante.|  
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|Imposta il valore predefinito dell'immagine associata con il pulsante.|  
|[CMFCToolBarButton::SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti.|  
|[CMFCToolBarButton::Serialize](#serialize)|Legge l'oggetto da un archivio o scrive in un archivio. Esegue l'override di [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).|  
|[CMFCToolBarButton::SetACCData](#setaccdata)|Popola l'oggetto specificato `CAccessibilityData` oggetto con i dati di accessibilità dal pulsante della barra degli strumenti.|  
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|Rinomina il formato degli Appunti globale.|  
|[CMFCToolBarButton::SetImage](#setimage)|Imposta l'indice dell'immagine del pulsante.|  
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|Imposta l'elenco di comandi che l'utente non è possibile personalizzare.|  
|[CMFCToolBarButton::SetRadio](#setradio)|Chiamato dal framework quando un pulsante viene modificato lo stato.|  
|[CMFCToolBarButton::SetRect](#setrect)|Imposta il rettangolo di delimitazione del pulsante.|  
|[CMFCToolBarButton::SetStyle](#setstyle)|Imposta lo stile del pulsante.|  
|[CMFCToolBarButton::SetVisible](#setvisible)|Specifica se il pulsante è visibile.|  
|[CMFCToolBarButton::Show](#show)|Mostra o nasconde il pulsante.|  
  
### <a name="data-members"></a>Membri di dati  
  
|nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarButton::m_bImage](#m_bimage)|Specifica se un'immagine è visualizzata sul pulsante.|  
|[CMFCToolBarButton::m_bText](#m_btext)|Specifica se un'etichetta di testo viene visualizzata sul pulsante.|  
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|Specifica se l'etichetta di testo viene visualizzato sotto l'immagine del pulsante.|  
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|Specifica se il pulsante ha un'immagine definita dall'utente.|  
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|Specifica se il pulsante Visualizza la relativa etichetta full-text, anche se non è possibile inserirlo nel rettangolo di delimitazione.|  
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.|  
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|Specifica se le etichette di testo multilinea sono abilitate.|  
|[CMFCToolBarButton::m_nID](#m_nid)|L'ID di comando del pulsante.|  
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|Lo stile del pulsante.|  
|[CMFCToolBarButton::m_strText](#m_strtext)|L'etichetta di testo del pulsante.|  
  
## <a name="remarks"></a>Note  
 Oggetto `CMFCToolbarButton` oggetto è un controllo che si trova su una barra degli strumenti. Il comportamento è simile a quello di un pulsante normale. È possibile assegnare un'etichetta di testo e di un'immagine a questo oggetto. Un pulsante della barra degli strumenti può anche avere un ID di comando. Quando l'utente fa clic sul pulsante della barra degli strumenti, il framework esegue il comando che specifica l'ID.  
  
 In genere, è possono personalizzare i pulsanti della barra degli strumenti: l'utente può trascinare i pulsanti da una barra degli strumenti a altra e copiare, incollare, eliminare e modificare le etichette di testo e immagini. Per impedire che l'utente Personalizza la barra degli strumenti, è possibile bloccare la barra degli strumenti in uno dei due modi. Uno dei due set di `bLocked` flag `TRUE` quando si chiama [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar), oppure aggiungere l'ID di comando di un singolo pulsante all'elenco globale di comandi protetti mediante il [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands) metodo.  
  
 `CMFCToolBarButton` gli oggetti visualizzati le immagini delle raccolte globali delle immagini della barra degli strumenti nell'applicazione. Questi insiemi sono gestiti dalla barra degli strumenti padre [CMFCToolBar classe](../../mfc/reference/cmfctoolbar-class.md). Per ulteriori informazioni, vedere [CMFCToolBarImages classe](../../mfc/reference/cmfctoolbarimages-class.md).  
  
 Quando l'utente sceglie un pulsante della barra degli strumenti, barra degli strumenti padre elabora il messaggio di mouse e comunica le azioni appropriate per il pulsante. Se il pulsante ha un ID di comando valido, la barra degli strumenti padre invia il `WM_COMMAND` messaggio per il frame padre.  
  
 Il `CMFCToolBarButton` classe è la classe base per altre classi di pulsante della barra degli strumenti, ad esempio [CMFCToolBarMenuButton classe](../../mfc/reference/cmfctoolbarmenubutton-class.md), [CMFCToolBarEditBoxButton classe](../../mfc/reference/cmfctoolbareditboxbutton-class.md), e [ Classe CMFCToolBarComboBoxButton](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).  
  
## <a name="example"></a>Esempio  
 Nell'esempio riportato di seguito viene illustrato come configurare un `CMFCToolBarButton` oggetto usando i vari metodi di `CMFCToolBarButton` classe. Nell'esempio viene illustrato come abilitare il puntatore del mouse e input da tastiera, impostare l'indice dell'immagine del pulsante, impostare il rettangolo di delimitazione del pulsante e rendere visibile il pulsante. Questo frammento di codice fa parte di [esempio controllo struttura a schede](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]  
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  
  
## <a name="requirements"></a>Requisiti  
 **Intestazione:** afxtoolbarbutton. h  
  
##  <a name="canbedropped"></a>  CMFCToolBarButton::CanBeDropped  
 Specifica se un utente è possibile posizionare un pulsante in una barra degli strumenti o menu durante la personalizzazione.  
  
```  
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pToolbar`  
 Non usato.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `TRUE`.  
  
### <a name="remarks"></a>Note  
 Per impostazione predefinita, un pulsante della barra degli strumenti può essere eliminato su ogni personalizzabile (vale a dire non bloccata) sulla barra degli strumenti.  
  
 L'implementazione predefinita di questo metodo restituisce `TRUE`. Eseguire l'override di questo metodo e restituire `FALSE` se si desidera impedire all'utente di riposizionamento pulsante.  
  
##  <a name="canbestored"></a>  CMFCToolBarButton::CanBeStored  
 Determina se il pulsante può essere archiviato.  
  
```  
virtual BOOL CanBeStored() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `TRUE`.  
  
### <a name="remarks"></a>Note  
 Il framework utilizza questo metodo per determinare se il pulsante può partecipare a un'operazione di trascinamento e rilascio.  
  
 L'implementazione predefinita restituisce `TRUE`. Eseguire l'override di questo metodo se il pulsante non può essere archiviato come parte di un'operazione di trascinamento e rilascio. Per ulteriori informazioni sulle operazioni di trascinamento e rilascio, vedere [trascinamento della selezione (OLE)](../../mfc/drag-and-drop-ole.md).  
  
##  <a name="canbestretched"></a>  CMFCToolBarButton::CanBeStretched  
 Specifica se un utente consente di estendere il pulsante di personalizzazione.  
  
```  
virtual BOOL CanBeStretched() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene utilizzato dal framework per determinare se il pulsante può essere estesa in modalità di personalizzazione.  
  
 L'implementazione predefinita di questo metodo restituisce `FALSE`. Eseguire l'override di questo metodo per restituire `TRUE` per un controllo a larghezza variabile, ad esempio una casella combinata o un dispositivo di scorrimento.  
  
 Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).  
  
##  <a name="cmfctoolbarbutton"></a>  CMFCToolBarButton::CMFCToolBarButton  
 Costruisce e inizializza un oggetto `CMFCToolBarButton`.  
  
```  
CMFCToolBarButton(
    UINT uiID,  
    int iImage,  
    LPCTSTR lpszText=NULL,  
    BOOL bUserButton=FALSE,  
    BOOL bLocked=FALSE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `uiID`  
 L'ID di comando del pulsante.  
  
 [in] `iImage`  
 L'indice dell'immagine del pulsante nella raccolta di immagini.  
  
 [in] `lpszText`  
 L'etichetta di testo del pulsante. Può essere `NULL`.  
  
 [in] `bUserButton`  
 Valore booleano che determina se il pulsante è definito dall'utente. Se questo parametro è `TRUE`, il pulsante è definito dall'utente. In caso contrario, l'immagine del pulsante viene caricato da una risorsa.  
  
 [in] `bLocked`  
 Valore booleano che determina se il pulsante può essere personalizzato. Se questo parametro è `TRUE`, non è possibile personalizzare il pulsante. In caso contrario, è possibile personalizzare il pulsante.  
  
##  <a name="comparewith"></a>  CMFCToolBarButton::CompareWith  
 Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` oggetto.  
  
```  
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;  
```  
  
### <a name="parameters"></a>Parametri  
 [in] `other`  
 Riferimento all'oggetto da confrontare con questa istanza.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'oggetto specificato è uguale al valore di questa istanza. in caso contrario, 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita determina se l'ID di comando dell'oggetto specificato è uguale all'ID di comando di questa istanza. Eseguire l'override di questo metodo se è necessario eseguire un'ulteriore elaborazione per determinare se due `CMFCToolBarButton` oggetti sono uguali.  
  
##  <a name="copyfrom"></a>  CMFCToolBarButton::CopyFrom  
 Copia le proprietà di un altro pulsante della barra degli strumenti al pulsante corrente.  
  
```  
virtual void CopyFrom(const CMFCToolBarButton& src);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `src`  
 Un riferimento al pulsante di origine da cui copiare.  
  
### <a name="remarks"></a>Note  
 Chiamare questo metodo per copiare un altro pulsante della barra degli strumenti per questo pulsante sulla barra degli strumenti.  
  
##  <a name="createfromoledata"></a>  CMFCToolBarButton::CreateFromOleData  
 Crea un `CMFCToolBarButton` oggetto forniti `COleDataObject` oggetto.  
  
```  
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pDataObject`  
 L'oggetto origine dati OLE.  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto `CMFCToolBarButton` creato.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene utilizzato dal framework per eseguire il trasferimento dei dati in diversi formati. Ad esempio, il `CMFCOutlookBarPane::OnDragOver` metodo utilizza questo metodo per eseguire operazioni di trascinamento e rilascio.  
  
##  <a name="enablewindow"></a>  CMFCToolBarButton::EnableWindow  
 Abilita o disabilita l'input da mouse e tastiera.  
  
```  
virtual void EnableWindow(BOOL bEnable = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `bEnable`  
 Impostare questo parametro su `TRUE` per abilitare l'input, o a `FALSE` per disattivare l'input.  
  
### <a name="remarks"></a>Note  
 Questo metodo chiama il `EnableWindow` funzione per attivare o disattivare l'input. Per ulteriori informazioni, vedere [EnableWindow](http://msdn.microsoft.com/library/windows/desktop/ms646291) in Windows SDK.  
  
##  <a name="exporttomenubutton"></a>  CMFCToolBarButton::ExportToMenuButton  
 Copia il testo dal pulsante della barra degli strumenti a un menu.  
  
```  
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;  
```  
  
### <a name="parameters"></a>Parametri  
 [in] `menuButton`  
 Un riferimento al pulsante di menu di destinazione.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `TRUE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per copiare il testo da un pulsante della barra degli strumenti a un pulsante di menu. L'implementazione predefinita consente di copiare l'etichetta di testo del pulsante. Se l'etichetta di testo è vuoto, questo metodo copia il testo della descrizione comando del pulsante.  
  
 L'implementazione predefinita di questo metodo restituisce `TRUE`. Eseguire l'override di questo metodo se si desidera eseguire altre azioni quando il framework converte un oggetto derivato da [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) a un pulsante di menu.  
  
##  <a name="getclipboardformat"></a>  CMFCToolBarButton::GetClipboardFormat  
 Recupera il formato degli Appunti globale per l'applicazione.  
  
```  
static CLIPFORMAT __stdcall GetClipboardFormat();
```  
  
### <a name="return-value"></a>Valore restituito  
 Globale `CLIPFORMAT` valore per l'applicazione.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per recuperare il formato degli Appunti per operazioni di trasferimento di dati OLE. Ad esempio, il [CMFCToolBarButton::CreateFromOleData](#createfromoledata) metodo utilizza questo metodo per copiare i dati da un oggetto di origine dati OLE.  
  
 Questo metodo imposta globale `CLIPFORMAT` valore la prima volta, questo metodo viene chiamato. Tutte le chiamate successive a questo metodo restituiscono questo valore.  
  
 Per consentire operazioni di trascinamento e rilascio tra applicazioni, chiamare il [CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname) metodo.  
  
 Per ulteriori informazioni su Appunti in MFC, vedere [Appunti](../../mfc/clipboard.md).  
  
##  <a name="gethwnd"></a>  CMFCToolBarButton::GetHwnd  
 Recupera l'handle di finestra associata con il pulsante della barra degli strumenti.  
  
```  
virtual HWND GetHwnd();
```  
  
### <a name="return-value"></a>Valore restituito  
 L'handle della finestra associata con il pulsante della barra degli strumenti o `NULL` se il pulsante della barra degli strumenti non dispone di alcun handle di finestra associata.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo restituisce `NULL`. Eseguire l'override di questo metodo per restituire l'handle della finestra del controllo specifico.  
  
##  <a name="getimage"></a>  CMFCToolBarButton::GetImage  
 Recupera l'indice dell'immagine del pulsante.  
  
```  
int GetImage() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Indice dell'immagine associata al pulsante.  
  
### <a name="remarks"></a>Note  
 Se il pulsante ha un'immagine definita dall'utente (ovvero, se `bUserButton` stato `TRUE` nel costruttore), l'indice restituito specifica un'immagine della raccolta di immagini definite dall'utente (vedere [CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). In caso contrario, l'indice consente di specificare un'immagine della raccolta di immagini che vengono caricati da un file di risorse (vedere [CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Per ulteriori informazioni sui file di risorse, vedere [lavorare con file di risorse](../../windows/working-with-resource-files.md).  
  
##  <a name="getinvalidaterect"></a>  CMFCToolBarButton::GetInvalidateRect  
 Recupera l'area dell'area client del pulsante che deve essere ridisegnato.  
  
```  
virtual const CRect GetInvalidateRect() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto `CRect` oggetto che specifica l'area che deve essere ridisegnata.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo restituisce l'intera area client. Eseguire l'override di questo metodo se si desidera un'area diversa da ridisegnare.  
  
##  <a name="getparentwnd"></a>  CMFCToolBarButton::GetParentWnd  
 Recupera la finestra padre del pulsante.  
  
```  
CWnd* GetParentWnd() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 La finestra padre del pulsante.  
  
##  <a name="getprotectedcommands"></a>  CMFCToolBarButton::GetProtectedCommands  
 Recupera l'elenco di comandi che l'utente non è possibile personalizzare.  
  
```  
static const CList<UINT,UINT>& GetProtectedCommands();
```  
  
### <a name="return-value"></a>Valore restituito  
 L'elenco di comandi protetti.  
  
### <a name="remarks"></a>Note  
 Modalità di personalizzazione, il framework disabilita i comandi di pulsante della barra degli strumenti che sono protetti. L'utente non è possibile eseguire trascinamento e rilascio e modificare le operazioni sui pulsanti della barra degli strumenti disabilitato.  
  
 Utilizzare il [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) metodo per definire l'elenco di comandi è protetto.  
  
##  <a name="gettextsize"></a>  CMFCToolBarButton::GetTextSize  
 Recupera la dimensione del testo del pulsante.  
  
```  
SIZE GetTextSize() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto `SIZE` oggetto che contiene la dimensione, in pixel, del testo del pulsante.  
  
##  <a name="hasfocus"></a>  CMFCToolBarButton::HasFocus  
 Determina se il pulsante ha lo stato attivo di input corrente.  
  
```  
virtual BOOL HasFocus() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante ha lo stato attivo di input. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo restituisce diverso da zero se il pulsante ha lo stato attivo di input o una finestra figlio o discendente della finestra con lo stato attivo di input. È possibile eseguire l'override di questa funzione per personalizzare questo comportamento.  
  
##  <a name="havehotborder"></a>  CMFCToolBarButton::HaveHotBorder  
 Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante.  
  
```  
virtual BOOL HaveHotBorder() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `TRUE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per determinare se il pulsante della barra degli strumenti deve essere visualizzato un bordo quando un utente le seleziona.  
  
 L'implementazione predefinita restituisce `TRUE`. È possibile eseguire l'override di questo metodo per personalizzare questo comportamento.  
  
##  <a name="isdrawimage"></a>  CMFCToolBarButton::IsDrawImage  
 Determina se un'immagine viene visualizzata sul pulsante.  
  
```  
BOOL IsDrawImage() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'immagine viene visualizzata nel pulsante. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questo metodo restituisce `FALSE` se il pulsante della barra degli strumenti non dispone di alcuna immagine associato ( [CMFCToolBarButton::GetImage](#getimage) restituisce -1) o se [CMFCToolBarButton::m_bImage](#m_bimage) è impostato su `FALSE`.  
  
##  <a name="isdrawtext"></a>  CMFCToolBarButton::IsDrawText  
 Determina se un'etichetta di testo viene visualizzata sul pulsante.  
  
```  
BOOL IsDrawText() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se viene visualizzata un'etichetta di testo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questo metodo restituisce `FALSE` se il pulsante della barra degli strumenti non dispone di alcuna etichetta di testo associata ( [CMFCToolBarButton::m_strText](#m_strtext) è vuoto) o [CMFCToolBarButton::m_bText](#m_btext) è impostato su `FALSE`.  
  
##  <a name="isdroppeddown"></a>  CMFCToolBarButton::IsDroppedDown  
 Determina se il pulsante consente di visualizzare un sottomenu.  
  
```  
virtual BOOL IsDroppedDown() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo restituisce `FALSE`. Eseguire l'override di questo metodo per restituire `TRUE` se il controllo consente di visualizzare un sottomenu.  
  
##  <a name="iseditable"></a>  CMFCToolBarButton::IsEditable  
 Determina se il pulsante può essere personalizzato.  
  
```  
virtual BOOL IsEditable() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se un pulsante può essere personalizzato dall'utente. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti mediante trascinamento e rilascio o modificare le operazioni.  
  
 L'implementazione predefinita restituisce `FALSE` se l'ID di comando del pulsante è un comando standard (è possibile determinare questo chiamando il `IsStandardCommand` (funzione)) o se il comando è presente nell'elenco di ID protetti i comandi. Per ulteriori informazioni sui comandi protetti, vedere [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) e [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands).  
  
 Eseguire l'override di questo metodo per personalizzare il comportamento.  
  
##  <a name="isextrasize"></a>  CMFCToolBarButton::IsExtraSize  
 Determina se è possibile visualizzare il pulsante con un bordo esteso.  
  
```  
virtual BOOL IsExtraSize() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante della barra degli strumenti può essere visualizzato con un bordo esteso. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Diverse interfacce utilizzano dimensioni aggiuntive per i bordi dei pulsanti della barra degli strumenti (ad esempio, i pulsanti arrotondamenti).  
  
 Se l'utente sposta questo pulsante da una barra degli strumenti a altra, il framework chiama la [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) metodo. Il [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) metodo imposta il flag di maggiori dimensioni a quello della nuova barra degli strumenti padre (per ulteriori informazioni, vedere [CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).  
  
##  <a name="isfirstingroup"></a>  CMFCToolBarButton::IsFirstInGroup  
 Determina se il pulsante è nella prima posizione in un gruppo pulsante.  
  
```  
virtual BOOL IsFirstInGroup() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante è il primo pulsante in un gruppo pulsante; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Questo metodo consente di definire un *gruppo di pulsanti* come un set di pulsanti che si trova nella stessa riga e sono delimitati da separatori o sul bordo della barra degli strumenti adiacente. Questo metodo restituisce `FALSE` se il pulsante della barra degli strumenti si intende il **Personalizza** pulsante. Per ulteriori informazioni sul **Personalizza** pulsante, vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).  
  
 Chiamare il [CMFCToolBarButton::IsLastInGroup](#islastingroup) metodo per determinare se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.  
  
##  <a name="ishidden"></a>  CMFCToolBarButton::IsHidden  
 Determina se il pulsante è nascosto.  
  
```  
BOOL IsHidden() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante è nascosto (visibile); in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando viene estesa la barra degli strumenti padre per determinare se il pulsante della barra degli strumenti è visibile.  
  
 Se si imposta il pulsante deve essere invisibile utilizzando il [CMFCToolBarButton::SetVisible](#setvisible) metodo, utilizzare [CMFCToolBarButton::IsVisible](#isvisible) per determinare se il pulsante della barra degli strumenti è visibile.  
  
 Per impostazione predefinita, tutti i pulsanti della barra degli strumenti sono visibili. Utilizzare il [CMFCToolBarButton::Show](#show) metodo per visualizzare o nascondere i pulsanti della barra degli strumenti.  
  
##  <a name="ishorizontal"></a>  CMFCToolBarButton::IsHorizontal  
 Determina se il pulsante si trova su una barra orizzontale.  
  
```  
BOOL IsHorizontal() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se un pulsante della barra degli strumenti si trova su una barra orizzontale; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per determinare il layout dei pulsanti della barra degli strumenti.  
  
 Questo metodo restituisce il `m_bHorz` (membro dati). Il valore predefinito di `m_bHorz` membro dati è `TRUE`; viene reimpostato a ogni chiamata al [CMFCToolBarButton::OnDraw](#ondraw) (metodo).  
  
##  <a name="islastingroup"></a>  CMFCToolBarButton::IsLastInGroup  
 Specifica se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.  
  
```  
virtual BOOL IsLastInGroup() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante è l'ultimo pulsante in un gruppo pulsante; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Questo metodo consente di definire un *gruppo di pulsanti* come un set di pulsanti che si trova nella stessa riga e sono delimitati da separatori o il bordo della barra degli strumenti, questo metodo restituisce adiacente `FALSE` pulsante della barra degli strumenti non ha elementi padre barra degli strumenti o sul pulsante della barra degli strumenti si intende il **Personalizza** pulsante. Per ulteriori informazioni sul **Personalizza** pulsante, vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).  
  
 Chiamare il [CMFCToolBarButton::IsFirstInGroup](#isfirstingroup) metodo per determinare se il pulsante è nella prima posizione in un gruppo pulsante.  
  
##  <a name="islocked"></a>  CMFCToolBarButton::IsLocked  
 Determina se il pulsante è presente una barra degli strumenti (non personalizzabile) bloccato.  
  
```  
BOOL IsLocked() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante si trova in una barra degli strumenti bloccata; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti mediante trascinamento e rilascio o modificare le operazioni. Impostare l'attributo bloccato sulla barra degli strumenti padre tramite il [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) metodo. Il framework passa il valore di questo attributo al costruttore di ogni pulsante della barra degli strumenti ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) che viene inserito nella barra degli strumenti padre.  
  
##  <a name="isownerof"></a>  CMFCToolBarButton::IsOwnerOf  
 Determina se il pulsante è il proprietario dell'handle di finestra specificato.  
  
```  
virtual BOOL IsOwnerOf(HWND hwnd);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `hwnd`  
 Un handle di finestra.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante è il proprietario dell'handle di finestra specificato; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questo metodo restituisce diverso da zero se `hwnd` fa riferimento all'handle di finestra diretta o è un elemento figlio dell'handle di finestra associata con il pulsante. Questo metodo restituisce 0 se `hwnd` è `NULL`.  
  
##  <a name="isvisible"></a>  CMFCToolBarButton::IsVisible  
 Determina se il pulsante della barra degli strumenti è visibile.  
  
```  
BOOL IsVisible() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pulsante della barra degli strumenti è visibile; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 È possibile visualizzare o nascondere il pulsante della barra degli strumenti utilizzando il [CMFCToolBarButton::SetVisible](#setvisible) metodo. Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) (metodo) sulla barra degli strumenti padre dopo aver chiamato [CMFCToolBarButton::SetVisible](#setvisible) per ricalcolare il layout di una barra degli strumenti padre.  
  
##  <a name="iswindowvisible"></a>  CMFCToolBarButton::IsWindowVisible  
 Determina se l'handle di finestra sottostante del pulsante è visibile.  
  
```  
virtual BOOL IsWindowVisible();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'handle di finestra sottostante del pulsante è visibile; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene restituito diverso da zero se l'attributo di stili dell'handle di finestra sottostante contiene i `WS_VISIBLE` stile. Questo metodo restituisce `FALSE` se l'handle di finestra sottostante del pulsante è `NULL`.  
  
##  <a name="m_bimage"></a>  CMFCToolBarButton::m_bImage  
 Specifica se un'immagine è visualizzata sul pulsante.  
  
```  
BOOL m_bImage;  
```  
  
### <a name="remarks"></a>Note  
 Se questo membro dati è impostato su `TRUE`, il framework Visualizza l'immagine associata con il pulsante della barra degli strumenti; in caso contrario il framework non viene visualizzata l'immagine. Questo membro influisce sul valore restituito del [CMFCToolBarButton::m_bImage](#m_bimage) metodo.  
  
##  <a name="m_btext"></a>  CMFCToolBarButton::m_bText  
 Specifica se un'etichetta di testo viene visualizzata sul pulsante.  
  
```  
BOOL m_bText;  
```  
  
### <a name="remarks"></a>Note  
 Se questo membro dati è impostato su `TRUE`, il framework Visualizza l'etichetta di testo del pulsante della barra degli strumenti; in caso contrario il framework non viene visualizzata l'etichetta di testo. Questo membro influisce sul valore restituito del [CMFCToolBarButton::m_bText](#m_btext) metodo.  
  
##  <a name="m_btextbelow"></a>  CMFCToolBarButton::m_bTextBelow  
 Specifica se l'etichetta di testo viene visualizzato sotto l'immagine del pulsante.  
  
```  
BOOL m_bTextBelow;  
```  
  
### <a name="remarks"></a>Note  
 Se questa variabile è impostata su `TRUE`, il framework Visualizza il testo del pulsante sotto l'immagine. Il valore predefinito di questo membro è `FALSE`.  
  
##  <a name="m_buserbutton"></a>  CMFCToolBarButton::m_bUserButton  
 Specifica se il pulsante dispone di un'immagine definita dall'utente  
  
```  
BOOL m_bUserButton;  
```  
  
### <a name="remarks"></a>Note  
 Questo membro dati è impostato su `TRUE` quando il pulsante dispone di un'immagine definita dall'utente associata.  
  
##  <a name="m_bwholetext"></a>  CMFCToolBarButton::m_bWholeText  
 Specifica se il pulsante Visualizza la relativa etichetta full-text, anche se non è possibile inserirlo nel rettangolo di delimitazione.  
  
```  
BOOL m_bWholeText;  
```  
  
### <a name="remarks"></a>Note  
 Se questo membro dati è impostato su `TRUE`, il framework Visualizza l'etichetta di testo completo aumentando il pulsante. In caso contrario, il framework Tronca e accoda i puntini di sospensione ( **...** ) per l'etichetta di testo.  
  
##  <a name="m_bwrap"></a>  CMFCToolBarButton::m_bWrap  
 Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.  
  
```  
BOOL m_bWrap;  
```  
  
### <a name="remarks"></a>Note  
 Il framework imposta il membro dati `TRUE` quando il pulsante della barra degli strumenti non rientra nella riga corrente o quando si specifica un layout (ad esempio, un numero specifico di pulsanti della barra degli strumenti per ogni riga).  
  
 Se questo membro dati è impostato su, il framework inserito questo pulsante nella riga successiva `TRUE` e la barra degli strumenti è ancorato in orizzontale o a virgola mobile.  
  
 Il valore predefinito di questo membro dati è `FALSE`.  
  
##  <a name="m_bwraptext"></a>  CMFCToolBarButton::m_bWrapText  
 Specifica se le etichette di testo multilinea sono abilitate.  
  
```  
AFX_IMPORT_DATA static BOOL m_bWrapText;  
```  
  
### <a name="remarks"></a>Note  
 Se questa variabile membro statico è `TRUE`, il framework consente tutte le barre degli strumenti visualizzare le etichette di testo multilinea sui pulsanti della barra degli strumenti.  
  
 Il valore predefinito di questo membro dati è `FALSE`.  
  
##  <a name="m_nid"></a>  CMFCToolBarButton::m_nID  
 L'ID di comando del pulsante.  
  
```  
UINT m_nID;  
```  
  
### <a name="remarks"></a>Note  
 Un ID di comando di -1 indica che il pulsante è un separatore. Disporre di tutti i separatori di pulsante di `TBBS_SEPARATOR` stile. Vedere [CMFCToolBarButton::m_nStyle](#m_nstyle) per ulteriori informazioni sugli stili pulsante.  
  
##  <a name="m_nstyle"></a>  CMFCToolBarButton::m_nStyle  
 Lo stile del pulsante.  
  
```  
UINT m_nStyle;  
```  
  
### <a name="remarks"></a>Note  
 Vedere [stili del controllo barra degli strumenti](../../mfc/reference/toolbar-control-styles.md) per un elenco di stili dei pulsanti della barra degli strumenti disponibili.  
  
##  <a name="m_strtext"></a>  CMFCToolBarButton::m_strText  
 L'etichetta di testo del pulsante.  
  
```  
CString m_strText;  
```  
  
### <a name="remarks"></a>Note  
 Questo membro dati contiene l'etichetta di testo del pulsante. L'etichetta di testo può essere vuoto.  
  
##  <a name="notifycommand"></a>  CMFCToolBarButton::NotifyCommand  
 Specifica se il pulsante elabora il [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) messaggio.  
  
```  
virtual BOOL NotifyCommand(int iNotifyCode);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `iNotifyCode`  
 Il messaggio di notifica che è associato al comando.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando sta per inviare un [WM_COMMAND](http://msdn.microsoft.com/library/windows/desktop/ms647591) messaggio alla finestra padre.  
  
 Per impostazione predefinita, questo metodo restituisce `FALSE`. Eseguire l'override di questo metodo per restituire `TRUE` se si desidera elaborare il `WM_COMMAND` messaggio o `FALSE` per indicare che la barra degli strumenti padre deve gestire il messaggio.  
  
##  <a name="onaddtocustomizepage"></a>  CMFCToolBarButton::OnAddToCustomizePage  
 Chiamato dal framework quando il pulsante viene aggiunto a un **Personalizza** la finestra di dialogo.  
  
```  
virtual void OnAddToCustomizePage();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera eseguire un'azione quando il pulsante viene aggiunto a un **Personalizza** la finestra di dialogo.  
  
##  <a name="onbeforedrag"></a>  CMFCToolBarButton::OnBeforeDrag  
 Specifica se è possibile trascinare il pulsante.  
  
```  
virtual BOOL OnBeforeDrag() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante può essere trascinato; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo prima che l'utente inizia a trascinare il pulsante.  
  
 L'implementazione predefinita di questo metodo restituisce `TRUE`. Eseguire l'override di questo metodo per restituire `FALSE` per disabilitare il trascinamento del pulsante.  
  
##  <a name="onbeforedrop"></a>  CMFCToolBarButton::OnBeforeDrop  
 Specifica se un utente è possibile rilasciare il pulsante nella barra degli strumenti di destinazione.  
  
```  
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pTarget`  
 La destinazione dell'operazione di trascinamento e rilascio.  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante può essere rilasciato in barra degli strumenti destinazione forniti. in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo prima che il pulsante viene rilasciato in una barra degli strumenti.  
  
 L'implementazione predefinita di questo metodo restituisce `TRUE`. Eseguire l'override di questo metodo per restituire `FALSE` per disabilitare l'operazione di trascinamento nella destinazione specificata.  
  
##  <a name="oncalculatesize"></a>  CMFCToolBarButton::OnCalculateSize  
 Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.  
  
```  
virtual SIZE OnCalculateSize(
    CDC* pDC,  
    const CSize& sizeDefault,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pDC`  
 Il contesto di dispositivo che viene visualizzato il pulsante.  
  
 [in] `sizeDefault`  
 Le dimensioni predefinite del pulsante.  
  
 [in] `bHorz`  
 Lo stato di ancoraggio della barra degli strumenti padre. Questo parametro è `TRUE` se la barra degli strumenti è ancorato in orizzontale o se è mobile, o `FALSE` se la barra degli strumenti è ancorato in verticale.  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto `SIZE` struttura che contiene le dimensioni del pulsante, in pixel.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per determinare le dimensioni del pulsante della barra degli strumenti per il contesto di dispositivo specificato e lo stato di ancoraggio.  
  
 L'implementazione predefinita prende in considerazione lo stato di ancorare la barra degli strumenti, posizioni, il testo di sotto o a destra dell'immagine, testo e immagine e le dimensioni di testo e immagine (se vengono visualizzati).  
  
 Eseguire l'override di questo metodo se si desidera specificare le dimensioni di un pulsante standard (ad esempio, un pulsante Modifica casella).  
  
##  <a name="oncancelmode"></a>  CMFCToolBarButton::OnCancelMode  
 Chiamato dal framework per gestire il [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) messaggio.  
  
```  
virtual void OnCancelMode();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera gestire il [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) messaggio.  
  
##  <a name="onchangeparentwnd"></a>  CMFCToolBarButton::OnChangeParentWnd  
 Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.  
  
```  
virtual void OnChangeParentWnd(CWnd* pWndParent);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWndParent`  
 La nuova finestra padre.  
  
### <a name="remarks"></a>Note  
 Il pulsante viene inserito in una barra degli strumenti, ad esempio, quando l'utente trascina da una barra degli strumenti a un'altra.  
  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione.  
  
##  <a name="onclick"></a>  CMFCToolBarButton::OnClick  
 Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.  
  
```  
virtual BOOL OnClick(
    CWnd* pWnd,  
    BOOL bDelay=TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWnd`  
 La finestra padre del pulsante della barra degli strumenti.  
  
 [in] `bDelay`  
 `TRUE` Se il messaggio deve essere gestito con un ritardo.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando l'utente fa clic sul pulsante della barra degli strumenti.  
  
 L'implementazione predefinita non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio fare clic su.  
  
##  <a name="onclickup"></a>  CMFCToolBarButton::OnClickUp  
 Chiamato dal framework quando l'utente rilascia il pulsante del mouse.  
  
```  
virtual BOOL OnClickUp();
```  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando l'utente rilascia il pulsante della barra degli strumenti.  
  
 L'implementazione predefinita non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio fare clic su.  
  
##  <a name="oncontexthelp"></a>  CMFCToolBarButton::OnContextHelp  
 Chiamato dal framework quando la barra degli strumenti padre gestisce un `WM_HELPHITTEST` messaggio.  
  
```  
virtual BOOL OnContextHelp(CWnd* pWnd);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWnd`  
 La finestra padre del pulsante della barra degli strumenti.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio della Guida.  
  
 Per ulteriori informazioni sul `WM_HELPHITTEST` dei messaggi, vedere [TN028: supporto della Guida sensibile al contesto](../../mfc/tn028-context-sensitive-help-support.md).  
  
##  <a name="onctlcolor"></a>  CMFCToolBarButton::OnCtlColor  
 Chiamato dal framework quando la barra degli strumenti padre gestisce un `WM_CTLCOLOR` messaggio.  
  
```  
virtual HBRUSH OnCtlColor(
    CDC* pDC,  
    UINT nCtlColor);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pDC`  
 Il contesto di dispositivo che viene visualizzato il pulsante.  
  
 [in] `nCtlColor`  
 La notifica di colore specifico.  
  
### <a name="return-value"></a>Valore restituito  
 Un handle all'oggetto brush che utilizza il framework per disegnare lo sfondo del pulsante.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando si elabora la barra degli strumenti padre il `WM_CTLCOLOR` messaggio per un pulsante della barra degli strumenti contenente un controllo di Windows. Il framework non chiamare questo metodo se il pulsante della barra degli strumenti privi di finestra.  
  
 Il framework chiama questo metodo quando il framework della barra degli strumenti è in modalità di personalizzazione e il pulsante della barra degli strumenti è sbloccato. Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Per ulteriori informazioni sul blocco di pulsanti della barra degli strumenti, vedere [CMFCToolBarButton::IsLocked](#islocked).  
  
 L'implementazione predefinita non esegue alcuna operazione e restituisce `NULL`.  
  
##  <a name="oncustomizemenu"></a>  CMFCToolBarButton::OnCustomizeMenu  
 Consente il pulsante modificare il menu specificato quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.  
  
```  
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pMenu`  
 Il menu da personalizzare.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo e restituire un valore diverso da zero se si desidera modificare il contenuto del menu specificato.  
  
##  <a name="ondblclk"></a>  CMFCToolBarButton::OnDblClk  
 Chiamato dal framework quando la barra degli strumenti padre gestisce un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) messaggio.  
  
```  
virtual void OnDblClk(CWnd* pWnd);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWnd`  
 -   La finestra padre del pulsante.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene chiamato dal `CMFCToolBar::OnLButtonDblClk` metodo quando la barra degli strumenti padre gestisce un [WM_LBUTTONDBLCLK](http://msdn.microsoft.com/library/windows/desktop/ms645606) messaggio.  
  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione.  
  
##  <a name="ondraw"></a>  CMFCToolBarButton::OnDraw  
 Chiamato dal framework per disegnare il pulsante utilizzando le opzioni e gli stili specificati.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rect,  
    CMFCToolBarImages* pImages,  
    BOOL bHorz=TRUE,  
    BOOL bCustomizeMode=FALSE,  
    BOOL bHighlight=FALSE,  
    BOOL bDrawBorder=TRUE,  
    BOOL bGrayDisabledButtons=TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pDC`  
 Il contesto di dispositivo che viene visualizzato il pulsante.  
  
 [in] `rect`  
 Il rettangolo di delimitazione del pulsante.  
  
 [in] `pImages`  
 La raccolta di immagini della barra degli strumenti che è associata al pulsante.  
  
 [in] `bHorz`  
 Lo stato di ancoraggio della barra degli strumenti padre. Questo parametro è `TRUE` quando il pulsante è ancorato in orizzontale e `FALSE` quando il pulsante è ancorato in verticale.  
  
 [in] `bCustomizeMode`  
 Specifica se la barra degli strumenti è in modalità di personalizzazione. Questo parametro è `TRUE` quando la barra degli strumenti è in modalità di personalizzazione e `FALSE` quando la barra degli strumenti non è in modalità di personalizzazione.  
  
 [in] `bHighlight`  
 Specifica se il pulsante è evidenziato. Questo parametro è `TRUE` quando il pulsante è evidenziato e `FALSE` quando il pulsante non sia più evidenziato.  
  
 [in] `bDrawBorder`  
 Specifica se il pulsante deve essere visualizzato un bordo. Questo parametro è `TRUE` quando il pulsante deve essere visualizzato un bordo e `FALSE` quando il pulsante non dovrebbe visualizzare il bordo.  
  
 [in] `bGrayDisabledButtons`  
 Specifica se ombreggiate pulsanti disabilitati o utilizzare la raccolta di immagini disabilitato. Questo parametro è `TRUE` quando pulsanti disabilitati devono essere disattivati e `FALSE` quando questo metodo devono utilizzare la raccolta di immagini disabilitato.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questo metodo per personalizzare il disegno di pulsante della barra degli strumenti.  
  
##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarButton::OnDrawOnCustomizeList  
 Chiamato dal framework per disegnare il pulsante di **comandi** riquadro del **Personalizza** la finestra di dialogo.  
  
```  
virtual int OnDrawOnCustomizeList(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bSelected);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pDC`  
 Il contesto di dispositivo che viene visualizzato il pulsante.  
  
 [in] `rect`  
 Il rettangolo di delimitazione del pulsante.  
  
 [in] `bSelected`  
 Specifica se il pulsante è selezionato. Se questo parametro è `TRUE`, il pulsante è selezionato. Se questo parametro è `FALSE`, il pulsante non è selezionato.  
  
### <a name="return-value"></a>Valore restituito  
 La larghezza, in pixel, del pulsante di contesto di dispositivo specificato.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene chiamato per la finestra di dialogo di personalizzazione ( **comandi** scheda) quando il pulsante sta per essere visualizzato nella casella di riepilogo di disegno personalizzato.  
  
 L'implementazione predefinita di questo metodo consente di visualizzare l'immagine e testo etichetta del pulsante se sono disponibili. Se l'etichetta di testo del pulsante non è disponibile, il metodo visualizza il testo della descrizione comando.  
  
 Eseguire l'override di questo metodo per eseguire il disegno personalizzato.  
  
##  <a name="ongetcustomtooltiptext"></a>  CMFCToolBarButton::OnGetCustomToolTipText  
 Chiamato dal framework per recuperare il testo della descrizione comando personalizzato per il pulsante.  
  
```  
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```  
  
### <a name="parameters"></a>Parametri  
 [out] `strToolTip`  
 Oggetto `CString` oggetto che riceve il testo della descrizione comando personalizzato.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando viene visualizzata la descrizione comando per il pulsante della barra degli strumenti. Se questo metodo restituisce `FALSE`, il framework utilizza una descrizione comandi predefinita.  
  
 L'implementazione predefinita non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo e restituire un valore diverso da zero per fornire il testo della descrizione comando personalizzato per il pulsante della barra degli strumenti.  
  
##  <a name="onglobalfontschanged"></a>  CMFCToolBarButton::OnGlobalFontsChanged  
 Chiamato dal framework quando viene modificato il tipo di carattere globale.  
  
```  
virtual void OnGlobalFontsChanged();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare il tipo di carattere utilizzato per visualizzare il testo del pulsante.  
  
##  <a name="onmove"></a>  CMFCToolBarButton::OnMove  
 Chiamato dal framework quando si sposta la barra degli strumenti padre.  
  
```  
virtual void OnMove();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per riposizionare il pulsante quando si sposta la barra degli strumenti padre.  
  
##  <a name="onshow"></a>  CMFCToolBarButton::OnShow  
 Chiamato dal framework quando il pulsante diventa visibile o invisibile.  
  
```  
virtual void OnShow(BOOL bShow);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `bShow`  
 Specifica se il pulsante è visibile. Se questo parametro è `TRUE`, il pulsante è visibile. In caso contrario, il pulsante non è visibile.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare la visibilità del pulsante.  
  
##  <a name="onsize"></a>  CMFCToolBarButton::OnSize  
 Chiamato dal framework quando la barra degli strumenti padre cambia la dimensione o posizione e la modifica, il pulsante modificare le dimensioni.  
  
```  
virtual void OnSize(int iSize);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `iSize`  
 La nuova larghezza del pulsante.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per ridimensionare il pulsante Modifica le dimensioni o la posizione della barra degli strumenti padre.  
  
##  <a name="ontoolhittest"></a>  CMFCToolBarButton::OnToolHitTest  
 Chiamato dal framework quando la barra degli strumenti padre è necessario determinare se un punto si trova il rettangolo di delimitazione del pulsante.  
  
```  
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,  
    TOOLINFO* pTI);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWnd`  
 La finestra padre del pulsante. Può essere `NULL`.  
  
 [in] `pTI`  
 Oggetto `TOOLINFO` struttura che contiene informazioni su uno strumento in un controllo descrizione comando.  
  
### <a name="return-value"></a>Valore restituito  
 Il risultato di `OnMenuButtonToolHitTest` se il pulsante è possibile recuperare un puntatore alla finestra cornice padre; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Se la finestra padre può convertire un oggetto intervallo valido, questo metodo chiama uno dei metodi seguenti:  
  
- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)  
  
- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)  
  
- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)  
  
##  <a name="onupdatetooltip"></a>  CMFCToolBarButton::OnUpdateToolTip  
 Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.  
  
```  
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,  
    int iButtonIndex,  
    CToolTipCtrl& wndToolTip,  
    CString& str);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pWndParent`  
 La finestra padre.  
  
 [in] `iButtonIndex`  
 Indice in base zero del pulsante nella raccolta di pulsante padre.  
  
 [in] `wndToolTip`  
 Il controllo che visualizza il testo della descrizione comando.  
  
 [out] `str`  
 Oggetto `CString` oggetto che riceve il testo della descrizione aggiornata.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `FALSE`.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce `FALSE`. Eseguire l'override di questo metodo per restituire un valore diverso da zero se si specifica una stringa di testo della descrizione comando.  
  
##  <a name="preparedrag"></a>  CMFCToolBarButton::PrepareDrag  
 Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento e rilascio.  
  
```  
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `srcItem`  
 Oggetto `COleDataSource` oggetto che archivia le informazioni sullo stato relative all'operazione di trascinamento e rilascio.  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se l'operazione ha esito positivo; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per preparare il pulsante della barra degli strumenti per archiviare lo stato nell'oggetto fornito `COleDataSource` oggetto. Questo metodo archivia lo stato stesso serializzazione in un file condiviso e passando quindi che il file di [COleDataSource:: CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) metodo. Per ulteriori informazioni sulla serializzazione pulsante della barra degli strumenti, vedere [CMFCToolBarButton::Serialize](#serialize).  
  
 Questo metodo non esegue alcuna operazione e restituisce `TRUE` se non può essere archiviato il pulsante (il [CMFCToolBarButton::CanBeStored](#canbestored) restituisce `FALSE`). Restituisce `FALSE` se si verifica un'eccezione durante la serializzazione degli oggetti.  
  
 Per ulteriori informazioni sulle operazioni di trascinamento e rilascio OLE, vedere [trascinamento della selezione (OLE)](../../mfc/drag-and-drop-ole.md).  
  
##  <a name="rect"></a>  CMFCToolBarButton::Rect  
 Recupera il rettangolo di delimitazione del pulsante.  
  
```  
const CRect& Rect() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Oggetto `CRect` oggetto che contiene il rettangolo di delimitazione di un pulsante.  
  
##  <a name="resetimagetodefault"></a>  CMFCToolBarButton::ResetImageToDefault  
 Imposta il valore predefinito dell'immagine associata con il pulsante.  
  
```  
virtual void ResetImageToDefault();
```  
  
### <a name="remarks"></a>Note  
 Questo metodo recupera l'immagine predefinita dalla barra degli strumenti padre utilizzando il [CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) metodo. Se il pulsante non dispone di alcuna immagine predefinita associato, questo metodo imposta l'etichetta di testo del pulsante in base alla relativa risorsa di tipo stringa utilizzando il [CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) metodo. Per ulteriori informazioni sulle risorse di stringa, vedere [lavorare con file di risorse](../../windows/working-with-resource-files.md).  
  
 Questo metodo non esegue alcuna operazione se il pulsante ha un'immagine definita dall'utente.  
  
##  <a name="savebarstate"></a>  CMFCToolBarButton::SaveBarState  
 Salva lo stato del pulsante della barra degli strumenti.  
  
```  
virtual void SaveBarState();
```  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando viene creato un `CMFCToolBarButton` oggetto come risultato di un'operazione di trascinamento e rilascio.  
  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per salvare lo stato del pulsante della barra degli strumenti in un'origine dati esterna.  
  
##  <a name="serialize"></a>  CMFCToolBarButton::Serialize  
 Legge l'oggetto da un archivio o scrive in un archivio.  
  
```  
virtual void Serialize(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `ar`  
 Il `CArchive` oggetto da cui o in cui serializzare.  
  
### <a name="remarks"></a>Note  
 Questo metodo supporta i processi di trasferimento di dati, ad esempio gli Appunti o le operazioni di trascinamento e rilascio. Legge o scrive le proprietà del pulsante, ad esempio l'ID, l'etichetta di testo e ID dell'immagine da o per l'oggetto fornito `CArchive` oggetto.  
  
 Per esempi di serializzazione, vedere [serializzazione: serializzazione di un oggetto](../../mfc/serialization-serializing-an-object.md).  
  
##  <a name="setaccdata"></a>  CMFCToolBarButton::SetACCData  
 Popola l'oggetto specificato `CAccessibilityData` oggetto con i dati di accessibilità dal pulsante della barra degli strumenti.  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,  
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `pParent`  
 La finestra padre del pulsante della barra degli strumenti.  
  
 [in] `data`  
 Oggetto `CAccessibilityData` oggetto popolato con i dati di accessibilità del pulsante della barra degli strumenti.  
  
### <a name="return-value"></a>Valore restituito  
 Questo metodo restituisce `TRUE`.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questo metodo per restituire `FALSE` se il pulsante della barra degli strumenti non fornisce i dati di accessibilità.  
  
##  <a name="setclipboardformatname"></a>  CMFCToolBarButton::SetClipboardFormatName  
 Rinomina il formato degli Appunti globale.  
  
```  
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `lpszName`  
 Il nuovo nome del formato degli Appunti globale. Non può essere `NULL`.  
  
### <a name="remarks"></a>Note  
 Questo metodo rende possibile per le operazioni di trascinamento e rilascio di verificarsi tra più applicazioni. Ogni applicazione deve fornire lo stesso nome di formato degli Appunti.  
  
 È necessario chiamare questo metodo prima il framework chiama [CMFCToolBarButton::GetClipboardFormat](#getclipboardformat).  
  
##  <a name="setimage"></a>  CMFCToolBarButton::SetImage  
 Imposta l'indice dell'immagine del pulsante.  
  
```  
virtual void SetImage(int iImage);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `iImage`  
 Indice dell'immagine della raccolta di immagini della barra degli strumenti.  
  
### <a name="remarks"></a>Note  
 Se il pulsante della barra degli strumenti è un separatore, `iImage` fa riferimento per la nuova larghezza del separatore.  
  
 Se `iImage` è minore di zero, questo metodo disabilita il disegno dell'immagine e consente di disegno dell'etichetta di testo del pulsante.  
  
##  <a name="setprotectedcommands"></a>  CMFCToolBarButton::SetProtectedCommands  
 Imposta l'elenco di comandi che l'utente non è possibile personalizzare.  
  
```  
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `lstCmds`  
 L'elenco di comandi protetti.  
  
### <a name="remarks"></a>Note  
 Modalità di personalizzazione, il framework disabilita i comandi di pulsante della barra degli strumenti che sono protetti. L'utente non è possibile eseguire trascinamento e rilascio e modificare le operazioni sui pulsanti della barra degli strumenti disabilitato.  
  
 Utilizzare il [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) metodo per recuperare l'elenco di comandi è protetto.  
  
##  <a name="setradio"></a>  CMFCToolBarButton::SetRadio  
 Chiamato dal framework quando un pulsante viene modificato lo stato.  
  
```  
virtual void SetRadio();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per eseguire un'azione personalizzata quando il pulsante Cambia lo stato.  
  
##  <a name="setrect"></a>  CMFCToolBarButton::SetRect  
 Imposta il rettangolo di delimitazione del pulsante.  
  
```  
void SetRect(const CRect rect);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `rect`  
 Il nuovo rettangolo di delimitazione del pulsante.  
  
### <a name="remarks"></a>Note  
 Questo metodo chiama il [CMFCToolBarButton::OnMove](#onmove) metodo dopo avere impostato il nuovo rettangolo di delimitazione.  
  
##  <a name="setstyle"></a>  CMFCToolBarButton::SetStyle  
 Imposta lo stile del pulsante.  
  
```  
virtual void SetStyle(UINT nStyle);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `nStyle`  
 Il nuovo stile del pulsante.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita imposta il [CMFCToolBarButton::m_nStyle](#m_nstyle) un membro dati `nStyle`. Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione aggiuntiva per gestire la modifica in stile. Vedere [stili del controllo barra degli strumenti](toolbar-control-styles.md) per un elenco di flag di stile valido.  
  
##  <a name="setvisible"></a>  CMFCToolBarButton::SetVisible  
 Specifica se il pulsante è visibile.  
  
```  
void SetVisible(BOOL bShow=TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `bShow`  
 Valore booleano che specifica se mostrare o nascondere il pulsante. Se questo parametro è `TRUE`, viene visualizzato il pulsante. Se il parametro è `FALSE`, il pulsante è nascosto.  
  
### <a name="remarks"></a>Note  
 Utilizzare questa funzione per nascondere o mostrare un pulsante della barra degli strumenti specifica. Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) metodo dopo aver chiamato questo metodo.  
  
##  <a name="show"></a>  CMFCToolBarButton::Show  
 Mostra o nasconde il pulsante.  
  
```  
void Show(BOOL bShow);
```  
  
### <a name="parameters"></a>Parametri  
 [in] `bShow`  
 Valore booleano che specifica se mostrare o nascondere il pulsante. Se questo parametro è `TRUE`, viene visualizzato il pulsante. Se il parametro è `FALSE`, il pulsante è nascosto.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo per aggiornare la visibilità dei pulsanti della barra degli strumenti quando si ridimensiona la barra degli strumenti padre. Il framework chiama questo metodo con `bShow` impostato su `FALSE` quando il pulsante non è più adatta all'interno della barra degli strumenti. Il framework chiama questo metodo con `bShow` impostato su `TRUE` se dopo il ridimensionamento sul pulsante nuovo rientra nei limiti della barra degli strumenti.  
  
 Utilizzare il [CMFCToolBarButton::SetVisible](#setvisible) per impostare la visibilità del pulsante generale.  
  
 Questo metodo chiama il [CMFCToolBarButton::OnShow](#onshow) metodo dopo che aggiornato lo stato di visibilità del pulsante.  
  
## <a name="see-also"></a>Vedere anche  
 [Grafico delle gerarchie](../../mfc/hierarchy-chart.md)   
 [Classi](../../mfc/reference/mfc-classes.md)   
 [Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)   
 [Classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)
