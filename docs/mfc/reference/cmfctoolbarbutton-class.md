---
title: Classe CMFCToolBarButton
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: 8e96740ba6755f489be07fbf8996cfa8b049314a
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/22/2020
ms.locfileid: "81754023"
---
# <a name="cmfctoolbarbutton-class"></a>Classe CMFCToolBarButton

Fornisce la funzionalità dei pulsanti alle barre degli strumenti.

## <a name="syntax"></a>Sintassi

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|Costruisce e inizializza un oggetto `CMFCToolBarButton`.|
|`CMFCToolBarButton::~CMFCToolBarButton`|Distruttore.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|Specifica se un utente può posizionare un pulsante su una barra degli strumenti o un menu durante la personalizzazione.|
|[CMFCToolBarButton::CanBeStored](#canbestored)|Specifica se il pulsante può essere memorizzato.|
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|Specifica se un utente può estendere il pulsante durante la personalizzazione.|
|[CMFCToolBarButton::CompareWith](#comparewith)|Confronta questa istanza con `CMFCToolBarButton` l'oggetto fornito.|
|[CMFCToolBarButton::CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti nel pulsante corrente.|
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|Crea `CMFCToolBarButton` un oggetto `COleDataObject` dall'oggetto fornito.|
|`CMFCToolBarButton::CreateObject`|Usato dal framework per creare un'istanza dinamica di questo tipo di classe.|
|[CMFCToolBarButton::EnableWindow](#enablewindow)|Abilita o disabilita l'input da mouse e tastiera.|
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|Copia il testo dal pulsante della barra degli strumenti in un menu.|
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|Recupera il formato globale degli Appunti per l'applicazione.|
|[CMFCToolBarButton::GetHwnd](#gethwnd)|Recupera l'handle di finestra associato al pulsante della barra degli strumenti.|
|[CMFCToolBarButton::GetImage](#getimage)|Recupera l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|Recupera l'area dell'area client del pulsante che deve essere ridisegnata.|
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|Recupera la finestra padre del pulsante.|
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|Recupera l'elenco di comandi che l'utente non può personalizzare.|
|[CMFCToolBarButton::GetTextSize](#gettextsize)|Recupera le dimensioni del testo del pulsante.|
|[CMFCToolBarButton::HasFocus](#hasfocus)|Determina se il pulsante ha lo stato attivo per l'input corrente.|
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|Determina se viene visualizzato un bordo del pulsante quando un utente seleziona il pulsante.|
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|Determina se un'immagine viene visualizzata sul pulsante.|
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|Determina se un'etichetta di testo viene visualizzata sul pulsante.|
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|Determina se il pulsante visualizza un sottomenu.|
|[CMFCToolBarButton::IsEditable](#iseditable)|Determina se il pulsante può essere personalizzato.|
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|Determina se il pulsante può essere visualizzato con un bordo esteso.|
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|Determina se il pulsante si trova nella prima posizione nel relativo gruppo di pulsanti.|
|[CMFCToolBarButton::IsHidden](#ishidden)|Determina se il pulsante è nascosto.|
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|Determina se il pulsante si trova su una barra degli strumenti orizzontale.|
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|Specifica se il pulsante si trova nell'ultima posizione nel relativo gruppo di pulsanti.|
|[CMFCToolBarButton::IsLocked](#islocked)|Determina se il pulsante si trova su una barra degli strumenti bloccata (non personalizzabile).|
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|Determina se il pulsante è il proprietario dell'handle di finestra fornito.|
|[CMFCToolBarButton::IsVisible](#isvisible)|Determina se il pulsante della barra degli strumenti è visibile.|
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|Determina se l'handle di finestra sottostante del pulsante è visibile.|
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|Specifica se il pulsante elabora il messaggio [WM_COMMAND.](/windows/win32/menurc/wm-command)|
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|Chiamato dal framework quando il pulsante viene aggiunto a una finestra di dialogo **Personalizza.**|
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|Specifica se il pulsante può essere trascinato.|
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|Specifica se un utente può rilasciare il pulsante sulla barra degli strumenti di destinazione.|
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.|
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|Chiamato dal framework per gestire il [messaggio di WM_CANCELMODE.](/windows/win32/winmsg/wm-cancelmode)|
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.|
|[CMFCToolBarButton::OnClick](#onclick)|Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.|
|[CMFCToolBarButton::OnClickUp](#onclickup)|Chiamato dal framework quando l'utente rilascia il pulsante del mouse.|
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_HELPHITTEST.|
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_CTLCOLOR.|
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|Consente al pulsante di modificare il menu fornito quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.|
|[CMFCToolBarButton::OnDblClk](#ondblclk)|Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio [di WM_LBUTTONDBLCLK.](/windows/win32/inputdev/wm-lbuttondblclk)|
|[CMFCToolBarButton::OnDraw](#ondraw)|Chiamato dal framework per disegnare il pulsante utilizzando gli stili e le opzioni specificati.|
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Chiamato dal framework per disegnare il pulsante nel riquadro **Comandi** della finestra di dialogo **Personalizza.**|
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|Chiamato dal framework per recuperare il testo della descrizione comandi personalizzata per il pulsante.|
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|Chiamato dal framework quando il tipo di carattere globale è stato modificato.|
|[CMFCToolBarButton::OnMove](#onmove)|Chiamato dal framework quando si sposta la barra degli strumenti padre.|
|[CMFCToolBarButton::OnShow](#onshow)|Chiamato dal framework quando il pulsante diventa visibile o invisibile.|
|[CMFCToolBarButton::OnSize](#onsize)|Chiamato dal framework quando la barra degli strumenti padre modifica le dimensioni o la posizione e questa modifica richiede che il pulsante modifichi le dimensioni.|
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|Chiamato dal framework quando la barra degli strumenti padre deve determinare se un punto si trova nel rettangolo di delimitazione del pulsante.|
|[Suggerimento Per CMFCToolBarButton::OnUpdateTool](#onupdatetooltip)|Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comandi.|
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento della selezione.|
|[CMFCToolBarButton::Rect](#rect)|Recupera il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|Imposta sul valore predefinito l'immagine associata al pulsante.|
|[CMFCToolBarButton::SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti.|
|[CMFCToolBarButton::Serialize](#serialize)|Legge l'oggetto da un archivio o lo scrive in un archivio. Esegue l'override di [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).|
|[CMFCToolBarButton::SetACCData](#setaccdata)|Popola `CAccessibilityData` l'oggetto fornito con i dati di accessibilità dal pulsante della barra degli strumenti.|
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|Rinomina il formato degli Appunti globali.|
|[CMFCToolBarButton::SetImage](#setimage)|Imposta l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|Imposta l'elenco dei comandi che l'utente non può personalizzare.|
|[CMFCToolBarButton::SetRadio](#setradio)|Chiamato dal framework quando un pulsante cambia lo stato controllato.|
|[CMFCToolBarButton::SetRect](#setrect)|Imposta il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton::SetStyle](#setstyle)|Imposta lo stile del pulsante.|
|[CMFCToolBarButton::SetVisible](#setvisible)|Specifica se il pulsante è visibile.|
|[CMFCToolBarButton::Mostra](#show)|Mostra o nasconde il pulsante.|

### <a name="data-members"></a>Membri dei dati

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::m_bImage](#m_bimage)|Specifica se un'immagine viene visualizzata sul pulsante.|
|[CMFCToolBarButton::m_bText](#m_btext)|Specifica se un'etichetta di testo viene visualizzata sul pulsante.|
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|Specifica se l'etichetta di testo viene visualizzata sotto l'immagine sul pulsante.|
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|Specifica se il pulsante dispone di un'immagine definita dall'utente.|
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|Specifica se il pulsante visualizza l'etichetta full-text anche se non rientra nel rettangolo di delimitazione.|
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.|
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|Specifica se le etichette di testo su più righe sono abilitate.|
|[CMFCToolBarButton::m_nID](#m_nid)|ID di comando del pulsante.|
|[Controllo CMFCToolBarButton::M_NSTYLE](#m_nstyle)|Stile del pulsante.|
|[CMFCToolBarButton::m_strText](#m_strtext)|Etichetta di testo del pulsante.|

## <a name="remarks"></a>Osservazioni

Un `CMFCToolbarButton` oggetto è un controllo che si trova su una barra degli strumenti. Il suo comportamento assomiglia a quello di un pulsante ordinario. È possibile assegnare un'immagine e un'etichetta di testo a questo oggetto. Un pulsante della barra degli strumenti può anche avere un ID di comando. Quando l'utente fa clic sul pulsante della barra degli strumenti, il framework esegue il comando specificato da questo ID.

In genere, i pulsanti della barra degli strumenti possono essere personalizzati: l'utente può trascinare i pulsanti da una barra degli strumenti all'altra e copiare, incollare, eliminare e modificare le etichette e le immagini di testo. Per impedire all'utente di personalizzare la barra degli strumenti, è possibile bloccare la barra degli strumenti in uno dei due modi. Impostare `bLocked` il flag su TRUE quando si chiama [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar)oppure aggiungere l'ID di comando di un singolo pulsante all'elenco globale dei comandi protetti utilizzando il [metodo CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) .

`CMFCToolBarButton`gli oggetti visualizzano le immagini delle raccolte globali di immagini della barra degli strumenti nell'applicazione. Questi insiemi vengono gestiti dalla barra degli strumenti padre, [CMFCToolBar Class](../../mfc/reference/cmfctoolbar-class.md). Per ulteriori informazioni, vedere [CMFCToolBarImages (classe).](../../mfc/reference/cmfctoolbarimages-class.md)

Quando l'utente fa clic su un pulsante della barra degli strumenti, la barra degli strumenti padre elabora il messaggio del mouse e comunica le azioni appropriate al pulsante. Se il pulsante ha un ID di comando valido, la barra degli strumenti padre invia il messaggio di WM_COMMAND al frame padre.

La `CMFCToolBarButton` classe è la classe base per altre classi di pulsanti della barra degli strumenti, ad esempio [CMFCToolBarMenuButton Class](../../mfc/reference/cmfctoolbarmenubutton-class.md), [CMFCToolBarEditBoxButton Class](../../mfc/reference/cmfctoolbareditboxbutton-class.md)e [CMFCToolBarComboBoxButton (Classe).](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md)

## <a name="example"></a>Esempio

Nell'esempio seguente viene `CMFCToolBarButton` illustrato come configurare `CMFCToolBarButton` un oggetto utilizzando vari metodi nella classe. L'esempio illustra come abilitare l'input del mouse e della tastiera, impostare l'indice dell'immagine del pulsante, impostare il rettangolo di delimitazione del pulsante e rendere visibile il pulsante. Questo frammento di codice fa parte [dell'esempio di controllo struttura a](../../overview/visual-cpp-samples.md)schede .

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>Requisiti

**Intestazione:** afxtoolbarbutton.h

## <a name="cmfctoolbarbuttoncanbedropped"></a><a name="canbedropped"></a>CMFCToolBarButton::CanBeDropped

Specifica se un utente può posizionare un pulsante su una barra degli strumenti o un menu durante la personalizzazione.

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>Parametri

*pBarra degli strumenti*<br/>
[in] Non utilizzato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Per impostazione predefinita, un pulsante della barra degli strumenti può essere rilasciato su ogni barra degli strumenti personalizzabile (ovvero non bloccata).

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo e restituire FALSE se si desidera impedire all'utente di riposizionare il pulsante.

## <a name="cmfctoolbarbuttoncanbestored"></a><a name="canbestored"></a>CMFCToolBarButton::CanBeStored

Determina se il pulsante può essere archiviato.

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il framework utilizza questo metodo per determinare se il pulsante può partecipare a un'operazione di trascinamento della selezione.

L'implementazione predefinita restituisce TRUE. Eseguire l'override di questo metodo se il pulsante non può essere archiviato come parte di un'operazione di trascinamento della selezione. Per ulteriori informazioni sulle operazioni di trascinamento della selezione, vedere [OLE drag and drop](../../mfc/drag-and-drop-ole.md).

## <a name="cmfctoolbarbuttoncanbestretched"></a><a name="canbestretched"></a>CMFCToolBarButton::CanBeStretched

Specifica se un utente può estendere il pulsante durante la personalizzazione.

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo viene utilizzato dal framework per determinare se il pulsante può essere esteso in modalità di personalizzazione.

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE per un controllo a larghezza variabile, ad esempio una casella combinata o un dispositivo di scorrimento.

Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).

## <a name="cmfctoolbarbuttoncmfctoolbarbutton"></a><a name="cmfctoolbarbutton"></a>CMFCToolBarButton::CMFCToolBarButton

Costruisce e inizializza un oggetto `CMFCToolBarButton`.

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Parametri

*uiID*<br/>
[in] ID di comando del pulsante.

*iImage (immagine)*<br/>
[in] Indice dell'immagine del pulsante nella raccolta di immagini.

*lpszText*<br/>
[in] Etichetta di testo del pulsante. Può essere NULL.

*bPulsante utente*<br/>
[in] Valore booleano che determina se il pulsante è definito dall'utente. Se questo parametro è TRUE, il pulsante è definito dall'utente. In caso contrario, l'immagine del pulsante viene caricata da una risorsa.

*Bloccato*<br/>
[in] Valore booleano che determina se il pulsante può essere personalizzato. Se questo parametro è TRUE, il pulsante non può essere personalizzato. In caso contrario, il pulsante può essere personalizzato.

## <a name="cmfctoolbarbuttoncomparewith"></a><a name="comparewith"></a>CMFCToolBarButton::CompareWith

Confronta questa istanza con `CMFCToolBarButton` l'oggetto fornito.

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Parametri

*Altro*<br/>
[in] Riferimento all'oggetto da confrontare con questa istanza.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'oggetto fornito è uguale al valore di questa istanza; in caso contrario, 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita determina se l'ID di comando dell'oggetto fornito è uguale all'ID di comando di questa istanza. Eseguire l'override di questo metodo se `CMFCToolBarButton` è necessario eseguire un'elaborazione aggiuntiva per determinare se due oggetti sono uguali.

## <a name="cmfctoolbarbuttoncopyfrom"></a><a name="copyfrom"></a>CMFCToolBarButton::CopyFrom

Copia le proprietà di un altro pulsante della barra degli strumenti nel pulsante corrente.

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Parametri

*src*<br/>
[in] Un riferimento al pulsante di origine da cui copiare.

### <a name="remarks"></a>Osservazioni

Chiamare questo metodo per copiare un altro pulsante della barra degli strumenti in questo pulsante della barra degli strumenti.

## <a name="cmfctoolbarbuttoncreatefromoledata"></a><a name="createfromoledata"></a>CMFCToolBarButton::CreateFromOleData

Crea `CMFCToolBarButton` un oggetto `COleDataObject` dall'oggetto fornito.

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject (oggetto PDataObject)*<br/>
[in] Oggetto dati OLE di origine.

### <a name="return-value"></a>Valore restituito

L'oggetto `CMFCToolBarButton` creato.

### <a name="remarks"></a>Osservazioni

Questo metodo viene utilizzato dal framework per eseguire il trasferimento dei dati in vari formati. Ad esempio, `CMFCOutlookBarPane::OnDragOver` il metodo utilizza questo metodo per eseguire operazioni di trascinamento della selezione.

## <a name="cmfctoolbarbuttonenablewindow"></a><a name="enablewindow"></a>CMFCToolBarButton::EnableWindow

Abilita o disabilita l'input da mouse e tastiera.

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*bEnable*<br/>
[in] Impostare questo parametro su TRUE per abilitare l'input o su FALSE per disabilitare l'input.

### <a name="remarks"></a>Osservazioni

Questo metodo `EnableWindow` chiama la funzione per abilitare o disabilitare l'input. Per ulteriori informazioni, vedere [EnableWindow](/windows/win32/api/winuser/nf-winuser-enablewindow) in Windows SDK.

## <a name="cmfctoolbarbuttonexporttomenubutton"></a><a name="exporttomenubutton"></a>CMFCToolBarButton::ExportToMenuButton

Copia il testo dal pulsante della barra degli strumenti in un menu.

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>Parametri

*menuButton*<br/>
[in] Un riferimento al pulsante del menu di destinazione.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per copiare il testo da un pulsante della barra degli strumenti a un pulsante di menu. L'implementazione predefinita copia l'etichetta di testo del pulsante. Se l'etichetta di testo è vuota, questo metodo copia il testo della descrizione comando del pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo se si desidera eseguire azioni aggiuntive quando il framework converte un oggetto derivato da [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) in un pulsante di menu.

## <a name="cmfctoolbarbuttongetclipboardformat"></a><a name="getclipboardformat"></a>CMFCToolBarButton::GetClipboardFormat

Recupera il formato globale degli Appunti per l'applicazione.

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>Valore restituito

Valore CLIPFORMAT globale per l'applicazione.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per recuperare il formato degli Appunti per le operazioni di trasferimento dati OLE. Ad esempio, il [CMFCToolBarButton::CreateFromOleData](#createfromoledata) metodo utilizza questo metodo per copiare i dati da un oggetto dati OLE di origine.

Questo metodo imposta il valore CLIPFORMAT globale la prima volta che viene chiamato questo metodo. Tutte le chiamate successive a questo metodo restituiscono questo valore.

Per consentire l'operazione di trascinamento della selezione tra le applicazioni, chiamare il [CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname) metodo.

Per ulteriori informazioni sugli Appunti in MFC, vedere [Appunti](../../mfc/clipboard.md).

## <a name="cmfctoolbarbuttongethwnd"></a><a name="gethwnd"></a>CMFCToolBarButton::GetHwnd

Recupera l'handle di finestra associato al pulsante della barra degli strumenti.

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>Valore restituito

Handle di finestra associato al pulsante della barra degli strumenti o NULL se al pulsante della barra degli strumenti non è associato alcun handle di finestra.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce NULL. Eseguire l'override di questo metodo per restituire l'handle di finestra del controllo specifico.

## <a name="cmfctoolbarbuttongetimage"></a><a name="getimage"></a>CMFCToolBarButton::GetImage

Recupera l'indice dell'immagine del pulsante.

```
int GetImage() const;
```

### <a name="return-value"></a>Valore restituito

Indice dell'immagine associata a questo pulsante.

### <a name="remarks"></a>Osservazioni

Se il pulsante dispone di un'immagine definita dall'utente, ovvero se *bUserButton* era TRUE nel costruttore, l'indice restituito specifica un'immagine nella raccolta di immagini definite dall'utente (vedere [CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). In caso contrario, l'indice specifica un'immagine nella raccolta di immagini caricate da un file di risorse (vedere [CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Per ulteriori informazioni sui file di risorse, vedere [Utilizzo dei file](../../windows/working-with-resource-files.md)di risorse .

## <a name="cmfctoolbarbuttongetinvalidaterect"></a><a name="getinvalidaterect"></a>CMFCToolBarButton::GetInvalidateRect

Recupera l'area dell'area client del pulsante che deve essere ridisegnata.

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` che specifica l'area che deve essere ridisegnata.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce l'intera area client. Eseguire l'override di questo metodo se si desidera ridisegnare un'area diversa.

## <a name="cmfctoolbarbuttongetparentwnd"></a><a name="getparentwnd"></a>CMFCToolBarButton::GetParentWnd

Recupera la finestra padre del pulsante.

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>Valore restituito

Finestra padre del pulsante.

## <a name="cmfctoolbarbuttongetprotectedcommands"></a><a name="getprotectedcommands"></a>CMFCToolBarButton::GetProtectedCommands

Recupera l'elenco di comandi che l'utente non può personalizzare.

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>Valore restituito

Elenco di comandi protetti.

### <a name="remarks"></a>Osservazioni

In modalità di personalizzazione, il framework disabilita i comandi dei pulsanti della barra degli strumenti protetti. L'utente non può eseguire operazioni di trascinamento e modifica sui pulsanti della barra degli strumenti disabilitati.

Utilizzare il [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) metodo per definire l'elenco dei comandi protetti.

## <a name="cmfctoolbarbuttongettextsize"></a><a name="gettextsize"></a>CMFCToolBarButton::GetTextSize

Recupera le dimensioni del testo del pulsante.

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto DIMENSIONE che contiene le dimensioni, in pixel, del testo del pulsante.

## <a name="cmfctoolbarbuttonhasfocus"></a><a name="hasfocus"></a>CMFCToolBarButton::HasFocus

Determina se il pulsante ha lo stato attivo per l'input corrente.

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante ha lo stato attivo per l'input; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce diverso da zero se il pulsante ha lo stato attivo per l'input o è una finestra figlio o discendente della finestra che ha lo stato attivo per l'input. È possibile eseguire l'override di questa funzione per personalizzare questo comportamento.

## <a name="cmfctoolbarbuttonhavehotborder"></a><a name="havehotborder"></a>CMFCToolBarButton::HaveHotBorder

Determina se viene visualizzato un bordo del pulsante quando un utente seleziona il pulsante.

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per determinare se il pulsante della barra degli strumenti deve visualizzare il bordo quando un utente lo seleziona.

L'implementazione predefinita restituisce TRUE. È possibile eseguire l'override di questo metodo per personalizzare questo comportamento.

## <a name="cmfctoolbarbuttonisdrawimage"></a><a name="isdrawimage"></a>CMFCToolBarButton::IsDrawImage

Determina se un'immagine viene visualizzata sul pulsante.

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un'immagine viene visualizzata sul pulsante; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce FALSE se il pulsante della barra degli strumenti non dispone di alcuna immagine associata ( [CMFCToolBarButton::GetImage](#getimage) restituisce -1) o se [CMFCToolBarButton::m_bImage](#m_bimage) è impostato su FALSE.

## <a name="cmfctoolbarbuttonisdrawtext"></a><a name="isdrawtext"></a>CMFCToolBarButton::IsDrawText

Determina se un'etichetta di testo viene visualizzata sul pulsante.

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene visualizzata un'etichetta di testo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce FALSE se il pulsante della barra degli strumenti non dispone di alcuna etichetta di testo associato ( [CMFCToolBarButton::m_strText](#m_strtext) è vuoto) o [CMFCToolBarButton::m_bText](#m_btext) è impostato su FALSE.

## <a name="cmfctoolbarbuttonisdroppeddown"></a><a name="isdroppeddown"></a>CMFCToolBarButton::IsDroppedDown

Determina se il pulsante visualizza un sottomenu.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se il controllo visualizza un sottomenu.

## <a name="cmfctoolbarbuttoniseditable"></a><a name="iseditable"></a>CMFCToolBarButton::IsEditable

Determina se il pulsante può essere personalizzato.

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante può essere personalizzato dall'utente; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti utilizzando le operazioni di trascinamento o modifica.

L'implementazione predefinita restituisce FALSE se l'ID di comando del `IsStandardCommand` pulsante è un comando standard (è possibile determinarlo chiamando la funzione) o se l'ID di comando è presente nell'elenco dei comandi protetti. Per ulteriori informazioni sui comandi protetti, vedere [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) e [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands).

Eseguire l'override di questo metodo per personalizzarne il comportamento.

## <a name="cmfctoolbarbuttonisextrasize"></a><a name="isextrasize"></a>CMFCToolBarButton::IsExtraSize

Determina se il pulsante può essere visualizzato con un bordo esteso.

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti può essere visualizzato con un bordo esteso; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Diversi skin utilizzano dimensioni aggiuntive per i bordi dei pulsanti della barra degli strumenti (ad esempio, pulsanti rotondi).

Se l'utente sposta questo pulsante da una barra degli strumenti a un'altra, il framework chiama il [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) metodo. Il [Metodo CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) imposta il flag di dimensione aggiuntivo su quello della nuova barra degli strumenti padre (per ulteriori informazioni, vedere [CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).

## <a name="cmfctoolbarbuttonisfirstingroup"></a><a name="isfirstingroup"></a>CMFCToolBarButton::IsFirstInGroup

Determina se il pulsante si trova nella prima posizione nel relativo gruppo di pulsanti.

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUESe il pulsante è il primo pulsante nel relativo gruppo di pulsanti; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo definisce un *gruppo* di pulsanti come un set adiacente di pulsanti posizionati sulla stessa riga e delimitati da separatori o dal bordo della barra degli strumenti. Questo metodo restituisce FALSE se il pulsante della barra degli strumenti fa riferimento al pulsante **Personalizza.** Per ulteriori informazioni sul pulsante **Personalizza** , vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il [CMFCToolBarButton::IsLastInGroup](#islastingroup) metodo per determinare se il pulsante si trova nell'ultima posizione nel relativo gruppo di pulsanti.

## <a name="cmfctoolbarbuttonishidden"></a><a name="ishidden"></a>CMFCToolBarButton::IsHidden

Determina se il pulsante è nascosto.

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è nascosto (invisibile); in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando la barra degli strumenti padre viene estesa per determinare se il pulsante della barra degli strumenti è visibile.

Se si imposta il pulsante in modo che sia invisibile utilizzando il [metodo CMFCToolBarButton::SetVisible](#setvisible) , utilizzare [CMFCToolBarButton::IsVisible](#isvisible) per determinare se il pulsante della barra degli strumenti è visibile.

Per impostazione predefinita, tutti i pulsanti della barra degli strumenti sono visibili. Utilizzare il [CMFCToolBarButton::Show](#show) metodo per nascondere o visualizzare i pulsanti della barra degli strumenti.

## <a name="cmfctoolbarbuttonishorizontal"></a><a name="ishorizontal"></a>CMFCToolBarButton::IsHorizontal

Determina se il pulsante si trova su una barra degli strumenti orizzontale.

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante della barra degli strumenti si trova su una barra degli strumenti orizzontale; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per determinare il layout dei pulsanti della barra degli strumenti.

Questo metodo `m_bHorz` restituisce il membro dati. Il valore predefinito `m_bHorz` del membro dati è TRUE. viene reimpostato a ogni chiamata al [CMFCToolBarButton::OnDraw](#ondraw) metodo.

## <a name="cmfctoolbarbuttonislastingroup"></a><a name="islastingroup"></a>CMFCToolBarButton::IsLastInGroup

Specifica se il pulsante si trova nell'ultima posizione nel relativo gruppo di pulsanti.

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUESe il pulsante è l'ultimo pulsante nel relativo gruppo di pulsanti; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo definisce un *gruppo* di pulsanti come un set adiacente di pulsanti posizionati sulla stessa riga e delimitati da separatori o il bordo della barra degli strumenti Questo metodo restituisce FALSE se il pulsante della barra degli strumenti non dispone di una barra degli strumenti padre o il pulsante della barra degli strumenti fa riferimento al pulsante **Personalizza.** Per ulteriori informazioni sul pulsante **Personalizza** , vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il [CMFCToolBarButton::IsFirstInGroup](#isfirstingroup) metodo per determinare se il pulsante è nella prima posizione nel relativo gruppo di pulsanti.

## <a name="cmfctoolbarbuttonislocked"></a><a name="islocked"></a>CMFCToolBarButton::IsLocked

Determina se il pulsante si trova su una barra degli strumenti bloccata (non personalizzabile).

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante si trova su una barra degli strumenti bloccata; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti utilizzando le operazioni di trascinamento o modifica. Impostare l'attributo locked sulla barra degli strumenti padre utilizzando il [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) metodo. Il framework passa il valore di questo attributo al costruttore di ogni pulsante della barra degli strumenti ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) che inserisce nella barra degli strumenti padre.

## <a name="cmfctoolbarbuttonisownerof"></a><a name="isownerof"></a>CMFCToolBarButton::IsOwnerOf

Determina se il pulsante è il proprietario dell'handle di finestra fornito.

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>Parametri

*Hwnd*<br/>
[in] Un handle di finestra.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è il proprietario dell'handle di finestra fornito; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce diverso da zero se *hwnd* fa riferimento all'handle di finestra diretta o è un elemento figlio dell'handle di finestra associato al pulsante. Questo metodo restituisce 0 se *hwnd* è NULL.

## <a name="cmfctoolbarbuttonisvisible"></a><a name="isvisible"></a>CMFCToolBarButton::IsVisible

Determina se il pulsante della barra degli strumenti è visibile.

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti è visibile; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

È possibile visualizzare o nascondere il pulsante della barra degli strumenti utilizzando il [CMFCToolBarButton::SetVisible](#setvisible) metodo. Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) metodo sulla barra degli strumenti padre dopo aver chiamato [CMFCToolBarButton::SetVisible](#setvisible) per ricalcolare il layout di una barra degli strumenti padre.

## <a name="cmfctoolbarbuttoniswindowvisible"></a><a name="iswindowvisible"></a>CMFCToolBarButton::IsWindowVisible

Determina se l'handle di finestra sottostante del pulsante è visibile.

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'handle di finestra sottostante del pulsante è visibile; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Questo metodo restituisce diverso da zero se l'attributo styles dell'handle di finestra sottostante contiene lo stile di WS_VISIBLE. Questo metodo restituisce FALSE se l'handle di finestra sottostante del pulsante è NULL.

## <a name="cmfctoolbarbuttonm_bimage"></a><a name="m_bimage"></a>CMFCToolBarButton::m_bImage

Specifica se un'immagine viene visualizzata sul pulsante.

```
BOOL m_bImage;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, il framework visualizza l'immagine associata al pulsante della barra degli strumenti; in caso contrario, il framework non visualizza l'immagine. Questo membro influisce sul valore restituito di [CMFCToolBarButton::m_bImage](#m_bimage) metodo.

## <a name="cmfctoolbarbuttonm_btext"></a><a name="m_btext"></a>CMFCToolBarButton::m_bText

Specifica se un'etichetta di testo viene visualizzata sul pulsante.

```
BOOL m_bText;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, il framework visualizza l'etichetta di testo del pulsante della barra degli strumenti; in caso contrario, il framework non visualizza l'etichetta di testo. Questo membro influisce sul valore restituito del [CMFCToolBarButton::m_bText](#m_btext) metodo.

## <a name="cmfctoolbarbuttonm_btextbelow"></a><a name="m_btextbelow"></a>CMFCToolBarButton::m_bTextBelow

Specifica se l'etichetta di testo viene visualizzata sotto l'immagine sul pulsante.

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>Osservazioni

Se questa variabile membro è impostata su TRUE, il framework visualizza il testo del pulsante sotto l'immagine. Il valore predefinito di questo membro è FALSE.

## <a name="cmfctoolbarbuttonm_buserbutton"></a><a name="m_buserbutton"></a>CMFCToolBarButton::m_bUserButton

Specifica se il pulsante dispone di un'immagine definita dall'utente

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>Osservazioni

Questo membro dati è impostato su TRUE quando al pulsante è associata un'immagine definita dall'utente.

## <a name="cmfctoolbarbuttonm_bwholetext"></a><a name="m_bwholetext"></a>CMFCToolBarButton::m_bWholeText

Specifica se il pulsante visualizza l'etichetta full-text anche se non rientra nel rettangolo di delimitazione.

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>Osservazioni

Se questo membro dati è impostato su TRUE, il framework visualizza l'etichetta di testo completo ingrandendo il pulsante. In caso contrario, il framework tronca e aggiunge i ellissi ( **...**) all'etichetta di testo.

## <a name="cmfctoolbarbuttonm_bwrap"></a><a name="m_bwrap"></a>CMFCToolBarButton::m_bWrap

Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.

```
BOOL m_bWrap;
```

### <a name="remarks"></a>Osservazioni

Il framework imposta questo membro dati su TRUE quando il pulsante della barra degli strumenti non rientra nella riga corrente o quando si specifica un layout (ad esempio, un numero specifico di pulsanti della barra degli strumenti per riga).

Il framework inserisce questo pulsante nella riga successiva se questo membro dati è impostato su TRUE e la barra degli strumenti è ancorata orizzontalmente o mobile.

Il valore predefinito di questo membro dati è FALSE.

## <a name="cmfctoolbarbuttonm_bwraptext"></a><a name="m_bwraptext"></a>CMFCToolBarButton::m_bWrapText

Specifica se le etichette di testo su più righe sono abilitate.

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>Osservazioni

Se questa variabile membro statica è TRUE, il framework consente a tutte le barre degli strumenti per visualizzare le etichette di testo su più righe sui pulsanti della barra degli strumenti.

Il valore predefinito di questo membro dati è FALSE.

## <a name="cmfctoolbarbuttonm_nid"></a><a name="m_nid"></a>CMFCToolBarButton::m_nID

ID di comando del pulsante.

```
UINT m_nID;
```

### <a name="remarks"></a>Osservazioni

Un ID di comando pari a -1 indica che il pulsante è un separatore. Tutti i separatori dei pulsanti hanno lo stile TBBS_SEPARATOR. Vedere [CMFCToolBarButton::m_nStyle](#m_nstyle) per ulteriori informazioni sugli stili dei pulsanti.

## <a name="cmfctoolbarbuttonm_nstyle"></a><a name="m_nstyle"></a>Controllo CMFCToolBarButton::M_NSTYLE

Stile del pulsante.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Osservazioni

Vedere [Stili del controllo ToolBar](../../mfc/reference/toolbar-control-styles.md) per l'elenco degli stili dei pulsanti della barra degli strumenti disponibili.

## <a name="cmfctoolbarbuttonm_strtext"></a><a name="m_strtext"></a>CMFCToolBarButton::m_strText

Etichetta di testo del pulsante.

```
CString m_strText;
```

### <a name="remarks"></a>Osservazioni

Questo membro dati contiene l'etichetta di testo del pulsante. L'etichetta di testo può essere vuota.

## <a name="cmfctoolbarbuttonnotifycommand"></a><a name="notifycommand"></a>CMFCToolBarButton::NotifyCommand

Specifica se il pulsante elabora il messaggio [WM_COMMAND.](/windows/win32/menurc/wm-command)

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>Parametri

*Codice iNotify*<br/>
[in] Messaggio di notifica associato al comando.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando sta per inviare un [messaggio di WM_COMMAND](/windows/win32/menurc/wm-command) alla finestra padre.

Per impostazione predefinita, questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se si desidera elaborare il messaggio di WM_COMMAND o FALSE per indicare che la barra degli strumenti padre deve gestire il messaggio.

## <a name="cmfctoolbarbuttononaddtocustomizepage"></a><a name="onaddtocustomizepage"></a>CMFCToolBarButton::OnAddToCustomizePage

Chiamato dal framework quando il pulsante viene aggiunto a una finestra di dialogo **Personalizza.**

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera eseguire un'azione quando il pulsante viene aggiunto a una finestra di dialogo **Personalizza.**

## <a name="cmfctoolbarbuttononbeforedrag"></a><a name="onbeforedrag"></a>CMFCToolBarButton::OnBeforeDrag

Specifica se il pulsante può essere trascinato.

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valore restituito

TRUESe il pulsante può essere trascinato; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo prima che l'utente inizia a trascinare il pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare il trascinamento del pulsante.

## <a name="cmfctoolbarbuttononbeforedrop"></a><a name="onbeforedrop"></a>CMFCToolBarButton::OnBeforeDrop

Specifica se un utente può rilasciare il pulsante sulla barra degli strumenti di destinazione.

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>Parametri

*pTarget (Destinazione)*<br/>
[in] Destinazione dell'operazione di trascinamento della selezione.

### <a name="return-value"></a>Valore restituito

TRUESe il pulsante può essere rilasciato sulla barra degli strumenti di destinazione fornita. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo prima che il pulsante viene rilasciato su una barra degli strumenti.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare l'operazione di rilascio sulla destinazione specificata.

## <a name="cmfctoolbarbuttononcalculatesize"></a><a name="oncalculatesize"></a>CMFCToolBarButton::OnCalculateSize

Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Contesto di dispositivo che visualizza il pulsante.

*sizeDefault (Impostazione predefinita)*<br/>
[in] Dimensioni predefinite del pulsante.

*bHorz*<br/>
[in] Stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE se la barra degli strumenti è ancorata orizzontalmente o è mobile oppure FALSE se la barra degli strumenti è ancorata verticalmente.

### <a name="return-value"></a>Valore restituito

Struttura `SIZE` che contiene le dimensioni del pulsante, in pixel.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per determinare le dimensioni del pulsante della barra degli strumenti per il contesto di dispositivo specificato e lo stato di ancoraggio.

L'implementazione predefinita considera le dimensioni del testo e dell'immagine (se visualizzate), le posizioni del testo e dell'immagine (il testo sotto o sul lato destro dell'immagine) e lo stato di ancoraggio della barra degli strumenti.

Eseguire l'override di questo metodo se si desidera fornire le dimensioni di un pulsante non standard (ad esempio, un pulsante della casella di modifica).

## <a name="cmfctoolbarbuttononcancelmode"></a><a name="oncancelmode"></a>CMFCToolBarButton::OnCancelMode

Chiamato dal framework per gestire il [messaggio di WM_CANCELMODE.](/windows/win32/winmsg/wm-cancelmode)

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera gestire il messaggio [WM_CANCELMODE.](/windows/win32/winmsg/wm-cancelmode)

## <a name="cmfctoolbarbuttononchangeparentwnd"></a><a name="onchangeparentwnd"></a>CMFCToolBarButton::OnChangeParentWnd

Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Parametri

*pWndParent (padre di pWndParent)*<br/>
[in] Nuova finestra padre.

### <a name="remarks"></a>Osservazioni

Il pulsante viene inserito in una barra degli strumenti, ad esempio quando l'utente lo trascina da una barra degli strumenti a un'altra barra degli strumenti.

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

## <a name="cmfctoolbarbuttononclick"></a><a name="onclick"></a>CMFCToolBarButton::OnClick

Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>Parametri

*pWnd (in questo stato di windows*<br/>
[in] Finestra padre del pulsante della barra degli strumenti.

*bRitarda*<br/>
[in] TRUESe il messaggio deve essere gestito con un ritardo.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando l'utente fa clic sul pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio di clic.

## <a name="cmfctoolbarbuttononclickup"></a><a name="onclickup"></a>CMFCToolBarButton::OnClickUp

Chiamato dal framework quando l'utente rilascia il pulsante del mouse.

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando l'utente rilascia il pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio di clic.

## <a name="cmfctoolbarbuttononcontexthelp"></a><a name="oncontexthelp"></a>CMFCToolBarButton::OnContextHelp

Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_HELPHITTEST.

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd (in questo stato di windows*<br/>
[in] Finestra padre del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio della Guida.

Per ulteriori informazioni sul messaggio di WM_HELPHITTEST, vedere [TN028: Supporto della Guida sensibile al contesto](../../mfc/tn028-context-sensitive-help-support.md).

## <a name="cmfctoolbarbuttononctlcolor"></a><a name="onctlcolor"></a>CMFCToolBarButton::OnCtlColor

Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio di WM_CTLCOLOR.

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Contesto di dispositivo che visualizza il pulsante.

*nCtlColore*<br/>
[in] Notifica di colore specifica.

### <a name="return-value"></a>Valore restituito

Handle per l'oggetto pennello utilizzato dal framework per disegnare lo sfondo del pulsante.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando la barra degli strumenti padre elabora il messaggio di WM_CTLCOLOR per un pulsante della barra degli strumenti che contiene un controllo Windows. Il framework non chiama questo metodo se il pulsante della barra degli strumenti è senza finestra.

Il framework chiama questo metodo quando il framework della barra degli strumenti è in modalità di personalizzazione e il pulsante della barra degli strumenti è sbloccato. Per ulteriori informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Per ulteriori informazioni sul blocco dei pulsanti della barra degli strumenti, vedere [CMFCToolBarButton::IsLocked](#islocked).

L'implementazione predefinita non esegue alcuna operazione e restituisce NULL.

## <a name="cmfctoolbarbuttononcustomizemenu"></a><a name="oncustomizemenu"></a>CMFCToolBarButton::OnCustomizeMenu

Consente al pulsante di modificare il menu fornito quando l'applicazione visualizza un menu di scelta rapida sulla barra degli strumenti padre.

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>Parametri

*pMenu (Menu)*<br/>
[in] Menu da personalizzare.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo e restituire un valore diverso da zero se si desidera modificare il contenuto del menu fornito.

## <a name="cmfctoolbarbuttonondblclk"></a><a name="ondblclk"></a>CMFCToolBarButton::OnDblClk

Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio [di WM_LBUTTONDBLCLK.](/windows/win32/inputdev/wm-lbuttondblclk)

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd (in questo stato di windows*<br/>
[in] - La finestra padre del pulsante.

### <a name="remarks"></a>Osservazioni

Questo metodo viene `CMFCToolBar::OnLButtonDblClk` chiamato dal metodo quando la barra degli strumenti padre gestisce un [messaggio di WM_LBUTTONDBLCLK.](/windows/win32/inputdev/wm-lbuttondblclk)

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

## <a name="cmfctoolbarbuttonondraw"></a><a name="ondraw"></a>CMFCToolBarButton::OnDraw

Chiamato dal framework per disegnare il pulsante utilizzando gli stili e le opzioni specificati.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Contesto di dispositivo che visualizza il pulsante.

*Rect*<br/>
[in] Rettangolo di delimitazione del pulsante.

*pImmagini*<br/>
[in] Raccolta di immagini della barra degli strumenti associate al pulsante.

*bHorz*<br/>
[in] Stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE quando il pulsante è ancorato orizzontalmente e FALSE quando il pulsante è ancorato verticalmente.

*bCustomizeMode (Modalità di personalizzazione)*<br/>
[in] Specifica se la barra degli strumenti è in modalità di personalizzazione. Questo parametro è TRUE quando la barra degli strumenti è in modalità di personalizzazione e FALSE quando la barra degli strumenti non è in modalità di personalizzazione.

*bEvidenziare*<br/>
[in] Specifica se il pulsante è evidenziato. Questo parametro è TRUE quando il pulsante è evidenziato e FALSE quando il pulsante non è evidenziato.

*bDrawBorder*<br/>
[in] Specifica se il pulsante deve visualizzare il bordo. Questo parametro è TRUE quando il pulsante deve visualizzare il bordo e FALSE quando il pulsante non deve visualizzare il bordo.

*bGrayDisabledButtons (Pulsanti)*<br/>
[in] Specifica se ombreggiare i pulsanti disabilitati o utilizzare la raccolta di immagini disabilitate. Questo parametro è TRUE quando i pulsanti disabilitati devono essere ombreggiati e FALSE quando questo metodo deve utilizzare la raccolta di immagini disabilitate.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questo metodo per personalizzare il disegno del pulsante della barra degli strumenti.

## <a name="cmfctoolbarbuttonondrawoncustomizelist"></a><a name="ondrawoncustomizelist"></a>CMFCToolBarButton::OnDrawOnCustomizeList

Chiamato dal framework per disegnare il pulsante nel riquadro **Comandi** della finestra di dialogo **Personalizza.**

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Contesto di dispositivo che visualizza il pulsante.

*Rect*<br/>
[in] Rettangolo di delimitazione del pulsante.

*bSelezionato*<br/>
[in] Specifica se il pulsante è selezionato. Se questo parametro è TRUE, il pulsante è selezionato. Se questo parametro è FALSE, il pulsante non è selezionato.

### <a name="return-value"></a>Valore restituito

Larghezza, in pixel, del pulsante nel contesto di dispositivo specificato.

### <a name="remarks"></a>Osservazioni

Questo metodo viene chiamato dalla finestra di dialogo di personalizzazione (scheda **Comandi)** quando il pulsante sta per essere visualizzato nella casella di riepilogo di disegno del proprietario.

L'implementazione predefinita di questo metodo visualizza l'immagine e l'etichetta di testo del pulsante, se disponibili. Se l'etichetta di testo del pulsante non è disponibile, il metodo visualizza il testo della descrizione comando.

Eseguire l'override di questo metodo per eseguire il disegno personalizzato.

## <a name="cmfctoolbarbuttonongetcustomtooltiptext"></a><a name="ongetcustomtooltiptext"></a>CMFCToolBarButton::OnGetCustomToolTipText

Chiamato dal framework per recuperare il testo della descrizione comandi personalizzata per il pulsante.

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>Parametri

*strToolTip (Suggerimento di strumenti)*<br/>
[fuori] Oggetto `CString` che riceve il testo della descrizione comando personalizzata.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo quando viene visualizzata la descrizione comando per il pulsante della barra degli strumenti. Se questo metodo restituisce FALSE, il framework utilizza una descrizione comando predefinita.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo e restituire un valore diverso da zero per fornire il testo della descrizione comando personalizzata per il pulsante della barra degli strumenti.

## <a name="cmfctoolbarbuttononglobalfontschanged"></a><a name="onglobalfontschanged"></a>CMFCToolBarButton::OnGlobalFontsChanged

Chiamato dal framework quando il tipo di carattere globale è stato modificato.

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare il tipo di carattere utilizzato per visualizzare il testo del pulsante.

## <a name="cmfctoolbarbuttononmove"></a><a name="onmove"></a>CMFCToolBarButton::OnMove

Chiamato dal framework quando si sposta la barra degli strumenti padre.

```
virtual void OnMove();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per riposizionare il pulsante quando si sposta la barra degli strumenti padre.

## <a name="cmfctoolbarbuttononshow"></a><a name="onshow"></a>CMFCToolBarButton::OnShow

Chiamato dal framework quando il pulsante diventa visibile o invisibile.

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
[in] Specifica se il pulsante è visibile. Se questo parametro è TRUE, il pulsante è visibile. In caso contrario, il pulsante non è visibile.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare la visibilità del pulsante.

## <a name="cmfctoolbarbuttononsize"></a><a name="onsize"></a>CMFCToolBarButton::OnSize

Chiamato dal framework quando la barra degli strumenti padre modifica le dimensioni o la posizione e questa modifica determina la modifica delle dimensioni del pulsante.

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>Parametri

*IDimensioni*<br/>
[in] Nuova larghezza del pulsante.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per ridimensionare il pulsante quando cambiano le dimensioni o la posizione della barra degli strumenti padre.

## <a name="cmfctoolbarbuttonontoolhittest"></a><a name="ontoolhittest"></a>CMFCToolBarButton::OnToolHitTest

Chiamato dal framework quando la barra degli strumenti padre deve determinare se un punto si trova nel rettangolo di delimitazione del pulsante.

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Parametri

*pWnd (in questo stato di windows*<br/>
[in] Finestra padre del pulsante. Può essere NULL.

*Pti*<br/>
[in] Struttura `TOOLINFO` che contiene informazioni su uno strumento in un controllo descrizione comandi.

### <a name="return-value"></a>Valore restituito

Il risultato di `OnMenuButtonToolHitTest` se il pulsante può recuperare un puntatore alla finestra cornice padre; in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo chiama uno dei seguenti metodi se è possibile convertire la finestra padre in un oggetto frame valido:

- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

## <a name="cmfctoolbarbuttononupdatetooltip"></a><a name="onupdatetooltip"></a>Suggerimento Per CMFCToolBarButton::OnUpdateTool

Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comandi.

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>Parametri

*pWndParent (padre di pWndParent)*<br/>
[in] Finestra padre.

*Indice iButton*<br/>
[in] Indice in base zero del pulsante nella raccolta di pulsanti padre.

*WndToolTip (suggerimento su WNdTool)*<br/>
[in] Controllo che visualizza il testo della descrizione comandi.

*Str*<br/>
[fuori] Oggetto `CString` che riceve il testo della descrizione comando aggiornato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se si fornisce una stringa di testo della descrizione comando.

## <a name="cmfctoolbarbuttonpreparedrag"></a><a name="preparedrag"></a>CMFCToolBarButton::PrepareDrag

Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento della selezione.

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>Parametri

*Elemento srcItem*<br/>
[in] Oggetto `COleDataSource` che archivia informazioni sullo stato relative all'operazione di trascinamento della selezione.

### <a name="return-value"></a>Valore restituito

TRUESe l'operazione ha esito positivo. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per preparare il pulsante della barra degli strumenti per archiviare lo stato nell'oggetto fornito. `COleDataSource` Questo metodo archivia il proprio stato serializzandosi in un file condiviso e passando il file al metodo [COleDataSource::CacheGlobalData.](../../mfc/reference/coledatasource-class.md#cacheglobaldata) Per ulteriori informazioni sulla serializzazione dei pulsanti della barra degli strumenti, vedere [CMFCToolBarButton::Serialize](#serialize).

Questo metodo non esegue alcuna operazione e restituisce TRUE se il pulsante non può essere archiviato (il [metodo CMFCToolBarButton::CanBeStored](#canbestored) restituisce FALSE). Restituisce FALSE se si verifica un'eccezione durante la serializzazione dell'oggetto.

Per ulteriori informazioni sulle operazioni di trascinamento OLE, vedere [OLE drag and drop](../../mfc/drag-and-drop-ole.md).

## <a name="cmfctoolbarbuttonrect"></a><a name="rect"></a>CMFCToolBarButton::Rect

Recupera il rettangolo di delimitazione del pulsante.

```
const CRect& Rect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` che contiene il rettangolo di delimitazione di un pulsante.

## <a name="cmfctoolbarbuttonresetimagetodefault"></a><a name="resetimagetodefault"></a>CMFCToolBarButton::ResetImageToDefault

Imposta sul valore predefinito l'immagine associata al pulsante.

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Osservazioni

Questo metodo recupera l'immagine predefinita dalla barra degli strumenti padre utilizzando il [CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) metodo. Se al pulsante non è associata alcuna immagine predefinita, questo metodo imposta l'etichetta di testo del pulsante in base alla relativa risorsa stringa utilizzando il [Metodo CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) . Per ulteriori informazioni sulle risorse stringa, vedere [Utilizzo dei file](../../windows/working-with-resource-files.md)di risorse .

Questo metodo non esegue alcuna operazione se il pulsante dispone di un'immagine definita dall'utente.

## <a name="cmfctoolbarbuttonsavebarstate"></a><a name="savebarstate"></a>CMFCToolBarButton::SaveBarState

Salva lo stato del pulsante della barra degli strumenti.

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo `CMFCToolBarButton` quando crea un oggetto come risultato di un'operazione di trascinamento della selezione.

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per salvare lo stato del pulsante della barra degli strumenti in un'origine dati esterna.

## <a name="cmfctoolbarbuttonserialize"></a><a name="serialize"></a>CMFCToolBarButton::Serialize

Legge l'oggetto da un archivio o lo scrive in un archivio.

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*Ar*<br/>
[in] Oggetto `CArchive` da cui o in cui eseguire la serializzazione.

### <a name="remarks"></a>Osservazioni

Questo metodo supporta i processi di trasferimento dei dati, ad esempio gli Appunti o le operazioni di trascinamento della selezione. Legge o scrive le proprietà del pulsante, ad esempio l'ID, `CArchive` l'etichetta di testo e l'ID immagine, da o nell'oggetto fornito.

Per esempi di serializzazione, vedere [Serializzazione: serializzazione di un oggetto](../../mfc/serialization-serializing-an-object.md).

## <a name="cmfctoolbarbuttonsetaccdata"></a><a name="setaccdata"></a>CMFCToolBarButton::SetACCData

Popola `CAccessibilityData` l'oggetto fornito con i dati di accessibilità dal pulsante della barra degli strumenti.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Parametri

*pPadre*<br/>
[in] Finestra padre del pulsante della barra degli strumenti.

*data*<br/>
[in] Oggetto `CAccessibilityData` popolato con i dati di accessibilità del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Osservazioni

Eseguire l'override di questo metodo per restituire FALSE se il pulsante della barra degli strumenti non fornisce dati di accessibilità.

## <a name="cmfctoolbarbuttonsetclipboardformatname"></a><a name="setclipboardformatname"></a>CMFCToolBarButton::SetClipboardFormatName

Rinomina il formato degli Appunti globali.

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Parametri

*lpszName*<br/>
[in] Nuovo nome del formato degli Appunti globali. Non può essere NULL.

### <a name="remarks"></a>Osservazioni

Questo metodo consente di eseguire operazioni di trascinamento della selezione tra più applicazioni. Ogni applicazione deve fornire lo stesso nome di formato degli Appunti.Each application must supply the same clipboard format name.

È necessario chiamare questo metodo prima che il framework [chiami CMFCToolBarButton::GetClipboardFormat](#getclipboardformat).

## <a name="cmfctoolbarbuttonsetimage"></a><a name="setimage"></a>CMFCToolBarButton::SetImage

Imposta l'indice dell'immagine del pulsante.

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>Parametri

*iImage (immagine)*<br/>
[in] Indice dell'immagine nella raccolta di immagini della barra degli strumenti.

### <a name="remarks"></a>Osservazioni

Se il pulsante della barra degli strumenti è un separatore, *iImage* fa riferimento alla nuova larghezza del pulsante separatore.

Se *iImage* è minore di zero, questo metodo disabilita il disegno dell'immagine e abilita il disegno dell'etichetta di testo del pulsante.

## <a name="cmfctoolbarbuttonsetprotectedcommands"></a><a name="setprotectedcommands"></a>CMFCToolBarButton::SetProtectedCommands

Imposta l'elenco dei comandi che l'utente non può personalizzare.

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>Parametri

*lstCmds (Stati di Abbigliamento)*<br/>
[in] Elenco di comandi protetti.

### <a name="remarks"></a>Osservazioni

In modalità di personalizzazione, il framework disabilita i comandi dei pulsanti della barra degli strumenti protetti. L'utente non può eseguire operazioni di trascinamento e modifica sui pulsanti della barra degli strumenti disabilitati.

Utilizzare il [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) metodo per recuperare l'elenco dei comandi protetti.

## <a name="cmfctoolbarbuttonsetradio"></a><a name="setradio"></a>CMFCToolBarButton::SetRadio

Chiamato dal framework quando un pulsante cambia lo stato controllato.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per eseguire un'azione personalizzata quando il pulsante cambia lo stato selezionato.

## <a name="cmfctoolbarbuttonsetrect"></a><a name="setrect"></a>CMFCToolBarButton::SetRect

Imposta il rettangolo di delimitazione del pulsante.

```cpp
void SetRect(const CRect rect);
```

### <a name="parameters"></a>Parametri

*Rect*<br/>
[in] Nuovo rettangolo di delimitazione del pulsante.

### <a name="remarks"></a>Osservazioni

Questo metodo chiama il [CMFCToolBarButton::OnMove](#onmove) metodo dopo aver impostato il nuovo rettangolo di delimitazione.

## <a name="cmfctoolbarbuttonsetstyle"></a><a name="setstyle"></a>CMFCToolBarButton::SetStyle

Imposta lo stile del pulsante.

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>Parametri

*nStyle*<br/>
[in] Nuovo stile del pulsante.

### <a name="remarks"></a>Osservazioni

L'implementazione predefinita imposta il [CMFCToolBarButton::m_nStyle](#m_nstyle) membro dati *nStyle*. Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione aggiuntiva per gestire la modifica nello stile. Vedere [Stili del controllo ToolBar](toolbar-control-styles.md) per un elenco di flag di stile validi.

## <a name="cmfctoolbarbuttonsetvisible"></a><a name="setvisible"></a>CMFCToolBarButton::SetVisible

Specifica se il pulsante è visibile.

```cpp
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
[in] Valore booleano che specifica se visualizzare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Osservazioni

Utilizzare questa funzione per nascondere o visualizzare un particolare pulsante della barra degli strumenti. Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) metodo dopo aver chiamato questo metodo.

## <a name="cmfctoolbarbuttonshow"></a><a name="show"></a>CMFCToolBarButton::Mostra

Mostra o nasconde il pulsante.

```cpp
void Show(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bShow*<br/>
[in] Valore booleano che specifica se visualizzare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Osservazioni

Il framework chiama questo metodo per aggiornare la visibilità dei pulsanti della barra degli strumenti quando la barra degli strumenti padre viene ridimensionata. Il framework chiama questo metodo con *bShow* impostato su FALSE quando il pulsante non rientra più nei limiti della barra degli strumenti. Il framework chiama questo metodo con *bShow* impostato su TRUE quando dopo il ridimensionamento del pulsante si adatta nuovamente all'interno dei limiti della barra degli strumenti.

Utilizzare il [CMFCToolBarButton::SetVisible](#setvisible) metodo per impostare la visibilità generale del pulsante.

Questo metodo chiama il [CMFCToolBarButton::OnShow](#onshow) metodo dopo l'aggiornamento dello stato di visibilità del pulsante.

## <a name="see-also"></a>Vedere anche

[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classi](../../mfc/reference/mfc-classes.md)<br/>
[CMFCToolBar (classe)](../../mfc/reference/cmfctoolbar-class.md)<br/>
[Classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)
