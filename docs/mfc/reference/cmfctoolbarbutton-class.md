---
title: Classe CMFCToolBarButton
ms.date: 11/04/2016
f1_keywords:
- CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CMFCToolBarButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeDropped
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStored
- AFXTOOLBARBUTTON/CMFCToolBarButton::CanBeStretched
- AFXTOOLBARBUTTON/CMFCToolBarButton::CompareWith
- AFXTOOLBARBUTTON/CMFCToolBarButton::CopyFrom
- AFXTOOLBARBUTTON/CMFCToolBarButton::CreateFromOleData
- AFXTOOLBARBUTTON/CMFCToolBarButton::EnableWindow
- AFXTOOLBARBUTTON/CMFCToolBarButton::ExportToMenuButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetClipboardFormat
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetHwnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetInvalidateRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::GetTextSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::HasFocus
- AFXTOOLBARBUTTON/CMFCToolBarButton::HaveHotBorder
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDrawText
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsDroppedDown
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsEditable
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsExtraSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsFirstInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHidden
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsHorizontal
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLastInGroup
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsLocked
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsOwnerOf
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::IsWindowVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::NotifyCommand
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnAddToCustomizePage
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnBeforeDrop
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCalculateSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCancelMode
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnChangeParentWnd
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClick
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnClickUp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnContextHelp
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCtlColor
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnCustomizeMenu
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDblClk
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDraw
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnDrawOnCustomizeList
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGetCustomToolTipText
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnGlobalFontsChanged
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnMove
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnShow
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnSize
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnToolHitTest
- AFXTOOLBARBUTTON/CMFCToolBarButton::OnUpdateToolTip
- AFXTOOLBARBUTTON/CMFCToolBarButton::PrepareDrag
- AFXTOOLBARBUTTON/CMFCToolBarButton::Rect
- AFXTOOLBARBUTTON/CMFCToolBarButton::ResetImageToDefault
- AFXTOOLBARBUTTON/CMFCToolBarButton::SaveBarState
- AFXTOOLBARBUTTON/CMFCToolBarButton::Serialize
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetACCData
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetClipboardFormatName
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetProtectedCommands
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRadio
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetRect
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::SetVisible
- AFXTOOLBARBUTTON/CMFCToolBarButton::Show
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bImage
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bTextBelow
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bUserButton
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWholeText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrap
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_bWrapText
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nID
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_nStyle
- AFXTOOLBARBUTTON/CMFCToolBarButton::m_strText
helpviewer_keywords:
- CMFCToolBarButton [MFC], CMFCToolBarButton
- CMFCToolBarButton [MFC], CanBeDropped
- CMFCToolBarButton [MFC], CanBeStored
- CMFCToolBarButton [MFC], CanBeStretched
- CMFCToolBarButton [MFC], CompareWith
- CMFCToolBarButton [MFC], CopyFrom
- CMFCToolBarButton [MFC], CreateFromOleData
- CMFCToolBarButton [MFC], EnableWindow
- CMFCToolBarButton [MFC], ExportToMenuButton
- CMFCToolBarButton [MFC], GetClipboardFormat
- CMFCToolBarButton [MFC], GetHwnd
- CMFCToolBarButton [MFC], GetImage
- CMFCToolBarButton [MFC], GetInvalidateRect
- CMFCToolBarButton [MFC], GetParentWnd
- CMFCToolBarButton [MFC], GetProtectedCommands
- CMFCToolBarButton [MFC], GetTextSize
- CMFCToolBarButton [MFC], HasFocus
- CMFCToolBarButton [MFC], HaveHotBorder
- CMFCToolBarButton [MFC], IsDrawImage
- CMFCToolBarButton [MFC], IsDrawText
- CMFCToolBarButton [MFC], IsDroppedDown
- CMFCToolBarButton [MFC], IsEditable
- CMFCToolBarButton [MFC], IsExtraSize
- CMFCToolBarButton [MFC], IsFirstInGroup
- CMFCToolBarButton [MFC], IsHidden
- CMFCToolBarButton [MFC], IsHorizontal
- CMFCToolBarButton [MFC], IsLastInGroup
- CMFCToolBarButton [MFC], IsLocked
- CMFCToolBarButton [MFC], IsOwnerOf
- CMFCToolBarButton [MFC], IsVisible
- CMFCToolBarButton [MFC], IsWindowVisible
- CMFCToolBarButton [MFC], NotifyCommand
- CMFCToolBarButton [MFC], OnAddToCustomizePage
- CMFCToolBarButton [MFC], OnBeforeDrag
- CMFCToolBarButton [MFC], OnBeforeDrop
- CMFCToolBarButton [MFC], OnCalculateSize
- CMFCToolBarButton [MFC], OnCancelMode
- CMFCToolBarButton [MFC], OnChangeParentWnd
- CMFCToolBarButton [MFC], OnClick
- CMFCToolBarButton [MFC], OnClickUp
- CMFCToolBarButton [MFC], OnContextHelp
- CMFCToolBarButton [MFC], OnCtlColor
- CMFCToolBarButton [MFC], OnCustomizeMenu
- CMFCToolBarButton [MFC], OnDblClk
- CMFCToolBarButton [MFC], OnDraw
- CMFCToolBarButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarButton [MFC], OnGetCustomToolTipText
- CMFCToolBarButton [MFC], OnGlobalFontsChanged
- CMFCToolBarButton [MFC], OnMove
- CMFCToolBarButton [MFC], OnShow
- CMFCToolBarButton [MFC], OnSize
- CMFCToolBarButton [MFC], OnToolHitTest
- CMFCToolBarButton [MFC], OnUpdateToolTip
- CMFCToolBarButton [MFC], PrepareDrag
- CMFCToolBarButton [MFC], Rect
- CMFCToolBarButton [MFC], ResetImageToDefault
- CMFCToolBarButton [MFC], SaveBarState
- CMFCToolBarButton [MFC], Serialize
- CMFCToolBarButton [MFC], SetACCData
- CMFCToolBarButton [MFC], SetClipboardFormatName
- CMFCToolBarButton [MFC], SetImage
- CMFCToolBarButton [MFC], SetProtectedCommands
- CMFCToolBarButton [MFC], SetRadio
- CMFCToolBarButton [MFC], SetRect
- CMFCToolBarButton [MFC], SetStyle
- CMFCToolBarButton [MFC], SetVisible
- CMFCToolBarButton [MFC], Show
- CMFCToolBarButton [MFC], m_bImage
- CMFCToolBarButton [MFC], m_bText
- CMFCToolBarButton [MFC], m_bTextBelow
- CMFCToolBarButton [MFC], m_bUserButton
- CMFCToolBarButton [MFC], m_bWholeText
- CMFCToolBarButton [MFC], m_bWrap
- CMFCToolBarButton [MFC], m_bWrapText
- CMFCToolBarButton [MFC], m_nID
- CMFCToolBarButton [MFC], m_nStyle
- CMFCToolBarButton [MFC], m_strText
ms.assetid: 8a6ecffb-86b0-4f5c-8211-a9146b463efd
ms.openlocfilehash: ec5b6692197dc224f503be050a537e6fa265f6d5
ms.sourcegitcommit: b032daf81cb5fdb1f5a988277ee30201441c4945
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/15/2018
ms.locfileid: "51694660"
---
# <a name="cmfctoolbarbutton-class"></a>Classe CMFCToolBarButton

Fornisce la funzionalità di pulsante alle barre degli strumenti.

## <a name="syntax"></a>Sintassi

```
class CMFCToolBarButton : public CObject
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::CMFCToolBarButton](#cmfctoolbarbutton)|Costruisce e inizializza un oggetto `CMFCToolBarButton`.|
|`CMFCToolBarButton::~CMFCToolBarButton`|Distruttore.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::CanBeDropped](#canbedropped)|Specifica se un utente è possibile posizionare un pulsante in una barra degli strumenti o menu durante la personalizzazione.|
|[CMFCToolBarButton::CanBeStored](#canbestored)|Specifica se il pulsante può essere archiviato.|
|[CMFCToolBarButton::CanBeStretched](#canbestretched)|Specifica se un utente può durare il pulsante durante la personalizzazione.|
|[CMFCToolBarButton::CompareWith](#comparewith)|Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` oggetto.|
|[CMFCToolBarButton::CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti per il pulsante corrente.|
|[CMFCToolBarButton::CreateFromOleData](#createfromoledata)|Crea una `CMFCToolBarButton` oggetto dall'oggetto fornito `COleDataObject` oggetto.|
|`CMFCToolBarButton::CreateObject`|Usato dal framework per creare un'istanza dinamica di questo tipo di classe.|
|[CMFCToolBarButton::EnableWindow](#enablewindow)|Abilita o disabilita l'input da mouse e tastiera.|
|[CMFCToolBarButton::ExportToMenuButton](#exporttomenubutton)|Copia il testo dal pulsante della barra degli strumenti a un menu.|
|[CMFCToolBarButton::GetClipboardFormat](#getclipboardformat)|Recupera il formato degli Appunti globale per l'applicazione.|
|[CMFCToolBarButton::GetHwnd](#gethwnd)|Recupera l'handle della finestra che viene associata al pulsante sulla barra degli strumenti.|
|[CMFCToolBarButton::GetImage](#getimage)|Recupera l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton::GetInvalidateRect](#getinvalidaterect)|Recupera l'area dell'area client del pulsante su cui deve essere ridisegnato.|
|[CMFCToolBarButton::GetParentWnd](#getparentwnd)|Recupera la finestra padre del pulsante.|
|[CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands)|Recupera l'elenco di comandi che l'utente non è possibile personalizzare.|
|[CMFCToolBarButton::GetTextSize](#gettextsize)|Recupera la dimensione del testo del pulsante.|
|[CMFCToolBarButton::HasFocus](#hasfocus)|Determina se il pulsante ha lo stato attivo di input corrente.|
|[CMFCToolBarButton::HaveHotBorder](#havehotborder)|Determina se viene visualizzato un bordo del pulsante quando un utente seleziona il pulsante.|
|[CMFCToolBarButton::IsDrawImage](#isdrawimage)|Determina se un'immagine viene visualizzata sul pulsante.|
|[CMFCToolBarButton::IsDrawText](#isdrawtext)|Determina se un'etichetta di testo viene visualizzata sul pulsante.|
|[CMFCToolBarButton::IsDroppedDown](#isdroppeddown)|Determina se il pulsante viene visualizzato un sottomenu.|
|[CMFCToolBarButton::IsEditable](#iseditable)|Determina se il pulsante può essere personalizzato.|
|[CMFCToolBarButton::IsExtraSize](#isextrasize)|Determina se il pulsante può essere visualizzato con un bordo esteso.|
|[CMFCToolBarButton::IsFirstInGroup](#isfirstingroup)|Determina se il pulsante è nella prima posizione nel relativo gruppo di pulsanti.|
|[CMFCToolBarButton::IsHidden](#ishidden)|Determina se il pulsante è nascosto.|
|[CMFCToolBarButton::IsHorizontal](#ishorizontal)|Determina se il pulsante si trova su una barra orizzontale.|
|[CMFCToolBarButton::IsLastInGroup](#islastingroup)|Specifica se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.|
|[CMFCToolBarButton::IsLocked](#islocked)|Determina se il pulsante è presente una barra degli strumenti (non personalizzabili) bloccato.|
|[CMFCToolBarButton::IsOwnerOf](#isownerof)|Determina se il pulsante è il proprietario dell'handle di finestra specificato.|
|[CMFCToolBarButton::IsVisible](#isvisible)|Determina se il pulsante della barra degli strumenti è visibile.|
|[CMFCToolBarButton::IsWindowVisible](#iswindowvisible)|Determina se l'handle di finestra sottostante del pulsante è visibile.|
|[CMFCToolBarButton::NotifyCommand](#notifycommand)|Specifica se il pulsante elabora i [WM_COMMAND](/windows/desktop/menurc/wm-command) messaggio.|
|[CMFCToolBarButton::OnAddToCustomizePage](#onaddtocustomizepage)|Chiamato dal framework quando il pulsante viene aggiunto a un **Personalizza** nella finestra di dialogo.|
|[CMFCToolBarButton::OnBeforeDrag](#onbeforedrag)|Specifica se il pulsante può essere trascinato.|
|[CMFCToolBarButton::OnBeforeDrop](#onbeforedrop)|Specifica se un utente può trascinare il pulsante nella barra degli strumenti di destinazione.|
|[CMFCToolBarButton::OnCalculateSize](#oncalculatesize)|Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.|
|[CMFCToolBarButton::OnCancelMode](#oncancelmode)|Chiamato dal framework per gestire il [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) messaggio.|
|[CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd)|Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.|
|[CMFCToolBarButton::OnClick](#onclick)|Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.|
|[CMFCToolBarButton::OnClickUp](#onclickup)|Chiamato dal framework quando l'utente rilascia il pulsante del mouse.|
|[CMFCToolBarButton::OnContextHelp](#oncontexthelp)|Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio WM_HELPHITTEST.|
|[CMFCToolBarButton::OnCtlColor](#onctlcolor)|Chiamato dal framework quando la barra degli strumenti padre gestisce un WM_CTLCOLOR (messaggio).|
|[CMFCToolBarButton::OnCustomizeMenu](#oncustomizemenu)|Consente il pulsante modificare il menu di scelta specificato quando l'applicazione viene visualizzato un menu di scelta rapida nella barra degli strumenti padre.|
|[CMFCToolBarButton::OnDblClk](#ondblclk)|Chiamato dal framework quando la barra degli strumenti padre gestisce un [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) messaggio.|
|[CMFCToolBarButton::OnDraw](#ondraw)|Chiamato dal framework per disegnare il pulsante utilizzando gli stili specificati e le opzioni.|
|[CMFCToolBarButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Chiamato dal framework per disegnare il pulsante di **comandi** riquadro della finestra il **Personalizza** nella finestra di dialogo.|
|[CMFCToolBarButton::OnGetCustomToolTipText](#ongetcustomtooltiptext)|Chiamata eseguita dal framework per recuperare il testo di descrizione comando personalizzata per il pulsante.|
|[CMFCToolBarButton::OnGlobalFontsChanged](#onglobalfontschanged)|Chiamato dal framework quando è stato modificato il tipo globale di carattere.|
|[CMFCToolBarButton::OnMove](#onmove)|Chiamato dal framework quando si sposta la barra degli strumenti padre.|
|[CMFCToolBarButton::OnShow](#onshow)|Chiamato dal framework quando il pulsante diventa visibile o invisibile.|
|[CMFCToolBarButton::OnSize](#onsize)|Chiamato dal framework quando la barra degli strumenti padre viene modificato le dimensioni o posizione e questa modifica richiede il pulsante per modificare le dimensioni.|
|[CMFCToolBarButton::OnToolHitTest](#ontoolhittest)|Chiamato dal framework quando la barra degli strumenti padre deve determinare se un punto si trova il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton::OnUpdateToolTip](#onupdatetooltip)|Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.|
|[CMFCToolBarButton::PrepareDrag](#preparedrag)|Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento e rilascio.|
|[CMFCToolBarButton::Rect](#rect)|Recupera il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton::ResetImageToDefault](#resetimagetodefault)|Imposta il valore predefinito l'immagine associata al pulsante.|
|[CMFCToolBarButton::SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti.|
|[CMFCToolBarButton::Serialize](#serialize)|Legge l'oggetto da un archivio o lo scrive in un archivio. Esegue l'override di [CObject::Serialize](../../mfc/reference/cobject-class.md#serialize).|
|[CMFCToolBarButton::SetACCData](#setaccdata)|Popola l'oggetto specificato `CAccessibilityData` oggetto con dati di accessibilità dal pulsante della barra degli strumenti.|
|[CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname)|Rinomina il formato degli Appunti globale.|
|[CMFCToolBarButton::SetImage](#setimage)|Imposta l'indice dell'immagine del pulsante.|
|[CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands)|Imposta l'elenco di comandi che l'utente non è possibile personalizzare.|
|[CMFCToolBarButton::SetRadio](#setradio)|Chiamato dal framework quando un pulsante viene modificato lo stato.|
|[CMFCToolBarButton::SetRect](#setrect)|Imposta il rettangolo di delimitazione del pulsante.|
|[CMFCToolBarButton::SetStyle](#setstyle)|Imposta lo stile del pulsante.|
|[CMFCToolBarButton::SetVisible](#setvisible)|Specifica se il pulsante è visibile.|
|[CMFCToolBarButton::Show](#show)|Mostra o nasconde il pulsante.|

### <a name="data-members"></a>Membri di dati

|nome|Descrizione|
|----------|-----------------|
|[CMFCToolBarButton::m_bImage](#m_bimage)|Specifica se un'immagine è visualizzata sul pulsante.|
|[CMFCToolBarButton::m_bText](#m_btext)|Specifica se un'etichetta di testo viene visualizzata sul pulsante.|
|[CMFCToolBarButton::m_bTextBelow](#m_btextbelow)|Specifica se l'etichetta di testo viene visualizzato sotto l'immagine del pulsante.|
|[CMFCToolBarButton::m_bUserButton](#m_buserbutton)|Specifica se il pulsante dispone di un'immagine definita dall'utente.|
|[CMFCToolBarButton::m_bWholeText](#m_bwholetext)|Specifica se il pulsante Visualizza la relativa etichetta full-text, anche se non rientra nel rettangolo di delimitazione.|
|[CMFCToolBarButton::m_bWrap](#m_bwrap)|Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.|
|[CMFCToolBarButton::m_bWrapText](#m_bwraptext)|Specifica se le etichette di testo multilinea sono abilitate.|
|[CMFCToolBarButton::m_nID](#m_nid)|ID comando del pulsante.|
|[CMFCToolBarButton::m_nStyle](#m_nstyle)|Lo stile del pulsante.|
|[CMFCToolBarButton::m_strText](#m_strtext)|L'etichetta di testo del pulsante.|

## <a name="remarks"></a>Note

Oggetto `CMFCToolbarButton` oggetto è un controllo che si trova su una barra degli strumenti. Il comportamento è simile a quello di un pulsante normale. È possibile assegnare un'immagine e un'etichetta di testo a questo oggetto. Un pulsante della barra degli strumenti può anche avere un ID di comando. Quando l'utente fa clic sul pulsante della barra degli strumenti, il framework esegue il comando che specifica l'ID.

In genere, i pulsanti della barra degli strumenti possono essere personalizzati: l'utente può trascinare pulsanti dalla barra degli uno strumenti a altro e copiare, incollare, eliminare e modificare le etichette di testo e immagini. Per evitare che l'utente Personalizza la barra degli strumenti, è possibile bloccare la barra degli strumenti in uno dei due modi. Impostare il `bLocked` flag su TRUE quando si chiama [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar), oppure aggiungere l'ID di comando di un singolo pulsante per l'elenco globale dei comandi protetti mediante il [CMFCToolBarButton:: SetProtectedCommands](#setprotectedcommands) (metodo).

`CMFCToolBarButton` oggetti di visualizzare le immagini delle raccolte globali delle immagini della barra degli strumenti dell'applicazione. Queste raccolte vengono gestite dalla barra degli strumenti padre [classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md). Per altre informazioni, vedere [classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md).

Quando l'utente sceglie un pulsante della barra degli strumenti, la barra degli strumenti padre elabora il messaggio di mouse e comunica le azioni appropriate per il pulsante. Se il pulsante presenta un ID di comando validi, la barra degli strumenti padre invia il messaggio WM_COMMAND al frame padre.

Il `CMFCToolBarButton` classe è la classe base per le altre classi di pulsante della barra degli strumenti, ad esempio [classe CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md), [classe CMFCToolBarEditBoxButton](../../mfc/reference/cmfctoolbareditboxbutton-class.md), e [ Classe CMFCToolBarComboBoxButton](../../mfc/reference/cmfctoolbarcomboboxbutton-class.md).

## <a name="example"></a>Esempio

L'esempio seguente illustra come configurare un `CMFCToolBarButton` oggetti utilizzando diversi metodi nel `CMFCToolBarButton` classe. L'esempio illustra come abilitare il puntatore del mouse e dell'input da tastiera, impostare l'indice dell'immagine del pulsante, impostare il rettangolo di delimitazione del pulsante e rendere visibile il pulsante. Questo frammento di codice fa parte di [esempio di controllo struttura a schede](../../visual-cpp-samples.md).

[!code-cpp[NVC_MFC_TabControl#1](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_1.cpp)]
[!code-cpp[NVC_MFC_TabControl#2](../../mfc/reference/codesnippet/cpp/cmfctoolbarbutton-class_2.cpp)]

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)

## <a name="requirements"></a>Requisiti

**Intestazione:** afxtoolbarbutton. h

##  <a name="canbedropped"></a>  CMFCToolBarButton::CanBeDropped

Specifica se un utente è possibile posizionare un pulsante in una barra degli strumenti o menu durante la personalizzazione.

```
virtual BOOL CanBeDropped(CMFCToolBar* pToolbar);
```

### <a name="parameters"></a>Parametri

*pToolbar*<br/>
[in] Non usato.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Note

Per impostazione predefinita, un pulsante della barra degli strumenti può essere eliminato su ogni personalizzabile (vale a dire non bloccata) sulla barra degli strumenti.

L'implementazione predefinita di questo metodo restituisce TRUE. L'override del metodo e restituisce FALSE se si desidera impedire all'utente di riposizionamento il pulsante.

##  <a name="canbestored"></a>  CMFCToolBarButton::CanBeStored

Determina se il pulsante può essere archiviato.

```
virtual BOOL CanBeStored() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Note

Il framework utilizza questo metodo per determinare se il pulsante può partecipare a un'operazione di trascinamento e rilascio.

L'implementazione predefinita restituisce TRUE. Eseguire l'override di questo metodo se il pulsante non può essere archiviato come parte di un'operazione di trascinamento e rilascio. Per altre informazioni sulle operazioni di trascinamento e rilascio, vedere [Drag and Drop (OLE)](../../mfc/drag-and-drop-ole.md).

##  <a name="canbestretched"></a>  CMFCToolBarButton::CanBeStretched

Specifica se un utente può durare il pulsante durante la personalizzazione.

```
virtual BOOL CanBeStretched() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

Questo metodo viene utilizzato dal framework per determinare se il pulsante può essere estesa in modalità di personalizzazione.

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE per un controllo a larghezza variabile, ad esempio una casella combinata o un dispositivo di scorrimento.

Per altre informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode).

##  <a name="cmfctoolbarbutton"></a>  CMFCToolBarButton::CMFCToolBarButton

Costruisce e inizializza un oggetto `CMFCToolBarButton`.

```
CMFCToolBarButton(
    UINT uiID,
    int iImage,
    LPCTSTR lpszText=NULL,
    BOOL bUserButton=FALSE,
    BOOL bLocked=FALSE);
```

### <a name="parameters"></a>Parametri

*uiID*<br/>
[in] ID comando del pulsante.

*iImage*<br/>
[in] L'indice dell'immagine del pulsante nella raccolta di immagini.

*lpszText*<br/>
[in] L'etichetta di testo del pulsante. Può essere NULL.

*bUserButton*<br/>
[in] Valore booleano che determina se il pulsante è definito dall'utente. Se questo parametro è TRUE, il pulsante è definito dall'utente. In caso contrario, l'immagine del pulsante viene caricato da una risorsa.

*Bloccato*<br/>
[in] Valore booleano che determina se il pulsante può essere personalizzato. Se questo parametro è TRUE, non è possibile personalizzare il pulsante. In caso contrario, è possibile personalizzare il pulsante.

##  <a name="comparewith"></a>  CMFCToolBarButton::CompareWith

Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` oggetto.

```
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;
```

### <a name="parameters"></a>Parametri

*other*<br/>
[in] Riferimento all'oggetto da confrontare con questa istanza.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'oggetto specificato è uguale al valore di questa istanza. in caso contrario, 0.

### <a name="remarks"></a>Note

L'implementazione predefinita determina se l'ID di comando dell'oggetto fornito è uguale all'ID di comando di questa istanza. Eseguire l'override di questo metodo se è necessario eseguire un'ulteriore elaborazione per determinare se due `CMFCToolBarButton` oggetti sono uguali.

##  <a name="copyfrom"></a>  CMFCToolBarButton::CopyFrom

Copia le proprietà di un altro pulsante della barra degli strumenti per il pulsante corrente.

```
virtual void CopyFrom(const CMFCToolBarButton& src);
```

### <a name="parameters"></a>Parametri

*src*<br/>
[in] Un riferimento al pulsante di origine da cui copiare.

### <a name="remarks"></a>Note

Chiamare questo metodo per copiare un altro pulsante della barra degli strumenti per questo pulsante sulla barra degli strumenti.

##  <a name="createfromoledata"></a>  CMFCToolBarButton::CreateFromOleData

Crea una `CMFCToolBarButton` oggetto dall'oggetto fornito `COleDataObject` oggetto.

```
static CMFCToolBarButton* __stdcall CreateFromOleData(COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
[in] L'oggetto origine dati OLE.

### <a name="return-value"></a>Valore restituito

Oggetto `CMFCToolBarButton` creato.

### <a name="remarks"></a>Note

Questo metodo viene utilizzato dal framework per eseguire il trasferimento dei dati in vari formati. Ad esempio, il `CMFCOutlookBarPane::OnDragOver` metodo Usa questo metodo per eseguire operazioni di trascinamento e rilascio.

##  <a name="enablewindow"></a>  CMFCToolBarButton::EnableWindow

Abilita o disabilita l'input da mouse e tastiera.

```
virtual void EnableWindow(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*bAttivare il*<br/>
[in] Impostare questo parametro su true per abilitare input o su FALSE per disattivare l'input.

### <a name="remarks"></a>Note

Questo metodo chiama il `EnableWindow` funzione per attivare o disattivare l'input. Per altre informazioni, vedere [EnableWindow](/windows/desktop/api/winuser/nf-winuser-enablewindow) nel SDK di Windows.

##  <a name="exporttomenubutton"></a>  CMFCToolBarButton::ExportToMenuButton

Copia il testo dal pulsante della barra degli strumenti a un menu.

```
virtual BOOL ExportToMenuButton(CMFCToolBarMenuButton& menuButton) const;
```

### <a name="parameters"></a>Parametri

*MenuButton*<br/>
[in] Un riferimento al pulsante di menu della destinazione.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per copiare il testo da un pulsante della barra degli strumenti per un pulsante di menu. L'implementazione predefinita consente di copiare l'etichetta di testo del pulsante. Se l'etichetta di testo è vuota, questo metodo copia il testo della descrizione comando del pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo se si desidera intraprendere azioni aggiuntive quando il framework converte un oggetto derivato da [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md) a un pulsante di menu.

##  <a name="getclipboardformat"></a>  CMFCToolBarButton::GetClipboardFormat

Recupera il formato degli Appunti globale per l'applicazione.

```
static CLIPFORMAT __stdcall GetClipboardFormat();
```

### <a name="return-value"></a>Valore restituito

Il valore CLIPFORMAT globale per l'applicazione.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per recuperare il formato degli Appunti per operazioni di trasferimento dei dati OLE. Ad esempio, il [CMFCToolBarButton::CreateFromOleData](#createfromoledata) metodo Usa questo metodo per copiare dati da un oggetto origine dati OLE.

Questo metodo imposta l'ora il primo valore CLIPFORMAT globale che viene chiamato questo metodo. Tutte le chiamate successive a questo metodo restituiscono questo valore.

Per consentire operazioni di trascinamento e rilascio tra applicazioni, chiamare il [CMFCToolBarButton::SetClipboardFormatName](#setclipboardformatname) (metodo).

Per altre informazioni sulle Appunti in MFC, vedere [negli Appunti](../../mfc/clipboard.md).

##  <a name="gethwnd"></a>  CMFCToolBarButton::GetHwnd

Recupera l'handle della finestra che viene associata al pulsante sulla barra degli strumenti.

```
virtual HWND GetHwnd();
```

### <a name="return-value"></a>Valore restituito

Handle della finestra associato con il pulsante della barra degli strumenti o NULL se il pulsante della barra degli strumenti non dispone di alcun handle di finestra associata.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo restituisce NULL. Eseguire l'override di questo metodo per restituire l'handle della finestra del controllo specifico.

##  <a name="getimage"></a>  CMFCToolBarButton::GetImage

Recupera l'indice dell'immagine del pulsante.

```
int GetImage() const;
```

### <a name="return-value"></a>Valore restituito

L'indice dell'immagine associata al pulsante.

### <a name="remarks"></a>Note

Se il pulsante con immagine definita dall'utente (vale a dire, se *bUserButton* era TRUE nel costruttore), l'indice restituito specifica un'immagine nella raccolta di immagini definite dall'utente (vedere [CMFCToolBar::GetUserImages](../../mfc/reference/cmfctoolbar-class.md#getuserimages)). In caso contrario, l'indice specifica un'immagine nella raccolta di immagini caricati da un file di risorse (vedere [CMFCToolBar::GetImages](../../mfc/reference/cmfctoolbar-class.md#getimages)). Per altre informazioni sui file di risorse, vedere [Working with Resource Files](../../windows/working-with-resource-files.md).

##  <a name="getinvalidaterect"></a>  CMFCToolBarButton::GetInvalidateRect

Recupera l'area dell'area client del pulsante su cui deve essere ridisegnato.

```
virtual const CRect GetInvalidateRect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` oggetto che specifica l'area in cui deve essere ridisegnato.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo restituisce l'intera area client. Eseguire l'override di questo metodo se si desidera che un'area diversa da ridisegnare.

##  <a name="getparentwnd"></a>  CMFCToolBarButton::GetParentWnd

Recupera la finestra padre del pulsante.

```
CWnd* GetParentWnd() const;
```

### <a name="return-value"></a>Valore restituito

La finestra padre del pulsante.

##  <a name="getprotectedcommands"></a>  CMFCToolBarButton::GetProtectedCommands

Recupera l'elenco di comandi che l'utente non è possibile personalizzare.

```
static const CList<UINT,UINT>& GetProtectedCommands();
```

### <a name="return-value"></a>Valore restituito

L'elenco di comandi protetti.

### <a name="remarks"></a>Note

In modalità di personalizzazione, il framework disabilita i comandi di pulsante della barra degli strumenti che sono protetti. L'utente non è possibile eseguire trascinamento e rilascio e modificare le operazioni sui pulsanti della barra degli strumenti disabilitato.

Usare la [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands) metodo per definire l'elenco di comandi è protetto.

##  <a name="gettextsize"></a>  CMFCToolBarButton::GetTextSize

Recupera la dimensione del testo del pulsante.

```
SIZE GetTextSize() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto dimensione che contiene la dimensione, in pixel, del testo del pulsante.

##  <a name="hasfocus"></a>  CMFCToolBarButton::HasFocus

Determina se il pulsante ha lo stato attivo di input corrente.

```
virtual BOOL HasFocus() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è nello stato attivo; in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo restituisce diverso da zero se il pulsante è nello stato attivo o è una finestra figlio o discendente della finestra che ha lo stato attivo di input. È possibile eseguire l'override di questa funzione per personalizzare questo comportamento.

##  <a name="havehotborder"></a>  CMFCToolBarButton::HaveHotBorder

Determina se viene visualizzato un bordo del pulsante quando un utente seleziona il pulsante.

```
virtual BOOL HaveHotBorder() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per determinare se il pulsante della barra degli strumenti deve visualizzare il bordo quando viene selezionato un utente.

L'implementazione predefinita restituisce TRUE. È possibile eseguire l'override di questo metodo per personalizzare questo comportamento.

##  <a name="isdrawimage"></a>  CMFCToolBarButton::IsDrawImage

Determina se un'immagine viene visualizzata sul pulsante.

```
BOOL IsDrawImage() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un'immagine viene visualizzato nel pulsante. in caso contrario 0.

### <a name="remarks"></a>Note

Questo metodo restituisce FALSE se il pulsante della barra degli strumenti non dispone di alcuna immagine associata ( [CMFCToolBarButton::GetImage](#getimage) restituisce -1) o se [CMFCToolBarButton::m_bImage](#m_bimage) è impostata su FALSE.

##  <a name="isdrawtext"></a>  CMFCToolBarButton::IsDrawText

Determina se un'etichetta di testo viene visualizzata sul pulsante.

```
BOOL IsDrawText() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un'etichetta di testo viene visualizzata. in caso contrario 0.

### <a name="remarks"></a>Note

Questo metodo restituisce FALSE se il pulsante della barra degli strumenti non presenta alcuna etichetta di testo associato ( [CMFCToolBarButton::m_strText](#m_strtext) è vuoto) o [CMFCToolBarButton::m_bText](#m_btext) è impostata su FALSE.

##  <a name="isdroppeddown"></a>  CMFCToolBarButton::IsDroppedDown

Determina se il pulsante viene visualizzato un sottomenu.

```
virtual BOOL IsDroppedDown() const;
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se il controllo consente di visualizzare un sottomenu.

##  <a name="iseditable"></a>  CMFCToolBarButton::IsEditable

Determina se il pulsante può essere personalizzato.

```
virtual BOOL IsEditable() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante può essere personalizzato dall'utente. in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti mediante trascinamento e rilascio o operazioni di modifica.

L'implementazione predefinita restituisce FALSE se l'ID di comando del pulsante è un comando standard (è possibile determinare tale chiamando il `IsStandardCommand` (funzione)) o se il comando è presente nell'elenco di ID protetti i comandi. Per altre informazioni sui comandi protetti, vedere [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) e [CMFCToolBarButton::SetProtectedCommands](#setprotectedcommands).

Eseguire l'override di questo metodo per personalizzare il comportamento.

##  <a name="isextrasize"></a>  CMFCToolBarButton::IsExtraSize

Determina se il pulsante può essere visualizzato con un bordo esteso.

```
virtual BOOL IsExtraSize() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti può essere visualizzato con un bordo esteso; in caso contrario 0.

### <a name="remarks"></a>Note

Diverse interfacce usano dimensioni aggiuntive per i bordi degli pulsanti della barra degli strumenti (ad esempio, pulsanti di arrotondamenti).

Se l'utente passa questo pulsante da una barra degli strumenti a altra, il framework chiama il [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) (metodo). Il [CMFCToolBarButton::OnChangeParentWnd](#onchangeparentwnd) metodo imposta il flag di maggiori dimensioni a quello della nuova barra degli strumenti padre (per altre informazioni, vedere [CMFCToolBar::IsButtonExtraSizeAvailable](../../mfc/reference/cmfctoolbar-class.md#isbuttonextrasizeavailable)).

##  <a name="isfirstingroup"></a>  CMFCToolBarButton::IsFirstInGroup

Determina se il pulsante è nella prima posizione nel relativo gruppo di pulsanti.

```
virtual BOOL IsFirstInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante è il primo pulsante nel relativo gruppo di pulsanti di; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Questo metodo consente di definire un *gruppo di pulsanti* come adiacenti set di pulsanti che sono posizionati sulla stessa riga e sono delimitati da separatori o il bordo della barra degli strumenti. Questo metodo restituisce FALSE se il pulsante della barra degli strumenti si intende il **Personalizza** pulsante. Per altre informazioni sul **Personalizza** pulsante, vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il [CMFCToolBarButton::IsLastInGroup](#islastingroup) metodo per determinare se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.

##  <a name="ishidden"></a>  CMFCToolBarButton::IsHidden

Determina se il pulsante è nascosto.

```
BOOL IsHidden() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante viene nascosta (visibile); in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando la barra degli strumenti padre viene estesa per determinare se il pulsante della barra degli strumenti è visibile.

Se è impostato il pulsante sia invisibile usando il [CMFCToolBarButton::SetVisible](#setvisible) metodo, usare [CMFCToolBarButton::IsVisible](#isvisible) per determinare se il pulsante della barra degli strumenti è visibile.

Per impostazione predefinita, sono visibili tutti i pulsanti della barra degli strumenti. Usare la [CMFCToolBarButton::Show](#show) metodo per visualizzare o nascondere pulsanti della barra degli strumenti.

##  <a name="ishorizontal"></a>  CMFCToolBarButton::IsHorizontal

Determina se il pulsante si trova su una barra orizzontale.

```
BOOL IsHorizontal() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un pulsante della barra degli strumenti si trova su una barra orizzontale; in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per determinare il layout dei pulsanti della barra degli strumenti.

Questo metodo restituisce il `m_bHorz` (membro dati). Il valore predefinito del `m_bHorz` membro dati è TRUE, viene reimpostato a ogni chiamata ai [CMFCToolBarButton::OnDraw](#ondraw) (metodo).

##  <a name="islastingroup"></a>  CMFCToolBarButton::IsLastInGroup

Specifica se il pulsante è l'ultima posizione nel relativo gruppo di pulsanti.

```
virtual BOOL IsLastInGroup() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante è l'ultimo pulsante nel relativo gruppo di pulsanti di; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Questo metodo consente di definire un *gruppo di pulsanti* come adiacenti set di pulsanti sono posizionati sulla stessa riga e sono delimitati da separatori o il bordo della barra degli strumenti di questo metodo restituisce FALSE se il pulsante della barra degli strumenti non presenta nessuna barra degli strumenti padre o pulsante della barra degli strumenti si intende il **Personalizza** pulsante. Per altre informazioni sul **Personalizza** pulsante, vedere [CMFCToolBar::GetCustomizeButton](../../mfc/reference/cmfctoolbar-class.md#getcustomizebutton).

Chiamare il [CMFCToolBarButton::IsFirstInGroup](#isfirstingroup) metodo per determinare se il pulsante è nella prima posizione nel relativo gruppo di pulsanti.

##  <a name="islocked"></a>  CMFCToolBarButton::IsLocked

Determina se il pulsante è presente una barra degli strumenti (non personalizzabili) bloccato.

```
BOOL IsLocked() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante si trova in una barra degli strumenti bloccata; in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per determinare se l'utente può personalizzare il pulsante della barra degli strumenti mediante trascinamento e rilascio o operazioni di modifica. Impostare l'attributo bloccato sulla barra degli strumenti padre usando il [CMFCToolBar::LoadToolBar](../../mfc/reference/cmfctoolbar-class.md#loadtoolbar) (metodo). Il framework passa il valore di questo attributo al costruttore di ogni pulsante sulla barra degli strumenti ( [CMFCToolbarButton](../../mfc/reference/cmfctoolbarbutton-class.md)) che viene inserito nella barra degli strumenti padre.

##  <a name="isownerof"></a>  CMFCToolBarButton::IsOwnerOf

Determina se il pulsante è il proprietario dell'handle di finestra specificato.

```
virtual BOOL IsOwnerOf(HWND hwnd);
```

### <a name="parameters"></a>Parametri

*HWND*<br/>
[in] Un handle di finestra.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante è il proprietario dell'handle di finestra fornito; in caso contrario 0.

### <a name="remarks"></a>Note

Questo metodo restituisce diverso da zero se *hwnd* fa riferimento all'handle della finestra diretta o è un elemento figlio dell'handle della finestra che viene associata al pulsante. Questo metodo restituisce 0 se *hwnd* è NULL.

##  <a name="isvisible"></a>  CMFCToolBarButton::IsVisible

Determina se il pulsante della barra degli strumenti è visibile.

```
BOOL IsVisible() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il pulsante della barra degli strumenti è visibile; in caso contrario 0.

### <a name="remarks"></a>Note

È possibile visualizzare o nascondere il pulsante della barra degli strumenti tramite il [CMFCToolBarButton::SetVisible](#setvisible) (metodo). Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) sulla barra degli strumenti padre dopo aver chiamato il metodo [CMFCToolBarButton::SetVisible](#setvisible) per ricalcolare il layout di una barra degli strumenti padre.

##  <a name="iswindowvisible"></a>  CMFCToolBarButton::IsWindowVisible

Determina se l'handle di finestra sottostante del pulsante è visibile.

```
virtual BOOL IsWindowVisible();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'handle di finestra sottostante del pulsante è visibile; in caso contrario 0.

### <a name="remarks"></a>Note

Questo metodo viene restituito diverso da zero se l'attributo stili dell'handle di finestra sottostante contiene lo stile WS_VISIBLE. Questo metodo restituisce FALSE se l'handle di finestra sottostante del pulsante è NULL.

##  <a name="m_bimage"></a>  CMFCToolBarButton::m_bImage

Specifica se un'immagine è visualizzata sul pulsante.

```
BOOL m_bImage;
```

### <a name="remarks"></a>Note

Se questo membro dati è impostato su TRUE, il framework Visualizza l'immagine associata al pulsante sulla barra degli strumenti; in caso contrario, il framework non viene visualizzata l'immagine. Questo membro ha effetto sul valore restituito del [CMFCToolBarButton::m_bImage](#m_bimage) (metodo).

##  <a name="m_btext"></a>  CMFCToolBarButton::m_bText

Specifica se un'etichetta di testo viene visualizzata sul pulsante.

```
BOOL m_bText;
```

### <a name="remarks"></a>Note

Se questo membro dati è impostato su TRUE, il framework Visualizza l'etichetta di testo del pulsante della barra degli strumenti; in caso contrario, il framework non viene visualizzata l'etichetta di testo. Questo membro ha effetto sul valore restituito del [CMFCToolBarButton::m_bText](#m_btext) (metodo).

##  <a name="m_btextbelow"></a>  CMFCToolBarButton::m_bTextBelow

Specifica se l'etichetta di testo viene visualizzato sotto l'immagine del pulsante.

```
BOOL m_bTextBelow;
```

### <a name="remarks"></a>Note

Se questa variabile membro è impostata su TRUE, il framework Visualizza il testo del pulsante sotto l'immagine. Il valore predefinito di questo membro è FALSE.

##  <a name="m_buserbutton"></a>  CMFCToolBarButton::m_bUserButton

Specifica se il pulsante dispone di un'immagine definita dall'utente

```
BOOL m_bUserButton;
```

### <a name="remarks"></a>Note

Questo membro dati è impostato su TRUE quando il pulsante con immagine definita dall'utente associata.

##  <a name="m_bwholetext"></a>  CMFCToolBarButton::m_bWholeText

Specifica se il pulsante Visualizza la relativa etichetta full-text, anche se non rientra nel rettangolo di delimitazione.

```
BOOL m_bWholeText;
```

### <a name="remarks"></a>Note

Se questo membro dati è impostato su TRUE, il framework Visualizza l'etichetta di testo completo aumentando il pulsante. In caso contrario, il framework Tronca e accoda i puntini di sospensione ( **...** ) per l'etichetta di testo.

##  <a name="m_bwrap"></a>  CMFCToolBarButton::m_bWrap

Specifica se il pulsante accanto a un separatore verrà inserito nella riga successiva.

```
BOOL m_bWrap;
```

### <a name="remarks"></a>Note

Il framework imposta questo membro dati su TRUE quando il pulsante della barra degli strumenti non rientra nella riga corrente o quando si specifica un layout (ad esempio, un numero specifico di pulsanti della barra degli strumenti per ogni riga).

Se questo membro dati è impostato su TRUE e la barra degli strumenti è ancorato in orizzontale o a virgola mobile, nella riga successiva viene inserito il framework di questo pulsante.

Il valore predefinito di questo membro dati è FALSE.

##  <a name="m_bwraptext"></a>  CMFCToolBarButton::m_bWrapText

Specifica se le etichette di testo multilinea sono abilitate.

```
AFX_IMPORT_DATA static BOOL m_bWrapText;
```

### <a name="remarks"></a>Note

Se questa variabile membro statica è TRUE, il framework consente tutte le barre degli strumenti visualizzare le etichette di testo multilinea sui pulsanti della barra degli strumenti.

Il valore predefinito di questo membro dati è FALSE.

##  <a name="m_nid"></a>  CMFCToolBarButton::m_nID

ID comando del pulsante.

```
UINT m_nID;
```

### <a name="remarks"></a>Note

Un ID di comando di -1 indica che il pulsante è un separatore. Tutti i separatori sono applicato lo stile TBBS_SEPARATOR. Visualizzare [CMFCToolBarButton::m_nStyle](#m_nstyle) per altre informazioni sugli stili di pulsante.

##  <a name="m_nstyle"></a>  CMFCToolBarButton::m_nStyle

Lo stile del pulsante.

```
UINT m_nStyle;
```

### <a name="remarks"></a>Note

Visualizzare [stili dei controlli ToolBar](../../mfc/reference/toolbar-control-styles.md) per l'elenco di stili dei pulsanti della barra degli strumenti disponibili.

##  <a name="m_strtext"></a>  CMFCToolBarButton::m_strText

L'etichetta di testo del pulsante.

```
CString m_strText;
```

### <a name="remarks"></a>Note

Questo membro dati contiene l'etichetta di testo del pulsante. L'etichetta di testo può essere vuoto.

##  <a name="notifycommand"></a>  CMFCToolBarButton::NotifyCommand

Specifica se il pulsante elabora i [WM_COMMAND](/windows/desktop/menurc/wm-command) messaggio.

```
virtual BOOL NotifyCommand(int iNotifyCode);
```

### <a name="parameters"></a>Parametri

*iNotifyCode*<br/>
[in] Il messaggio di notifica associato con il comando.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando sta per inviare un [WM_COMMAND](/windows/desktop/menurc/wm-command) messaggio alla finestra padre.

Per impostazione predefinita, questo metodo restituisce FALSE. Eseguire l'override di questo metodo per restituire TRUE se si desidera elaborare il messaggio WM_COMMAND o FALSE per indicare che la barra degli strumenti padre deve gestire il messaggio.

##  <a name="onaddtocustomizepage"></a>  CMFCToolBarButton::OnAddToCustomizePage

Chiamato dal framework quando il pulsante viene aggiunto a un **Personalizza** nella finestra di dialogo.

```
virtual void OnAddToCustomizePage();
```

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si desidera eseguire un'azione quando il pulsante viene aggiunto a un **Personalizza** nella finestra di dialogo.

##  <a name="onbeforedrag"></a>  CMFCToolBarButton::OnBeforeDrag

Specifica se il pulsante può essere trascinato.

```
virtual BOOL OnBeforeDrag() const;
```

### <a name="return-value"></a>Valore restituito

TRUE se il pulsante può essere trascinato; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo prima che l'utente inizia a trascinare il pulsante.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare il trascinamento del pulsante.

##  <a name="onbeforedrop"></a>  CMFCToolBarButton::OnBeforeDrop

Specifica se un utente può trascinare il pulsante nella barra degli strumenti di destinazione.

```
virtual BOOL OnBeforeDrop(CMFCToolBar* pTarget);
```

### <a name="parameters"></a>Parametri

*pTarget*<br/>
[in] La destinazione dell'operazione di trascinamento e rilascio.

### <a name="return-value"></a>Valore restituito

TRUE se è possibile eliminare il pulsante nella barra degli strumenti; destinazione forniti in caso contrario, FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo prima che viene rilasciato il pulsante nella barra degli strumenti.

L'implementazione predefinita di questo metodo restituisce TRUE. Eseguire l'override di questo metodo per restituire FALSE per disabilitare l'operazione di rilascio sulla destinazione specificata.

##  <a name="oncalculatesize"></a>  CMFCToolBarButton::OnCalculateSize

Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio.

```
virtual SIZE OnCalculateSize(
    CDC* pDC,
    const CSize& sizeDefault,
    BOOL bHorz);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Il contesto di dispositivo che visualizza il pulsante.

*sizeDefault*<br/>
[in] La dimensione predefinita del pulsante.

*bHorz*<br/>
[in] Lo stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE se la barra degli strumenti è mobile o ancorato orizzontalmente, o FALSE se la barra degli strumenti è ancorato in verticale.

### <a name="return-value"></a>Valore restituito

Oggetto `SIZE` struttura che contiene le dimensioni del pulsante, in pixel.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per determinare le dimensioni del pulsante della barra degli strumenti per il contesto di dispositivo specificato e lo stato di ancoraggio.

L'implementazione predefinita prende in considerazione le dimensioni di testo e immagine (se vengono visualizzati), le posizioni di tipo text e image (il testo sotto o sul lato destro dell'immagine) e la barra degli strumenti dello stato di ancoraggio.

Eseguire l'override di questo metodo se si desidera specificare le dimensioni di un pulsante non standard (ad esempio, un pulsante casella di modifica).

##  <a name="oncancelmode"></a>  CMFCToolBarButton::OnCancelMode

Chiamato dal framework per gestire il [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) messaggio.

```
virtual void OnCancelMode();
```

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo se si vuole gestire il [WM_CANCELMODE](/windows/desktop/winmsg/wm-cancelmode) messaggio.

##  <a name="onchangeparentwnd"></a>  CMFCToolBarButton::OnChangeParentWnd

Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti.

```
virtual void OnChangeParentWnd(CWnd* pWndParent);
```

### <a name="parameters"></a>Parametri

*pWndParent*<br/>
[in] La nuova finestra padre.

### <a name="remarks"></a>Note

Il pulsante viene inserito in una barra degli strumenti, ad esempio, quando l'utente trascina lo da una barra degli strumenti a un'altra.

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

##  <a name="onclick"></a>  CMFCToolBarButton::OnClick

Chiamato dal framework quando l'utente fa clic sul pulsante del mouse.

```
virtual BOOL OnClick(
    CWnd* pWnd,
    BOOL bDelay=TRUE);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
[in] La finestra padre del pulsante della barra degli strumenti.

*bDelay*<br/>
[in] TRUE se il messaggio deve essere gestito con un ritardo.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando l'utente fa clic sul pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio fare clic su.

##  <a name="onclickup"></a>  CMFCToolBarButton::OnClickUp

Chiamato dal framework quando l'utente rilascia il pulsante del mouse.

```
virtual BOOL OnClickUp();
```

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando l'utente rilascia il pulsante della barra degli strumenti.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio fare clic su.

##  <a name="oncontexthelp"></a>  CMFCToolBarButton::OnContextHelp

Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio WM_HELPHITTEST.

```
virtual BOOL OnContextHelp(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
[in] La finestra padre del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se il pulsante elabora il messaggio della Guida.

Per altre informazioni sul messaggio WM_HELPHITTEST, vedere [TN028: supporto della Guida sensibile al contesto](../../mfc/tn028-context-sensitive-help-support.md).

##  <a name="onctlcolor"></a>  CMFCToolBarButton::OnCtlColor

Chiamato dal framework quando la barra degli strumenti padre gestisce un WM_CTLCOLOR (messaggio).

```
virtual HBRUSH OnCtlColor(
    CDC* pDC,
    UINT nCtlColor);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Il contesto di dispositivo che visualizza il pulsante.

*nCtlColor*<br/>
[in] La notifica di colore specifico.

### <a name="return-value"></a>Valore restituito

Handle all'oggetto brush che il framework utilizza per disegnare lo sfondo del pulsante.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando la barra degli strumenti padre elabora le WM_CTLCOLOR (messaggio) per un pulsante della barra degli strumenti contenente un controllo di Windows. Il framework non chiama questo metodo se il pulsante della barra degli strumenti è attivo.

Il framework chiama questo metodo quando il framework della barra degli strumenti è in modalità di personalizzazione e il pulsante della barra degli strumenti è sbloccato. Per altre informazioni sulla modalità di personalizzazione, vedere [CMFCToolBar::SetCustomizeMode](../../mfc/reference/cmfctoolbar-class.md#setcustomizemode). Per altre informazioni sui blocchi i pulsanti della barra degli strumenti, vedere [CMFCToolBarButton::IsLocked](#islocked).

L'implementazione predefinita non esegue alcuna operazione e viene restituito NULL.

##  <a name="oncustomizemenu"></a>  CMFCToolBarButton::OnCustomizeMenu

Consente il pulsante modificare il menu di scelta specificato quando l'applicazione viene visualizzato un menu di scelta rapida nella barra degli strumenti padre.

```
virtual BOOL OnCustomizeMenu(CMenu* pMenu);
```

### <a name="parameters"></a>Parametri

*pMenu*<br/>
[in] Il menu di personalizzazione.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. L'override del metodo e restituisce un valore diverso da zero se si desidera modificare il contenuto del menu di scelta specificato.

##  <a name="ondblclk"></a>  CMFCToolBarButton::OnDblClk

Chiamato dal framework quando la barra degli strumenti padre gestisce un [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) messaggio.

```
virtual void OnDblClk(CWnd* pWnd);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
[in] - finestra padre del pulsante.

### <a name="remarks"></a>Note

Questo metodo viene chiamato il `CMFCToolBar::OnLButtonDblClk` metodo quando la barra degli strumenti padre gestisce una [WM_LBUTTONDBLCLK](/windows/desktop/inputdev/wm-lbuttondblclk) messaggio.

L'implementazione predefinita di questo metodo non esegue alcuna operazione.

##  <a name="ondraw"></a>  CMFCToolBarButton::OnDraw

Chiamato dal framework per disegnare il pulsante utilizzando gli stili specificati e le opzioni.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rect,
    CMFCToolBarImages* pImages,
    BOOL bHorz=TRUE,
    BOOL bCustomizeMode=FALSE,
    BOOL bHighlight=FALSE,
    BOOL bDrawBorder=TRUE,
    BOOL bGrayDisabledButtons=TRUE);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Il contesto di dispositivo che visualizza il pulsante.

*Rect*<br/>
[in] Il rettangolo di delimitazione del pulsante.

*pImages*<br/>
[in] La raccolta di immagini della barra degli strumenti che è associata al pulsante.

*bHorz*<br/>
[in] Lo stato di ancoraggio della barra degli strumenti padre. Questo parametro è TRUE quando il pulsante è ancorato in orizzontale e FALSE quando il pulsante è ancorato in verticale.

*bCustomizeMode*<br/>
[in] Specifica se la barra degli strumenti è in modalità di personalizzazione. Questo parametro è TRUE se la barra degli strumenti è in modalità di personalizzazione e FALSE quando la barra degli strumenti non è in modalità di personalizzazione.

*bHighlight*<br/>
[in] Specifica se il pulsante è evidenziato. Questo parametro è TRUE quando il pulsante è evidenziato e FALSE quando il pulsante non sia più evidenziato.

*bDrawBorder*<br/>
[in] Specifica se il pulsante deve visualizzare il bordo. Questo parametro è TRUE quando il pulsante dovrebbe visualizzare il bordo e FALSE quando il pulsante non dovrebbe visualizzare il bordo.

*bGrayDisabledButtons*<br/>
[in] Specifica se i pulsanti disabilitati, ombreggiate o utilizzare la raccolta di immagini disabilitato. Questo parametro è TRUE quando i pulsanti disabilitati sarà ombreggiata e FALSE quando questo metodo deve usare la raccolta di immagini disabilitato.

### <a name="remarks"></a>Note

Eseguire l'override di questo metodo per personalizzare il disegno di pulsante della barra degli strumenti.

##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarButton::OnDrawOnCustomizeList

Chiamato dal framework per disegnare il pulsante di **comandi** riquadro della finestra il **Personalizza** nella finestra di dialogo.

```
virtual int OnDrawOnCustomizeList(
    CDC* pDC,
    const CRect& rect,
    BOOL bSelected);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
[in] Il contesto di dispositivo che visualizza il pulsante.

*Rect*<br/>
[in] Il rettangolo di delimitazione del pulsante.

*bSelected*<br/>
[in] Specifica se il pulsante è selezionato. Se questo parametro è TRUE, il pulsante è selezionato. Se questo parametro è FALSE, il pulsante non è selezionato.

### <a name="return-value"></a>Valore restituito

La larghezza in pixel, del pulsante nel contesto di dispositivo specificato.

### <a name="remarks"></a>Note

Questo metodo viene chiamato dalla finestra di dialogo di personalizzazione ( **comandi** scheda) quando il pulsante sta per essere visualizzato nella casella di riepilogo di disegno.

L'implementazione predefinita di questo metodo consente di visualizzare l'etichetta di testo e immagine del pulsante se sono disponibili. Se l'etichetta di testo del pulsante non è disponibile, il metodo visualizza il testo della descrizione comando.

Eseguire l'override di questo metodo per eseguire il disegno personalizzato.

##  <a name="ongetcustomtooltiptext"></a>  CMFCToolBarButton::OnGetCustomToolTipText

Chiamata eseguita dal framework per recuperare il testo di descrizione comando personalizzata per il pulsante.

```
virtual BOOL OnGetCustomToolTipText(CString& strToolTip);
```

### <a name="parameters"></a>Parametri

*strToolTip*<br/>
[out] Oggetto `CString` oggetto che riceve il testo della descrizione comando personalizzata.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando viene visualizzata la descrizione comando del pulsante della barra degli strumenti. Se questo metodo restituisce FALSE, il framework utilizza una descrizione comando predefinita.

L'implementazione predefinita non esegue alcuna operazione e restituisce FALSE. L'override del metodo e restituisce un valore diverso da zero per fornire testo della descrizione comando personalizzata per il pulsante della barra degli strumenti.

##  <a name="onglobalfontschanged"></a>  CMFCToolBarButton::OnGlobalFontsChanged

Chiamato dal framework quando è stato modificato il tipo globale di carattere.

```
virtual void OnGlobalFontsChanged();
```

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare il tipo di carattere utilizzato per visualizzare il testo del pulsante.

##  <a name="onmove"></a>  CMFCToolBarButton::OnMove

Chiamato dal framework quando si sposta la barra degli strumenti padre.

```
virtual void OnMove();
```

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per riposizionare il pulsante quando si sposta la barra degli strumenti padre.

##  <a name="onshow"></a>  CMFCToolBarButton::OnShow

Chiamato dal framework quando il pulsante diventa visibile o invisibile.

```
virtual void OnShow(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bMostra*<br/>
[in] Specifica se il pulsante è visibile. Se questo parametro è TRUE, il pulsante è visibile. In caso contrario, il pulsante non è visibile.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per aggiornare la visibilità del pulsante.

##  <a name="onsize"></a>  CMFCToolBarButton::OnSize

Chiamato dal framework quando la barra degli strumenti padre viene modificato le dimensioni o posizione e questa modifica fa sì che il pulsante modificare le dimensioni.

```
virtual void OnSize(int iSize);
```

### <a name="parameters"></a>Parametri

*iSize*<br/>
[in] La nuova larghezza del pulsante.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per ridimensionare il pulsante quando viene modificata la dimensione o la posizione della barra degli strumenti padre.

##  <a name="ontoolhittest"></a>  CMFCToolBarButton::OnToolHitTest

Chiamato dal framework quando la barra degli strumenti padre deve determinare se un punto si trova il rettangolo di delimitazione del pulsante.

```
virtual BOOL OnToolHitTest(
    const CWnd* pWnd,
    TOOLINFO* pTI);
```

### <a name="parameters"></a>Parametri

*pWnd*<br/>
[in] La finestra padre del pulsante. Può essere NULL.

*PTI*<br/>
[in] Oggetto `TOOLINFO` struttura che contiene informazioni su uno strumento in un controllo tooltip.

### <a name="return-value"></a>Valore restituito

Il risultato di `OnMenuButtonToolHitTest` se il pulsante consente di recuperare un puntatore alla finestra cornice padre; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Se la finestra padre può convertire un oggetto frame valido, questo metodo chiama uno dei metodi seguenti:

- [CMDIFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cmdiframewndex-class.md#onmenubuttontoolhittest)

- [CFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/cframewndex-class.md#onmenubuttontoolhittest)

- [COleIPFrameWndEx::OnMenuButtonToolHitTest](../../mfc/reference/coleipframewndex-class.md#onmenubuttontoolhittest)

##  <a name="onupdatetooltip"></a>  CMFCToolBarButton::OnUpdateToolTip

Chiamato dal framework quando la barra degli strumenti padre aggiorna il testo della descrizione comando.

```
virtual BOOL OnUpdateToolTip(
    CWnd* pWndParent,
    int iButtonIndex,
    CToolTipCtrl& wndToolTip,
    CString& str);
```

### <a name="parameters"></a>Parametri

*pWndParent*<br/>
[in] Finestra padre.

*iButtonIndex*<br/>
[in] Indice a base zero del pulsante nell'insieme di pulsanti della padre.

*wndToolTip*<br/>
[in] Il controllo che visualizza il testo della descrizione comando.

*str*<br/>
[out] Oggetto `CString` oggetto che riceve il testo della descrizione aggiornata.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce FALSE.

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione e restituisce FALSE. Eseguire l'override di questo metodo per restituire un valore diverso da zero se si specifica una stringa di testo della descrizione comando.

##  <a name="preparedrag"></a>  CMFCToolBarButton::PrepareDrag

Chiamato dal framework quando il pulsante sta per eseguire un'operazione di trascinamento e rilascio.

```
virtual BOOL PrepareDrag(COleDataSource& srcItem);
```

### <a name="parameters"></a>Parametri

*srcItem*<br/>
[in] Oggetto `COleDataSource` oggetto che archivia le informazioni sullo stato relative all'operazione di trascinamento e rilascio.

### <a name="return-value"></a>Valore restituito

TRUE se l'operazione ha esito positivo; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per preparare il pulsante della barra degli strumenti per archiviare il relativo stato nell'oggetto fornito `COleDataSource` oggetto. Questo metodo archivia lo stato esegue la serializzazione di se stesso in un file condiviso e quindi passando tale file per il [COleDataSource:: CacheGlobalData](../../mfc/reference/coledatasource-class.md#cacheglobaldata) (metodo). Per altre informazioni sulla serializzazione di pulsante della barra degli strumenti, vedere [CMFCToolBarButton::Serialize](#serialize).

Questo metodo non esegue alcuna operazione e restituisce TRUE se il pulsante non può essere archiviato (il [CMFCToolBarButton::CanBeStored](#canbestored) metodo restituisce FALSE). Restituisce FALSE se si verifica un'eccezione durante la serializzazione dell'oggetto.

Per altre informazioni sulle operazioni di trascinamento e rilascio OLE, vedere [Drag and Drop (OLE)](../../mfc/drag-and-drop-ole.md).

##  <a name="rect"></a>  CMFCToolBarButton::Rect

Recupera il rettangolo di delimitazione del pulsante.

```
const CRect& Rect() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `CRect` oggetto che contiene il rettangolo di delimitazione di un pulsante.

##  <a name="resetimagetodefault"></a>  CMFCToolBarButton::ResetImageToDefault

Imposta il valore predefinito l'immagine associata al pulsante.

```
virtual void ResetImageToDefault();
```

### <a name="remarks"></a>Note

Questo metodo recupera l'immagine predefinita da relativa barra degli strumenti padre utilizzando la [CMFCToolBar::GetDefaultImage](../../mfc/reference/cmfctoolbar-class.md#getdefaultimage) (metodo). Se il pulsante non dispone di alcuna immagine predefinita associata, questo metodo imposta l'etichetta di testo del pulsante in base alla relativa risorsa di tipo stringa utilizzando il [CStringT::LoadString](../../atl-mfc-shared/reference/cstringt-class.md#loadstring) (metodo). Per altre informazioni sulle risorse stringa, vedere [Working with Resource Files](../../windows/working-with-resource-files.md).

Questo metodo non esegue alcuna operazione se il pulsante con immagine definita dall'utente.

##  <a name="savebarstate"></a>  CMFCToolBarButton::SaveBarState

Salva lo stato del pulsante della barra degli strumenti.

```
virtual void SaveBarState();
```

### <a name="remarks"></a>Note

Il framework chiama questo metodo quando si crea un `CMFCToolBarButton` oggetto come risultato di un'operazione di trascinamento e rilascio.

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per salvare lo stato del pulsante della barra degli strumenti in un'origine dati esterna.

##  <a name="serialize"></a>  CMFCToolBarButton::Serialize

Legge l'oggetto da un archivio o lo scrive in un archivio.

```
virtual void Serialize(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*ar*<br/>
[in] Il `CArchive` oggetto da cui o in cui serializzare.

### <a name="remarks"></a>Note

Questo metodo supporta i processi di trasferimento dei dati, ad esempio negli Appunti o operazioni di trascinamento e rilascio. Legge o scrive le proprietà del pulsante, ad esempio l'ID etichetta di testo e ID dell'immagine da o verso l'oggetto fornito `CArchive` oggetto.

Per esempi di serializzazione, vedere [serializzazione: serializzazione di un oggetto](../../mfc/serialization-serializing-an-object.md).

##  <a name="setaccdata"></a>  CMFCToolBarButton::SetACCData

Popola l'oggetto specificato `CAccessibilityData` oggetto con dati di accessibilità dal pulsante della barra degli strumenti.

```
virtual BOOL SetACCData(
    CWnd* pParent,
    CAccessibilityData& data);
```

### <a name="parameters"></a>Parametri

*pParent*<br/>
[in] La finestra padre del pulsante della barra degli strumenti.

*data*<br/>
[in] Oggetto `CAccessibilityData` oggetto popolato con i dati di accessibilità del pulsante della barra degli strumenti.

### <a name="return-value"></a>Valore restituito

Questo metodo restituisce TRUE.

### <a name="remarks"></a>Note

Eseguire l'override di questo metodo per restituire FALSE se il pulsante della barra degli strumenti non è forniti dati di accessibilità.

##  <a name="setclipboardformatname"></a>  CMFCToolBarButton::SetClipboardFormatName

Rinomina il formato degli Appunti globale.

```
static void __stdcall SetClipboardFormatName(LPCTSTR lpszName);
```

### <a name="parameters"></a>Parametri

*lpszName*<br/>
[in] Il nuovo nome del formato Appunti globale. Non può essere NULL.

### <a name="remarks"></a>Note

Questo metodo rende possibile per operazioni di trascinamento e rilascio affinché vengano eseguite tra più applicazioni. Ogni applicazione deve fornire lo stesso nome di formato degli Appunti.

È necessario chiamare questo metodo prima il framework chiama [CMFCToolBarButton::GetClipboardFormat](#getclipboardformat).

##  <a name="setimage"></a>  CMFCToolBarButton::SetImage

Imposta l'indice dell'immagine del pulsante.

```
virtual void SetImage(int iImage);
```

### <a name="parameters"></a>Parametri

*iImage*<br/>
[in] L'indice dell'immagine nella raccolta di immagini della barra degli strumenti.

### <a name="remarks"></a>Note

Se il pulsante della barra degli strumenti è un separatore *iImage* si intende la nuova larghezza del pulsante separatore.

Se *iImage* è minore di zero, questo metodo disabilita il disegno dell'immagine e consente di disegno dell'etichetta di testo del pulsante.

##  <a name="setprotectedcommands"></a>  CMFCToolBarButton::SetProtectedCommands

Imposta l'elenco di comandi che l'utente non è possibile personalizzare.

```
static void SetProtectedCommands(const CList<UINT,UINT>& lstCmds);
```

### <a name="parameters"></a>Parametri

*lstCmds*<br/>
[in] L'elenco di comandi protetti.

### <a name="remarks"></a>Note

In modalità di personalizzazione, il framework disabilita i comandi di pulsante della barra degli strumenti che sono protetti. L'utente non è possibile eseguire trascinamento e rilascio e modificare le operazioni sui pulsanti della barra degli strumenti disabilitato.

Usare la [CMFCToolBarButton::GetProtectedCommands](#getprotectedcommands) metodo per recuperare l'elenco di comandi è protetto.

##  <a name="setradio"></a>  CMFCToolBarButton::SetRadio

Chiamato dal framework quando un pulsante viene modificato lo stato.

```
virtual void SetRadio();
```

### <a name="remarks"></a>Note

L'implementazione predefinita di questo metodo non esegue alcuna operazione. Eseguire l'override di questo metodo per eseguire un'azione personalizzata quando il pulsante viene modificato lo stato.

##  <a name="setrect"></a>  CMFCToolBarButton::SetRect

Imposta il rettangolo di delimitazione del pulsante.

```
void SetRect(const CRect rect);
```

### <a name="parameters"></a>Parametri

*Rect*<br/>
[in] Il nuovo rettangolo di delimitazione del pulsante.

### <a name="remarks"></a>Note

Questo metodo chiama il [CMFCToolBarButton::OnMove](#onmove) metodo dopo avere impostato il nuovo rettangolo di delimitazione.

##  <a name="setstyle"></a>  CMFCToolBarButton::SetStyle

Imposta lo stile del pulsante.

```
virtual void SetStyle(UINT nStyle);
```

### <a name="parameters"></a>Parametri

*nStyle*<br/>
[in] Il nuovo stile del pulsante.

### <a name="remarks"></a>Note

L'implementazione predefinita imposta il [CMFCToolBarButton::m_nStyle](#m_nstyle) membro dati da *nStyle*. Eseguire l'override di questo metodo se si desidera eseguire un'elaborazione aggiuntiva per gestire la modifica in stile. Visualizzare [stili dei controlli ToolBar](toolbar-control-styles.md) per un elenco dei flag di stile valido.

##  <a name="setvisible"></a>  CMFCToolBarButton::SetVisible

Specifica se il pulsante è visibile.

```
void SetVisible(BOOL bShow=TRUE);
```

### <a name="parameters"></a>Parametri

*bMostra*<br/>
[in] Valore booleano che specifica se mostrare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Note

Utilizzare questa funzione per nascondere o mostrare un pulsante della barra degli strumenti particolare. Chiamare il [CPane::AdjustSizeImmediate](../../mfc/reference/cpane-class.md#adjustsizeimmediate) metodo dopo aver chiamato questo metodo.

##  <a name="show"></a>  CMFCToolBarButton::Show

Mostra o nasconde il pulsante.

```
void Show(BOOL bShow);
```

### <a name="parameters"></a>Parametri

*bMostra*<br/>
[in] Valore booleano che specifica se mostrare o nascondere il pulsante. Se questo parametro è TRUE, viene visualizzato il pulsante. Se il parametro è FALSE, il pulsante è nascosto.

### <a name="remarks"></a>Note

Il framework chiama questo metodo per aggiornare la visibilità dei pulsanti della barra degli strumenti quando la barra degli strumenti padre viene ridimensionato. Il framework chiama questo metodo con *bMostra* impostato su FALSE quando il pulsante non è più adatta all'interno della barra degli strumenti. Il framework chiama questo metodo con *bMostra* impostata su TRUE quando dopo il ridimensionamento del pulsante anche in questo caso si adatta all'interno della barra degli strumenti.

Usare la [CMFCToolBarButton::SetVisible](#setvisible) metodo per impostare la visibilità del pulsante generale.

Questo metodo chiama il [CMFCToolBarButton::OnShow](#onshow) metodo dopo che aggiorna lo stato di visibilità del pulsante.

## <a name="see-also"></a>Vedere anche

[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Classi](../../mfc/reference/mfc-classes.md)<br/>
[Classe CMFCToolBar](../../mfc/reference/cmfctoolbar-class.md)<br/>
[Classe CMFCToolBarImages](../../mfc/reference/cmfctoolbarimages-class.md)
