---
title: CWinApp (classe)
ms.date: 11/04/2016
f1_keywords:
- CWinApp
- AFXWIN/CWinApp
- AFXWIN/CWinApp::CWinApp
- AFXWIN/CWinApp::AddDocTemplate
- AFXWIN/CWinApp::AddToRecentFileList
- AFXWIN/CWinApp::ApplicationRecoveryCallback
- AFXWIN/CWinApp::CloseAllDocuments
- AFXWIN/CWinApp::CreatePrinterDC
- AFXWIN/CWinApp::DelRegTree
- AFXWIN/CWinApp::DoMessageBox
- AFXWIN/CWinApp::DoWaitCursor
- AFXWIN/CWinApp::EnableD2DSupport
- AFXWIN/CWinApp::EnableHtmlHelp
- AFXWIN/CWinApp::EnableTaskbarInteraction
- AFXWIN/CWinApp::ExitInstance
- AFXWIN/CWinApp::GetApplicationRecoveryParameter
- AFXWIN/CWinApp::GetApplicationRecoveryPingInterval
- AFXWIN/CWinApp::GetApplicationRestartFlags
- AFXWIN/CWinApp::GetAppRegistryKey
- AFXWIN/CWinApp::GetDataRecoveryHandler
- AFXWIN/CWinApp::GetFirstDocTemplatePosition
- AFXWIN/CWinApp::GetHelpMode
- AFXWIN/CWinApp::GetNextDocTemplate
- AFXWIN/CWinApp::GetPrinterDeviceDefaults
- AFXWIN/CWinApp::GetProfileBinary
- AFXWIN/CWinApp::GetProfileInt
- AFXWIN/CWinApp::GetProfileString
- AFXWIN/CWinApp::GetSectionKey
- AFXWIN/CWinApp::HideApplication
- AFXWIN/CWinApp::HtmlHelp
- AFXWIN/CWinApp::InitInstance
- AFXWIN/CWinApp::IsTaskbarInteractionEnabled
- AFXWIN/CWinApp::LoadCursor
- AFXWIN/CWinApp::LoadIcon
- AFXWIN/CWinApp::LoadOEMCursor
- AFXWIN/CWinApp::LoadOEMIcon
- AFXWIN/CWinApp::LoadStandardCursor
- AFXWIN/CWinApp::LoadStandardIcon
- AFXWIN/CWinApp::OnDDECommand
- AFXWIN/CWinApp::OnIdle
- AFXWIN/CWinApp::OpenDocumentFile
- AFXWIN/CWinApp::ParseCommandLine
- AFXWIN/CWinApp::PreTranslateMessage
- AFXWIN/CWinApp::ProcessMessageFilter
- AFXWIN/CWinApp::ProcessShellCommand
- AFXWIN/CWinApp::ProcessWndProcException
- AFXWIN/CWinApp::Register
- AFXWIN/CWinApp::RegisterWithRestartManager
- AFXWIN/CWinApp::ReopenPreviousFilesAtRestart
- AFXWIN/CWinApp::RestartInstance
- AFXWIN/CWinApp::RestoreAutosavedFilesAtRestart
- AFXWIN/CWinApp::Run
- AFXWIN/CWinApp::RunAutomated
- AFXWIN/CWinApp::RunEmbedded
- AFXWIN/CWinApp::SaveAllModified
- AFXWIN/CWinApp::SelectPrinter
- AFXWIN/CWinApp::SetHelpMode
- AFXWIN/CWinApp::SupportsApplicationRecovery
- AFXWIN/CWinApp::SupportsAutosaveAtInterval
- AFXWIN/CWinApp::SupportsAutosaveAtRestart
- AFXWIN/CWinApp::SupportsRestartManager
- AFXWIN/CWinApp::Unregister
- AFXWIN/CWinApp::WinHelp
- AFXWIN/CWinApp::WriteProfileBinary
- AFXWIN/CWinApp::WriteProfileInt
- AFXWIN/CWinApp::WriteProfileString
- AFXWIN/CWinApp::EnableShellOpen
- AFXWIN/CWinApp::LoadStdProfileSettings
- AFXWIN/CWinApp::OnContextHelp
- AFXWIN/CWinApp::OnFileNew
- AFXWIN/CWinApp::OnFileOpen
- AFXWIN/CWinApp::OnFilePrintSetup
- AFXWIN/CWinApp::OnHelp
- AFXWIN/CWinApp::OnHelpFinder
- AFXWIN/CWinApp::OnHelpIndex
- AFXWIN/CWinApp::OnHelpUsing
- AFXWIN/CWinApp::RegisterShellFileTypes
- AFXWIN/CWinApp::SetAppID
- AFXWIN/CWinApp::SetRegistryKey
- AFXWIN/CWinApp::UnregisterShellFileTypes
- AFXWIN/CWinApp::m_bHelpMode
- AFXWIN/CWinApp::m_eHelpType
- AFXWIN/CWinApp::m_hInstance
- AFXWIN/CWinApp::m_lpCmdLine
- AFXWIN/CWinApp::m_nCmdShow
- AFXWIN/CWinApp::m_pActiveWnd
- AFXWIN/CWinApp::m_pszAppID
- AFXWIN/CWinApp::m_pszAppName
- AFXWIN/CWinApp::m_pszExeName
- AFXWIN/CWinApp::m_pszHelpFilePath
- AFXWIN/CWinApp::m_pszProfileName
- AFXWIN/CWinApp::m_pszRegistryKey
- AFXWIN/CWinApp::m_dwRestartManagerSupportFlags
- AFXWIN/CWinApp::m_nAutosaveInterval
- AFXWIN/CWinApp::m_pDataRecoveryHandler
helpviewer_keywords:
- CWinApp [MFC], CWinApp
- CWinApp [MFC], AddDocTemplate
- CWinApp [MFC], AddToRecentFileList
- CWinApp [MFC], ApplicationRecoveryCallback
- CWinApp [MFC], CloseAllDocuments
- CWinApp [MFC], CreatePrinterDC
- CWinApp [MFC], DelRegTree
- CWinApp [MFC], DoMessageBox
- CWinApp [MFC], DoWaitCursor
- CWinApp [MFC], EnableD2DSupport
- CWinApp [MFC], EnableHtmlHelp
- CWinApp [MFC], EnableTaskbarInteraction
- CWinApp [MFC], ExitInstance
- CWinApp [MFC], GetApplicationRecoveryParameter
- CWinApp [MFC], GetApplicationRecoveryPingInterval
- CWinApp [MFC], GetApplicationRestartFlags
- CWinApp [MFC], GetAppRegistryKey
- CWinApp [MFC], GetDataRecoveryHandler
- CWinApp [MFC], GetFirstDocTemplatePosition
- CWinApp [MFC], GetHelpMode
- CWinApp [MFC], GetNextDocTemplate
- CWinApp [MFC], GetPrinterDeviceDefaults
- CWinApp [MFC], GetProfileBinary
- CWinApp [MFC], GetProfileInt
- CWinApp [MFC], GetProfileString
- CWinApp [MFC], GetSectionKey
- CWinApp [MFC], HideApplication
- CWinApp [MFC], HtmlHelp
- CWinApp [MFC], InitInstance
- CWinApp [MFC], IsTaskbarInteractionEnabled
- CWinApp [MFC], LoadCursor
- CWinApp [MFC], LoadIcon
- CWinApp [MFC], LoadOEMCursor
- CWinApp [MFC], LoadOEMIcon
- CWinApp [MFC], LoadStandardCursor
- CWinApp [MFC], LoadStandardIcon
- CWinApp [MFC], OnDDECommand
- CWinApp [MFC], OnIdle
- CWinApp [MFC], OpenDocumentFile
- CWinApp [MFC], ParseCommandLine
- CWinApp [MFC], PreTranslateMessage
- CWinApp [MFC], ProcessMessageFilter
- CWinApp [MFC], ProcessShellCommand
- CWinApp [MFC], ProcessWndProcException
- CWinApp [MFC], Register
- CWinApp [MFC], RegisterWithRestartManager
- CWinApp [MFC], ReopenPreviousFilesAtRestart
- CWinApp [MFC], RestartInstance
- CWinApp [MFC], RestoreAutosavedFilesAtRestart
- CWinApp [MFC], Run
- CWinApp [MFC], RunAutomated
- CWinApp [MFC], RunEmbedded
- CWinApp [MFC], SaveAllModified
- CWinApp [MFC], SelectPrinter
- CWinApp [MFC], SetHelpMode
- CWinApp [MFC], SupportsApplicationRecovery
- CWinApp [MFC], SupportsAutosaveAtInterval
- CWinApp [MFC], SupportsAutosaveAtRestart
- CWinApp [MFC], SupportsRestartManager
- CWinApp [MFC], Unregister
- CWinApp [MFC], WinHelp
- CWinApp [MFC], WriteProfileBinary
- CWinApp [MFC], WriteProfileInt
- CWinApp [MFC], WriteProfileString
- CWinApp [MFC], EnableShellOpen
- CWinApp [MFC], LoadStdProfileSettings
- CWinApp [MFC], OnContextHelp
- CWinApp [MFC], OnFileNew
- CWinApp [MFC], OnFileOpen
- CWinApp [MFC], OnFilePrintSetup
- CWinApp [MFC], OnHelp
- CWinApp [MFC], OnHelpFinder
- CWinApp [MFC], OnHelpIndex
- CWinApp [MFC], OnHelpUsing
- CWinApp [MFC], RegisterShellFileTypes
- CWinApp [MFC], SetAppID
- CWinApp [MFC], SetRegistryKey
- CWinApp [MFC], UnregisterShellFileTypes
- CWinApp [MFC], m_bHelpMode
- CWinApp [MFC], m_eHelpType
- CWinApp [MFC], m_hInstance
- CWinApp [MFC], m_lpCmdLine
- CWinApp [MFC], m_nCmdShow
- CWinApp [MFC], m_pActiveWnd
- CWinApp [MFC], m_pszAppID
- CWinApp [MFC], m_pszAppName
- CWinApp [MFC], m_pszExeName
- CWinApp [MFC], m_pszHelpFilePath
- CWinApp [MFC], m_pszProfileName
- CWinApp [MFC], m_pszRegistryKey
- CWinApp [MFC], m_dwRestartManagerSupportFlags
- CWinApp [MFC], m_nAutosaveInterval
- CWinApp [MFC], m_pDataRecoveryHandler
ms.assetid: e426a3cd-0d15-40d6-bd55-beaa5feb2343
ms.openlocfilehash: 6366638ebfd5e78ad517a8913e4276d5cd820670
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62323359"
---
# <a name="cwinapp-class"></a>CWinApp (classe)

Classe di base da cui deriva un oggetto applicazione Windows.

## <a name="syntax"></a>Sintassi

```
class CWinApp : public CWinThread
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CWinApp::CWinApp](#cwinapp)|Costruisce un oggetto `CWinApp`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CWinApp::AddDocTemplate](#adddoctemplate)|Aggiunge un modello di documento elenco dell'applicazione di modelli di documento disponibili.|
|[CWinApp::AddToRecentFileList](#addtorecentfilelist)|Aggiunge un nome di file all'elenco dei file utilizzato di recente (MRU).|
|[CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback)|Chiamato dal framework quando l'applicazione viene chiusa in modo imprevisto.|
|[CWinApp::CloseAllDocuments](#closealldocuments)|Chiude tutti i documenti aperti.|
|[CWinApp::CreatePrinterDC](#createprinterdc)|Crea un contesto di dispositivo stampante.|
|[CWinApp::DelRegTree](#delregtree)|Elimina una chiave specificata e tutte le relative sottochiavi.|
|[CWinApp::DoMessageBox](#domessagebox)|Implements [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox) per l'applicazione.|
|[CWinApp::DoWaitCursor](#dowaitcursor)|Consente di attivare e disattivare il cursore di attesa.|
|[CWinApp::EnableD2DSupport](#enabled2dsupport)|Abilita il supporto D2D dell'applicazione. Chiamare questo metodo prima dell'inizializzazione della finestra principale.|
|[CWinApp::EnableHtmlHelp](#enablehtmlhelp)|Implementa HTMLHelp per l'applicazione, invece di WinHelp.|
|[CWinApp::EnableTaskbarInteraction](#enabletaskbarinteraction)|Consente l'interazione della barra delle applicazioni.|
|[CWinApp::ExitInstance](#exitinstance)|Eseguire l'override per eseguire la pulizia quando l'applicazione termina.|
|[CWinApp::GetApplicationRecoveryParameter](#getapplicationrecoveryparameter)|Recupera il parametro di input per il metodo di ripristino dell'applicazione.|
|[CWinApp::GetApplicationRecoveryPingInterval](#getapplicationrecoverypinginterval)|Restituisce la lunghezza di tempo in cui Gestione riavvio è in attesa per la funzione di callback di ripristino da restituire.|
|[CWinApp::GetApplicationRestartFlags](#getapplicationrestartflags)|Restituisce i flag per la gestione riavvio.|
|[CWinApp::GetAppRegistryKey](#getappregistrykey)|Chiave restituisce per HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Software".|
|[CWinApp::GetDataRecoveryHandler](#getdatarecoveryhandler)|Ottiene il gestore di ripristino dei dati per questa istanza dell'applicazione.|
|[CWinApp::GetFirstDocTemplatePosition](#getfirstdoctemplateposition)|Recupera la posizione del primo modello di documento.|
|[CWinApp::GetHelpMode](#gethelpmode)|Recupera il tipo di Guida utilizzata dall'applicazione.|
|[CWinApp::GetNextDocTemplate](#getnextdoctemplate)|Recupera la posizione di un modello di documento. Può essere utilizzato in modo ricorsivo.|
|[CWinApp::GetPrinterDeviceDefaults](#getprinterdevicedefaults)|Recupera le impostazioni predefinite dispositivo stampante.|
|[CWinApp::GetProfileBinary](#getprofilebinary)|Recupera i dati binari da una voce dell'applicazione. File INI.|
|[CWinApp::GetProfileInt](#getprofileint)|Recupera un numero intero da una voce dell'applicazione. File INI.|
|[CWinApp::GetProfileString](#getprofilestring)|Recupera una stringa da una voce dell'applicazione. File INI.|
|[CWinApp::GetSectionKey](#getsectionkey)|Chiave restituisce per HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Software".|
|[CWinApp::HideApplication](#hideapplication)|Consente di nascondere l'applicazione prima di chiudere tutti i documenti.|
|[CWinApp::HtmlHelp](#htmlhelp)|Le chiamate di `HTMLHelp` funzione Windows.|
|[CWinApp::InitInstance](#initinstance)|Eseguire l'override per eseguire l'inizializzazione dell'istanza di Windows, ad esempio la creazione di oggetti finestra.|
|[CWinApp::IsTaskbarInteractionEnabled](#istaskbarinteractionenabled)|Indica se è abilitata l'interazione della barra delle applicazioni di Windows 7.|
|[CWinApp::LoadCursor](#loadcursor)|Carica una risorsa del cursore.|
|[CWinApp::LoadIcon](#loadicon)|Carica una risorsa icona.|
|[CWinApp::LoadOEMCursor](#loadoemcursor)|Carica un OEM di Windows predefinite del cursore che il **OCR_** costanti specificano in WINDOWS. H.|
|[CWinApp::LoadOEMIcon](#loadoemicon)|Carica un'icona predefinita OEM di Windows che il **OIC_** costanti specificano in WINDOWS. H.|
|[CWinApp::LoadStandardCursor](#loadstandardcursor)|Carica un Windows predefiniti del cursore che il **IDC _** costanti specificano in WINDOWS. H.|
|[CWinApp::LoadStandardIcon](#loadstandardicon)|Carica un'icona predefinita di Windows che il **IDI_** costanti specificano in WINDOWS. H.|
|[CWinApp::OnDDECommand](#onddecommand)|Chiamato dal framework in risposta a un dynamic data exchange (DDE) eseguire comandi.|
|[CWinApp::OnIdle](#onidle)|Eseguire l'override per l'elaborazione di tempo di inattività specifiche dell'applicazione.|
|[CWinApp::OpenDocumentFile](#opendocumentfile)|Chiamato dal framework per aprire un documento da un file.|
|[CWinApp::ParseCommandLine](#parsecommandline)|Analizza i singoli parametri e i flag nella riga di comando.|
|[CWinApp::PreTranslateMessage](#pretranslatemessage)|Filtra i messaggi prima che vengano inviati alle funzioni di Windows [TranslateMessage](/windows/desktop/api/winuser/nf-winuser-translatemessage) e [DispatchMessage](/windows/desktop/api/winuser/nf-winuser-dispatchmessage).|
|[CWinApp::ProcessMessageFilter](#processmessagefilter)|Intercetta determinati messaggi prima che raggiungano l'applicazione.|
|[CWinApp::ProcessShellCommand](#processshellcommand)|Gestisce i flag e gli argomenti della riga di comando.|
|[CWinApp::ProcessWndProcException](#processwndprocexception)|Intercetta tutte le eccezioni non gestite generate dal messaggio dell'applicazione e i gestori comando.|
|[CWinApp::Register](#register)|Esegue la registrazione personalizzata.|
|[CWinApp::RegisterWithRestartManager](#registerwithrestartmanager)|Registra l'applicazione con Gestione riavvio.|
|[CWinApp::ReopenPreviousFilesAtRestart](#reopenpreviousfilesatrestart)|Determina se la gestione riavvio riapre i file che sono stati aperti quando l'applicazione è stata chiusa in modo imprevisto.|
|[CWinApp::RestartInstance](#restartinstance)|Consente di gestire il riavvio di un'applicazione avviato da Gestione riavvio.|
|[CWinApp::RestoreAutosavedFilesAtRestart](#restoreautosavedfilesatrestart)|Determina se Gestione riavvio consente di ripristinare i file salvato automaticamente quando riavvia l'applicazione.|
|[CWinApp::Run](#run)|Esegue il ciclo di messaggi predefinito. Eseguire l'override per personalizzare il ciclo di messaggi.|
|[CWinApp::RunAutomated](#runautomated)|Testa la riga di comando dell'applicazione per il **/Automation** opzione. Obsoleta. In alternativa, usare il valore [CCommandLineInfo::m_bRunAutomated](../../mfc/reference/ccommandlineinfo-class.md#m_brunautomated) dopo aver chiamato [ParseCommandLine](#parsecommandline).|
|[CWinApp::RunEmbedded](#runembedded)|Testa la riga di comando dell'applicazione per il **/Embedding** opzione. Obsoleta. In alternativa, usare il valore [CCommandLineInfo::m_bRunEmbedded](../../mfc/reference/ccommandlineinfo-class.md#m_brunembedded) dopo aver chiamato [ParseCommandLine](#parsecommandline).|
|[CWinApp::SaveAllModified](#saveallmodified)|Chiede all'utente di salvare i documenti modificati tutti.|
|[CWinApp::SelectPrinter](#selectprinter)|Consente di selezionare una stampante indicata in precedenza da un utente tramite una finestra di dialogo Stampa.|
|[CWinApp::SetHelpMode](#sethelpmode)|Imposta e inizializza il tipo di Guida utilizzata dall'applicazione.|
|[CWinApp::SupportsApplicationRecovery](#supportsapplicationrecovery)|Determina se la gestione riavvio consente di recuperare un'applicazione che è stato terminato in modo imprevisto.|
|[CWinApp::SupportsAutosaveAtInterval](#supportsautosaveatinterval)|Determina se la si chiuda Gestione riavvio apre i documenti a intervalli regolari.|
|[CWinApp::SupportsAutosaveAtRestart](#supportsautosaveatrestart)|Determina se la si chiuda Gestione riavvio qualsiasi aprire i documenti quando l'applicazione viene riavviata.|
|[CWinApp::SupportsRestartManager](#supportsrestartmanager)|Determina se l'applicazione supporta la gestione del riavvio.|
|[CWinApp::Unregister](#unregister)|Annulla la registrazione di tutte le informazioni note per essere registrato dal `CWinApp` oggetto.|
|[CWinApp::WinHelp](#winhelp)|Le chiamate di `WinHelp` funzione Windows.|
|[CWinApp::WriteProfileBinary](#writeprofilebinary)|Scrive i dati binari a una voce dell'applicazione. File INI.|
|[CWinApp::WriteProfileInt](#writeprofileint)|Scrive un intero a una voce dell'applicazione. File INI.|
|[CWinApp::WriteProfileString](#writeprofilestring)|Scrive una stringa di una voce dell'applicazione. File INI.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Descrizione|
|----------|-----------------|
|[CWinApp::EnableShellOpen](#enableshellopen)|Consente all'utente di aprire i file di dati da Gestione File di Windows.|
|[CWinApp::LoadStdProfileSettings](#loadstdprofilesettings)|Standard di caricamenti. Impostazioni del file INI e abilita la recente funzionalità degli elenchi del file.|
|[CWinApp::OnContextHelp](#oncontexthelp)|Gestisce MAIUSC + F1 all'interno dell'applicazione.|
|[CWinApp::OnFileNew](#onfilenew)|Implementa il ID_FILE_NEW (comando).|
|[CWinApp::OnFileOpen](#onfileopen)|Implementa il ID_FILE_OPEN (comando).|
|[CWinApp::OnFilePrintSetup](#onfileprintsetup)|Implementa il ID_FILE_PRINT_SETUP (comando).|
|[CWinApp::OnHelp](#onhelp)|Gestisce F1 Guida all'interno dell'applicazione (usando il contesto corrente).|
|[CWinApp::OnHelpFinder](#onhelpfinder)|Gestisce i comandi ID_HELP_FINDER e ID_DEFAULT_HELP.|
|[CWinApp::OnHelpIndex](#onhelpindex)|Gestisce il ID_HELP_INDEX (comando) e fornisce un argomento della Guida predefinito.|
|[CWinApp::OnHelpUsing](#onhelpusing)|Gestisce il ID_HELP_USING (comando).|
|[CWinApp::RegisterShellFileTypes](#registershellfiletypes)|Registra i tipi di documenti dell'applicazione con la gestione di File di Windows.|
|[CWinApp::SetAppID](#setappid)|Imposta in modo esplicito l'ID modello utente applicazione per l'applicazione. Questo metodo deve essere chiamato prima che qualsiasi interfaccia utente viene presentato all'utente (il modo migliore è il costruttore dell'applicazione).|
|[CWinApp::SetRegistryKey](#setregistrykey)|Fa sì che le impostazioni dell'applicazione da archiviare nel Registro di sistema anziché. File INI.|
|[CWinApp::UnregisterShellFileTypes](#unregistershellfiletypes)|Annulla la registrazione di tipi di documenti dell'applicazione con la gestione di File di Windows.|

### <a name="public-data-members"></a>Membri dati pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CWinApp::m_bHelpMode](#m_bhelpmode)|Indica se l'utente è in modalità di contesto della Guida (in genere richiamate con MAIUSC + F1).|
|[CWinApp::m_eHelpType](#m_ehelptype)|Specifica il tipo di Guida utilizzata dall'applicazione.|
|[CWinApp::m_hInstance](#m_hinstance)|Identifica l'istanza corrente dell'applicazione.|
|[CWinApp::m_lpCmdLine](#m_lpcmdline)|Punta a una stringa con terminazione null che specifica la riga di comando per l'applicazione.|
|[CWinApp::m_nCmdShow](#m_ncmdshow)|Specifica come deve essere visualizzato inizialmente la finestra.|
|[CWinApp::m_pActiveWnd](#m_pactivewnd)|Puntatore alla finestra principale dell'applicazione contenitore quando un server OLE sul posto attivo.|
|[CWinApp::m_pszAppID](#m_pszappid)|Modello di ID utente dell'applicazione.|
|[CWinApp::m_pszAppName](#m_pszappname)|Specifica il nome dell'applicazione.|
|[CWinApp::m_pszExeName](#m_pszexename)|Il nome del modulo dell'applicazione.|
|[CWinApp::m_pszHelpFilePath](#m_pszhelpfilepath)|Percorso file della Guida dell'applicazione.|
|[CWinApp::m_pszProfileName](#m_pszprofilename)|L'applicazione. Nome del file INI.|
|[CWinApp::m_pszRegistryKey](#m_pszregistrykey)|Utilizzato per determinare la chiave del Registro di sistema completo per l'archiviazione delle impostazioni del profilo dell'applicazione.|

### <a name="protected-data-members"></a>Membri dati protetti

|Nome|Descrizione|
|----------|-----------------|
|[CWinApp::m_dwRestartManagerSupportFlags](#m_dwrestartmanagersupportflags)|Flag che determinano il comportamento di Gestione riavvio.|
|[CWinApp::m_nAutosaveInterval](#m_nautosaveinterval)|Il periodo di tempo in millisecondi tra si chiuda.|
|[CWinApp::m_pDataRecoveryHandler](#m_pdatarecoveryhandler)|Puntatore al gestore di ripristino dei dati per l'applicazione.|

## <a name="remarks"></a>Note

Un oggetto applicazione fornisce le funzioni membro per l'inizializzazione dell'applicazione (e ciascuna istanza dello stesso) e per l'esecuzione dell'applicazione.

Ogni applicazione che usa le classi Microsoft Foundation può contenere solo un oggetto derivato da `CWinApp`. Questo oggetto viene costruito quando vengono costruite altri oggetti globali C++ ed è già disponibile quando chiama Windows la `WinMain` (funzione), che viene fornito per la libreria Microsoft Foundation Class. Dichiarare la derivata `CWinApp` oggetto a livello globale.

Quando si deriva una classe dell'applicazione dal `CWinApp`, eseguire l'override di [InitInstance](#initinstance) funzione membro per creare l'oggetto della finestra principale dell'applicazione.

Oltre al `CWinApp` funzioni membro, la libreria Microsoft Foundation Class fornisce le seguenti funzioni globali per accedere la `CWinApp` oggetti e altre informazioni globali:

- [AfxGetApp](application-information-and-management.md#afxgetapp) recupera un puntatore per il `CWinApp` oggetto.

- [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle) recupera un handle per l'istanza dell'applicazione corrente.

- [AfxGetResourceHandle](application-information-and-management.md#afxgetresourcehandle) recupera un handle per le risorse dell'applicazione.

- [AfxGetAppName](application-information-and-management.md#afxgetappname) recupera un puntatore a una stringa contenente il nome dell'applicazione. In alternativa, se si dispone di un puntatore per il `CWinApp` dell'oggetto, usare `m_pszExeName` per ottenere il nome dell'applicazione.

Vedere [CWinApp: La classe dell'applicazione](../../mfc/cwinapp-the-application-class.md) per altre informazioni sul `CWinApp` (classe), tra cui un riepilogo delle operazioni seguenti:

- `CWinApp`-derivato il codice scritto per la creazione guidata applicazione.

- `CWinApp`del ruolo nella sequenza di esecuzione dell'applicazione.

- `CWinApp`'s le implementazioni delle funzioni di membro predefinito.

- `CWinApp`della chiave a sottoponibili a override.

Il `m_hPrevInstance` membro dati non esiste più. Per determinare se un'altra istanza dell'applicazione è in esecuzione, usare un mutex denominato. Se il mutex di apertura non riesce, allora non sono presenti altre istanze dell'applicazione in esecuzione.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWinThread](../../mfc/reference/cwinthread-class.md)

`CWinApp`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxwin.h

##  <a name="adddoctemplate"></a>  CWinApp::AddDocTemplate

Chiamare questa funzione membro per aggiungere un modello di documento all'elenco dei modelli disponibili per i documenti che gestisce l'applicazione.

```
void AddDocTemplate(CDocTemplate* pTemplate);
```

### <a name="parameters"></a>Parametri

*pTemplate*<br/>
Un puntatore al `CDocTemplate` da aggiungere.

### <a name="remarks"></a>Note

È necessario aggiungere tutti i documenti modelli in un'applicazione prima di chiamare [RegisterShellFileTypes](#registershellfiletypes).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#35](../../mfc/reference/codesnippet/cpp/cwinapp-class_1.cpp)]

##  <a name="addtorecentfilelist"></a>  CWinApp::AddToRecentFileList

Chiamare questa funzione membro da aggiungere *lpszPathName* all'elenco dei file usati di recente.

```
virtual void AddToRecentFileList(LPCTSTR lpszPathName);
```

### <a name="parameters"></a>Parametri

*lpszPathName*<br/>
Percorso del file.

### <a name="remarks"></a>Note

È necessario chiamare il [LoadStdProfileSettings](#loadstdprofilesettings) funzione membro per caricare l'elenco dei file usati di recente corrente prima di usare questa funzione membro.

Il framework chiama questa funzione membro quando apre un file o si esegue il comando Salva con nome per salvare un file con un nuovo nome.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#36](../../mfc/reference/codesnippet/cpp/cwinapp-class_2.cpp)]

##  <a name="applicationrecoverycallback"></a>  CWinApp::ApplicationRecoveryCallback

Chiamato dal framework quando l'applicazione viene chiusa in modo imprevisto.

```
virtual DWORD ApplicationRecoveryCallback(LPVOID lpvParam);
```

### <a name="parameters"></a>Parametri

*lpvParam*<br/>
[in] Riservato per utilizzi futuri.

### <a name="return-value"></a>Valore restituito

0 se questo metodo ha esito positivo; diverso da zero se si verifica un errore.

### <a name="remarks"></a>Note

Se l'applicazione supporti Gestione riavvio, il framework chiama questa funzione quando l'applicazione viene chiusa in modo imprevisto.

L'implementazione predefinita di `ApplicationRecoveryCallback` utilizza il `CDataRecoveryHandler` per salvare l'elenco dei documenti attualmente aperti nel Registro di sistema. Questo metodo non non salva automaticamente tutti i file.

Per personalizzare il comportamento, eseguire l'override di questa funzione in un oggetto derivato [classe CWinApp](../../mfc/reference/cwinapp-class.md) oppure passare il proprio metodo di ripristino dell'applicazione come parametro al [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).

##  <a name="closealldocuments"></a>  CWinApp::CloseAllDocuments

Chiamare questa funzione membro per chiudere tutti i documenti aperti prima di uscire.

```
void CloseAllDocuments(BOOL bEndSession);
```

### <a name="parameters"></a>Parametri

*bEndSession*<br/>
Specifica se la sessione di Windows viene completata. È TRUE se la sessione; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Chiamare [HideApplication](#hideapplication) prima di chiamare `CloseAllDocuments`.

##  <a name="createprinterdc"></a>  CWinApp::CreatePrinterDC

Chiamare questa funzione membro per creare un contesto di periferica (DC) della stampante dalla stampante selezionata.

```
BOOL CreatePrinterDC(CDC& dc);
```

### <a name="parameters"></a>Parametri

*dc*<br/>
Un riferimento a un contesto di dispositivo stampante.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contesto di dispositivo stampante viene creato correttamente. in caso contrario 0.

### <a name="remarks"></a>Note

`CreatePrinterDC` Inizializza il contesto di dispositivo passato per riferimento, in modo che è possibile usarlo da stampare.

Se la funzione ha esito positivo, al termine della stampa, è necessario eliminare definitivamente il contesto di dispositivo. È possibile consentire il distruttore del [CDC](../../mfc/reference/cdc-class.md) oggetto farlo oppure è possibile farlo in modo esplicito chiamando [CDC::DeleteDC](../../mfc/reference/cdc-class.md#deletedc).

##  <a name="cwinapp"></a>  CWinApp::CWinApp

Costruisce un `CWinApp` oggetto e passa *lpszAppName* da archiviare come il nome dell'applicazione.

```
CWinApp(LPCTSTR lpszAppName = NULL);
```

### <a name="parameters"></a>Parametri

*lpszAppName*<br/>
Una stringa con terminazione null che contiene il nome dell'applicazione che utilizza Windows. Se questo argomento viene omesso oppure è NULL, `CWinApp` Usa la stringa di risorsa AFX_IDS_APP_TITLE o il nome del file del file eseguibile.

### <a name="remarks"></a>Note

È necessario costruire un oggetto globale del `CWinApp`-classe derivata. Si può avere un solo `CWinApp` oggetto nell'applicazione. Il costruttore archivia un puntatore per il `CWinApp` oggetti in modo che `WinMain` può chiamare le funzioni per inizializzare ed eseguire l'applicazione di membro dell'oggetto.

##  <a name="delregtree"></a>  CWinApp::DelRegTree

Elimina una chiave del Registro di sistema specifico e tutte le relative sottochiavi.

```
LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName);

LONG DelRegTree(
    HKEY hParentKey,
    const CString& strKeyName,
    CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametri

*hParentKey*<br/>
Handle per una chiave del Registro di sistema.

*strKeyName*<br/>
Il nome della chiave del Registro di sistema da eliminare.

*pTM*<br/>
Puntatore all'oggetto CAtlTransactionManager.

### <a name="return-value"></a>Valore restituito

Se la funzione ha esito positivo, il valore restituito è ERROR_SUCCESS. Se la funzione ha esito negativo, il valore restituito è un codice di errore diverso da zero definito nel file Winerror. h.

### <a name="remarks"></a>Note

Chiamare questa funzione per eliminare la chiave specificata e nelle relative sottochiavi.

##  <a name="domessagebox"></a>  CWinApp::DoMessageBox

Il framework chiama questa funzione membro per implementare una finestra di messaggio per la funzione globale [AfxMessageBox](cstring-formatting-and-message-box-display.md#afxmessagebox).

```
virtual int DoMessageBox(
    LPCTSTR lpszPrompt,
    UINT nType,
    UINT nIDPrompt);
```

### <a name="parameters"></a>Parametri

*lpszPrompt*<br/>
Indirizzo del testo nella finestra di messaggio.

*nType*<br/>
La finestra di messaggio [stile](../../mfc/reference/styles-used-by-mfc.md#message-box-styles).

*nIDPrompt*<br/>
Indice in una stringa di contesto della Guida.

### <a name="return-value"></a>Valore restituito

Restituisce gli stessi valori `AfxMessageBox`.

### <a name="remarks"></a>Note

Non chiamare questa funzione membro per aprire una finestra di messaggio; usare `AfxMessageBox` invece.

Eseguire l'override di questa funzione membro per personalizzare l'elaborazione a livello di applicazione dei `AfxMessageBox` chiamate.

##  <a name="dowaitcursor"></a>  CWinApp::DoWaitCursor

Questa funzione membro viene chiamata dal framework per implementare [CWaitCursor](../../mfc/reference/cwaitcursor-class.md), [CCmdTarget::BeginWaitCursor](../../mfc/reference/ccmdtarget-class.md#beginwaitcursor), [CCmdTarget::EndWaitCursor](../../mfc/reference/ccmdtarget-class.md#endwaitcursor), e [ CCmdTarget::RestoreWaitCursor](../../mfc/reference/ccmdtarget-class.md#restorewaitcursor).

```
virtual void DoWaitCursor(int nCode);
```

### <a name="parameters"></a>Parametri

*nCode*<br/>
Se questo parametro è 1, viene visualizzato un cursore di attesa. Se è 0, il cursore di attesa viene ripristinato senza incrementare il conteggio dei riferimenti. Se-1, il cursore di attesa termina.

### <a name="remarks"></a>Note

Il valore predefinito implementa un cursore a forma di clessidra. `DoWaitCursor` mantiene un conteggio dei riferimenti. Quando è positivo, viene visualizzato il cursore a forma di clessidra.

Durante la chiamata non è in genere `DoWaitCursor` direttamente, è possibile eseguire l'override di questa funzione membro per modificare il cursore di attesa o per eseguire un'elaborazione aggiuntiva quando viene visualizzato il cursore di attesa.

Per un modo più semplice e più semplice implementare un cursore di attesa, usare `CWaitCursor`.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#37](../../mfc/reference/codesnippet/cpp/cwinapp-class_3.cpp)]

##  <a name="enabled2dsupport"></a>  CWinApp::EnableD2DSupport

È necessario Visual Studio 2010 SP1.

Abilita il supporto D2D dell'applicazione. Chiamare questo metodo prima dell'inizializzazione della finestra principale.

```
BOOL EnableD2DSupport(
    D2D1_FACTORY_TYPE d2dFactoryType = D2D1_FACTORY_TYPE_SINGLE_THREADED,
    DWRITE_FACTORY_TYPE writeFactoryType = DWRITE_FACTORY_TYPE_SHARED);
```

### <a name="parameters"></a>Parametri

*d2dFactoryType*<br/>
Il modello di threading la factory D2D e delle risorse viene creato.

*writeFactoryType*<br/>
Un valore che specifica se l'oggetto factory di scrittura verrà condiviso o isolato

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se il supporto D2D è stato abilitato, FALSE, in caso contrario

##  <a name="enablehtmlhelp"></a>  CWinApp::EnableHtmlHelp

Chiamare questa funzione membro all'interno del costruttore del `CWinApp`-classe derivata da utilizzare HTMLHelp per la Guida dell'applicazione.

```
void EnableHtmlHelp();
```

### <a name="remarks"></a>Note

##  <a name="enableshellopen"></a>  CWinApp::EnableShellOpen

Chiamare questa funzione, in genere dal `InitInstance` sostituzione, consente di abilitare gli utenti dell'applicazione aprire i file di dati quando si fa doppio clic i file dalla gestione di File all'interno di Windows.

```
void EnableShellOpen();
```

### <a name="remarks"></a>Note

Chiamare il `RegisterShellFileTypes` utilizzabile in combinazione con questa funzione membro, o fornire una. File. REG con l'applicazione per la registrazione manuale dei tipi di documento.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#38](../../mfc/reference/codesnippet/cpp/cwinapp-class_4.cpp)]

##  <a name="enabletaskbarinteraction"></a>  CWinApp::EnableTaskbarInteraction

Consente l'interazione della barra delle applicazioni.

```
BOOL EnableTaskbarInteraction(BOOL bEnable = TRUE);
```

### <a name="parameters"></a>Parametri

*bEnable*<br/>
Specifica se l'interazione con barra delle applicazioni Windows 7 deve essere abilitata (TRUE) oppure disabilitata (FALSE).

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se l'interazione della barra delle applicazioni può essere abilitato o disabilitato.

### <a name="remarks"></a>Note

Questo metodo deve essere chiamato prima della creazione della finestra principale, in caso contrario le asserzioni e restituisce FALSE.

##  <a name="exitinstance"></a>  CWinApp::ExitInstance

Chiamato dal framework all'interno di `Run` funzione membro per uscire da questa istanza dell'applicazione.

```
virtual int ExitInstance();
```

### <a name="return-value"></a>Valore restituito

Codice di uscita dell'applicazione; 0 non indica errori e i valori maggiori di 0 indicano un errore. Questo valore viene usato come valore restituito da `WinMain`.

### <a name="remarks"></a>Note

Non chiamare questa funzione membro da qualsiasi posizione ma entro la `Run` funzione membro.

L'implementazione predefinita di questa funzione scrive le opzioni di framework dell'applicazione. File INI. Eseguire l'override di questa funzione per pulire quando l'applicazione termina.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#39](../../mfc/reference/codesnippet/cpp/cwinapp-class_5.cpp)]

##  <a name="getapplicationrecoveryparameter"></a>  CWinApp::GetApplicationRecoveryParameter

Recupera il parametro di input per il metodo di ripristino dell'applicazione.

```
virtual LPVOID GetApplicationRecoveryParameter();
```

### <a name="return-value"></a>Valore restituito

Il parametro di input predefinito per il metodo di ripristino dell'applicazione.

### <a name="remarks"></a>Note

Il comportamento predefinito di questa funzione restituisce NULL.

Per altre informazioni, vedere [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).

##  <a name="getapplicationrecoverypinginterval"></a>  CWinApp::GetApplicationRecoveryPingInterval

Restituisce la lunghezza di tempo in cui Gestione riavvio è in attesa per la funzione di callback di ripristino da restituire.

```
virtual DWORD GetApplicationRecoveryPingInterval();
```

### <a name="return-value"></a>Valore restituito

Il periodo di tempo in millisecondi.

### <a name="remarks"></a>Note

Quando un'applicazione che viene registrata con il manager di riavvio viene chiuso in modo imprevisto, l'applicazione tenta di salvare i documenti aperti e chiama la funzione di callback di ripristino. La funzione di callback di ripristino predefinito è [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).

Il periodo di tempo che il framework attende che la funzione di callback di ripristino da restituire è l'intervallo di ping. È possibile personalizzare l'intervallo di ping eseguendo l'override `CWinApp::GetApplicationRecoveryPingInterval` o fornendo un valore personalizzato per `RegisterWithRestartManager`.

##  <a name="getapplicationrestartflags"></a>  CWinApp::GetApplicationRestartFlags

Restituisce i flag per la gestione riavvio.

```
virtual DWORD GetApplicationRestartFlags();
```

### <a name="return-value"></a>Valore restituito

I flag per la gestione del riavvio. L'implementazione predefinita restituisce 0.

### <a name="remarks"></a>Note

I flag per la gestione del riavvio non hanno alcun effetto con l'implementazione predefinita. Vengono fornite per un uso futuro.

I flag è impostato quando si registra l'applicazione con Gestione riavvio tramite [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager).

I valori possibili per i flag di Gestione riavvio sono come segue:

- RESTART_NO_CRASH

- RESTART_NO_HANG

- RESTART_NO_PATCH

- RESTART_NO_REBOOT

##  <a name="getappregistrykey"></a>  CWinApp::GetAppRegistryKey

Restituisce la chiave per HKEY_CURRENT_USER\\\RegistryKey\ProfileName "Software".

```
HKEY GetAppRegistryKey(CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametri

*pTM*<br/>
Puntatore a un oggetto `CAtlTransactionManager`.

### <a name="return-value"></a>Valore restituito

Chiave dell'applicazione se la funzione ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Note

##  <a name="getdatarecoveryhandler"></a>  CWinApp::GetDataRecoveryHandler

Ottiene il gestore di ripristino dei dati per questa istanza dell'applicazione.

```
virtual CDataRecoveryHandler *GetDataRecoveryHandler();
```

### <a name="return-value"></a>Valore restituito

Il gestore di ripristino dei dati per questa istanza dell'applicazione.

### <a name="remarks"></a>Note

Ogni applicazione che Usa Gestione riavvio deve avere un'istanza di [classe CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md). Questa classe è responsabile del monitoraggio documenti aperti e i file di salvataggio automatico. Il comportamento del `CDataRecoveryHandler` dipende dalla configurazione di Gestione riavvio. Per altre informazioni, vedere [classe CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md).

Questo metodo restituisce NULL in sistemi operativi precedenti a Windows Vista. Gestione riavvio non è supportata nei sistemi operativi precedenti a Windows Vista.

Se l'applicazione non ha attualmente un gestore di ripristino dei dati, questo metodo ne crea uno e restituisce un puntatore a esso.

##  <a name="getfirstdoctemplateposition"></a>  CWinApp::GetFirstDocTemplatePosition

Ottiene la posizione del primo modello di documento nell'applicazione.

```
POSITION GetFirstDocTemplatePosition() const;
```

### <a name="return-value"></a>Valore restituito

Un valore di posizione che può essere utilizzato per iterazione o il recupero di puntatore a oggetto; NULL se l'elenco è vuoto.

### <a name="remarks"></a>Note

Utilizzare il valore di posizione restituito in una chiamata a [GetNextDocTemplate](#getnextdoctemplate) per ottenere le prime [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) oggetto.

##  <a name="gethelpmode"></a>  CWinApp::GetHelpMode

Recupera il tipo di Guida utilizzata dall'applicazione.

```
AFX_HELP_TYPE GetHelpMode();
```

### <a name="return-value"></a>Valore restituito

Il tipo di supporto usato dall'applicazione. Visualizzare [CWinApp::m_eHelpType](#m_ehelptype) per altre informazioni.

##  <a name="getnextdoctemplate"></a>  CWinApp::GetNextDocTemplate

Ottiene il modello di documento identificato da *pos*, quindi imposta *pos* sul valore di posizione.

```
CDocTemplate* GetNextDocTemplate(POSITION& pos) const;
```

### <a name="parameters"></a>Parametri

*pos*<br/>
Un riferimento a un valore di posizione restituito da una chiamata precedente a `GetNextDocTemplate` oppure [funzioni membro GetFirstDocTemplatePosition](#getfirstdoctemplateposition). Il valore viene aggiornato nella successiva posizione da questa chiamata.

### <a name="return-value"></a>Valore restituito

Un puntatore a un [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) oggetto.

### <a name="remarks"></a>Note

È possibile usare `GetNextDocTemplate` in un ciclo di iterazione in avanti se si stabilisce la posizione iniziale con una chiamata a `GetFirstDocTemplatePosition`.

È necessario assicurarsi che il valore di posizione è valido. Se non è valido, quindi asserisce la versione di Debug della libreria di classi Microsoft Foundation.

Se il modello di documento recuperato è l'ultimo disponibile, quindi il nuovo valore della *pos* è impostato su NULL.

##  <a name="getprinterdevicedefaults"></a>  CWinApp::GetPrinterDeviceDefaults

Chiamare questa funzione membro per preparare una stampante contesto di dispositivo per la stampa.

```
BOOL GetPrinterDeviceDefaults(struct tagPDA* pPrintDlg);
```

### <a name="parameters"></a>Parametri

*pPrintDlg*<br/>
Un puntatore a un [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Recupera le impostazioni predefinite della stampante da di Windows. File INI come necessario, o viene utilizzata l'ultima configurazione stampante impostata dall'utente nel programma di installazione di stampa.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#40](../../mfc/reference/codesnippet/cpp/cwinapp-class_6.cpp)]

##  <a name="getprofilebinary"></a>  CWinApp::GetProfileBinary

Chiamare questa funzione membro per recuperare i dati binari da una voce in una sezione specificata del Registro di sistema dell'applicazione o. File INI.

```
BOOL GetProfileBinary(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPBYTE* ppData,
    UINT* pBytes);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce il cui valore deve essere recuperato.

*ppData*<br/>
Punta a un puntatore che riceve l'indirizzo dei dati.

*pBytes*<br/>
Punti da UINT che riceverà le dimensioni dei dati (in byte).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione membro non distinzione maiuscole / minuscole, pertanto, le stringhe nel *lpszSection* e *lpszEntry* parametri alcune possibili differenze nei case.

> [!NOTE]
> `GetProfileBinary` Alloca un buffer e restituisce il relativo indirizzo nelle \* *ppData*. Il chiamante è responsabile della liberazione di buffer, utilizzare **delete []**.

> [!IMPORTANT]
> I dati restituiti dalla funzione non sono necessariamente con terminazione null e il chiamante deve eseguire la convalida. Per altre informazioni, vedere [Evitare sovraccarichi del buffer](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#41](../../mfc/reference/codesnippet/cpp/cwinapp-class_7.cpp)]

Per un altro esempio, vedere [CWinApp::WriteProfileBinary](#writeprofilebinary).

##  <a name="getprofileint"></a>  CWinApp::GetProfileInt

Chiamare questa funzione membro per recuperare il valore di un intero da una voce in una sezione specifica del Registro di sistema dell'applicazione o del file INI.

```
UINT GetProfileInt(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    int nDefault);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce il cui valore deve essere recuperato.

*nDefault*<br/>
Specifica il valore predefinito per restituire se il framework non riesce a trovare la voce.

### <a name="return-value"></a>Valore restituito

Valore intero della stringa che segue la voce specificata se la funzione ha esito positivo. Il valore restituito è il valore della *nDefault* parametro se la funzione non trova la voce. Il valore restituito è 0 se il valore che corrisponde alla voce specificata non è un intero.

Questa funzione supporta la notazione esadecimale per il valore nel file INI. Quando si recupera un intero con segno, è necessario il cast del valore in un **int**.

### <a name="remarks"></a>Note

Questa funzione membro non distinzione maiuscole / minuscole, pertanto, le stringhe nel *lpszSection* e *lpszEntry* parametri alcune possibili differenze nei case.

> [!IMPORTANT]
> I dati restituiti dalla funzione non sono necessariamente con terminazione null e il chiamante deve eseguire la convalida. Per altre informazioni, vedere [Evitare sovraccarichi del buffer](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#42](../../mfc/reference/codesnippet/cpp/cwinapp-class_8.cpp)]

Per un altro esempio, vedere [CWinApp:: Writeprofileint](#writeprofileint).

##  <a name="getprofilestring"></a>  CWinApp::GetProfileString

Chiamare questa funzione membro per recuperare la stringa associata a una voce all'interno della sezione specificata nel Registro di sistema dell'applicazione o. File INI.

```
CString GetProfileString(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszDefault = NULL);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce stringa di cui è necessario recuperare. Questo valore non deve essere NULL.

*lpszDefault*<br/>
Punta sul valore di stringa predefinito per la voce specificata se la voce non è stata trovata nel file di inizializzazione.

### <a name="return-value"></a>Valore restituito

Il valore restituito è la stringa da dell'applicazione. File INI o *lpszDefault* se non è stata trovata la stringa. La lunghezza massima delle stringhe supportata dal framework è MAX_PATH. Se *lpszDefault* è NULL, il valore restituito è una stringa vuota.

### <a name="remarks"></a>Note

> [!IMPORTANT]
> I dati restituiti dalla funzione non sono necessariamente con terminazione null e il chiamante deve eseguire la convalida. Per altre informazioni, vedere [Evitare sovraccarichi del buffer](/windows/desktop/SecBP/avoiding-buffer-overruns).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Per un altro esempio, vedere l'esempio relativo [CWinApp::GetProfileInt](#getprofileint).

##  <a name="getsectionkey"></a>  CWinApp::GetSectionKey

Restituisce la chiave per HKEY_CURRENT_USER\\\RegistryKey\AppName\lpszSection "Software".

```
HKEY GetSectionKey(
    LPCTSTR lpszSection,
    CAtlTransactionManager* pTM = NULL);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Il nome della chiave da ottenere.

*pTM*<br/>
Puntatore a un oggetto `CAtlTransactionManager`.

### <a name="return-value"></a>Valore restituito

Chiave di sessione se la funzione ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Note

##  <a name="hideapplication"></a>  CWinApp::HideApplication

Chiamare questa funzione membro per nascondere un'applicazione prima di chiudere i documenti aperti.

```
void HideApplication();
```

##  <a name="htmlhelp"></a>  CWinApp::HtmlHelp

Chiamare questa funzione membro per richiamare l'applicazione HTMLHelp.

```
virtual void HtmlHelp(
    DWORD_PTR dwData,
    UINT nCmd = 0x000F);
```

### <a name="parameters"></a>Parametri

*dwData*<br/>
Specifica i dati aggiuntivi. Il valore usato dipende dal valore della *nCmd* parametro.

*nCmd*<br/>
Specifica il tipo di Guida richiesto. Per un elenco di valori possibili e gli effetti di *dwData* parametro, vedere la *uCommand* parametro descritto in sui the HTMLHelp funzione API nel SDK di Windows.

### <a name="remarks"></a>Note

Inoltre, il framework chiama questa funzione per richiamare l'applicazione HTMLHelp.

Il framework chiuderà automaticamente l'applicazione HTMLHelp quando l'applicazione termina.

##  <a name="initinstance"></a>  CWinApp::InitInstance

Windows consente a diverse copie dello stesso programma per l'esecuzione nello stesso momento.

```
virtual BOOL InitInstance();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'inizializzazione ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Inizializzazione dell'applicazione a livello concettuale è suddiviso in due sezioni: inizializzazione una tantum dell'applicazione che viene eseguita la prima volta che l'esecuzione del programma e inizializzazione dell'istanza che viene eseguito ogni volta che una copia dell'esecuzione del programma, tra cui la prima volta. Implementazione del framework di `WinMain` chiama questa funzione.

Eseguire l'override `InitInstance` inizializzare ogni nuova istanza dell'applicazione in esecuzione in Windows. In genere, si esegue l'override `InitInstance` per costruire l'oggetto finestra principale e impostare il `CWinThread::m_pMainWnd` membro dati in modo che punti a tale finestra. Per altre informazioni sull'override di questa funzione membro, vedere [CWinApp: La classe dell'applicazione](../../mfc/cwinapp-the-application-class.md).

> [!NOTE]
> Le applicazioni MFC devono essere inizializzate come apartment a thread singolo (STA). Se si chiama [CoInitializeEx](/windows/desktop/api/combaseapi/nf-combaseapi-coinitializeex) nel `InitInstance` eseguire l'override, specificare COINIT_APARTMENTTHREADED (anziché COINIT_MULTITHREADED).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCListView#9](../../atl/reference/codesnippet/cpp/cwinapp-class_10.cpp)]

##  <a name="istaskbarinteractionenabled"></a>  CWinApp::IsTaskbarInteractionEnabled

Indica se è abilitata l'interazione della barra delle applicazioni di Windows 7.

```
virtual BOOL IsTaskbarInteractionEnabled();
```

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se `EnableTaskbarInteraction` è stato chiamato e il sistema operativo è Windows 7 o versione successiva.

### <a name="remarks"></a>Note

L'interazione della barra delle applicazioni significa che l'applicazione MDI Visualizza il contenuto di finestre figlio MDI nelle anteprime a schede separate che vengono visualizzati quando il puntatore del mouse è posizionato sopra il pulsante della barra delle applicazioni dell'applicazione.

##  <a name="loadcursor"></a>  CWinApp::LoadCursor

Carica la risorsa del cursore denominata da *lpszResourceName* o specificato da *nIDResource* dal file eseguibile corrente.

```
HCURSOR LoadCursor(LPCTSTR lpszResourceName) const;  HCURSOR LoadCursor(UINT nIDResource) const;
```

### <a name="parameters"></a>Parametri

*lpszResourceName*<br/>
Punta a una stringa con terminazione null che contiene il nome della risorsa cursore. È possibile usare un `CString` per questo argomento.

*nIDResource*<br/>
ID della risorsa cursore. Per un elenco di risorse, vedere [LoadCursor](/windows/desktop/api/winuser/nf-winuser-loadcursora) nel SDK di Windows.

### <a name="return-value"></a>Valore restituito

Un handle per un cursore se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

`LoadCursor` Carica il cursore in memoria solo se non è stato precedentemente caricato; in caso contrario, viene recuperato un handle di risorsa esistente.

Usare la [LoadStandardCursor](#loadstandardcursor) oppure [LoadOEMCursor](#loadoemcursor) funzione membro per i cursori di Windows predefiniti di accesso.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#44](../../mfc/reference/codesnippet/cpp/cwinapp-class_11.cpp)]

##  <a name="loadicon"></a>  CWinApp::LoadIcon

Carica la risorsa icona denominata dal *lpszResourceName* o specificato da *nIDResource* dal file eseguibile.

```
HICON LoadIcon(LPCTSTR lpszResourceName) const;  HICON LoadIcon(UINT nIDResource) const;
```

### <a name="parameters"></a>Parametri

*lpszResourceName*<br/>
Punta a una stringa con terminazione null che contiene il nome della risorsa icona. È anche possibile usare un `CString` per questo argomento.

*nIDResource*<br/>
Numero di ID della risorsa icona.

### <a name="return-value"></a>Valore restituito

Un handle per un'icona se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

`LoadIcon` Carica l'icona solo se non è stato precedentemente caricato; in caso contrario, viene recuperato un handle di risorsa esistente.

È possibile usare la [LoadStandardIcon](#loadstandardicon) oppure [LoadOEMIcon](#loadoemicon) funzione membro per accedere alle icone di Windows predefinite.

> [!NOTE]
> Questa funzione membro chiama la funzione API Win32 [LoadIcon](/windows/desktop/api/winuser/nf-winuser-loadicona), che è possibile caricare solo un'icona con dimensioni conformi per i valori delle metriche del sistema SM_CXICON e SM_CYICON.

##  <a name="loadoemcursor"></a>  CWinApp::LoadOEMCursor

Caricamenti di Windows predefiniti risorsa cursore specificata da *nIDCursor*.

```
HCURSOR LoadOEMCursor(UINT nIDCursor) const;
```

### <a name="parameters"></a>Parametri

*nIDCursor*<br/>
Un' **OCR_** manifesto identificatore costante che specifica un cursore di Windows predefinito. È necessario disporre `#define OEMRESOURCE` prima `#include \<afxwin.h>` per ottenere l'accesso per il **OCR_** costanti in WINDOWS. H.

### <a name="return-value"></a>Valore restituito

Un handle per un cursore se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Usare la `LoadOEMCursor` oppure [LoadStandardCursor](#loadstandardcursor) funzione membro per i cursori di Windows predefiniti di accesso.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#45](../../mfc/reference/codesnippet/cpp/cwinapp-class_12.h)]

[!code-cpp[NVC_MFCWindowing#46](../../mfc/reference/codesnippet/cpp/cwinapp-class_13.cpp)]

##  <a name="loadoemicon"></a>  CWinApp::LoadOEMIcon

Caricamenti di Windows predefiniti risorsa icona specificata da *nIDIcon*.

```
HICON LoadOEMIcon(UINT nIDIcon) const;
```

### <a name="parameters"></a>Parametri

*nIDIcon*<br/>
Un' **OIC_** manifesto identificatore costante che specifica un'icona di Windows predefinita. È necessario disporre `#define OEMRESOURCE` prima `#include \<afxwin.h>` per l'accesso di **OIC_** costanti in WINDOWS. H.

### <a name="return-value"></a>Valore restituito

Un handle per un'icona se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Usare la `LoadOEMIcon` oppure [LoadStandardIcon](#loadstandardicon) funzione membro per accedere alle icone di Windows predefinite.

##  <a name="loadstandardcursor"></a>  CWinApp::LoadStandardCursor

Caricamenti di Windows predefiniti risorsa cursore che *lpszCursorName* specifica.

```
HCURSOR LoadStandardCursor(LPCTSTR lpszCursorName) const;
```

### <a name="parameters"></a>Parametri

*lpszCursorName*<br/>
Un' **IDC _** manifesto identificatore costante che specifica un cursore di Windows predefinito. Questi identificatori sono definiti in WINDOWS. H. L'elenco seguente mostra i valori predefiniti possibili e significati per *lpszCursorName*:

- Cursore a freccia IDC_ARROW Standard

- Cursore di inserimento di testo IDC_IBEAM Standard

- Cursore a clessidra IDC_WAIT utilizzata quando Windows esegue un'attività che richiedono molto tempo

- Cursore di selettore IDC_CROSS per la selezione

- IDC_UPARROW freccia rivolta verso l'alto

- IDC_SIZE obsoleto e non è supportato; usare IDC_SIZEALL

- Freccia a quattro punte di oggetto IDC_SIZEALL. Il cursore da utilizzare per ridimensionare una finestra.

- IDC_ICON obsoleto e non supportati. Usare IDC_ARROW.

- Freccia a due punte IDC_SIZENWSE con termina in alto a sinistra e basso a destra

- Freccia a due punte IDC_SIZENESW con le estremità in alto a sinistra a destra e inferiore

- Freccia a due punte IDC_SIZEWE orizzontale

- Freccia a due punte IDC_SIZENS verticale

### <a name="return-value"></a>Valore restituito

Un handle per un cursore se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Usare la `LoadStandardCursor` oppure [LoadOEMCursor](#loadoemcursor) funzione membro per i cursori di Windows predefiniti di accesso.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#47](../../mfc/reference/codesnippet/cpp/cwinapp-class_14.cpp)]

##  <a name="loadstandardicon"></a>  CWinApp::LoadStandardIcon

Caricamenti di Windows predefiniti risorsa icona che *lpszIconName* specifica.

```
HICON LoadStandardIcon(LPCTSTR lpszIconName) const;
```

### <a name="parameters"></a>Parametri

*lpszIconName*<br/>
Un identificatore costante del manifesto che specifica un'icona di Windows predefinita. Questi identificatori sono definiti in WINDOWS. H. Per un elenco di possibili valori predefiniti e le relative descrizioni, vedere la *lpIconName* nel parametro [LoadIcon](/windows/desktop/api/winuser/nf-winuser-loadicona) nel SDK di Windows.

### <a name="return-value"></a>Valore restituito

Un handle per un'icona se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Usare la `LoadStandardIcon` oppure [LoadOEMIcon](#loadoemicon) funzione membro per accedere alle icone di Windows predefinite.

##  <a name="loadstdprofilesettings"></a>  CWinApp::LoadStdProfileSettings

Chiamare questa funzione membro all'interno di [InitInstance](#initinstance) funzione membro per abilitare e caricare l'elenco dei file utilizzati più di recente (MRU) e l'ultimo stato di anteprima.

```
void LoadStdProfileSettings(UINT nMaxMRU = _AFX_MRU_COUNT);
```

### <a name="parameters"></a>Parametri

*nMaxMRU*<br/>
Il numero degli ultimi file usati per tenere traccia.

### <a name="remarks"></a>Note

Se *nMaxMRU* è 0, non viene mantenuto alcun elenco MRU.

##  <a name="m_bhelpmode"></a>  CWinApp::m_bHelpMode

TRUE se l'applicazione è in modalità di contesto della Guida (tradizionalmente richiamata con MAIUSC + F1); in caso contrario, FALSE.

```
BOOL m_bHelpMode;
```

### <a name="remarks"></a>Note

In modalità di contesto della Guida, il cursore diventa un punto interrogativo e l'utente può spostarsi su schermo. Esaminare questo flag se si vuole implementare una gestione speciale quando è nella modalità della Guida. `m_bHelpMode` è una variabile pubblica di tipo BOOL.

##  <a name="m_dwrestartmanagersupportflags"></a>  CWinApp::m_dwRestartManagerSupportFlags

Flag che determinano il comportamento di Gestione riavvio.

```
DWORD m_dwRestartManagerSupportFlags;
```

### <a name="remarks"></a>Note

Per abilitare la gestione riavvio, impostare `m_dwRestartManagerSupportFlags` al comportamento desiderato. Nella tabella seguente mostra i flag disponibili.

|||
|-|-|
|Flag|Descrizione|
|AFX_RESTART_MANAGER_SUPPORT_RESTART|L'applicazione è registrata con [CWinApp::RegisterWithRestartManager](#registerwithrestartmanager). Gestione riavvio è responsabile per il riavvio dell'applicazione se lo termina in modo imprevisto.|
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY|L'applicazione è registrata con Gestione riavvio e la gestione riavvio chiama la funzione di callback di ripristino quando riavvia l'applicazione. La funzione di callback di ripristino predefinito è [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|- AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART|Salvataggio automatico è abilitato e la si chiuda Gestione riavvio qualsiasi aprire i documenti quando l'applicazione viene riavviata.|
|- AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL|Salvataggio automatico è abilitato e la si chiuda Gestione riavvio qualsiasi aprire i documenti a intervalli regolari. L'intervallo viene definito dal [CWinApp::m_nAutosaveInterval](#m_nautosaveinterval).|
|- AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES|Gestione riavvio consente di aprire i documenti precedentemente aperti dopo il riavvio dell'applicazione da un'uscita imprevista. Il [classe CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) gestisce l'archiviazione dell'elenco di documenti aperti e il ripristino di questi.|
|- AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES|Gestione riavvio richiesto all'utente di ripristinare i file salvato automaticamente dopo il riavvio dell'applicazione. Il `CDataRecoveryHandler` classe esegue una query all'utente.|
|- AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE|L'unione di AFX_RESTART_MANAGER_SUPPORT_RESTART AFX_RESTART_MANAGER_SUPPORT_RECOVER e AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_ALL_ASPECTS|L'unione di AFX_RESTART_MANAGER_SUPPORT_NO_AUTOSAVE, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL e AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_RESTART_ASPECTS|L'unione di AFX_RESTART_MANAGER_SUPPORT_RESTART, AFX_RESTART_MANAGER_AUTOSAVE_AT_RESTART, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES e AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|
|-AFX_RESTART_MANAGER_SUPPORT_RECOVERY_ASPECTS|L'unione ofAFX_RESTART_MANAGER_SUPPORT_RECOVERY AFX_RESTART_MANAGER_AUTOSAVE_AT_INTERVAL, AFX_RESTART_MANAGER_REOPEN_PREVIOUS_FILES e AFX_RESTART_MANAGER_RESTORE_AUTOSAVED_FILES.|

##  <a name="m_ehelptype"></a>  CWinApp::m_eHelpType

Il tipo di questo membro dati è di tipo enumerato AFX_HELP_TYPE, che viene definito all'interno di `CWinApp` classe.

```
AFX_HELP_TYPE m_eHelpType;
```

### <a name="remarks"></a>Note

L'enumerazione AFX_HELP_TYPE viene definito come segue:

```
enum AFX_HELP_TYPE {
    afxWinHelp = 0,
    afxHTMLHelp = 1
    };
```

- Per impostare la Guida dell'applicazione per la Guida HTML, chiamare [SetHelpMode](#sethelpmode) e specificare `afxHTMLHelp`.

- Per impostare la Guida dell'applicazione per WinHelp, chiamare `SetHelpMode` e specificare `afxWinHelp`.

##  <a name="m_hinstance"></a>  CWinApp::m_hInstance

Corrisponde alla *hInstance* parametro passato da Windows a `WinMain`.

```
HINSTANCE m_hInstance;
```

### <a name="remarks"></a>Note

Il `m_hInstance` membro dati è un handle per l'istanza corrente dell'applicazione in esecuzione in Windows. Viene restituito dalla funzione globale [AfxGetInstanceHandle](application-information-and-management.md#afxgetinstancehandle). `m_hInstance` è una variabile pubblica di tipo HINSTANCE.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#55](../../mfc/reference/codesnippet/cpp/cwinapp-class_15.cpp)]

##  <a name="m_lpcmdline"></a>  CWinApp::m_lpCmdLine

Corrisponde alla *lpCmdLine fa* parametro passato da Windows a `WinMain`.

```
LPTSTR m_lpCmdLine;
```

### <a name="remarks"></a>Note

Punta a una stringa con terminazione null che specifica la riga di comando per l'applicazione. Usare `m_lpCmdLine` a eventuali argomenti della riga di comando di accesso specificato quando l'applicazione è stata avviata dall'utente. `m_lpCmdLine` è una variabile pubblica di tipo LPTSTR.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]

##  <a name="m_nautosaveinterval"></a>  CWinApp::m_nAutosaveInterval

Il periodo di tempo in millisecondi tra si chiuda.

```
int m_nAutosaveInterval;
```

### <a name="remarks"></a>Note

È possibile configurare la gestione riavvio per i documenti aperti di salvataggio automatico a intervalli prestabiliti. Se l'applicazione non file di salvataggio automatico, questo parametro ha effetto.

##  <a name="m_ncmdshow"></a>  CWinApp::m_nCmdShow

Corrisponde alla *nCmdShow* parametro passato da Windows a `WinMain`.

```
int m_nCmdShow;
```

### <a name="remarks"></a>Note

È necessario passare `m_nCmdShow` come argomento quando si chiama [CWnd:: ShowWindow](../../mfc/reference/cwnd-class.md#showwindow) per la finestra principale dell'applicazione. `m_nCmdShow` è una variabile pubblica di tipo **int**.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#56](../../mfc/reference/codesnippet/cpp/cwinapp-class_17.cpp)]

##  <a name="m_pactivewnd"></a>  CWinApp::m_pActiveWnd

Usare questo membro dei dati per archiviare un puntatore alla finestra principale dell'applicazione contenitore OLE che contiene i server dell'applicazione posto OLE attivato.

### <a name="remarks"></a>Note

Se questo membro dati è NULL, l'applicazione non è attivo sul posto.

Il framework imposta questa variabile membro quando la finestra cornice è attivato da un'applicazione contenitore OLE sul posto.

##  <a name="m_pdatarecoveryhandler"></a>  CWinApp::m_pDataRecoveryHandler

Puntatore al gestore di ripristino dei dati per l'applicazione.

```
CDataRecoveryHandler* m_pDataRecoveryHandler;
```

### <a name="remarks"></a>Note

Il gestore di ripristino dei dati di un'applicazione consente di monitorare i documenti aperti e si chiuda li. Il framework utilizza il gestore di ripristino dei dati per ripristinare i file salvato automaticamente quando un'applicazione viene riavviata dopo che viene chiusa in modo imprevisto. Per altre informazioni, vedere [classe CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md).

##  <a name="m_pszappname"></a>  CWinApp::m_pszAppName

Specifica il nome dell'applicazione.

```
LPCTSTR m_pszAppName;
```

### <a name="remarks"></a>Note

Il nome dell'applicazione può provenire dal parametro passato per il [CWinApp](#cwinapp) costruttore, oppure, se non specificato, alla stringa di risorsa con l'ID di AFX_IDS_APP_TITLE. Se il nome dell'applicazione non viene trovato nella risorsa, si tratta del programma. Nome del file EXE.

Restituito dalla funzione globale [AfxGetAppName](application-information-and-management.md#afxgetappname). `m_pszAppName` è una variabile pubblica di tipo **const char**<strong>\*</strong>.

> [!NOTE]
> Se si assegna un valore a `m_pszAppName`, deve essere allocata in modo dinamico nell'heap. Il `CWinApp` chiamate del distruttore **gratuito**() con puntatore ' this '. È possibile usare il `_tcsdup`funzione libreria run-time () per eseguire l'allocazione. Inoltre, liberare la memoria associata al puntatore corrente prima di assegnare un nuovo valore. Ad esempio:

[!code-cpp[NVC_MFCWindowing#57](../../mfc/reference/codesnippet/cpp/cwinapp-class_18.cpp)]

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#65](../../mfc/reference/codesnippet/cpp/cwinapp-class_19.cpp)]

##  <a name="m_pszexename"></a>  CWinApp::m_pszExeName

Contiene il nome del file eseguibile dell'applicazione senza estensione.

```
LPCTSTR m_pszExeName;
```

### <a name="remarks"></a>Note

A differenza [m_pszAppName](#m_pszappname), questo nome non può contenere spazi vuoti. `m_pszExeName` è una variabile pubblica di tipo **const char**<strong>\*</strong>.

> [!NOTE]
> Se si assegna un valore a `m_pszExeName`, deve essere allocata in modo dinamico nell'heap. Il `CWinApp` chiamate del distruttore **gratuito**() con puntatore ' this '. È possibile usare il `_tcsdup`funzione libreria run-time () per eseguire l'allocazione. Inoltre, liberare la memoria associata al puntatore corrente prima di assegnare un nuovo valore. Ad esempio:

[!code-cpp[NVC_MFCWindowing#58](../../mfc/reference/codesnippet/cpp/cwinapp-class_20.cpp)]

##  <a name="m_pszhelpfilepath"></a>  CWinApp::m_pszHelpFilePath

Contiene il percorso del file della Guida dell'applicazione.

```
LPCTSTR m_pszHelpFilePath;
```

### <a name="remarks"></a>Note

Per impostazione predefinita, inizializza il framework `m_pszHelpFilePath` al nome dell'applicazione con ". HLP"aggiunto. Per modificare il nome del file della Guida, impostare `m_pszHelpFilePath` in modo che punti a una stringa che contiene il nome completo del file della Guida desiderato. Un modo pratico per eseguire questa operazione è dell'applicazione [InitInstance](#initinstance) (funzione). `m_pszHelpFilePath` è una variabile pubblica di tipo **const char**<strong>\*</strong>.

> [!NOTE]
> Se si assegna un valore a `m_pszHelpFilePath`, deve essere allocata in modo dinamico nell'heap. Il `CWinApp` chiamate del distruttore **gratuito**() con puntatore ' this '. È possibile usare il `_tcsdup`funzione libreria run-time () per eseguire l'allocazione. Inoltre, liberare la memoria associata al puntatore corrente prima di assegnare un nuovo valore. Ad esempio:

[!code-cpp[NVC_MFCWindowing#59](../../mfc/reference/codesnippet/cpp/cwinapp-class_21.cpp)]

##  <a name="m_pszprofilename"></a>  CWinApp::m_pszProfileName

Contiene il nome dell'applicazione. File INI.

```
LPCTSTR m_pszProfileName;
```

### <a name="remarks"></a>Note

`m_pszProfileName` è una variabile pubblica di tipo **const char**<strong>\*</strong>.

> [!NOTE]
> Se si assegna un valore a `m_pszProfileName`, deve essere allocata in modo dinamico nell'heap. Il `CWinApp` chiamate del distruttore **gratuito**() con puntatore ' this '. È possibile usare il `_tcsdup`funzione libreria run-time () per eseguire l'allocazione. Inoltre, liberare la memoria associata al puntatore corrente prima di assegnare un nuovo valore. Ad esempio:

[!code-cpp[NVC_MFCWindowing#60](../../mfc/reference/codesnippet/cpp/cwinapp-class_22.cpp)]

##  <a name="m_pszregistrykey"></a>  CWinApp::m_pszRegistryKey

Utilizzato per determinare, nel Registro di sistema o file con estensione INI, le impostazioni del profilo dell'applicazione sono archiviate.

```
LPCTSTR m_pszRegistryKey;
```

### <a name="remarks"></a>Note

In genere, questo membro dati viene considerato di sola lettura.

- Il valore viene archiviato per una chiave del Registro di sistema. Il nome per l'impostazione del profilo dell'applicazione viene aggiunta alla chiave del Registro di sistema seguente: HKEY_CURRENT_USER/Software/LocalAppWizard-Generated/.

Se si assegna un valore a `m_pszRegistryKey`, deve essere allocata in modo dinamico nell'heap. Il `CWinApp` chiamate del distruttore **gratuito**() con puntatore ' this '. È possibile usare il `_tcsdup`funzione libreria run-time () per eseguire l'allocazione. Inoltre, liberare la memoria associata al puntatore corrente prima di assegnare un nuovo valore. Ad esempio:

[!code-cpp[NVC_MFCWindowing#61](../../mfc/reference/codesnippet/cpp/cwinapp-class_23.cpp)]

##  <a name="m_pszappid"></a>  CWinApp::m_pszAppID

Modello di ID utente dell'applicazione.

```
LPCTSTR m_pszAppID;
```

### <a name="remarks"></a>Note

##  <a name="oncontexthelp"></a>  CWinApp::OnContextHelp

Gestisce MAIUSC + F1 all'interno dell'applicazione.

```
afx_msg void OnContextHelp();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_CONTEXT_HELP, OnContextHelp )` dell'istruzione di `CWinApp` classe mappa dei messaggi e anche aggiungere una voce della tabella di tasti di scelta rapida, in genere MAIUSC + F1, per abilitare questa funzione membro.

`OnContextHelp` Inserisce l'applicazione in modalità della Guida. Il cursore cambia e una freccia e un punto interrogativo e l'utente può quindi spostare il puntatore del mouse e premere il pulsante sinistro del mouse per selezionare una finestra di dialogo, finestra, menu o pulsante di comando. Questa funzione recupera il contesto della Guida dell'oggetto posizionato sotto il cursore e chiama la funzione di Windows WinHelp con tale contesto della Guida.

##  <a name="onddecommand"></a>  CWinApp::OnDDECommand

Chiamato dal framework quando la finestra cornice principale riceve un DDE eseguire messaggio.

```
virtual BOOL OnDDECommand(LPTSTR lpszCommand);
```

### <a name="parameters"></a>Parametri

*lpszCommand*<br/>
Punta a una stringa di comando DDE ricevuti dall'applicazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il comando è gestito; in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita controlla se il comando è una richiesta di aprire un documento e, in questo caso, si apre il documento specificato. La gestione di File Windows invia tali stringhe di comando DDE in genere quando l'utente fa doppio clic su un file di dati. Override di questa funzione per gestire altri DDE eseguire comandi, ad esempio il comando di stampa.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#48](../../mfc/reference/codesnippet/cpp/cwinapp-class_24.cpp)]

##  <a name="onfilenew"></a>  CWinApp::OnFileNew

Implementa il ID_FILE_NEW (comando).

```
afx_msg void OnFileNew();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_FILE_NEW, OnFileNew )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, questa funzione gestisce l'esecuzione del comando File nuovo.

Visualizzare [Nota tecnica 22](../../mfc/tn022-standard-commands-implementation.md) per informazioni sul comportamento predefinito e indicazioni su come eseguire l'override di questa funzione membro.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onfileopen"></a>  CWinApp::OnFileOpen

Implementa il ID_FILE_OPEN (comando).

```
afx_msg void OnFileOpen();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_FILE_OPEN, OnFileOpen )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, questa funzione gestisce l'esecuzione del comando Apri File.

Per informazioni sul comportamento predefinito e indicazioni su come eseguire l'override di questa funzione membro, vedere [Nota tecnica 22](../../mfc/tn022-standard-commands-implementation.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onfileprintsetup"></a>  CWinApp::OnFilePrintSetup

Implementa il ID_FILE_PRINT_SETUP (comando).

```
afx_msg void OnFilePrintSetup();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_FILE_PRINT_SETUP, OnFilePrintSetup )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, questa funzione gestisce l'esecuzione del comando Stampa di File.

Per informazioni sul comportamento predefinito e indicazioni su come eseguire l'override di questa funzione membro, vedere [Nota tecnica 22](../../mfc/tn022-standard-commands-implementation.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#49](../../mfc/reference/codesnippet/cpp/cwinapp-class_25.cpp)]

[!code-cpp[NVC_MFCWindowing#50](../../mfc/reference/codesnippet/cpp/cwinapp-class_26.cpp)]

##  <a name="onhelp"></a>  CWinApp::OnHelp

Gestisce F1 Guida all'interno dell'applicazione (usando il contesto corrente).

```
afx_msg void OnHelp();
```

### <a name="remarks"></a>Note

In genere si aggiungerà anche una voce del tasto di scelta rapida per il tasto F1. Abilitare il tasto F1 è solo una convenzione, non è un requisito.

È necessario aggiungere un' `ON_COMMAND( ID_HELP, OnHelp )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, chiamato dal framework quando l'utente preme il tasto F1.

L'implementazione predefinita di questa funzione di gestore di messaggi determina il contesto della Guida corrispondente per la finestra corrente, la finestra di dialogo o voce di menu e quindi chiama WINHELP. FILE EXE. Se è attualmente disponibile alcun contesto, la funzione utilizza il contesto predefinito.

Eseguire l'override di questa funzione membro per impostare il contesto della Guida su un valore diverso dalla finestra, la finestra di dialogo, voce di menu o pulsante della barra degli strumenti che attualmente ha lo stato attivo. Chiamare `WinHelp` con il valore desiderato per l'ID del contesto.

##  <a name="onhelpfinder"></a>  CWinApp::OnHelpFinder

Gestisce i comandi ID_HELP_FINDER e ID_DEFAULT_HELP.

```
afx_msg void OnHelpFinder();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_HELP_FINDER, OnHelpFinder )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, il framework chiama questa funzione di gestore di messaggi quando l'utente dell'applicazione seleziona il comando di ricerca della Guida per richiamare `WinHelp` con lo standard **HELP_FINDER** argomento.

##  <a name="onhelpindex"></a>  CWinApp::OnHelpIndex

Gestisce il ID_HELP_INDEX (comando) e fornisce un argomento della Guida predefinito.

```
afx_msg void OnHelpIndex();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_HELP_INDEX, OnHelpIndex )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Se abilitata, il framework chiama questa funzione di gestore di messaggi quando l'utente dell'applicazione seleziona il comando di indice della Guida per richiamare `WinHelp` con lo standard **HELP_INDEX** argomento.

##  <a name="onhelpusing"></a>  CWinApp::OnHelpUsing

Gestisce il ID_HELP_USING (comando).

```
afx_msg void OnHelpUsing();
```

### <a name="remarks"></a>Note

È necessario aggiungere un' `ON_COMMAND( ID_HELP_USING, OnHelpUsing )` dell'istruzione di `CWinApp` mappa messaggi di classe per abilitare questa funzione membro. Il framework chiama questa funzione di gestore di messaggi quando l'utente dell'applicazione seleziona il comando da richiamare la Guida mediante il `WinHelp` dell'applicazione con lo standard **HELP_HELPONHELP** argomento.

##  <a name="onidle"></a>  CWinApp::OnIdle

Eseguire l'override di questa funzione membro per eseguire l'elaborazione di tempo di inattività.

```
virtual BOOL OnIdle(LONG lCount);
```

### <a name="parameters"></a>Parametri

*lCount*<br/>
Un contatore incrementato ogni volta che `OnIdle` viene chiamato quando la coda di messaggi dell'applicazione è vuota. Questo conteggio viene reimpostato su 0 ogni volta che un nuovo messaggio viene elaborato. È possibile usare la *lCount* parametro per determinare il relativo periodo di tempo l'applicazione è stata inattiva senza elaborare un messaggio.

### <a name="return-value"></a>Valore restituito

Diverso da zero per la ricezione di più elaborazione tempo di inattività; 0 se è necessario non è più tempo di inattività.

### <a name="remarks"></a>Note

`OnIdle` viene chiamato nel ciclo di messaggi predefinito quando la coda di messaggi dell'applicazione è vuota. Usare l'override per chiamare le attività del gestore di inattività di uno sfondo personalizzato.

`OnIdle` Restituisce 0 per indicare che non è necessario alcun tempo di elaborazione inattive. Il *lCount* parametro viene incrementato ogni volta `OnIdle` viene chiamato quando la coda di messaggi è vuota e viene reimpostato su 0 ogni volta che un nuovo messaggio viene elaborato. È possibile chiamare le diverse routine di inattività basate su questo conteggio.

Di seguito viene riepilogato l'elaborazione di cicli inattivi:

1. Se il ciclo di messaggi nella libreria di classi Microsoft Foundation controlla la coda di messaggi e trova non messaggi in sospeso, chiama il metodo `OnIdle` per l'oggetto applicazione e fornisce 0 come i *lCount* argomento.

2. `OnIdle` esegue alcune operazioni di elaborazione e restituisce un valore diverso da zero per indicare che deve essere chiamato nuovamente per effettuare un'ulteriore elaborazione.

3. Il ciclo di messaggi controlla di nuovo la coda di messaggi. Se è in sospeso alcun messaggio, chiama il metodo `OnIdle` incremento anche in questo caso, il *lCount* argomento.

4. Infine, `OnIdle` completa l'elaborazione di tutte le relative attività inattive e restituisce 0. In questo modo il ciclo di messaggi per arrestare la chiamata `OnIdle` fino a quando non viene ricevuto il messaggio successivo dalla coda dei messaggi, momento in cui il ciclo inattivo viene riavviata con l'argomento impostato su 0.

Non eseguire le attività lunghe durante `OnIdle` perché l'applicazione non è in grado di elaborare input dell'utente fino a `OnIdle` restituisce.

> [!NOTE]
> L'implementazione predefinita di `OnIdle` aggiornamenti oggetti dell'interfaccia utente, ad esempio voci di menu e pulsanti della barra degli strumenti di comando ed esegue la pulizia di struttura interna dei dati. Pertanto, se esegue l'override `OnIdle`, è necessario chiamare `CWinApp::OnIdle` con il `lCount` nella versione sottoposta a override. Chiamare innanzitutto l'elaborazione inattiva di tutte le classe di base (ovvero, finché la classe di base `OnIdle` restituisce 0). Se è necessario eseguire operazioni prima che venga completato l'elaborazione di classe di base, esaminare l'implementazione della classe di base per selezionare appropriate *lCount* durante il quale le operazioni vengono eseguite.

Se non si desidera `OnIdle` per essere chiamato ogni volta che un messaggio viene recuperato dalla coda dei messaggi, è possibile eseguire l'override di [CWinThreadIsIdleMessage](../../mfc/reference/cwinthread-class.md#isidlemessage). Se un'applicazione ha impostato un timer molto breve, o se il sistema invia quindi il messaggio di WM_SYSTIMER `OnIdle` verrà chiamato più volte e influire negativamente sulle prestazioni.

### <a name="example"></a>Esempio

I due esempi seguenti mostrano come usare `OnIdle`. Nel primo esempio elabora due attività inattive usando il *lCount* argomento per definire le priorità le attività. La prima attività è con priorità alta e che devi procedere laddove possibile. La seconda attività è meno importante e deve essere eseguita solo quando è presente una lunga pausa nell'input dell'utente. Si noti la chiamata alla versione della classe di base di `OnIdle`. Nel secondo esempio gestisce un gruppo di attività inattive con priorità diverse.

[!code-cpp[NVC_MFCWindowing#51](../../mfc/reference/codesnippet/cpp/cwinapp-class_27.cpp)]

##  <a name="opendocumentfile"></a>  CWinApp::OpenDocumentFile

Il framework chiama questo metodo per aprire la named [CDocument](../../mfc/reference/cdocument-class.md) file per l'applicazione.

```
virtual CDocument* OpenDocumentFile(
    LPCTSTR lpszFileName
    BOOL bAddToMRU = TRUE);
```

### <a name="parameters"></a>Parametri

*lpszFileName*<br/>
[in] Il nome del file da aprire.

*bAddToMRU*<br/>
[in] TRUE indica che il documento è uno dei file più recente; FALSE indica che il documento non è uno dei file più recente.

### <a name="return-value"></a>Valore restituito

Un puntatore a un `CDocument` se riesce; in caso contrario, NULL.

### <a name="remarks"></a>Note

Se è già aperto un documento che ha lo stesso nome, la prima finestra cornice che contiene il documento verrà visualizzato lo stato attivo. Se un'applicazione supporta più modelli di documento, il framework utilizza l'estensione del nome file per trovare il modello di documento appropriato per provare a caricare il documento. Se l'operazione riesce, il modello crea quindi una finestra cornice e visualizzazione del documento.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#52](../../mfc/reference/codesnippet/cpp/cwinapp-class_16.cpp)]

##  <a name="parsecommandline"></a>  CWinApp::ParseCommandLine

Chiamare questa funzione membro per l'invio di parametri, uno alla volta, a e analizzare la riga di comando [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam).

```
void ParseCommandLine(CCommandLineInfo& rCmdInfo);
```

### <a name="parameters"></a>Parametri

*rCmdInfo*<br/>
Un riferimento a un [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) oggetto.

### <a name="remarks"></a>Note

Quando si avvia un nuovo progetto MFC mediante la creazione guidata applicazione, la creazione guidata applicazione creerà un'istanza locale di `CCommandLineInfo`, quindi chiamare `ProcessShellCommand` e `ParseCommandLine` nel [InitInstance](#initinstance) funzione membro. Una riga di comando segue la route descritta di seguito:

1. Dopo la creazione `InitInstance`, il `CCommandLineInfo` oggetto viene passato a `ParseCommandLine`.

2. `ParseCommandLine` chiama quindi `CCommandLineInfo::ParseParam` più volte, una volta per ogni parametro.

3. `ParseParam` riempie i `CCommandLineInfo` oggetto, che viene quindi passato a [ProcessShellCommand](#processshellcommand).

4. `ProcessShellCommand` gestisce gli argomenti della riga di comando e i flag.

Si noti che è possibile chiamare `ParseCommandLine` direttamente in base alle esigenze.

Per una descrizione dei flag della riga di comando, vedere [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand).

##  <a name="pretranslatemessage"></a>  CWinApp::PreTranslateMessage

Eseguire l'override di questa funzione per filtrare i messaggi di finestra prima che vengano inviati alle funzioni di Windows [TranslateMessage](/windows/desktop/api/winuser/nf-winuser-translatemessage) e [DispatchMessage](/windows/desktop/api/winuser/nf-winuser-dispatchmessage) l'implementazione predefinita esegue tasto di scelta rapida conversione, è necessario chiamare il `CWinApp::PreTranslateMessage` funzione membro sottoposto a override nella versione in uso.

```
virtual BOOL PreTranslateMessage(MSG* pMsg);
```

### <a name="parameters"></a>Parametri

*pMsg*<br/>
Un puntatore a un [MSG](/windows/desktop/api/winuser/ns-winuser-tagmsg) struttura che contiene il messaggio da elaborare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il messaggio è stato completamente elaborato `PreTranslateMessage` e non devono essere elaborati ulteriormente. Zero se il messaggio deve essere elaborato in modo normale.

##  <a name="processmessagefilter"></a>  CWinApp::ProcessMessageFilter

Funzione di hook del framework chiama questa funzione membro per filtrare e rispondere a determinati messaggi di Windows.

```
virtual BOOL ProcessMessageFilter(
    int code,
    LPMSG lpMsg);
```

### <a name="parameters"></a>Parametri

*codice*<br/>
Specifica un codice di hook. Questa funzione membro utilizza il codice per determinare la modalità di elaborazione *lpMsg.*

*lpMsg*<br/>
Un puntatore a un Windows [MSG](/windows/desktop/api/winuser/ns-winuser-tagmsg) struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il messaggio viene elaborato; in caso contrario 0.

### <a name="remarks"></a>Note

Una funzione hook elabora gli eventi prima che vengano inviati al messaggio normale dell'applicazione di elaborazione.

Se si esegue l'override di questa funzionalità avanzata, assicurarsi di chiamare la versione della classe base per mantenere il framework di hook di elaborazione.

##  <a name="processshellcommand"></a>  CWinApp::ProcessShellCommand

Questa funzione membro viene chiamata da [InitInstance](#initinstance) per accettare i parametri passati dalle `CCommandLineInfo` oggetto identificato da *rCmdInfo*ed eseguire l'azione indicata.

```
BOOL ProcessShellCommand(CCommandLineInfo& rCmdInfo);
```

### <a name="parameters"></a>Parametri

*rCmdInfo*<br/>
Un riferimento a un [CCommandLineInfo](../../mfc/reference/ccommandlineinfo-class.md) oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il comando della shell viene elaborato correttamente. Se 0, restituisce FALSE dalla [InitInstance](#initinstance).

### <a name="remarks"></a>Note

Quando si avvia un nuovo progetto MFC mediante la creazione guidata applicazione, la creazione guidata applicazione creerà un'istanza locale di `CCommandLineInfo`, quindi chiamare `ProcessShellCommand` e [ParseCommandLine](#parsecommandline) nel `InitInstance` funzione membro. Una riga di comando segue la route descritta di seguito:

1. Dopo la creazione `InitInstance`, il `CCommandLineInfo` oggetto viene passato a `ParseCommandLine`.

2. `ParseCommandLine` quindi chiama [CCommandLineInfo::ParseParam](../../mfc/reference/ccommandlineinfo-class.md#parseparam) più volte, una volta per ogni parametro.

3. `ParseParam` riempie i `CCommandLineInfo` oggetto, che viene quindi passato a `ProcessShellCommand`.

4. `ProcessShellCommand` gestisce gli argomenti della riga di comando e i flag.

I membri dati della `CCommandLineInfo` oggetto, identificato da [CCommandLineInfo::m_nShellCommand](../../mfc/reference/ccommandlineinfo-class.md#m_nshellcommand), sono di tipo enumerato seguente, che viene definito all'interno di `CCommandLineInfo` classe.

```
enum {
    FileNew,
    FileOpen,
    FilePrint,
    FilePrintTo,
    FileDDE
    };
```

Per una breve descrizione della ognuno di questi valori, vedere `CCommandLineInfo::m_nShellCommand`.

##  <a name="processwndprocexception"></a>  CWinApp::ProcessWndProcException

Il framework chiama questa funzione membro ogni volta che il gestore non intercettare un'eccezione generata in uno dei messaggi dell'applicazione o gestori di comandi.

```
virtual LRESULT ProcessWndProcException(
    CException* e,
    const MSG* pMsg);
```

### <a name="parameters"></a>Parametri

*e*<br/>
Puntatore a un'eccezione non rilevata.

*pMsg*<br/>
Oggetto [MSG](/windows/desktop/api/winuser/ns-winuser-tagmsg) struttura che contiene informazioni sul messaggio di windows che ha causato il framework generare un'eccezione.

### <a name="return-value"></a>Valore restituito

Il valore che deve essere restituito a Windows. In genere questo è 0L per messaggi windows, L 1 (TRUE) per i messaggi di comando.

### <a name="remarks"></a>Note

Non chiamare direttamente questa funzione membro.

L'implementazione predefinita di questa funzione membro crea una finestra di messaggio. Se l'eccezione non rilevata originata da un menu, barra degli strumenti o errore del comando di tasti di scelta rapida, la finestra di messaggio viene visualizzato un messaggio "Comando non riuscito". in caso contrario, viene visualizzato un messaggio "Errore interno dell'applicazione".

Eseguire l'override di questa funzione membro per fornire la gestione globale delle eccezioni. Chiamare la funzionalità di base solo se si desidera che la finestra di messaggio da visualizzare.

##  <a name="register"></a>  CWinApp::Register

Esegue qualsiasi attività di registrazione non è gestita da `RegisterShellFileTypes`.

```
virtual BOOL Register();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero in caso di esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Note

L'implementazione predefinita restituisce semplicemente TRUE. Eseguire l'override di questa funzione per fornire qualsiasi procedura di registrazione personalizzato.

##  <a name="registershellfiletypes"></a>  CWinApp::RegisterShellFileTypes

Chiamare questa funzione membro per registrare tutti i tipi di documenti dell'applicazione con la gestione di File di Windows.

```
void RegisterShellFileTypes(BOOL bCompat = FALSE);
```

### <a name="parameters"></a>Parametri

*bCompat*<br/>
[in] TRUE aggiunge voci di registrazione per i comandi della shell di stampa e stampare per, consentendo all'utente di stampare i file direttamente dalla shell oppure trascinando il file a un oggetto della stampante. Viene inoltre aggiunta una chiave DefaultIcon. Per impostazione predefinita, questo parametro è FALSE per la compatibilità con le versioni precedenti.

### <a name="remarks"></a>Note

Ciò consente all'utente di aprire un file di dati creato dall'applicazione facendo doppio clic su da all'interno di gestione File. Chiamare `RegisterShellFileTypes` dopo aver chiamato [AddDocTemplate](#adddoctemplate) per ognuno dei modelli di documento nell'applicazione. Chiamare anche il [EnableShellOpen](#enableshellopen) funzione di membro quando si chiama `RegisterShellFileTypes`.

`RegisterShellFileTypes` scorre l'elenco delle [CDocTemplate](../../mfc/reference/cdoctemplate-class.md) gli oggetti che l'applicazione gestisce e, per ogni modello di documento, aggiunge voci al database di registrazione che gestisce Windows per le associazioni di file. Gestione file Usa queste voci per aprire un file di dati quando l'utente fa doppio clic su. Questo evita di dover spedire una. File. REG con l'applicazione.

> [!NOTE]
> `RegisterShellFileTypes` funziona solo se l'utente esegue il programma con diritti di amministratore. Se il programma non dispone dei diritti di amministratore, è possibile modificare le chiavi del Registro di sistema.

Se il database di registrazione associa già un'estensione nome file specificato con un altro tipo di file, non viene creata alcuna nuova associazione. Vedere il `CDocTemplate` classe per il formato delle stringhe necessarie per registrare queste informazioni.

##  <a name="registerwithrestartmanager"></a>  CWinApp::RegisterWithRestartManager

Registra l'applicazione con Gestione riavvio.

```
virtual HRESULT RegisterWithRestartManager(
    BOOL bRegisterRecoveryCallback,
    const CString& strRestartIdentifier);

virtual HRESULT RegisterWithRestartManager(
    LPCWSTR pwzCommandLineArgs,
    DWORD dwRestartFlags,
    APPLICATION_RECOVERY_CALLBACK pRecoveryCallback,
    LPVOID lpvParam,
    DWORD dwPingInterval,
    DWORD dwCallbackFlags);
```

### <a name="parameters"></a>Parametri

|||
|-|-|
|Parametro|Descrizione|
|*bRegisterRecoveryCallback*|[in] TRUE indica che questa istanza dell'applicazione utilizza una funzione di callback di ripristino; FALSE indica che non lo è. Il framework chiama la funzione di callback di ripristino quando l'applicazione viene chiusa in modo imprevisto. Per altre informazioni, vedere [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|*strRestartIdentifier*|[in] Stringa univoca che identifica questa istanza di Gestione riavvio. L'identificatore di Gestione riavvio è univoco per ogni istanza di un'applicazione.|
|*pwzCommandLineArgs*|[in] Stringa che contiene gli argomenti aggiuntivi dalla riga di comando.|
|*dwRestartFlags*|[in] Flag opzionale per la gestione riavvio. Per altre informazioni, vedere la sezione Osservazioni.|
|*pRecoveryCallback*|[in] La funzione di callback di ripristino. Questa funzione deve accettare un parametro LPVOID come input e restituire un valore DWORD. La funzione di callback di ripristino predefinita è `CWinApp::ApplicationRecoveryCallback`.|
|*lpvParam*|[in] Il parametro di input per la funzione di callback di ripristino. Per altre informazioni, vedere [CWinApp::ApplicationRecoveryCallback](#applicationrecoverycallback).|
|*dwPingInterval*|[in] Il periodo di tempo che Gestione riavvio è in attesa per la funzione di callback di ripristino da restituire. Questo parametro è espresso in millisecondi.|
|*dwCallbackFlags*|[in] Flag passati alla funzione di callback di ripristino. Riservato per usi futuri.|

### <a name="return-value"></a>Valore restituito

S_OK se il metodo ha esito positivo. in caso contrario un codice di errore.

### <a name="remarks"></a>Note

Se l'applicazione usa l'implementazione di MFC predefinita per i file di salvataggio automatico, è consigliabile utilizzare la versione semplice del `RegisterWithRestartManager`. Usare la versione complessa di `RegisterWithRestartManager` se si desidera personalizzare il comportamento di salvataggio automatico dell'applicazione.

Se si chiama questo metodo con una stringa vuota per *strRestartIdentifier*, `RegisterWithRestartManager` crea una stringa dell'identificatore univoco per questa istanza del riavvio di gestione.

Quando un'applicazione viene chiusa in modo imprevisto, Gestione riavvio riavvia l'applicazione dalla riga di comando e fornisce che l'univoco riavvia identificatore come argomento facoltativo. In questo scenario, il framework chiama `RegisterWithRestartManager` due volte. La prima chiamata proviene [CWinApp:: InitInstance](#initinstance) con una stringa vuota per l'identificatore di stringa. Quindi, il metodo [CWinApp::ProcessShellCommand](#processshellcommand) chiamate `RegisterWithRestartManager` con l'identificatore univoco di riavvio.

Dopo aver registrato un'applicazione con Gestione riavvio, Gestione riavvio consente di monitorare l'applicazione. Se l'applicazione viene chiusa in modo imprevisto, Gestione riavvio chiama la funzione di callback di ripristino durante il processo di chiusura. Le attese di Gestione riavvio di *dwPingInterval* per una risposta dalla funzione di callback di ripristino. Se la funzione di callback di ripristino non risponde entro questo intervallo, l'applicazione viene chiusa senza eseguire la funzione di callback di ripristino.

Per impostazione predefinita, il dwRestartFlags non sono supportati ma vengono forniti per utilizzi futuri. I valori possibili per *dwRestartFlags* sono i seguenti:

- RESTART_NO_CRASH

- RESTART_NO_HANG

- RESTART_NO_PATCH

- RESTART_NO_REBOOT

##  <a name="reopenpreviousfilesatrestart"></a>  CWinApp::ReopenPreviousFilesAtRestart

Determina se la gestione riavvio riapre i file che sono stati aperti quando l'applicazione è stata chiusa in modo imprevisto.

```
virtual BOOL ReopenPreviousFilesAtRestart() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che Gestione riavvio riapre i file aperti in precedenza; FALSE indica che non Gestione riavvio.

##  <a name="restartinstance"></a>  CWinApp::RestartInstance

Consente di gestire il riavvio di un'applicazione avviato da Gestione riavvio.

```
virtual BOOL CWinApp::RestartInstance();
```

### <a name="return-value"></a>Valore restituito

TRUE se il gestore di ripristino dei dati consente di aprire i documenti precedentemente aperti; FALSE se il gestore di ripristino di dati contiene un errore o se non sono presenti documenti precedentemente aperti.

### <a name="remarks"></a>Note

Gestione riavvio un'applicazione al riavvio, il framework chiama questo metodo. Questo metodo recupera il gestore di ripristino dei dati e ripristina i file salvato automaticamente. Questo metodo chiama [CDataRecoveryHandler::RestoreAutosavedDocuments](../../mfc/reference/cdatarecoveryhandler-class.md#restoreautosaveddocuments) per determinare se l'utente vuole ripristinare i file salvato automaticamente.

Questo metodo restituisce FALSE se il [CDataRecoveryHandler](../../mfc/reference/cdatarecoveryhandler-class.md) determina che non vi sono alcun documenti aperti. Se non esistesse alcuna documenti aperti, l'applicazione viene avviata normalmente.

##  <a name="restoreautosavedfilesatrestart"></a>  CWinApp::RestoreAutosavedFilesAtRestart

Determina se Gestione riavvio consente di ripristinare i file salvato automaticamente quando riavvia l'applicazione.

```
virtual BOOL RestoreAutosavedFilesAtRestart() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che la gestione riavvio consente di ripristinare file salvato automaticamente; FALSE indica che non Gestione riavvio.

##  <a name="run"></a>  CWinApp::Run

Fornisce un ciclo di messaggi predefinito.

```
virtual int Run();
```

### <a name="return-value"></a>Valore restituito

Un' **int** valore restituito da `WinMain`.

### <a name="remarks"></a>Note

`Run` acquisisce e invia i messaggi di Windows fino a quando l'applicazione riceve un messaggio WM_QUIT. Se la coda di messaggi dell'applicazione non contiene attualmente alcun messaggio `Run` chiamate [OnIdle](#onidle) per eseguire l'elaborazione di tempo di inattività. Passano i messaggi in ingresso per il [PreTranslateMessage](#pretranslatemessage) funzione membro per un'elaborazione speciale e quindi per la funzione di Windows `TranslateMessage` per la traduzione della tastiera standard; infine, il `DispatchMessage` viene chiamata la funzione di Windows.

`Run` è raramente sottoposto a override, ma è possibile eseguirne l'override per fornire un comportamento speciale.

##  <a name="runautomated"></a>  CWinApp::RunAutomated

Chiamare questa funzione per determinare se la " **/Automation**"o" **-automazione**" option è presente, che indica se l'applicazione server è stata avviata da un'applicazione client.

```
BOOL RunAutomated();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'opzione è stata trovata. in caso contrario 0.

### <a name="remarks"></a>Note

Se presente, l'opzione viene rimossa dalla riga di comando. Per altre informazioni sull'automazione OLE, vedere l'articolo [server di automazione](../../mfc/automation-servers.md).

##  <a name="runembedded"></a>  CWinApp::RunEmbedded

Chiamare questa funzione per determinare se la " **/Embedding**"o" **-incorporamento**" option è presente, che indica se l'applicazione server è stata avviata da un'applicazione client.

```
BOOL RunEmbedded();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'opzione è stata trovata. in caso contrario 0.

### <a name="remarks"></a>Note

Se presente, l'opzione viene rimossa dalla riga di comando. Per altre informazioni sull'incorporamento, vedere l'articolo [server: Implementazione di un Server](../../mfc/servers-implementing-a-server.md).

##  <a name="saveallmodified"></a>  CWinApp::SaveAllModified

Chiamato dal framework per salvare tutti i documenti quando è necessario chiudere finestra cornice principale dell'applicazione o tramite un messaggio WM_QUERYENDSESSION.

```
virtual BOOL SaveAllModified();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se è sicuro terminare l'applicazione. 0 se non sicure terminare l'applicazione.

### <a name="remarks"></a>Note

L'implementazione predefinita di questa funzione membro chiama il [CDocument:: SaveModified](../../mfc/reference/cdocument-class.md#savemodified) funzione membro, a sua volta per tutti i documenti modificati all'interno dell'applicazione.

##  <a name="selectprinter"></a>  CWinApp::SelectPrinter

Chiamare questa funzione membro per selezionare una stampante specifica e rilasciare la stampante selezionata in precedenza nella finestra di dialogo di stampa.

```
void SelectPrinter(
    HANDLE hDevNames,
    HANDLE hDevMode,
    BOOL bFreeOld = TRUE);
```

### <a name="parameters"></a>Parametri

*hDevNames*<br/>
Un handle a un [DEVNAMES](/windows/desktop/api/commdlg/ns-commdlg-tagdevnames) struttura che identifica il driver, il dispositivo e i nomi di porta di output di una stampante specifico.

*hDevMode*<br/>
Un handle a un [DEVMODE](/windows/desktop/api/wingdi/ns-wingdi-_devicemodea) struttura che specifica le informazioni sull'inizializzazione di dispositivi e l'ambiente di una stampante.

*bFreeOld*<br/>
Libera la stampante selezionata in precedenza.

### <a name="remarks"></a>Note

Se entrambe *hDevMode* e *hDevNames* sono NULL, `SelectPrinter` utilizza la stampante predefinita corrente.

##  <a name="sethelpmode"></a>  CWinApp::SetHelpMode

Imposta il tipo di supporto dell'applicazione.

```
void SetHelpMode(AFX_HELP_TYPE eHelpType);
```

### <a name="parameters"></a>Parametri

*eHelpType*<br/>
Specifica il tipo di Guida da utilizzare. Visualizzare [CWinApp::m_eHelpType](#m_ehelptype) per altre informazioni.

### <a name="remarks"></a>Note

Imposta il tipo di supporto dell'applicazione.

Per impostare il tipo di supporto dell'applicazione HTMLHelp, è possibile chiamare [EnableHTMLHelp](#enablehtmlhelp). Dopo aver chiamato `EnableHTMLHelp`, l'applicazione deve usare HTMLHelp come l'applicazione della Guida. Se si desidera passare all'utilizzo di WinHelp, è possibile chiamare `SetHelpMode` e impostare *eHelpType* a `afxWinHelp`.

##  <a name="setregistrykey"></a>  CWinApp::SetRegistryKey

Fa sì che le impostazioni dell'applicazione da archiviare nel Registro di sistema anziché file INI.

```
void SetRegistryKey(LPCTSTR lpszRegistryKey);
void SetRegistryKey(UINT nIDRegistryKey);
```

### <a name="parameters"></a>Parametri

*lpszRegistryKey*<br/>
Puntatore a una stringa contenente il nome della chiave.

*nIDRegistryKey*<br/>
ID della risorsa stringa contenente il nome della chiave del Registro di sistema.

### <a name="remarks"></a>Note

La funzione imposta *m_pszRegistryKey*, che viene quindi usato per il `GetProfileInt`, `GetProfileString`, `WriteProfileInt`, e `WriteProfileString` funzioni membro di `CWinApp`. Se questa funzione è stata chiamata, l'elenco di usato più di recente (MRU) file viene archiviato anche nel Registro di sistema. La chiave del Registro di sistema è in genere il nome di una società. Questo viene archiviato in una chiave nel formato seguente: HKEY_CURRENT_USER\Software\\< nome società\>\\< nome applicazione\>\\< nome della sezione\>\\< nome del valore\>.

##  <a name="supportsapplicationrecovery"></a>  CWinApp::SupportsApplicationRecovery

Determina se la gestione riavvio consente di recuperare un'applicazione che è stato terminato in modo imprevisto.

```
virtual BOOL SupportsApplicationRecovery() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che la gestione riavvio consente di recuperare l'applicazione. FALSE indica che non Gestione riavvio.

##  <a name="supportsautosaveatinterval"></a>  CWinApp::SupportsAutosaveAtInterval

Determina se la si chiuda Gestione riavvio apre i documenti a intervalli regolari.

```
virtual BOOL SupportsAutosaveAtInterval() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che la si chiuda Gestione riavvio apre documenti; FALSE indica che non Gestione riavvio.

##  <a name="supportsautosaveatrestart"></a>  CWinApp::SupportsAutosaveAtRestart

Determina se la si chiuda Gestione riavvio qualsiasi aprire i documenti quando l'applicazione viene riavviata.

```
virtual BOOL SupportsAutosaveAtRestart() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che la si chiuda Gestione riavvio apre i documenti quando l'applicazione viene riavviata; FALSE indica che non Gestione riavvio.

##  <a name="supportsrestartmanager"></a>  CWinApp::SupportsRestartManager

Determina se l'applicazione supporta la gestione del riavvio.

```
virtual BOOL SupportsRestartManager() const;
```

### <a name="return-value"></a>Valore restituito

TRUE indica che l'applicazione supporti Gestione riavvio; FALSE indica che l'applicazione non avviene.

##  <a name="unregister"></a>  CWinApp::Unregister

Annulla la registrazione di tutti i file registrati dall'oggetto applicazione.

```
virtual BOOL Unregister();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero in caso di esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Note

Il `Unregister` funzione Annulla la registrazione eseguita dall'oggetto applicazione e il [registrare](#register) (funzione). In genere, entrambe le funzioni vengono chiamate in modo implicito da MFC e di conseguenza non verranno visualizzati nel codice.

Eseguire l'override di questa funzione per eseguire i passaggi di annullamento della registrazione personalizzata.

##  <a name="unregistershellfiletypes"></a>  CWinApp::UnregisterShellFileTypes

Chiamare questa funzione membro per annullare la registrazione di tutti i tipi di documento dell'applicazione con la gestione di File di Windows.

```
void UnregisterShellFileTypes();
```

##  <a name="winhelp"></a>  CWinApp::WinHelp

Chiamare questa funzione membro per richiamare l'applicazione WinHelp.

```
virtual void WinHelp(
    DWORD_PTR dwData,
    UINT nCmd = HELP_CONTEXT);
```

### <a name="parameters"></a>Parametri

*dwData*<br/>
Specifica i dati aggiuntivi. Il valore usato dipende dal valore della *nCmd* parametro.

*nCmd*<br/>
Specifica il tipo di Guida richiesto. Per un elenco di valori possibili e gli effetti di *dwData* parametro, vedere la [WinHelp](/windows/desktop/api/winuser/nf-winuser-winhelpa) funzione Windows.

### <a name="remarks"></a>Note

Inoltre, il framework chiama questa funzione per richiamare l'applicazione WinHelp.

Il framework chiuderà automaticamente l'applicazione WinHelp quando l'applicazione termina.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#53](../../mfc/reference/codesnippet/cpp/cwinapp-class_28.cpp)]

##  <a name="writeprofilebinary"></a>  CWinApp::WriteProfileBinary

Chiamare questa funzione membro per scrivere i dati binari in della sezione del Registro di sistema dell'applicazione o. File INI.

```
BOOL WriteProfileBinary(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPBYTE pData,
    UINT nBytes);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce. Se la sezione non esiste, viene creato. Il nome della sezione avviene indipendenti. la stringa può essere qualsiasi combinazione di lettere maiuscole e minuscole.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce in cui è possibile scrivere il valore. Se la voce non esiste nella sezione specificata, viene creato.

*pData*<br/>
Punta ai dati da scrivere.

*nBytes*<br/>
Contiene il numero di byte da scrivere.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

Questo esempio viene usato `CWinApp* pApp = AfxGetApp();` per ottenere la classe CWinApp che illustra in modo che `WriteProfileBinary` e `GetProfileBinary` può essere usata da qualsiasi funzione in un'applicazione MFC.

[!code-cpp[NVC_MFCWindowing#54](../../mfc/reference/codesnippet/cpp/cwinapp-class_29.cpp)]

Per un altro esempio, vedere l'esempio relativo [CWinApp::GetProfileBinary](#getprofilebinary).

##  <a name="writeprofileint"></a>  CWinApp::WriteProfileInt

Chiamare questa funzione membro per scrivere il valore specificato nella sezione specificata del Registro di sistema dell'applicazione o. File INI.

```
BOOL WriteProfileInt(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    int nValue);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce. Se la sezione non esiste, viene creato. Il nome della sezione avviene indipendenti. la stringa può essere qualsiasi combinazione di lettere maiuscole e minuscole.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce in cui è possibile scrivere il valore. Se la voce non esiste nella sezione specificata, viene creato.

*nValue*<br/>
Contiene il valore da scrivere.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

Questo esempio viene usato `CWinApp* pApp = AfxGetApp();` per ottenere la classe CWinApp che illustra in modo che `WriteProfileString`, `WriteProfileInt`, `GetProfileString`, e `GetProfileInt` può essere usata da qualsiasi funzione in un'applicazione MFC.

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Per un altro esempio, vedere l'esempio relativo [CWinApp::GetProfileInt](#getprofileint).

##  <a name="writeprofilestring"></a>  CWinApp::WriteProfileString

Chiamare questa funzione membro per scrivere la stringa specificata nella sezione specificata del Registro di sistema dell'applicazione o. File INI.

```
BOOL WriteProfileString(
    LPCTSTR lpszSection,
    LPCTSTR lpszEntry,
    LPCTSTR lpszValue);
```

### <a name="parameters"></a>Parametri

*lpszSection*<br/>
Punta a una stringa con terminazione null che specifica la sezione che contiene la voce. Se la sezione non esiste, viene creato. Il nome della sezione avviene indipendenti. la stringa può essere qualsiasi combinazione di lettere maiuscole e minuscole.

*lpszEntry*<br/>
Punta a una stringa con terminazione null che contiene la voce in cui è possibile scrivere il valore. Se la voce non esiste nella sezione specificata, viene creato. Se questo parametro è NULL, la sezione specificata da *lpszSection* viene eliminato.

*lpszValue*<br/>
Punta alla stringa da scrivere. Se questo parametro è NULL, la voce specificata per il *lpszEntry* parametro viene eliminato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCWindowing#43](../../mfc/reference/codesnippet/cpp/cwinapp-class_9.cpp)]

Per un altro esempio, vedere l'esempio relativo [CWinApp::GetProfileInt](#getprofileint).

##  <a name="setappid"></a>  CWinApp::SetAppID

Imposta in modo esplicito l'ID modello utente applicazione per l'applicazione. Questo metodo deve essere chiamato prima che qualsiasi interfaccia utente viene presentata all'utente (il modo migliore è il costruttore dell'applicazione).

```
void SetAppID(LPCTSTR lpcszAppID);
```

### <a name="parameters"></a>Parametri

*lpcszAppID*<br/>
Specifica l'ID modello utente applicazione.

### <a name="remarks"></a>Note

## <a name="see-also"></a>Vedere anche

[Classe CWinThread](../../mfc/reference/cwinthread-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Procedura: Aggiungere il supporto di Gestione riavvio](../../mfc/how-to-add-restart-manager-support.md)
