---
title: COleControl (classe) | Documenti Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: aafb5da5a26fefedbf41cda009ed49bf8658eb58
ms.sourcegitcommit: f1b051abb1de3fe96350be0563aaf4e960da13c3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/27/2018
ms.locfileid: "37039550"
---
# <a name="colecontrol-class"></a>COleControl (classe)
Classe di base avanzata per lo sviluppo di controlli OLE.  
  
## <a name="syntax"></a>Sintassi  
  
```  
class COleControl : public CWnd  
```  
  
## <a name="members"></a>Membri  
  
### <a name="public-constructors"></a>Costruttori pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleControl::COleControl](#colecontrol)|Crea un oggetto `COleControl`.|  
  
### <a name="public-methods"></a>Metodi pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleControl::AmbientAppearance](#ambientappearance)|Recupera l'aspetto del controllo corrente.|  
|[COleControl::AmbientBackColor](#ambientbackcolor)|Restituisce il valore della proprietà BackColor di ambiente.|  
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Restituisce il nome del controllo come specificato dal contenitore.|  
|[COleControl::AmbientFont](#ambientfont)|Restituisce il valore della proprietà di tipo di carattere ambiente.|  
|[COleControl::AmbientForeColor](#ambientforecolor)|Restituisce il valore della proprietà ForeColor di ambiente.|  
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Restituisce l'ID impostazioni locali. del contenitore|  
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Restituisce il tipo di unità usate dal contenitore.|  
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se verrà visualizzati un handle di ridimensionamento.|  
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina se verrà visualizzato un motivo di tratteggio a.|  
|[COleControl::AmbientTextAlign](#ambienttextalign)|Restituisce il tipo di allineamento del testo specificato dal contenitore.|  
|[COleControl::AmbientUIDead](#ambientuidead)|Determina se il controllo deve rispondere alle azioni dell'interfaccia utente.|  
|[COleControl::AmbientUserMode](#ambientusermode)|Determina la modalità del contenitore.|  
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica al contenitore che è stata modificata una proprietà associata.|  
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Viene richiesta un'autorizzazione per modificare il valore della proprietà.|  
|[COleControl::ClientToParent](#clienttoparent)|Converte un punto di origine del controllo a un punto di origine del relativo contenitore.|  
|[COleControl::ClipCaretRect](#clipcaretrect)|Modifica un rettangolo di punto di inserimento se si sovrappongono da un controllo.|  
|[COleControl::ControlInfoChanged](#controlinfochanged)|Chiamare questa funzione dopo aver modificato il set di tasti di scelta gestita dal controllo.|  
|[COleControl::DisplayError](#displayerror)|Visualizza eventi di errore predefiniti all'utente del controllo.|  
|[COleControl::DoClick](#doclick)|Implementazione dell'azione `DoClick` metodo.|  
|[COleControl::DoPropExchange](#dopropexchange)|Serializza le proprietà di un `COleControl` oggetto.|  
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Consente di ricreare un controllo OLE che è stato sottoclassato da un controllo di Windows.|  
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Abilita il supporto di frame semplice per un controllo.|  
|[COleControl::ExchangeExtent](#exchangeextent)|Serializza la larghezza e altezza del controllo.|  
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializza le proprietà predefinite del controllo.|  
|[COleControl::ExchangeVersion](#exchangeversion)|Serializza il numero di versione del controllo.|  
|[COleControl::FireClick](#fireclick)|Viene attivato il magazzino `Click` evento.|  
|[COleControl::FireDblClick](#firedblclick)|Viene attivato il magazzino `DblClick` evento.|  
|[COleControl::FireError](#fireerror)|Viene attivato il magazzino `Error` evento.|  
|[COleControl::FireEvent](#fireevent)|Viene generato un evento personalizzato.|  
|[COleControl::FireKeyDown](#firekeydown)|Viene attivato il magazzino `KeyDown` evento.|  
|[COleControl::FireKeyPress](#firekeypress)|Viene attivato il magazzino `KeyPress` evento.|  
|[COleControl::FireKeyUp](#firekeyup)|Viene attivato il magazzino `KeyUp` evento.|  
|[COleControl::FireMouseDown](#firemousedown)|Viene attivato il magazzino `MouseDown` evento.|  
|[COleControl::FireMouseMove](#firemousemove)|Viene attivato il magazzino `MouseMove` evento.|  
|[COleControl::FireMouseUp](#firemouseup)|Viene attivato il magazzino `MouseUp` evento.|  
|[COleControl::FireReadyStateChange](#firereadystatechange)|Genera un evento quando cambia lo stato del controllo pronto.|  
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Modifica il comportamento di attivazione predefinito di un controllo che supporta il `IPointerInactive` interfaccia.|  
|[COleControl::GetAmbientProperty](#getambientproperty)|Restituisce il valore della proprietà di ambiente specificato.|  
|[COleControl::GetAppearance](#getappearance)|Restituisce il valore della proprietà Appearance azionario.|  
|[COleControl::GetBackColor](#getbackcolor)|Restituisce il valore della proprietà BackColor azionario.|  
|[COleControl::GetBorderStyle](#getborderstyle)|Restituisce il valore della proprietà BorderStyle azionario.|  
|[COleControl::GetCapture](#getcapture)|Determina se un oggetto di controllo senza finestra, attivato lo stato mouse capture.|  
|[COleControl::GetClassID](#getclassid)|Recupera l'ID di classe OLE del controllo.|  
|[COleControl::GetClientOffset](#getclientoffset)|Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro dell'area client.|  
|[COleControl::GetClientRect](#getclientrect)|Recupera le dimensioni dell'area client del controllo.|  
|[COleControl::GetClientSite](#getclientsite)|Query di un oggetto per il puntatore al relativo sito client corrente all'interno del contenitore.|  
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera le impostazioni del flag di controllo.|  
|[COleControl::GetControlSize](#getcontrolsize)|Restituisce la posizione e dimensioni del controllo OLE.|  
|[COleControl::GetDC](#getdc)|Fornisce un mezzo per un controllo senza finestra ottenere un contesto di dispositivo dal relativo contenitore.|  
|[COleControl::GetEnabled](#getenabled)|Restituisce il valore della proprietà Enabled stock.|  
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera un puntatore a un oggetto di controllo estesi appartenente al contenitore.|  
|[COleControl::GetFocus](#getfocus)|Determina se il controllo ha lo stato attivo.|  
|[COleControl::GetFont](#getfont)|Restituisce il valore della proprietà del tipo di carattere azionario.|  
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Vengono restituite le metriche di un `CFontHolder` oggetto.|  
|[COleControl::GetForeColor](#getforecolor)|Restituisce il valore della proprietà ForeColor azionario.|  
|[COleControl::GetHwnd](#gethwnd)|Restituisce il valore della proprietà hWnd azionario.|  
|[COleControl::GetMessageString](#getmessagestring)|Fornisce il testo della barra di stato per una voce di menu.|  
|[COleControl::GetNotSupported](#getnotsupported)|Impedisce l'accesso al valore della proprietà di un controllo dall'utente.|  
|[COleControl::GetReadyState](#getreadystate)|Restituisce lo stato di conformità del controllo.|  
|[COleControl::GetRectInContainer](#getrectincontainer)|Restituisce il rettangolo rispetto al relativo contenitore.|  
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Vengono restituite le metriche della proprietà del tipo di carattere azionario.|  
|[COleControl::GetText](#gettext)|Restituisce il valore della proprietà Text o Caption azionario.|  
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Eseguire l'override per consentire un controllo senza finestra per essere la destinazione di trascinamento e operazioni di trascinamento.|  
|[COleControl::InitializeIIDs](#initializeiids)|Indica la classe base degli IID verrà utilizzato il controllo.|  
|[COleControl::InternalGetFont](#internalgetfont)|Restituisce un `CFontHolder` oggetto per la proprietà predefinita.|  
|[COleControl::InternalGetText](#internalgettext)|Recupera le proprietà predefinite di didascalia o il testo.|  
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Imposta lo stato di conformità del controllo e genera l'evento di modifica di stato pronto.|  
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalida un'area del controllo visualizzata, in modo da ricreare.|  
|[COleControl::InvalidateRgn](#invalidatergn)|Invalida l'area client della finestra contenitore all'interno dell'area specificata. Consente di ridisegnare controlli privi di finestra nell'area.|  
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Consente il caricamento specializzato di un controllo OLE.|  
|[COleControl::IsModified](#ismodified)|Determina se lo stato del controllo è stato modificato.|  
|[COleControl:: IsOptimizedDraw](#isoptimizeddraw)|Indica se il contenitore supporta disegno ottimizzato per l'operazione di disegno corrente.|  
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Chiamata eseguita per determinare se il controllo è una sottoclasse una finestra di controllano.|  
|[COleControl::Load](#load)|Reimposta i dati asincroni precedenti e avvia un nuovo caricamento della proprietà asincrona del controllo.|  
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina se il controllo del codice può essere disattivata dal contenitore.|  
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Chiamato quando viene modificata una proprietà di ambiente.|  
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Chiamato quando viene modificata la proprietà di aspetto predefinita.|  
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Chiamato quando viene modificata la proprietà BackColor predefinita.|  
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Chiamato quando viene modificata la proprietà BorderStyle predefinita.|  
|[COleControl::OnClick](#onclick)|Chiamato per generare le azioni fare clic su eventi.|  
|[COleControl::OnClose](#onclose)|Notifica al controllo che `IOleControl::Close` è stato chiamato.|  
|[COleControl::OnDoVerb](#ondoverb)|Chiamato dopo l'esecuzione di un verbo di controllo.|  
|[COleControl::OnDraw](#ondraw)|Chiamata eseguita quando un controllo si ridisegni se stesso.|  
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Chiamato dal contenitore quando viene richiesto un controllo ridisegni utilizzando un contesto di dispositivo metafile.|  
|[COleControl::OnEdit](#onedit)|Chiamato dal contenitore dell'interfaccia utente di attivare un controllo OLE.|  
|[COleControl::OnEnabledChanged](#onenabledchanged)|Chiamato quando viene modificata la proprietà Enabled di magazzino.|  
|[COleControl::OnEnumVerbs](#onenumverbs)|Chiamato dal contenitore da enumerare i verbi del controllo.|  
|[COleControl::OnEventAdvise](#oneventadvise)|Chiamata eseguita quando i gestori eventi vengono connesso o disconnesso da un controllo.|  
|[COleControl::OnFontChanged](#onfontchanged)|Chiamato quando viene modificata la proprietà predefinita.|  
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Chiamato quando viene modificata la proprietà ForeColor predefinita.|  
|[COleControl::OnFreezeEvents](#onfreezeevents)|Chiamato quando gli eventi del controllo sono bloccati o sbloccati.|  
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica al controllo che `IOleObject::GetColorSet` è stato chiamato.|  
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Fornisce informazioni di tasti di scelta rapida per il contenitore.|  
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Chiamato per ottenere una stringa per rappresentare un valore della proprietà.|  
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Richiede l'handle del menu del controllo che vengono unite con il contenitore.|  
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Eseguire l'override per recuperare la dimensione del controllo visualizzato più vicina alla modalità di dimensioni e la misura proposta.|  
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Restituisce le stringhe che rappresentano i valori possibili per una proprietà.|  
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Restituisce il valore corrispondente a una stringa predefinita.|  
|[COleControl::OnGetViewExtent](#ongetviewextent)|Eseguire l'override per recuperare la dimensione delle aree di visualizzazione del controllo (consente di abilitare due passaggi disegno).|  
|[COleControl::OnGetViewRect](#ongetviewrect)|Eseguire l'override per convertire le dimensioni del controllo in un rettangolo iniziando in corrispondenza di una posizione specifica.|  
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Eseguire l'override per recuperare lo stato di visualizzazione del controllo.|  
|[COleControl::OnHideToolBars](#onhidetoolbars)|Chiamato dal contenitore quando il controllo è disattivata l'interfaccia utente.|  
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Eseguire l'override per il contenitore per il controllo inattivo in mouse dispatch WM_MOUSEMOVE dei messaggi del puntatore al controllo.|  
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Eseguire l'override per il contenitore per il controllo inattivo in mouse dispatch WM_SETCURSOR dei messaggi del puntatore al controllo.|  
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Chiamato dopo che è stata attivata l'evento KeyDown azionario.|  
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Chiamata eseguita dopo l'evento KeyPress titolo è stata attivata.|  
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Chiamato dopo che è stata attivata l'evento KeyUp azionario.|  
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indica quale pagina delle proprietà da utilizzare per modificare una proprietà.|  
|[COleControl::OnMnemonic](#onmnemonic)|Chiamata eseguita quando è stato premuto un tasto mnemonico del controllo.|  
|[COleControl::OnProperties](#onproperties)|Chiamata eseguita quando è stato richiamato verbo "Properties" del controllo.|  
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Eseguire l'override di query se la visualizzazione del controllo si sovrappone a un determinato punto.|  
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Eseguire l'override di query se la visualizzazione del controllo si sovrappone a qualsiasi punto in un rettangolo specificato.|  
|[COleControl::OnRenderData](#onrenderdata)|Chiamato dal framework per recuperare i dati nel formato specificato.|  
|[COleControl::OnRenderFileData](#onrenderfiledata)|Chiamato dal framework per recuperare dati da un file nel formato specificato.|  
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Chiamato dal framework per recuperare i dati dalla memoria globale nel formato specificato.|  
|[COleControl::OnResetState](#onresetstate)|Reimposta le proprietà di un controllo per i valori predefiniti.|  
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica al controllo che `IOleControl::SetClientSite` è stato chiamato.|  
|[COleControl::OnSetData](#onsetdata)|Sostituisce i dati del controllo con un altro valore.|  
|[COleControl::OnSetExtent](#onsetextent)|Chiamato dopo che l'estensione del controllo è stato modificato.|  
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Chiamato dopo che sono state modificate le dimensioni del controllo.|  
|[COleControl::OnShowToolBars](#onshowtoolbars)|Chiamata eseguita quando il controllo è stata attivata l'interfaccia utente.|  
|[COleControl::OnTextChanged](#ontextchanged)|Chiamato quando viene modificata la riserva testo o la proprietà Caption.|  
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Elabora i messaggi della finestra (ad eccezione dei messaggi di tastiera e mouse) per i controlli privi di finestra.|  
|[COleControl::ParentToClient](#parenttoclient)|Converte un punto rispetto a un punto di origine del controllo dell'origine del contenitore.|  
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica al contenitore che è stata chiusa una finestra di dialogo modale.|  
|[COleControl::PreModalDialog](#premodaldialog)|Notifica al contenitore che sta per essere visualizzata una finestra di dialogo modale.|  
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Elimina e ricrea la finestra del controllo.|  
|[COleControl::Refresh](#refresh)|Impone un aggiornamento di aspetto del controllo.|  
|[COleControl::ReleaseCapture](#releasecapture)|Rilascia lo stato mouse capture.|  
|[COleControl::ReleaseDC](#releasedc)|Rilascia il contesto di dispositivo di visualizzazione di un contenitore di un controllo senza finestra.|  
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Reimposta l'elemento padre della finestra del controllo.|  
|[COleControl::ResetStockProps](#resetstockprops)|Inizializza `COleControl` proprietà sui rispettivi valori predefiniti predefinite.|  
|[COleControl::ResetVersion](#resetversion)|Inizializza il numero di versione per un determinato valore.|  
|[COleControl::ScrollWindow](#scrollwindow)|Consente un controllo senza finestra scorrere un'area all'interno di propria immagine attivo sul posto sullo schermo.|  
|[COleControl::SelectFontObject](#selectfontobject)|Seleziona una proprietà del tipo di carattere personalizzata in un contesto di dispositivo.|  
|[COleControl::SelectStockFont](#selectstockfont)|Seleziona la proprietà predefinita in un contesto di dispositivo.|  
|[COleControl::SerializeExtent](#serializeextent)|Serializza o Inizializza lo spazio di visualizzazione per il controllo.|  
|[COleControl::SerializeStockProps](#serializestockprops)|Serializza o Inizializza il `COleControl` proprietà predefinite.|  
|[COleControl::SerializeVersion](#serializeversion)|Serializza o Inizializza le informazioni sulla versione del controllo.|  
|[COleControl::SetAppearance](#setappearance)|Imposta il valore della proprietà Appearance azionario.|  
|[COleControl::SetBackColor](#setbackcolor)|Imposta il valore della proprietà BackColor azionario.|  
|[COleControl::SetBorderStyle](#setborderstyle)|Imposta il valore della proprietà BorderStyle azionario.|  
|[COleControl::SetCapture](#setcapture)|Fa sì che la finestra del controllo contenitore di prendere possesso dell'acquisizione del mouse per conto del controllo.|  
|[COleControl::SetControlSize](#setcontrolsize)|Imposta la posizione e dimensioni del controllo OLE.|  
|[COleControl::SetEnabled](#setenabled)|Imposta il valore della proprietà Enabled stock.|  
|[COleControl::SetFocus](#setfocus)|Fa sì che la finestra del controllo contenitore da intraprendere possiede lo stato attivo di input per conto del controllo.|  
|[COleControl::SetFont](#setfont)|Imposta il valore della proprietà del tipo di carattere azionario.|  
|[COleControl::SetForeColor](#setforecolor)|Imposta il valore della proprietà ForeColor azionario.|  
|[COleControl::SetInitialSize](#setinitialsize)|Imposta le dimensioni di un controllo OLE alla prima visualizzazione in un contenitore.|  
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Modifica lo stato modificato di un controllo.|  
|[COleControl::SetNotPermitted](#setnotpermitted)|Indica che una richiesta di modifica non è riuscito.|  
|[COleControl::SetNotSupported](#setnotsupported)|Impedisce la modifica al valore della proprietà di un controllo dall'utente.|  
|[COleControl::SetRectInContainer](#setrectincontainer)|Imposta il rettangolo rispetto al relativo contenitore.|  
|[COleControl::SetText](#settext)|Imposta il valore della proprietà Text o Caption azionario.|  
|[COleControl::ThrowError](#throwerror)|Segnala che si è verificato un errore in un controllo OLE.|  
|[COleControl::TransformCoords](#transformcoords)|Trasformazioni di coordinare i valori compresi tra un contenitore e il controllo.|  
|[COleControl::TranslateColor](#translatecolor)|Converte un' **OLE_COLOR** valore a un **COLORREF** valore.|  
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina se le proprietà di ambiente sarà disponibile al successivo caricamento il controllo.|  
|[COleControl::WindowProc](#windowproc)|Fornisce una procedura di Windows per un `COleControl` oggetto.|  
  
### <a name="protected-methods"></a>Metodi protetti  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleControl::DrawContent](#drawcontent)|Chiamato dal framework quando l'aspetto del controllo deve essere aggiornato.|  
|[COleControl::DrawMetafile](#drawmetafile)|Chiamato dal framework quando viene usato il contesto di dispositivo metafile.|  
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Abilita chiamata al metodo di automazione.|  
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Chiamato dal framework per inizializzare l'elenco dei formati di dati supportati dal controllo.|  
  
## <a name="remarks"></a>Note  
 Derivata da `CWnd`, questa classe eredita tutte le funzionalità di un oggetto finestra di Windows e funzionalità aggiuntive specifiche di OLE, ad esempio di generazione dell'evento e la possibilità di supportare metodi e proprietà.  
  
 OLE (controlli) possono essere inseriti nelle applicazioni contenitore OLE e comunicare con il contenitore usando un sistema bidirezionale di generazione dell'evento e che espone metodi e proprietà per il contenitore. Si noti che i contenitori OLE standard supportano solo la funzionalità di base di un controllo OLE. Non sono in grado di supportare funzionalità estese di un controllo OLE. Generazione dell'evento si verifica quando gli eventi vengono inviati al contenitore come risultato di determinate azioni hanno luogo nel controllo. A sua volta, il contenitore comunica con il controllo tramite un set di metodi e proprietà analoghe alle funzioni membro esposto e membri di dati di una classe C++. Questo approccio consente allo sviluppatore di controllare l'aspetto del controllo e notificare al contenitore il verificarsi di determinate azioni.  
  
## <a name="windowless-controls"></a>Controlli senza finestra  
 OLE (controlli) può essere utilizzato attivo sul posto senza una finestra. Controlli privi di finestra presentano vantaggi significativi:  
  
-   Controlli privi di finestra possono essere trasparente e non rettangolari  
  
-   Controlli privi di finestra ridurre il tempo di dimensioni e la creazione di istanza dell'oggetto  
  
 I controlli non richiedono una finestra. Servizi che offre una finestra facilmente possono essere forniti tramite una singola finestra condivisa (in genere del contenitore) e un po' di invio di codice. Disporre di una finestra è principalmente una complicazione non necessari per l'oggetto.  
  
 Quando viene utilizzata l'attivazione senza finestra, il contenitore (che dispone di una finestra) è responsabile di fornire servizi che sarebbero altrimenti forniti dalla finestra propria del controllo. Ad esempio, se il controllo deve eseguire una query lo stato attivo, interrogare lo stato mouse capture, oppure per ottenere un contesto di dispositivo, queste operazioni vengono gestite dal contenitore. Il `COleControl` [le funzioni membro privi di finestra operazione](http://msdn.microsoft.com/en-us/e9e28f79-9a70-4ae4-a5aa-b3e92f1904df) richiamare queste operazioni nel contenitore.  
  
 Quando è abilitata l'attivazione senza finestra, i delegati contenitore i messaggi per il controllo di input `IOleInPlaceObjectWindowless` interfaccia (un'estensione del [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) per il supporto privi di finestra). `COleControl`dell'implementazione di questa interfaccia invierà messaggi tramite mappa messaggi del controllo, dopo la regolazione del mouse coordinate in modo appropriato. È possibile elaborare questi messaggi come comuni messaggi di finestra, aggiungendo le voci corrispondenti alla mappa messaggi.  
  
 In un controllo senza finestra, è consigliabile usare sempre la `COleControl` funzioni membro anziché corrispondente `CWnd` funzioni membro o le relative funzioni API Windows correlate.  
  
 Oggetti di controllo OLE possono anche creare una finestra solo quando diventano attivi, ma aumenta la quantità di lavoro necessaria per la transizione non attivo-attivo e la velocità della transizione diventa inattivo. Vi sono alcuni casi si tratta di un problema: ad esempio, prendere in considerazione una griglia di caselle di testo. Quando il cursore su e giù intelligente tramite la colonna, ogni controllo deve essere posto attivato e quindi disattivata. La velocità della transizione non attivo/attivo influisce direttamente la velocità di scorrimento.  
  
 Per ulteriori informazioni sullo sviluppo di un'infrastruttura di controllo OLE, vedere gli articoli [controlli ActiveX MFC](../../mfc/mfc-activex-controls.md) e [Panoramica: creazione di un programma di controllo ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Per informazioni sull'ottimizzazione OLE (controlli), inclusi i controlli privi di finestra e sfarfallio, vedere [controlli ActiveX MFC: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CWnd](../../mfc/reference/cwnd-class.md)  
  
 `COleControl`  
  
## <a name="requirements"></a>Requisiti  
 **Intestazione:** afxctl. h  
  
##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor  
 Restituisce il valore della proprietà BackColor di ambiente.  
  
```  
OLE_COLOR AmbientBackColor();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore corrente della proprietà del contenitore ambiente BackColor, se presente. Se la proprietà non è supportata, questa funzione restituisce il colore di sfondo di Windows definiti dal sistema.  
  
### <a name="remarks"></a>Note  
 La proprietà BackColor ambiente è disponibile a tutti i controlli e viene definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName  
 Il nome che di contenitore è assegnato al controllo può essere utilizzato nei messaggi di errore visualizzati all'utente.  
  
```  
CString AmbientDisplayName();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il nome del controllo OLE. Il valore predefinito è una stringa di lunghezza zero.  
  
### <a name="remarks"></a>Note  
 Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientfont"></a>  COleControl::AmbientFont  
 Restituisce il valore della proprietà di tipo di carattere ambiente.  
  
```  
LPFONTDISP AmbientFont();
```  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore a interfaccia dispatch di tipo di carattere ambiente del contenitore. Il valore predefinito è **NULL**. Se il valore restituito non è uguale a **NULL**, è responsabile del rilascio il tipo di carattere chiamando il relativo [IUnknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) funzione membro.  
  
### <a name="remarks"></a>Note  
 La proprietà del tipo di carattere ambiente è definito dal contenitore e disponibile per tutti i controlli. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor  
 Restituisce il valore della proprietà ForeColor di ambiente.  
  
```  
OLE_COLOR AmbientForeColor();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore corrente di proprietà ForeColor di ambiente del contenitore, se presente. Se non è supportato, questa funzione restituisce il colore del testo definita dal sistema Windows.  
  
### <a name="remarks"></a>Note  
 La proprietà ForeColor ambiente è disponibile a tutti i controlli e viene definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID  
 Restituisce l'ID impostazioni locali. del contenitore  
  
```  
LCID AmbientLocaleID();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore della proprietà ID delle impostazioni locali del contenitore, se presente. Se questa proprietà non è supportata, questa funzione restituisce 0.  
  
### <a name="remarks"></a>Note  
 Il controllo è possibile utilizzare il valore LocaleID per adattare l'interfaccia utente per le impostazioni locali specifiche. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance  
 Recupera l'impostazione di aspetto corrente per l'oggetto controllo.  
  
```  
short AmbientAppearance();
```  
  
### <a name="return-value"></a>Valore restituito  
 L'aspetto del controllo:  
  
- **0** flat aspetto  
  
- **1** aspetto 3D  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione per recuperare il valore corrente della **DISPID_AMBIENT_APPEARANCE** proprietà per il controllo.  
  
##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits  
 Restituisce il tipo di unità usate dal contenitore.  
  
```  
CString AmbientScaleUnits();
```  
  
### <a name="return-value"></a>Valore restituito  
 Stringa contenente la proprietà ScaleUnits ambiente del contenitore. Se questa proprietà non è supportata, questa funzione restituisce una stringa di lunghezza zero.  
  
### <a name="remarks"></a>Note  
 Proprietà ScaleUnits ambiente del contenitore può essere utilizzata per visualizzare le posizioni o dimensioni, con l'etichetta con l'unità scelto, ad esempio twip o centimetri. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles  
 Determina se il contenitore consente il controllo da visualizzare quadratini di ridimensionamento per se stesso quando sono attive.  
  
```  
BOOL AmbientShowGrabHandles();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se devono essere visualizzati quadratini di ridimensionamento. in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce diverso da zero.  
  
### <a name="remarks"></a>Note  
 Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching  
 Determina se il contenitore consente il controllo da visualizzare se stesso con un bordo tratteggiato modello quando attivo dell'interfaccia utente.  
  
```  
BOOL AmbientShowHatching();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il pattern tratteggiato deve essere visualizzato; in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce diverso da zero.  
  
### <a name="remarks"></a>Note  
 Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign  
 Determina l'allineamento del testo dell'ambiente preferito dal contenitore del controllo.  
  
```  
short AmbientTextAlign();
```  
  
### <a name="return-value"></a>Valore restituito  
 Lo stato della proprietà TextAlign ambiente del contenitore. Se questa proprietà non è supportata, questa funzione restituisce 0.  
  
 Di seguito è un elenco di valori validi restituiti:  
  
|Valore restituito|Significato|  
|------------------|-------------|  
|0|Allineamento generale (numeri per il testo a destra, a sinistra).|  
|1|Giustificato a sinistra|  
|2|Al centro|  
|3|Allinea a destra|  
  
### <a name="remarks"></a>Note  
 Questa proprietà è disponibile a tutti i controlli incorporati e viene definita dal contenitore. Si noti che il contenitore non è necessario per supportare questa proprietà.  
  
##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead  
 Determina se il contenitore richiede il controllo di rispondere alle azioni dell'interfaccia utente.  
  
```  
BOOL AmbientUIDead();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo deve rispondere alle azioni dell'interfaccia utente; in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce 0.  
  
### <a name="remarks"></a>Note  
 Ad esempio, un contenitore potrebbe impostare ciò **TRUE** in modalità progettazione.  
  
##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode  
 Determina se il contenitore è in modalità progettazione o in modalità utente.  
  
```  
BOOL AmbientUserMode();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il contenitore è in modalità utente. in caso contrario 0 (in modalità progettazione). Se questa proprietà non è supportata, questa funzione restituisce TRUE.  
  
### <a name="remarks"></a>Note  
 Ad esempio, un contenitore potrebbe impostare ciò **FALSE** in modalità progettazione.  
  
##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged  
 Segnala che il valore della proprietà associata è stata modificata.  
  
```  
void BoundPropertyChanged(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 ID di invio di una proprietà del controllo associata.  
  
### <a name="remarks"></a>Note  
 Questo deve essere chiamato ogni volta che il valore della proprietà cambia, anche nei casi in cui la modifica non è stata eseguita tramite la proprietà metodo Set. Tenere presente in particolare delle proprietà associate che vengono mappate a variabili membro. Ogni volta che un membro variabile modifiche, `BoundPropertyChanged` deve essere chiamato.  
  
##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit  
 Richiede l'autorizzazione dal `IPropertyNotifySink` interfaccia per modificare un valore della proprietà con associazione fornito dal controllo.  
  
```  
BOOL BoundPropertyRequestEdit(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 ID di invio di una proprietà del controllo associata.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la modifica è consentita; in caso contrario 0. Il valore predefinito è diverso da zero.  
  
### <a name="remarks"></a>Note  
 Se viene negata l'autorizzazione, il controllo non deve consentire il valore di modifica della proprietà. Questa operazione può essere eseguita da verrà ignorato o non superati l'azione che ha tentato di modificare il valore della proprietà.  
  
##  <a name="clienttoparent"></a>  COleControl::ClientToParent  
 Converte le coordinate del *PowerPoint* nelle coordinate padre.  
  
```  
virtual void ClientToParent(
    LPCRECT lprcBounds, 
    LPPOINT pPoint) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *lprcBounds*  
 Puntatore ai limiti del controllo OLE all'interno del contenitore. L'area del controllo intera, compresi i bordi e le barre di scorrimento, ma non l'area client.  
  
 *PowerPoint*  
 Puntatore al punto area client di OLE da convertire nelle coordinate dell'elemento padre (contenitore).  
  
### <a name="remarks"></a>Note  
 Nell'input *PowerPoint* è correlato all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo). Nell'output *PowerPoint* è correlato all'origine dell'elemento padre (angolo superiore sinistro del contenitore).  
  
##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect  
 Modifica un rettangolo di punto di inserimento se completamente o parzialmente coperto da oggetti sovrapposti, opachi.  
  
```  
BOOL ClipCaretRect(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *lpRect*  
 In input, un puntatore a un [RECT](../../mfc/reference/rect-structure1.md) struttura che contiene l'area di punto di inserimento affinché venga regolato. Nell'output, l'area rettificato punto di inserimento, o **NULL** se il rettangolo di punto di inserimento è completamente coperto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Un punto di inserimento è una riga, blocco o bitmap che indica in genere in cui verrà inserita il testo o grafica lampeggiante.  
  
 Un oggetto senza finestra non è possibile visualizzare in modo sicuro un accento circonflesso senza prima verificare che il punto di inserimento è parzialmente o totalmente nascosto per oggetti sovrapposti. Per assicurarsi che possibili, è possibile utilizzare un oggetto `ClipCaretRect` per ottenere il punto di inserimento regolata (reduced) per verificare che quest ' ultima rientri nell'area di visualizzazione.  
  
 Creazione di un punto di inserimento di oggetti devono presentare il rettangolo di punto di inserimento a `ClipCaretRect` e utilizzare il rettangolo adattato per il punto di inserimento. Se il punto di inserimento è completamente nascosto, questo metodo restituirà **FALSE** e il punto di inserimento non deve essere visualizzato affatto in questo caso.  
  
##  <a name="colecontrol"></a>  COleControl::COleControl  
 Costruisce un oggetto `COleControl`.  
  
```  
COleControl();
```  
  
### <a name="remarks"></a>Note  
 Questa funzione in genere non viene chiamata direttamente. Il controllo OLE in genere viene invece creato dalla relativa class factory.  
  
##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged  
 Chiamare questa funzione quando viene modificato il set di tasti di scelta supportati dal controllo.  
  
```  
void ControlInfoChanged();
```  
  
### <a name="remarks"></a>Note  
 Dopo aver ricevuto la notifica, il contenitore del controllo ottiene il nuovo set di tasti di scelta effettuando una chiamata a [IOleControl::GetControlInfo](http://msdn.microsoft.com/library/windows/desktop/ms693730). Si noti che il contenitore non è necessario per rispondere a questa notifica.  
  
##  <a name="displayerror"></a>  COleControl::DisplayError  
 Chiamato dal framework dopo l'evento di errore predefinita è stata gestita (a meno che il gestore dell'evento è eliminata la visualizzazione dell'errore).  
  
```  
virtual void DisplayError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    LPCTSTR lpszSource,  
    LPCTSTR lpszHelpFile,  
    UINT nHelpID);
```  
  
### <a name="parameters"></a>Parametri  
 *SCODE*  
 Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 *lpszDescription*  
 La descrizione dell'errore da segnalare.  
  
 *lpszSource*  
 Il nome del modulo ha generato l'errore (in genere, il nome del modulo di controllo OLE).  
  
 *lpszHelpFile*  
 Il nome del file della Guida che contiene una descrizione dell'errore.  
  
 *nHelpID*  
 L'ID contesto della Guida dell'errore da segnalare.  
  
### <a name="remarks"></a>Note  
 Il comportamento predefinito consente di visualizzare una finestra di messaggio contenente la descrizione dell'errore, contenuto in *lpszDescription*.  
  
 Eseguire l'override di questa funzione per personalizzare la modalità di visualizzazione degli errori.  
  
##  <a name="doclick"></a>  COleControl::DoClick  
 Simula un mouse fare clic su azione sul controllo.  
  
```  
void DoClick();
```  
  
### <a name="remarks"></a>Note  
 Il sottoponibile a override `COleControl::OnClick` funzione membro viene chiamata e di riferimento di un evento verrà generato, se supportata dal controllo fare clic su.  
  
 Questa funzione è supportata per il `COleControl` classe di base come un metodo, chiamato DoClick. Per altre informazioni, vedere l'articolo [controlli ActiveX: metodi](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="dopropexchange"></a>  COleControl::DoPropExchange  
 Chiamato dal framework durante il caricamento o l'archiviazione di un controllo da una rappresentazione nell'archivio permanente, ad esempio un set di proprietà o di flusso.  
  
```  
virtual void DoPropExchange(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametri  
 *pPX*  
 Un puntatore a un `CPropExchange` oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio proprietà, inclusa la relativa direzione.  
  
### <a name="remarks"></a>Note  
 Questa funzione esegue in genere chiamate per il **px** famiglia di funzioni per caricare o archiviare proprietà specifiche definite dall'utente di un controllo OLE.  
  
 Se Creazione guidata controllo è stato utilizzato per creare il progetto di controllo OLE, la versione sottoposta a override di questa funzione serializzerà le proprietà predefinite supportate dal `COleControl` con una chiamata alla funzione di classe di base, `COleControl::DoPropExchange`. Quando si aggiungono proprietà definite dall'utente per il controllo OLE è necessario modificare questa funzione per serializzare la nuova proprietà. Per ulteriori informazioni sulla serializzazione, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint  
 Consente di ricreare un controllo OLE che è stato sottoclassato da un controllo di Windows.  
  
```  
void DoSuperclassPaint(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Puntatore al contesto di dispositivo del contenitore del controllo.  
  
 *rcBounds*  
 L'area in cui il controllo è da disegnare.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione per gestire correttamente il disegno di un controllo OLE non attivo. Questa funzione deve essere utilizzata solo se l'OLE controllare sottoclassi di un controllo di Windows e deve essere chiamato nel `OnDraw` funzione del controllo.  
  
 Per ulteriori informazioni su questa funzione e crea una sottoclasse di un controllo Windows, vedere l'articolo [controlli ActiveX: creazione di sottoclassi di un controllo Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).  
  
##  <a name="drawcontent"></a>  COleControl::DrawContent  
 Chiamato dal framework quando l'aspetto del controllo deve essere aggiornato.  
  
```  
void DrawContent(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Puntatore al contesto di dispositivo.  
  
 *RC*  
 Area rettangolare da disegnare.  
  
### <a name="remarks"></a>Note  
 Questa funzione chiama direttamente il sottoponibile a override `OnDraw` (funzione).  
  
##  <a name="drawmetafile"></a>  COleControl::DrawMetafile  
 Chiamato dal framework quando viene usato il contesto di dispositivo metafile.  
  
```  
void DrawMetafile(
    CDC* pDC,  
    CRect& rc);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Puntatore al contesto di dispositivo metafile.  
  
 *RC*  
 Area rettangolare da disegnare.  
  
##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame  
 Abilita la caratteristica di frame semplice per un controllo OLE.  
  
```  
void EnableSimpleFrame();
```  
  
### <a name="remarks"></a>Note  
 Questa caratteristica consente un controllo supportare il contenimento visivo di altri controlli, ma non true contenimento OLE. Un esempio può essere una casella di gruppo con più controlli all'interno. Questi controlli non sono OLE contenuti, ma sono nella stessa casella di gruppo.  
  
##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent  
 Serializza o Inizializza lo stato dell'estensione del controllo (le relative dimensioni in **HIMETRIC** unità).  
  
```  
BOOL ExchangeExtent(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametri  
 *pPX*  
 Un puntatore a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio proprietà, inclusa la relativa direzione.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la funzione ha esito positivo. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione viene chiamata in genere l'implementazione predefinita di `COleControl::DoPropExchange`.  
  
##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps  
 Serializza o Inizializza lo stato delle proprietà predefinite del controllo.  
  
```  
void ExchangeStockProps(CPropExchange* pPX);
```  
  
### <a name="parameters"></a>Parametri  
 *pPX*  
 Un puntatore a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio proprietà, inclusa la relativa direzione.  
  
### <a name="remarks"></a>Note  
 Questa funzione viene chiamata in genere l'implementazione predefinita di `COleControl::DoPropExchange`.  
  
##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion  
 Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.  
  
```  
BOOL ExchangeVersion(
    CPropExchange* pPX,  
    DWORD dwVersionDefault,  
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *pPX*  
 Un puntatore a un `CPropExchange` oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio proprietà, inclusa la relativa direzione.  
  
 *dwVersionDefault*  
 Il numero di versione corrente del controllo.  
  
 *bConvert*  
 Indica se i dati persistenti devono essere convertiti nel formato più recente quando salvata o gestiti nello stesso formato che è stato caricato.  
  
### <a name="return-value"></a>Valore restituito  
 NonZero della funzione ha esito positivo. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 In genere, questo sarà la prima funzione chiamata da un override del metodo `COleControl::DoPropExchange`. Durante il caricamento, questa funzione legge il numero di versione dei dati persistenti e imposta l'attributo version del [CPropExchange](../../mfc/reference/cpropexchange-class.md) conseguenza dell'oggetto. Quando si salva, questa funzione scrive il numero di versione dei dati persistenti.  
  
 Per ulteriori informazioni sul controllo delle versioni e la persistenza, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).  
  
##  <a name="fireclick"></a>  COleControl::FireClick  
 Chiamato dal framework quando viene selezionato il puntatore del mouse su un controllo attivo.  
  
```  
void FireClick();
```  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per l'attivazione automatica di un evento Click, mappa eventi del controllo deve avere un Click predefinito evento definito.  
  
##  <a name="firedblclick"></a>  COleControl::FireDblClick  
 Chiamato dal framework quando il mouse si fa doppio clic su un controllo attivo.  
  
```  
void FireDblClick();
```  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento DblClick, mappa eventi del controllo deve avere un evento DblClick predefinito definito.  
  
##  <a name="fireerror"></a>  COleControl::FireError  
 Genera l'evento di errore predefinita.  
  
```  
void FireError(
    SCODE scode,  
    LPCTSTR lpszDescription,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parametri  
 *SCODE*  
 Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 *lpszDescription*  
 La descrizione dell'errore da segnalare.  
  
 *nHelpID*  
 L'ID della Guida dell'errore da segnalare.  
  
### <a name="remarks"></a>Note  
 Questo evento fornisce un modo di segnalazione, nella posizione appropriata nel codice, che si è verificato un errore all'interno del controllo. A differenza di altri eventi predefiniti, ad esempio MouseMove, o fare clic su errore mai viene generato dal framework.  
  
 Per segnalare un errore che si verifica durante una funzione get di proprietà, funzione di set di proprietà o metodo di automazione, chiamare [COleControl:: ThrowError](#throwerror).  
  
 L'implementazione del controllo OLE Stock errore evento utilizza un `SCODE` valore. Se il controllo utilizza questo evento e dovrà essere utilizzato in Visual Basic 4.0, si riceveranno errori perché il `SCODE` valore non è supportato in Visual Basic.  
  
 Per risolvere questo problema, modificare manualmente il `SCODE` parametro del controllo. File ODL da un **lungo**. Inoltre, qualsiasi evento personalizzato, metodo o proprietà che utilizza un `SCODE` parametro provoca inoltre lo stesso problema.  
  
##  <a name="fireevent"></a>  COleControl::FireEvent  
 Genera un evento definito dall'utente dal controllo con un numero qualsiasi di argomenti facoltativi.  
  
```  
void AFX_CDECL FireEvent(
    DISPID dispid,  
    BYTE* pbParams,  
 ...);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 ID di invio dell'evento di attivazione.  
  
 *pbParams*  
 Un descrittore per i tipi di parametro dell'evento.  
  
### <a name="remarks"></a>Note  
 In genere questa funzione non deve essere chiamata direttamente. In alternativa, chiamare le funzioni che generano eventi nell'area della mappa eventi del controllo dichiarazione della classe.  
  
 Il *pbParams* argomento è un elenco delimitato da spazi **VTS _**. Uno o più di questi valori, separati da spazi (non virgole), specificano l'elenco dei parametri della funzione. I valori possibili sono i seguenti:  
  
|Simbolo|tipo di parametro|  
|------------|--------------------|  
|**VTS_COLOR**|**OLE_COLOR**|  
|**VTS_FONT**|**IFontDisp\***|  
|**VTS_HANDLE**|`HWND`|  
|**VTS_PICTURE**|**IPictureDisp\***|  
|**VTS_OPTEXCLUSIVE**|**OLE_OPTEXCLUSIVE\***|  
|**VTS_TRISTATE**|**OLE_TRISTATE**|  
|**VTS_XPOS_HIMETRIC**|**OLE_XPOS_HIMETRIC**|  
|**VTS_YPOS_HIMETRIC**|**OLE_YPOS_HIMETRIC**|  
|**VTS_XPOS_PIXELS**|**OLE_XPOS_PIXELS**|  
|**VTS_YPOS_PIXELS**|**OLE_YPOS_PIXELS**|  
|**VTS_XSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_YSIZE_PIXELS**|**OLE_XSIZE_PIXELS**|  
|**VTS_XSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
|**VTS_YSIZE_HIMETRIC**|**OLE_XSIZE_HIMETRIC**|  
  
> [!NOTE]
>  Costanti di tipo variant aggiuntive sono state definite per tutti i tipi variant, ad eccezione di **VTS_FONT** e **VTS_PICTURE**, che forniscono un puntatore alla costante di dati variant. Queste costanti vengono denominate usando il **VTS_P** `constantname` convenzione. Ad esempio **VTS_PCOLOR** è un puntatore a un **VTS_COLOR** costante.  
  
##  <a name="firekeydown"></a>  COleControl::FireKeyDown  
 Chiamato dal framework quando viene premuto un tasto mentre il controllo è attivo dell'interfaccia utente.  
  
```  
void FireKeyDown(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parametri  
 *pnChar*  
 Puntatore al valore codice tasto virtuale di tasto premuto. Per un elenco di codici di virtuali standard chiavi, vedere winuser. h  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento KeyDown, mappa eventi del controllo deve avere un evento KeyDown predefinito definito.  
  
##  <a name="firekeypress"></a>  COleControl::FireKeyPress  
 Chiamato dal framework quando un tasto viene premuto e rilasciato mentre il controllo personalizzato è attivo dell'interfaccia utente all'interno del contenitore.  
  
```  
void FireKeyPress(USHORT* pnChar);
```  
  
### <a name="parameters"></a>Parametri  
 *pnChar*  
 Un puntatore per il valore del carattere del tasto premuto.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Il destinatario dell'evento può modificare *pnChar*, ad esempio, convertire tutti i caratteri minuscoli in caratteri maiuscoli. Se si desidera esaminare il carattere modificato, eseguire l'override `OnKeyPressEvent`.  
  
 Per la generazione automatica di un evento KeyPress, mappa eventi del controllo deve disporre di un evento KeyPress titolo definito.  
  
##  <a name="firekeyup"></a>  COleControl::FireKeyUp  
 Chiamato dal framework quando viene rilasciato un tasto mentre il controllo personalizzato è attivo dell'interfaccia utente all'interno del contenitore.  
  
```  
void FireKeyUp(
    USHORT* pnChar,  
    short nShiftState);
```  
  
### <a name="parameters"></a>Parametri  
 *pnChar*  
 Puntatore al valore della chiave rilasciata codice tasto virtuale. Per un elenco di codici di virtuali standard chiavi, vedere winuser. h  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento KeyUp, mappa eventi del controllo deve avere un evento KeyUp predefinito definito.  
  
##  <a name="firemousedown"></a>  COleControl::FireMouseDown  
 Chiamato dal framework quando viene premuto un pulsante del mouse su un controllo personalizzato attivo.  
  
```  
void FireMouseDown(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametri  
 *nButton*  
 Il valore numerico del pulsante del mouse è premuto. Può contenere uno dei valori seguenti:  
  
- **LEFT_BUTTON** è stato premuto il pulsante sinistro del mouse verso il basso.  
  
- **MIDDLE_BUTTON** è stato premuto il pulsante centrale del mouse verso il basso.  
  
- **RIGHT_BUTTON** è stato premuto il pulsante destro del mouse verso il basso.  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
 *x*  
 La coordinata x del cursore quando è stato premuto un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
 *y*  
 La coordinata y del cursore quando è stato premuto un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento MouseDown, mappa eventi del controllo deve avere un evento MouseDown predefinito definito.  
  
##  <a name="firemousemove"></a>  COleControl::FireMouseMove  
 Chiamato dal framework quando il cursore viene spostato su un controllo personalizzato attivo.  
  
```  
void FireMouseMove(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametri  
 *nButton*  
 Il valore numerico dei pulsanti del mouse è premuto. Contiene una combinazione dei valori seguenti:  
  
- **LEFT_BUTTON** durante l'azione è stato premuto il pulsante sinistro del mouse verso il basso.  
  
- **MIDDLE_BUTTON** è stato premuto il pulsante centrale del mouse verso il basso durante l'azione.  
  
- **RIGHT_BUTTON** durante l'azione è stato premuto il pulsante destro del mouse verso il basso.  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
 *x*  
 La coordinata x del cursore. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
 *y*  
 La coordinata y del cursore. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento MouseMove, mappa eventi del controllo deve avere un evento MouseMove predefinito definito.  
  
##  <a name="firemouseup"></a>  COleControl::FireMouseUp  
 Chiamato dal framework quando viene rilasciato un pulsante del mouse su un controllo personalizzato attivo.  
  
```  
void FireMouseUp(
    short nButton,  
    short nShiftState,  
    OLE_XPOS_PIXELS x,  
    OLE_YPOS_PIXELS y);
```  
  
### <a name="parameters"></a>Parametri  
 *nButton*  
 Il valore numerico del rilascio del pulsante del mouse. Può avere uno dei valori seguenti:  
  
- **LEFT_BUTTON** è stato rilasciato il pulsante sinistro del mouse.  
  
- **MIDDLE_BUTTON** è stato rilasciato il pulsante centrale del mouse.  
  
- **RIGHT_BUTTON** è stato rilasciato il pulsante destro del mouse.  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
 *x*  
 La coordinata x del cursore quando è stato rilasciato un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
 *y*  
 La coordinata y di un cursore quando è stato rilasciato un pulsante del mouse. La coordinata è relativa all'angolo superiore sinistro della finestra del controllo.  
  
### <a name="remarks"></a>Note  
 Se questo evento viene definito come un evento personalizzato, determinano quando viene generato l'evento.  
  
 Per la generazione automatica di un evento MouseUp, mappa eventi del controllo deve avere un evento MouseUp predefinito definito.  
  
##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange  
 Genera un evento con il valore corrente dello stato del controllo.  
  
```  
void FireReadyStateChange();
```  
  
### <a name="remarks"></a>Note  
 Stato di pronto può essere uno dei valori seguenti:  
  
 **READYSTATE_UNINITIALIZED**  
 Stato di inizializzazione predefinito  
  
 **READYSTATE_LOADING**  
 Controllo sta caricando le relative proprietà  
  
 **READYSTATE_LOADED**  
 Controllo è stato inizializzato  
  
 **READYSTATE_INTERACTIVE**  
 Controllo dispone di dati sufficienti per essere interattivo ma non tutti asincrono dei dati è ancora caricato  
  
 **READYSTATE_COMPLETE** controllo dispone di tutti i relativi dati  
  
 Uso [GetReadyState](#getreadystate) per determinare l'attuale del controllo.  
  
 [InternalSetReadyState](#internalsetreadystate) cambia lo stato di pronto per il valore specificato, quindi chiama `FireReadyStateChange`.  
  
##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy  
 Modifica il comportamento di attivazione predefinito di un controllo che supporta il `IPointerInactive` interfaccia.  
  
```  
virtual DWORD GetActivationPolicy();
```  
  
### <a name="return-value"></a>Valore restituito  
 Una combinazione di flag dal **POINTERINACTIVE** enumerazione. Flag possibili sono:  
  
 **POINTERINACTIVE_ACTIVATEONENTRY**  
 L'oggetto deve essere attivato quando il mouse viene spostato durante un'operazione di spostamento del mouse sul posto.  
  
 **POINTERINACTIVE_DEACTIVATEONLEAVE**  
 L'oggetto deve essere disattivato quando il mouse viene spostato l'oggetto durante un'operazione di spostamento del mouse.  
  
 **POINTERINACTIVE_ACTIVATEONDRAG**  
 L'oggetto deve essere attivato quando il mouse viene trascinato su di esso durante il trascinamento sul posto e operazione di trascinamento.  
  
### <a name="remarks"></a>Note  
 Quando il `IPointerInactive` interfaccia è abilitata, il contenitore delegherà i messaggi WM_SETCURSOR e WM_MOUSEMOVE a esso. `COleControl`dell'implementazione di questa interfaccia invierà messaggi tramite mappa messaggi del controllo, dopo la regolazione del mouse coordinate in modo appropriato.  
  
 Ogni volta che il contenitore riceve un messaggio WM_SETCURSOR o WM_MOUSEMOVE con il puntatore del mouse su un oggetto inattivo che supporta `IPointerInactive`, questo deve chiamare `GetActivationPolicy` sui flag di interfaccia e restituito dal **POINTERINACTIVE**enumerazione.  
  
 È possibile elaborare questi messaggi come comuni messaggi di finestra, aggiungendo le voci corrispondenti alla mappa messaggi. Nei gestori, evitare di usare il `m_hWnd` variabile membro (o tutte le funzioni membro che lo utilizza) senza prima verificare che sia presente il relativo valore non - **NULL**.  
  
 Qualsiasi oggetto destinati a più di impostare il cursore del mouse e/o generare un evento di spostamento del mouse, ad esempio come fornire indicazioni visive speciali, deve restituire il **POINTERINACTIVE_ACTIVATEONENTRY** flag e disegnare i commenti e suggerimenti solo quando è attivo. Se l'oggetto viene restituito questo flag, il contenitore deve attivarlo posto immediatamente e quindi trasmette il messaggio stesso che ha attivato la chiamata a `GetActivationPolicy`.  
  
 Se entrambi i **POINTERINACTIVE_ACTIVATEONENTRY** e **POINTERINACTIVE_DEACTIVATEONLEAVE** vengono restituiti i flag, quindi l'oggetto verrà attivata solo quando il mouse è posizionato sull'oggetto. Se solo il **POINTERINACTIVE_ACTIVATEONENTRY** flag viene restituito, quindi l'oggetto verrà attivata solo una volta quando il mouse viene posizionato prima l'oggetto.  
  
 È possibile che si voglia un controllo inattivo per essere la destinazione di un trascinamento OLE e operazione di trascinamento. Questa operazione richiede l'attivazione del controllo al momento che l'utente trascina un oggetto su di esso, in modo che la finestra del controllo può essere registrata come obiettivo di rilascio. Affinché avvenga durante il trascinamento l'attivazione, restituire la **POINTERINACTIVE_ACTIVATEONDRAG** flag:  
  
 [!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]  
  
 Le informazioni comunicate mediante `GetActivationPolicy` non deve essere memorizzato nella cache da un contenitore. Al contrario, questo metodo deve essere chiamato ogni volta che il mouse viene spostato su un oggetto inattivo.  
  
 Se un oggetto inattivo non richiedono per essere attivato quando il mouse viene spostato, sul posto, il contenitore deve inviare messaggi WM_SETCURSOR successivi a questo oggetto chiamando [OnInactiveSetCursor](#oninactivesetcursor) fintanto che il puntatore del mouse resta di sopra l'oggetto.  
  
 L'abilitazione di `IPointerInactive` interfaccia in genere significa che si desidera il controllo sia in grado di elaborare i messaggi del mouse in qualsiasi momento. Per ottenere questo comportamento in un contenitore che non supporta il `IPointerInactive` interfaccia, è necessario disporre sempre attivo quando visibile, ovvero il controllo deve avere il **OLEMISC_ACTIVATEWHENVISIBLE** flag tra i vari flag. Tuttavia, per evitare questo flag da che diventino effettive in un contenitore che supporta `IPointerInactive`, è inoltre possibile specificare il **OLEMISC_IGNOREACTIVATEWHENVISIBLE** flag:  
  
 [!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]  
  
##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty  
 Ottiene il valore della proprietà di ambiente del contenitore.  
  
```  
BOOL GetAmbientProperty(
    DISPID dispid,  
    VARTYPE vtProp,  
    void* pvProp);
```  
  
### <a name="parameters"></a>Parametri  
 *dwDispid*  
 ID dispatch della proprietà di ambiente desiderata.  
  
 *vtProp*  
 Un tag di tipo variant che specifica il tipo del valore da restituire in *pvProp*.  
  
 *pvProp*  
 Un puntatore all'indirizzo della variabile che riceverà il valore della proprietà o valore restituito. Il tipo effettivo del puntatore ' this ' deve corrispondere al tipo specificato da *vtProp*.  
  
|vtProp|Tipo di pvProp|  
|------------|--------------------|  
|`VT_BOOL`|**BOOL\***|  
|`VT_BSTR`|**CString\***|  
|`VT_I2`|**short\***|  
|`VT_I4`|**Long\***|  
|`VT_R4`|**float\***|  
|`VT_R8`|**Double\***|  
|`VT_CY`|**CY\***|  
|**VT_COLOR**|**OLE_COLOR\***|  
|**VT_DISPATCH**|**LPDISPATCH\***|  
|**VT_FONT**|**LPFONTDISP\***|  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la proprietà di ambiente è supportata; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se si utilizza `GetAmbientProperty` per recuperare le proprietà DisplayName e ScaleUnits ambiente, impostare *vtProp* a `VT_BSTR` e *pvProp* a **CString\*** . Se si recuperano proprietà di tipo di carattere ambiente, impostare *vtProp* alla **VT_FONT** e *pvProp* a **LPFONTDISP\***.  
  
 Si noti che le funzioni sono già state fornite per le proprietà di ambiente comuni, ad esempio [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).  
  
##  <a name="getappearance"></a>  COleControl::GetAppearance  
 Implementa la funzione Get della proprietà Appearance predefinite del controllo.  
  
```  
short GetAppearance ();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore restituito specifica l'impostazione di aspetto corrente come una **breve** ( `VT_I2`) valore, se ha esito positivo. Questo valore è zero se l'aspetto del controllo è flat e 1 se l'aspetto del controllo è 3D.  
  
##  <a name="getbackcolor"></a>  COleControl::GetBackColor  
 Implementa la funzione Get della proprietà BackColor predefinite del controllo.  
  
```  
OLE_COLOR GetBackColor();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore restituito specifica il colore di sfondo corrente come una **OLE_COLOR** valore, se ha esito positivo. Questo valore può essere convertito in un **COLORREF** valore con una chiamata a `TranslateColor`.  
  
##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle  
 Implementa la funzione Get della proprietà BorderStyle predefinite del controllo.  
  
```  
short GetBorderStyle();
```  
  
### <a name="return-value"></a>Valore restituito  
 1 se il controllo ha un bordo normale. 0 se il controllo non ha bordi.  
  
##  <a name="getcapture"></a>  COleControl::GetCapture  
 Determina se il `COleControl` oggetto lo stato mouse capture.  
  
```  
CWnd* GetCapture();
```  
  
### <a name="return-value"></a>Valore restituito  
 Se il controllo è attivato e privi di finestra, restituisce **ciò** se il controllo ha attualmente lo stato mouse capture (come stabilito dal contenitore del controllo) o **NULL** se non ha l'acquisizione.  
  
 In caso contrario, restituisce il `CWnd` oggetto che lo stato mouse capture (uguale a `CWnd::GetCapture`).  
  
### <a name="remarks"></a>Note  
 Un controllo senza finestra attivato riceve il puntatore del mouse capture quando [SetCapture](#setcapture) viene chiamato.  
  
##  <a name="getclassid"></a>  COleControl::GetClassID  
 Chiamato dal framework per recuperare l'ID di classe OLE del controllo.  
  
```  
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;  
```  
  
### <a name="parameters"></a>Parametri  
 *pclsid*  
 Puntatore alla posizione dell'ID di classe.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata non riuscita; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 In genere implementata dal [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).  
  
##  <a name="getclientoffset"></a>  COleControl::GetClientOffset  
 Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro dell'area client.  
  
```  
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *pdxOffset*  
 Puntatore all'offset orizzontale dell'area client del controllo OLE.  
  
 *pdyOffset*  
 Puntatore all'offset verticale dell'area client del controllo OLE.  
  
### <a name="remarks"></a>Note  
 Il controllo OLE presenta un'area rettangolare all'interno del contenitore. L'area client del controllo è l'area di controllo ad eccezione di bordi e le barre di scorrimento. L'offset recuperati tramite `GetClientOffset` è la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro dell'area client. Se il controllo contiene gli elementi non client diversi dai bordi standard e le barre di scorrimento, eseguire l'override di questa funzione membro per specificare l'offset.  
  
##  <a name="getclientrect"></a>  COleControl::GetClientRect  
 Recupera le dimensioni dell'area client del controllo.  
  
```  
virtual void GetClientRect(LPRECT lpRect) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *lpRect*  
 Puntatore a un `RECT` struttura che contiene le dimensioni dell'area client del controllo senza finestra, vale a dire la dimensione del controllo meno bordi della finestra, frame, le barre di scorrimento e così via. Il *lpRect* parametro indica le dimensioni del rettangolo client del controllo, non la posizione.  
  
##  <a name="getclientsite"></a>  COleControl::GetClientSite  
 Query di un oggetto per il puntatore al relativo sito client corrente all'interno del contenitore.  
  
```  
LPOLECLIENTSITE GetClientSite();
```  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore al sito corrente client del controllo nel relativo contenitore.  
  
### <a name="remarks"></a>Note  
 Il puntatore restituito punta a un'istanza di `IOleClientSite`. Il `IOleClientSite` interfaccia implementata da contenitori, è la visualizzazione dell'oggetto di contesto: dove è ancorato nel documento, in cui Ottiene lo spazio di archiviazione, interfaccia utente e altre risorse.  
  
##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags  
 Recupera le impostazioni del flag di controllo.  
  
```  
virtual DWORD GetControlFlags();
```  
  
### <a name="return-value"></a>Valore restituito  
 Una combinazione introdotto dall'operatore OR dei flag nell'enumerazione ControlFlags:  
  
```  
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };  
```  
  
### <a name="remarks"></a>Note  
 Per impostazione predefinita `GetControlFlags` restituisce `fastBeginPaint | clipPaintDC`.  
  
 `fastBeginPaint`  
 Se impostato, viene utilizzato un disegno begin funzione personalizzata per la OLE (controlli) anziché la [BeginPaint](http://msdn.microsoft.com/library/windows/desktop/dd183362) API (impostazione predefinita).  
  
 `clipPaintDC`  
 Se non è impostato, disattiva la chiamata a `IntersectClipRect` effettuate da `COleControl` e garantisce una maggiore velocità. Se si usa l'attivazione senza finestra, il flag non ha alcun effetto.  
  
 `pointerInactive`  
 Se impostato, gestisce l'interazione del mouse mentre il controllo è inattivo abilitando `COleControl`dell'implementazione del `IPointerInactive` interfaccia, che è disabilitato per impostazione predefinita.  
  
 `noFlickerActivate`  
 Se impostato, evitano così le operazioni di disegno extra e lo sfarfallio visivo. Utilizzarlo quando il controllo disegna se stesso in modo identico negli stati attivi e inattivi. Se si usa l'attivazione senza finestra, il flag non ha alcun effetto.  
  
 `windowlessActivate`  
 Se impostato, indica che il controllo utilizza l'attivazione senza finestra.  
  
 `canOptimizeDraw`  
 Se impostato, indica che il controllo eseguirà il disegno ottimizzato, se il contenitore lo supporta.  
  
 Per ulteriori informazioni `GetControlFlags` e altre ottimizzazioni di controlli OLE, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="getcontrolsize"></a>  COleControl::GetControlSize  
 Recupera la dimensione della finestra del controllo OLE.  
  
```  
void GetControlSize(
    int* pcx,  
    int* pcy);
```  
  
### <a name="parameters"></a>Parametri  
 *pcx*  
 Specifica la larghezza del controllo in pixel.  
  
 *pcy*  
 Specifica l'altezza del controllo in pixel.  
  
### <a name="remarks"></a>Note  
 Si noti che tutte le coordinate per finestre di controllo sono rispetto all'angolo superiore sinistro del controllo.  
  
##  <a name="getdc"></a>  COleControl::GetDC  
 Fornisce per un oggetto senza finestra per il contesto di dispositivo get una schermata o compatibile, dal relativo contenitore.  
  
```  
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```  
  
### <a name="parameters"></a>Parametri  
 *lprcRect*  
 Un puntatore al rettangolo il controllo senza finestra desidera essere ridisegnata, nelle coordinate client del controllo. **NULL** significa extent dell'oggetto completo.  
  
 *dwFlags*  
 Attributi di disegno del contesto di dispositivo. Scelte disponibili sono:  
  
- **OLEDC_NODRAW** indica che l'oggetto non utilizza il contesto di dispositivo per eseguire qualsiasi, ma semplicemente di disegno per ottenere informazioni sul dispositivo di visualizzazione. Il contenitore deve semplicemente passare controller di dominio della finestra senza un'ulteriore elaborazione.  
  
- **OLEDC_PAINTBKGND** richiede che il contenitore disegnare lo sfondo prima di restituire il controller di dominio. Un oggetto deve utilizzare questo flag se richiede un controller di dominio per il disegno di un'area con sfondo trasparente.  
  
- **OLEDC_OFFSCREEN** informa il contenitore in cui si desidera eseguire il rendering in una bitmap fuori schermo che quindi deve essere copiata sullo schermo l'oggetto. Questo flag devono essere utilizzate da un oggetto quando è possibile eseguire l'operazione di disegno vengono generate molte lo sfarfallio. Il contenitore è gratuito rispettare la richiesta o non. Tuttavia, se questo flag non è impostato, il contenitore deve passare nuovamente sullo schermo controller di dominio. In questo modo gli oggetti eseguire operazioni dirette dello schermo, ad esempio che illustra una selezione (tramite un **XOR** operazione).  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore al contesto di dispositivo di visualizzazione per il contenitore `CWnd` area client se ha esito positivo; in caso contrario, il valore restituito è **NULL**. Il contesto di dispositivo di visualizzazione può essere utilizzato nelle funzioni GDI successive per disegnare l'area client della finestra del contenitore.  
  
### <a name="remarks"></a>Note  
 Il [ReleaseDC](#releasedc) funzione membro deve essere chiamata per rilasciare il contesto dopo il disegno. Quando si chiama `GetDC`, gli oggetti passano il rettangolo che desiderano disegnare nel propria coordinate client. `GetDC` traduce tali corrispondenza delle coordinate dell'area client del contenitore. L'oggetto non deve richiedere un rettangolo desiderato maggiore di un proprio rettangolo area client, le cui dimensioni possono essere recuperate con [GetClientRect](#getclientrect). In questo modo si impedisce che gli oggetti inavvertitamente disegno in cui non sono tenuti a.  
  
##  <a name="getenabled"></a>  COleControl::GetEnabled  
 Implementa la funzione Get di scorte del controllo proprietà Enabled.  
  
```  
BOOL GetEnabled();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo è abilitato; in caso contrario 0.  
  
##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl  
 Ottiene un puntatore a un oggetto gestito dal contenitore che rappresenta il controllo con un set di proprietà estese.  
  
```  
LPDISPATCH GetExtendedControl();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore per il contenitore del estesa oggetto controllo. Se non è disponibile alcun oggetto, il valore è **NULL**.  
  
 Questo oggetto può essere modificato tramite la relativa `IDispatch` interfaccia. È anche possibile usare `QueryInterface` per ottenere altre interfacce disponibili fornite dall'oggetto. Tuttavia, l'oggetto non è necessario per supportare un set specifico di interfacce. Si noti che ricorrere a funzionalità specifiche dell'oggetto controllo esteso del contenitore consente di limitare la portabilità del controllo in altri contenitori arbitrari.  
  
### <a name="remarks"></a>Note  
 La funzione che chiama questa funzione è responsabile del rilascio il puntatore al termine con l'oggetto. Si noti che il contenitore non è necessario per supportare questo oggetto.  
  
##  <a name="getfocus"></a>  COleControl::GetFocus  
 Determina se il `COleControl` oggetto ha lo stato attivo.  
  
```  
CWnd* GetFocus();
```  
  
### <a name="return-value"></a>Valore restituito  
 Se il controllo è attivato e privi di finestra, restituisce **ciò** se il controllo ha attualmente lo stato attivo (come stabilito dal contenitore del controllo), o **NULL** se non è lo stato attivo.  
  
 In caso contrario, restituisce il `CWnd` oggetto che ha lo stato attivo (uguale a `CWnd::GetFocus`).  
  
### <a name="remarks"></a>Note  
 Un controllo senza finestra attivato riceve lo stato attivo quando [SetFocus](#setfocus) viene chiamato.  
  
##  <a name="getfont"></a>  COleControl::GetFont  
 Implementa la funzione Get della proprietà del tipo di carattere azionario.  
  
```  
LPFONTDISP GetFont();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore all'interfaccia dispatch del tipo di carattere della proprietà Font predefinita del controllo.  
  
### <a name="remarks"></a>Note  
 Si noti che il chiamante deve rilasciare l'oggetto al termine. All'interno dell'implementazione del controllo, utilizzare `InternalGetFont` per accedere all'oggetto del tipo di carattere azionario del controllo. Per ulteriori informazioni sull'utilizzo dei tipi di carattere nel controllo, vedere l'articolo [controlli ActiveX: utilizzo dei tipi di carattere in un controllo ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).  
  
##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics  
 Misura la metrica di testo per qualsiasi `CFontHolder` oggetto di proprietà dal controllo.  
  
```  
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parametri  
 *lptm*  
 Puntatore a un [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) struttura.  
  
 *fontHolder*  
 Riferimento a un [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto.  
  
### <a name="remarks"></a>Note  
 È possibile selezionare un tipo di carattere con la [COleControl::SelectFontObject](#selectfontobject) (funzione). `GetFontTextMetrics` inizializzerà il `TEXTMETRIC` struttura a cui punta *lptm* con le informazioni di metrica valido `fontHolder`del tipo di carattere se ha esito positivo oppure compilare la struttura con zero se l'operazione non riesce. È consigliabile utilizzare questa funzione anziché [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) quando disegno del controllo perché i controlli, come qualsiasi incorporati oggetto OLE, potrebbero essere necessarie per il rendering autonomamente in un metafile.  
  
 Il `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornato quando il [SelectFontObject](#selectfontobject) funzione viene chiamata. È necessario chiamare `GetFontTextMetrics` solo dopo che la proprietà predefinita per assicurare che le informazioni fornisce la selezione è valida.  
  
##  <a name="getforecolor"></a>  COleControl::GetForeColor  
 Implementa la funzione Get della proprietà ForeColor azionario.  
  
```  
OLE_COLOR GetForeColor();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore restituito specifica il colore di primo piano corrente come una **OLE_COLOR** valore, se ha esito positivo. Questo valore può essere convertito in un [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) valore con una chiamata a `TranslateColor`.  
  
##  <a name="gethwnd"></a>  COleControl::GetHwnd  
 Implementa la funzione Get della proprietà hWnd azionario.  
  
```  
OLE_HANDLE GetHwnd();
```  
  
### <a name="return-value"></a>Valore restituito  
 Handle della finestra del controllo OLE, se presente. in caso contrario **NULL**.  
  
##  <a name="getmessagestring"></a>  COleControl::GetMessageString  
 Chiamato dal framework per ottenere una stringa breve che descrive lo scopo della voce di menu identificata *nID*.  
  
```  
virtual void GetMessageString(
    UINT nID,  
    CString& rMessage) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *nID*  
 Un ID di elemento di menu.  
  
 *rMessage*  
 Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite cui verrà restituita una stringa dell'oggetto.  
  
### <a name="remarks"></a>Note  
 Utilizzabile per ottenere un messaggio per la visualizzazione in una barra di stato, la voce di menu viene evidenziata. L'implementazione predefinita tenta di caricare una risorsa stringa identificata *nID*.  
  
##  <a name="getnotsupported"></a>  COleControl::GetNotSupported  
 Impedisce l'accesso al valore della proprietà di un controllo dall'utente.  
  
```  
void GetNotSupported();
```  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione invece la funzione Get di qualsiasi proprietà in cui il recupero della proprietà dall'utente del controllo non è supportato. Un esempio potrebbe essere una proprietà di sola scrittura.  
  
##  <a name="getreadystate"></a>  COleControl::GetReadyState  
 Restituisce lo stato di conformità del controllo.  
  
```  
long GetReadyState();
```  
  
### <a name="return-value"></a>Valore restituito  
 Lo stato di conformità del controllo, uno dei valori seguenti:  
  
 **READYSTATE_UNINITIALIZED**  
 Stato di inizializzazione predefinito  
  
 **READYSTATE_LOADING**  
 Controllo sta caricando le relative proprietà  
  
 **READYSTATE_LOADED**  
 Controllo è stato inizializzato  
  
 **READYSTATE_INTERACTIVE**  
 Controllo dispone di dati sufficienti per essere interattivo ma non tutti asincrono dei dati è ancora caricato  
  
 **READYSTATE_COMPLETE**  
 Controllo dispone di tutti i relativi dati  
  
### <a name="remarks"></a>Note  
 La maggior parte dei controlli semplici mai necessario differenziare **LOADED** e **INTERACTIVE**. Tuttavia, i controlli che supportano le proprietà del percorso dati non possono essere pronti a essere interattive fino a quando non vengono ricevuti almeno alcuni dati in modo asincrono. Un controllo deve provare a diventare interattivo appena possibile.  
  
##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer  
 Ottiene le coordinate del rettangolo rispetto al contenitore, espresso come unità di dispositivo.  
  
```  
BOOL GetRectInContainer(LPRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *lpRect*  
 Puntatore alla struttura rettangolo in cui verranno copiate coordinate del controllo.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo è attivo sul posto; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il rettangolo è valido solo se il controllo è attivo sul posto.  
  
##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics  
 Misura la metrica di testo per la proprietà del controllo predefinita del tipo di carattere, che può essere selezionata con il [SelectStockFont](#selectstockfont) (funzione).  
  
```  
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```  
  
### <a name="parameters"></a>Parametri  
 *lptm*  
 Un puntatore a un [TEXTMETRIC](http://msdn.microsoft.com/library/windows/desktop/dd145132) struttura.  
  
### <a name="remarks"></a>Note  
 Il `GetStockTextMetrics` funzione inizializzerà il `TEXTMETRIC` struttura a cui punta *lptm* con le informazioni di metrica valido se ha esito positivo o riempimento della struttura con zero se l'operazione non riesce. Utilizzare questa funzione anziché [GetTextMetrics](http://msdn.microsoft.com/library/windows/desktop/dd144941) quando disegno del controllo perché i controlli, come qualsiasi incorporati oggetto OLE, potrebbero essere necessarie per il rendering autonomamente in un metafile.  
  
 Il `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornato quando il `SelectStockFont` funzione viene chiamata. È necessario chiamare questa funzione solo dopo che il tipo di carattere azionario per assicurare che le informazioni che fornisce la selezione è valida.  
  
##  <a name="gettext"></a>  COleControl::GetText  
 Implementa la funzione Get della proprietà Text o Caption azionario.  
  
```  
BSTR GetText();
```  
  
### <a name="return-value"></a>Valore restituito  
 Il valore corrente della stringa di testo di controllo o una stringa di lunghezza zero se non è presente alcuna stringa.  
  
> [!NOTE]
>  Per ulteriori informazioni sul `BSTR` del tipo di dati, vedere [i tipi di dati](../../mfc/reference/data-types-mfc.md) nella sezione macro e funzioni globali.  
  
### <a name="remarks"></a>Note  
 Si noti che il chiamante di questa funzione deve chiamare `SysFreeString` nella stringa di ha restituito al fine di liberare la risorsa. All'interno dell'implementazione del controllo, utilizzare `InternalGetText` per accedere alle proprietà di testo o didascalia predefinita del controllo.  
  
##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget  
 Eseguire l'override `GetWindowlessDropTarget` quando si desidera un controllo senza finestra deve essere la destinazione OLE trascinamento della selezione operazione.  
  
```  
virtual IDropTarget* GetWindowlessDropTarget();
```  
  
### <a name="return-value"></a>Valore restituito  
 Puntatore all'oggetto `IDropTarget` interfaccia. Poiché non dispone di una finestra, un oggetto senza finestra non è possibile registrare un `IDropTarget` interfaccia. Tuttavia, per partecipare al trascinamento della selezione, un oggetto senza finestra puoi implementare l'interfaccia e restituirlo in `GetWindowlessDropTarget`.  
  
### <a name="remarks"></a>Note  
 In genere, ciò richiede che la finestra del controllo sia stata registrata come obiettivo di rilascio. Ma poiché il controllo non dispone di alcuna finestra propria, il contenitore utilizzerà la propria finestra come obiettivo di rilascio. Il controllo deve semplicemente fornire un'implementazione del `IDropTarget` interfaccia a cui il contenitore può delegare le chiamate al momento appropriato. Ad esempio:  
  
 [!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]  
  
##  <a name="initializeiids"></a>  COleControl::InitializeIIDs  
 Indica la classe base degli IID verrà utilizzato il controllo.  
  
```  
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```  
  
### <a name="parameters"></a>Parametri  
 *piidPrimary*  
 Puntatore all'ID di interfaccia di interfaccia dispatch principale del controllo.  
  
 *piidEvents*  
 Puntatore all'ID di interfaccia di interfaccia di eventi del controllo.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione nel costruttore del controllo per informare la classe di base dell'interfaccia ID verrà utilizzato il controllo del codice.  
  
##  <a name="internalgetfont"></a>  COleControl::InternalGetFont  
 Accede alla proprietà del carattere predefinite del controllo  
  
```  
CFontHolder& InternalGetFont();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un riferimento a un [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto che contiene l'oggetto del tipo di carattere azionario.  
  
##  <a name="internalgettext"></a>  COleControl::InternalGetText  
 Accede alla proprietà Text o Caption predefinita del controllo.  
  
```  
const CString& InternalGetText();
```  
  
### <a name="return-value"></a>Valore restituito  
 Riferimento per la stringa di testo del controllo.  
  
##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState  
 Imposta lo stato di conformità del controllo.  
  
```  
void InternalSetReadyState(long lNewReadyState);
```  
  
### <a name="parameters"></a>Parametri  
 *lNewReadyState*  
 Lo stato di conformità da impostare per il controllo, in uno dei valori seguenti:  
  
 **READYSTATE_UNINITIALIZED**  
 Stato di inizializzazione predefinito  
  
 **READYSTATE_LOADING**  
 Controllo sta caricando le relative proprietà  
  
 **READYSTATE_LOADED**  
 Controllo è stato inizializzato  
  
 **READYSTATE_INTERACTIVE**  
 Controllo dispone di dati sufficienti per essere interattivo ma non tutti asincrono dei dati è ancora caricato  
  
 **READYSTATE_COMPLETE**  
 Controllo dispone di tutti i relativi dati  
  
### <a name="remarks"></a>Note  
 La maggior parte dei controlli semplici mai necessario differenziare **LOADED** e **INTERACTIVE**. Tuttavia, i controlli che supportano le proprietà del percorso dati non possono essere pronti a essere interattive fino a quando non vengono ricevuti almeno alcuni dati in modo asincrono. Un controllo deve provare a diventare interattivo appena possibile.  
  
##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl  
 Forza il controllo ridisegni.  
  
```  
void InvalidateControl(
    LPCRECT lpRect = NULL,  
    BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *lpRect*  
 Un puntatore all'area del controllo da invalidare.  
  
 *bErase*  
 Specifica se lo sfondo all'interno dell'area di aggiornamento deve essere cancellato durante l'elaborazione di regione di aggiornamento.  
  
### <a name="remarks"></a>Note  
 Se *lpRect* dispone di un **NULL** valore, l'intero controllo viene ridisegnato. Se *lpRect* non **NULL**, ciò indica la parte del rettangolo che deve essere invalidato. Nei casi in cui il controllo non dispone di finestre, o non è attualmente attivo, il rettangolo viene ignorato e viene eseguita una chiamata per il sito del client [IAdviseSink::OnViewChange](http://msdn.microsoft.com/library/windows/desktop/ms694337) funzione membro. Utilizzare questa funzione anziché `CWnd::InvalidateRect` o `InvalidateRect`.  
  
##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn  
 Invalida l'area client della finestra contenitore all'interno dell'area specificata.  
  
```  
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *pRgn*  
 Un puntatore a un [CRgn](../../mfc/reference/crgn-class.md) oggetto che identifica l'area di visualizzazione dell'oggetto OLE da invalidare, nelle coordinate client della finestra contenitore. Se questo parametro è **NULL**, l'extent è l'intero oggetto.  
  
 *bErase*  
 Specifica se lo sfondo all'interno dell'area deve essere cancellati. Se **TRUE**, lo sfondo viene cancellato. Se **FALSE**, lo sfondo non subisce modifiche.  
  
### <a name="remarks"></a>Note  
 Questa operazione consente di ricreare i controlli privi di finestra all'interno del contenitore. L'area invalidato, insieme a tutte le altre aree nell'area di aggiornamento, è contrassegnato per il disegno quando la successiva [WM_PAINT](http://msdn.microsoft.com/library/windows/desktop/dd145213) messaggio viene inviato.  
  
 Se *bErase* viene **TRUE** per qualsiasi parte della regione di aggiornamento, viene cancellato l'intera area, non solo nella parte specificata, lo sfondo.  
  
##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX  
 Consente il caricamento specializzato di un controllo OLE.  
  
```  
BOOL IsConvertingVBX();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo viene convertito; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Durante la conversione di un form che usa VBX controlli a una che utilizza OLE (controlli), il codice di caricamento speciale per i controlli OLE potrebbe essere necessario. Ad esempio, se si sta caricando un'istanza del controllo OLE, potrebbe essere una chiamata a [PX_Font](persistence-of-ole-controls.md#px_font) nel `DoPropExchange`:  
  
 [!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]  
  
 Tuttavia, i controlli VBX non è un oggetto di tipo di carattere. ogni proprietà del tipo di carattere è stato salvato singolarmente. In questo caso, si utilizzerebbe `IsConvertingVBX` per distinguere tra questi due casi:  
  
 [!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]  
  
 Un altro caso sarebbe se il controllo VBX salvato proprietari dati binari (nella relativa **VBM_SAVEPROPERTY** dal gestore di messaggi), e il controllo OLE Salva i dati binari in un formato diverso. Se si desidera che il controllo OLE per essere compatibile con il controllo VBX, è possibile leggere entrambi i vecchi e nuovi formati utilizzando il `IsConvertingVBX` funzione distinguendo se è stato caricato il controllo VBX o del controllo OLE.  
  
 Del controllo `DoPropExchange` funzione, è possibile verificare questa condizione e se è true, eseguire carico codice specifico per questa conversione (ad esempio, negli esempi precedenti). Se il controllo non verrà convertito, è possibile eseguire codice carico normale. Questa possibilità è applicabile solo ai controlli da convertire da controparti VBX.  
  
##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed  
 Abilita chiamata al metodo di automazione.  
  
```  
BOOL IsInvokeAllowed(DISPID dispid);
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo è stato inizializzato; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Implementazione del framework del **IDispatch:: Invoke** chiamate **IsInvokeAllowed** per determinare se una determinata funzione (identificato da `dispid`) può essere richiamato. Il comportamento predefinito per un controllo OLE consiste nel consentire a metodi di automazione per essere richiamato solo se il controllo è stato inizializzato; Tuttavia, **IsInvokeAllowed** è una funzione virtuale e può essere sottoposto a override se necessario (ad esempio, quando il controllo viene utilizzato come server di automazione). Per altre informazioni, vedere l'articolo della Knowledge Base Q166472, "HOWTO: utilizzare un controllo OLE come Server di automazione." Articoli della Knowledge Base sono disponibili in [ http://support.microsoft.com ](http://support.microsoft.com/).  
  
##  <a name="ismodified"></a>  COleControl::IsModified  
 Determina se è stato modificato lo stato del controllo.  
  
```  
BOOL IsModified();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se lo stato del controllo è stato modificato dopo l'ultimo salvataggio; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Lo stato di un controllo viene modificato quando una proprietà cambia valore.  
  
##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw  
 Determina se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente.  
  
```  
BOOL IsOptimizedDraw();
```  
  
### <a name="return-value"></a>Valore restituito  
 **TRUE** se il contenitore supporta ottimizzato di disegno per l'operazione di disegno corrente; in caso contrario **FALSE**.  
  
### <a name="remarks"></a>Note  
 Se disegno ottimizzato è supportato, quindi il controllo necessario non selezionare i vecchi oggetti (penne, pennelli, tipi di carattere e così via) nel contesto di dispositivo al termine di disegno.  
  
##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl  
 Chiamato dal framework per determinare se il controllo è una sottoclasse una finestra di controllano.  
  
```  
virtual BOOL IsSubclassedControl();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il controllo è una sottoclasse; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 È necessario eseguire l'override di questa funzione e restituire **TRUE** se ha il controllo OLE sottoclassi di un controllo di Windows.  
  
##  <a name="load"></a>  COleControl::Load  
 Reimposta i precedenti dati caricati in modo asincrono e avvia un nuovo caricamento della proprietà asincrona del controllo.  
  
```  
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```  
  
### <a name="parameters"></a>Parametri  
 *strNewPath*  
 Un puntatore a una stringa contenente il percorso che fa riferimento il percorso assoluto della proprietà di controllo asincrono.  
  
 *prop*  
 Un [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) oggetto che implementa una proprietà di controllo asincrono.  
  
##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive  
 Impedisce il contenitore di disattivazione del controllo.  
  
```  
BOOL LockInPlaceActive(BOOL bLock);
```  
  
### <a name="parameters"></a>Parametri  
 *Blocco*  
 **TRUE** se lo stato attivo sul posto del controllo deve essere bloccato. **FALSE** se deve essere sbloccata.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il blocco ha avuto esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Si noti che ogni blocco di controllo deve essere abbinato a un sblocco del controllo al termine. È solo necessario bloccare il controllo del codice per brevi periodi, ad esempio durante la generazione di un evento.  
  
##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange  
 Chiamato dal framework quando una proprietà di ambiente del contenitore è stato modificato valore.  
  
```  
virtual void OnAmbientPropertyChange(DISPID dispid);
```  
  
### <a name="parameters"></a>Parametri  
 *dispID*  
 ID dispatch della proprietà di ambiente che è stata modificata, o **DISPID_UNKNOWN** se più proprietà sono stati modificati.  
  
##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged  
 Chiamato dal framework quando è stato modificato il valore della proprietà Appearance azionario.  
  
```  
virtual void OnAppearanceChanged ();
```  
  
### <a name="remarks"></a>Note  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama `InvalidateControl`.  
  
##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged  
 Chiamato dal framework quando è stato modificato il valore della proprietà BackColor azionario.  
  
```  
virtual void OnBackColorChanged();
```  
  
### <a name="remarks"></a>Note  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama `InvalidateControl`.  
  
##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged  
 Chiamato dal framework quando è stato modificato il valore della proprietà BorderStyle azionario.  
  
```  
virtual void OnBorderStyleChanged();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama `InvalidateControl`.  
  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione.  
  
##  <a name="onclick"></a>  COleControl::OnClick  
 Chiamato dal framework quando ha fatto clic su un pulsante del mouse o è stato richiamato il metodo predefinito DoClick.  
  
```  
virtual void OnClick(USHORT iButton);
```  
  
### <a name="parameters"></a>Parametri  
 *iButton*  
 Indice di un pulsante del mouse. Può avere uno dei valori seguenti:  
  
- **LEFT_BUTTON** è stato scelto il pulsante sinistro del mouse.  
  
- **MIDDLE_BUTTON** è stato fatto clic sul pulsante centrale del mouse.  
  
- **RIGHT_BUTTON** è stato scelto il pulsante destro del mouse.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama `COleControl::FireClick`.  
  
 Eseguire l'override di questa funzione membro per modificare o estendere la gestione predefinita.  
  
##  <a name="onclose"></a>  COleControl::OnClose  
 Chiamato dal framework quando il contenitore è chiamato il controllo **IOleControl:: Close** (funzione).  
  
```  
virtual void OnClose(DWORD dwSaveOption);
```  
  
### <a name="parameters"></a>Parametri  
 *dwSaveOption*  
 Flag che indica se l'oggetto deve essere salvato prima del caricamento. I valori validi sono:  
  
- `OLECLOSE_SAVEIFDIRTY`  
  
- `OLECLOSE_NOSAVE`  
  
- `OLECLOSE_PROMPTSAVE`  
  
### <a name="remarks"></a>Note  
 Per impostazione predefinita `OnClose` Salva l'oggetto di controllo se è stato modificato e *dwSaveOption* può essere `OLECLOSE_SAVEIFDIRTY` o `OLECLOSE_PROMPTSAVE`.  
  
##  <a name="ondoverb"></a>  COleControl::OnDoVerb  
 Chiamato dal framework quando il contenitore chiama il **IOleObject:: DoVerb** funzione membro.  
  
```  
virtual BOOL OnDoVerb(
    LONG iVerb,  
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *iVerb*  
 L'indice del verbo di controllo da richiamare.  
  
 *lpMsg*  
 Un puntatore al messaggio di Windows che ha causato il verbo da richiamare.  
  
 *hWndParent*  
 L'handle della finestra padre del controllo. Se l'esecuzione del verbo crea una finestra (o windows), *hWndParent* deve essere utilizzato come elemento padre.  
  
 *lpRect*  
 Un puntatore a una struttura RECT in cui verranno copiate le coordinate del controllo, in relazione il contenitore.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se chiamata ha esito positivo. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita utilizza il `ON_OLEVERB` e `ON_STDOLEVERB` voci della mappa per determinare la funzione corretta per richiamare messaggi.  
  
 Eseguire l'override di questa funzione per modificare la gestione predefinita di verbo.  
  
##  <a name="ondraw"></a>  COleControl::OnDraw  
 Chiamato dal framework per disegnare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.  
  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rcBounds,  
    const CRect& rcInvalid);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Il contesto di dispositivo in cui si verifica il disegno.  
  
 *rcBounds*  
 L'area rettangolare del controllo, inclusi il bordo.  
  
 *rcInvalid*  
 L'area rettangolare del controllo che non è valido.  
  
### <a name="remarks"></a>Note  
 `OnDraw` in genere viene chiamato per la visualizzazione su schermo, passando un contesto di dispositivo dello schermo come *pDC*. Il *rcBounds* parametro identifica il rettangolo nel contesto di dispositivo di destinazione (rispetto alla relativa modalità di mapping corrente). Il *rcInvalid* parametro sia costituita dal rettangolo effettivo non è valido. In alcuni casi si tratterà un'area più piccola *rcBounds*.  
  
##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile  
 Chiamato dal framework per disegnare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo metafile specificato.  
  
```  
virtual void OnDrawMetafile(
    CDC* pDC,  
    const CRect& rcBounds);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Il contesto di dispositivo in cui si verifica il disegno.  
  
 *rcBounds*  
 L'area rettangolare del controllo, inclusi il bordo.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama la [OnDraw](#ondraw) (funzione).  
  
##  <a name="onedit"></a>  COleControl::OnEdit  
 Fa sì che il controllo sia attivata l'interfaccia utente.  
  
```  
virtual BOOL OnEdit(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *lpMsg*  
 Un puntatore al messaggio di Windows che ha richiamato il verbo.  
  
 *hWndParent*  
 Un handle alla finestra padre del controllo.  
  
 *lpRect*  
 Un puntatore al rettangolo utilizzato dal controllo nel contenitore.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questo è lo stesso effetto di richiamo del controllo `OLEIVERB_UIACTIVATE` verbo.  
  
 Questa funzione viene in genere utilizzata come funzione del gestore per un `ON_OLEVERB` voce della mappa del messaggio. Ciò rende disponibile un verbo "Edit" menu "Oggetto" del controllo. Ad esempio:  
  
 [!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]  
  
##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged  
 Chiamato dal framework quando viene modificato il valore della proprietà Enabled di magazzino.  
  
```  
virtual void OnEnabledChanged();
```  
  
### <a name="remarks"></a>Note  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama [InvalidateControl](#invalidatecontrol).  
  
##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs  
 Chiamato dal framework quando il contenitore chiama il **IOleObject:: EnumVerbs** funzione membro.  
  
```  
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```  
  
### <a name="parameters"></a>Parametri  
 *ppenumOleVerb*  
 Un puntatore per il **IEnumOLEVERB** oggetto che enumera i verbi del controllo.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se i verbi disponibili; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Enumera l'implementazione predefinita di `ON_OLEVERB` le voci della mappa messaggi.  
  
 Eseguire l'override di questa funzione per modificare la modalità predefinita di enumerazione dei verbi.  
  
##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise  
 Chiamato dal framework quando un gestore eventi è connesso o disconnesso da un controllo OLE.  
  
```  
virtual void OnEventAdvise(BOOL bAdvise);
```  
  
### <a name="parameters"></a>Parametri  
 *bAdvise*  
 **TRUE** indica che un gestore eventi è stato connesso al controllo. **FALSE** indica che un gestore eventi è stato disconnesso dal controllo.  
  
##  <a name="onfontchanged"></a>  COleControl::OnFontChanged  
 Chiamato dal framework quando è stato modificato il valore della proprietà del tipo di carattere azionario.  
  
```  
virtual void OnFontChanged();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama `COleControl::InvalidateControl`. Se il controllo Crea una sottoclasse un controllo Windows, l'implementazione predefinita invia anche un **WM_SETFONT** messaggio alla finestra del controllo.  
  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione.  
  
### <a name="example"></a>Esempio  
 [!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]  
  
##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged  
 Chiamato dal framework quando è stato modificato il valore della proprietà ForeColor azionario.  
  
```  
virtual void OnForeColorChanged();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama `InvalidateControl`.  
  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione.  
  
##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents  
 Chiamato dal framework dopo le chiamate di contenitore **IOleControl:: FreezeEvents**.  
  
```  
virtual void OnFreezeEvents(BOOL bFreeze);
```  
  
### <a name="parameters"></a>Parametri  
 *bFreeze*  
 **TRUE** se il controllo della gestione degli eventi è bloccata; in caso contrario **FALSE**.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita non esegue alcuna operazione.  
  
 Eseguire l'override di questa funzione se si desidera un comportamento aggiuntivo quando la gestione degli eventi è bloccato o sbloccato.  
  
##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet  
 Chiamato dal framework quando il contenitore chiama il **IViewObject::GetColorSet** funzione membro.  
  
```  
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,  
    HDC hicTargetDev,  
    LPLOGPALETTE* ppColorSet);
```  
  
### <a name="parameters"></a>Parametri  
 *ptd*  
 Punta al dispositivo di destinazione per cui è necessario eseguire il rendering dell'immagine. Se questo valore è **NULL**, l'immagine deve essere eseguito il rendering per un dispositivo di destinazione predefinito, in genere un dispositivo di visualizzazione.  
  
 *hicTargetDev*  
 Specifica il contesto di informazioni sul dispositivo di destinazione indicato da *ptd*. Questo parametro può essere un contesto di dispositivo, ma non è necessariamente. Se *ptd* viene **NULL**, *hicTargetDev* deve inoltre essere **NULL**.  
  
 *ppColorSet*  
 Un puntatore alla posizione in cui deve essere copiato il set di colori che verrebbe usato. Se la funzione non restituisce il set di colori **NULL** viene restituito.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se viene restituito un set di colore validi. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il contenitore chiama questa funzione per recuperare tutti i colori necessari per disegnare il controllo OLE. Il contenitore può utilizzare i set di colori ottenuti in combinazione con i colori che è necessario impostare la tavolozza dei colori complessiva. L'implementazione predefinita restituisce **FALSE**.  
  
 Eseguire l'override di questa funzione per eseguire qualsiasi elaborazione speciale della richiesta.  
  
##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo  
 Chiamato dal framework quando il contenitore del controllo richiede informazioni sul controllo.  
  
```  
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```  
  
### <a name="parameters"></a>Parametri  
 *pControlInfo*  
 Puntatore a un [CONTROLINFO](http://msdn.microsoft.com/library/windows/desktop/ms680734) struttura deve essere compilato.  
  
### <a name="remarks"></a>Note  
 Queste informazioni è costituita principalmente da una descrizione dei tasti di scelta rapida del controllo. Compila l'implementazione predefinita *pControlInfo* con le informazioni predefinite.  
  
 Eseguire l'override di questa funzione se il controllo deve elaborare tasti di scelta.  
  
##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString  
 Chiamato dal framework per ottenere una stringa che rappresenta il valore corrente della proprietà identificate *dispid*.  
  
```  
virtual BOOL OnGetDisplayString(
    DISPID dispid,  
    CString& strValue);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 L'ID di invio di una proprietà del controllo.  
  
 *StrValue*  
 Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite cui verrà restituita una stringa dell'oggetto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha restituita una stringa *strValue;* in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione se il controllo del codice ha una proprietà il cui valore non può essere convertito direttamente in una stringa e si desidera che il valore della proprietà da visualizzare in un browser fornito dal contenitore proprietà.  
  
##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu  
 Chiamato dal framework quando il controllo dell'interfaccia utente attivata per visualizzare il menu di scelta da unire in menu esistente del contenitore.  
  
```  
virtual HMENU OnGetInPlaceMenu();
```  
  
### <a name="return-value"></a>Valore restituito  
 L'handle del menu del controllo, o **NULL** se il controllo è none. L'implementazione predefinita restituisce **NULL**.  
  
### <a name="remarks"></a>Note  
 Per ulteriori informazioni sull'unione di risorse OLE, vedere l'articolo [menu e risorse (OLE)](../../mfc/menus-and-resources-ole.md).  
  
##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent  
 Chiamato dal framework in risposta a un contenitore **IViewObjectEx::GetNaturalExtent** richiesta.  
  
```  
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```  
  
### <a name="parameters"></a>Parametri  
 *dwAspect*  
 Specifica la modalità con cui l'oggetto deve essere rappresentato. Rappresentazioni di includono il contenuto, un'icona, un'immagine di anteprima o un documento stampato. I valori validi sono tratti dall'enumerazione [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oppure **DVASPECT2**.  
  
 *lindex*  
 La parte dell'oggetto che riveste interesse. Attualmente disponibile solo per -1 è valida.  
  
 *ptd*  
 Punta ai [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) struttura definisce il dispositivo di destinazione per cui restituire le dimensioni dell'oggetto.  
  
 *hicTargetDev*  
 Specifica il contesto di informazioni per il dispositivo di destinazione indicato dal *ptd* parametro dal quale l'oggetto può estrarre metrica del dispositivo e testare le funzionalità del dispositivo. Se *ptd* viene **NULL**, l'oggetto deve ignorare il valore di *hicTargetDev* parametro.  
  
 *pExtentInfo*  
 Punta ai **DVEXTENTINFO** struttura che specifica i dati di ridimensionamento. Il **DVEXTENTINFO** struttura è:  
  
 `typedef struct  tagExtentInfo`  
  
 `{`  
  
 `UINT cb;`  
  
 `DWORD dwExtentMode;`  
  
 `SIZEL sizelProposed;`  
  
 `}   DVEXTENTINFO;`  
  
 Il membro della struttura `dwExtentMode` può assumere uno dei due valori:  
  
- **DVEXTENT_CONTENT** Inquire qual è il controllo deve essere per esattamente adattarle al contenuto (snap di dimensione)  
  
- **DVEXTENT_INTEGRAL** durante il ridimensionamento, passare la dimensione proposta al controllo del codice  
  
 *psizel*  
 Punta al ridimensionamento dei dati restituiti dal controllo. I dati di ridimensionamento restituito sono impostati su -1 per qualsiasi dimensione che non è stata rettificata.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se è stato restituito o regola le dimensioni; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione per restituire le dimensioni dell'oggetto visualizzato più vicino alla modalità di dimensioni e la misura proposta nel **DVEXTENTINFO** struttura. L'implementazione predefinita restituisce **FALSE** e non rende rettifiche alla dimensione.  
  
##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings  
 Chiamato dal framework per ottenere un set di stringhe predefinite che rappresentano i valori possibili per una proprietà.  
  
```  
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,  
    CStringArray* pStringArray,  
    CDWordArray* pCookieArray);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 L'ID di invio di una proprietà del controllo.  
  
 *pStringArray*  
 Una matrice di stringhe in cui inserire in valori restituiti.  
  
 *pCookieArray*  
 Oggetto `DWORD` matrice da riempire con i valori restituiti.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se gli elementi aggiunti alla *pStringArray* e *pCookieArray*.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione se il controllo del codice ha una proprietà con un set di valori possibili che possono essere rappresentati da stringhe. Per ogni elemento aggiunto alla *pStringArray*, è necessario aggiungere un elemento "cookie" corrispondente a *pCookieArray.* Questi valori "cookie" possono essere passati in un secondo momento dal framework per il `COleControl::OnGetPredefinedValue` (funzione).  
  
##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue  
 Chiamato dal framework per ottenere il valore corrispondente a una delle stringhe predefinite restituite in precedenza da un override di `COleControl::OnGetPredefinedStrings`.  
  
```  
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,  
    DWORD dwCookie,  
    VARIANT* lpvarOut);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 L'ID di invio di una proprietà del controllo.  
  
 *dwCookie*  
 Un valore del cookie restituito in precedenza da un override di `COleControl::OnGetPredefinedStrings`.  
  
 *lpvarOut*  
 Puntatore a un **VARIANT** struttura tramite cui verrà restituito un valore della proprietà.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se è stato restituito un valore *lpvarOut*; in caso contrario, 0.  
  
##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent  
 Chiamato dal framework in risposta a un contenitore [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) richiesta.  
  
```  
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```  
  
### <a name="parameters"></a>Parametri  
 *dwDrawAspect*  
 `DWORD` che descrive quale form o aspetto, di un oggetto viene visualizzato. I valori validi sono tratti dall'enumerazione [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oppure **DVASPECT2**.  
  
 *lindex*  
 La parte dell'oggetto che riveste interesse. Attualmente disponibile solo per -1 è valida.  
  
 *ptd*  
 Punta ai [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) struttura definisce il dispositivo di destinazione per cui restituire le dimensioni dell'oggetto.  
  
 *lpsizel*  
 Punta alla posizione in cui vengono restituite le dimensioni dell'oggetto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se le informazioni di extent sono restituite correttamente; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione se il controllo utilizza disegno a due passaggi e le parti opache e trasparente hanno dimensioni diverse.  
  
##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect  
 Chiamato dal framework in risposta a un contenitore **IViewObjectEx::GetRect** richiesta.  
  
```  
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```  
  
### <a name="parameters"></a>Parametri  
 *dwAspect*  
 `DWORD` che descrive quale form o aspetto, di un oggetto viene visualizzato. I valori validi sono tratti dall'enumerazione [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oppure **DVASPECT2**:  
  
- **DVASPECT_CONTENT** rettangolo di delimitazione dell'intero oggetto. Nell'angolo superiore sinistro dell'oggetto origine e dimensioni uguali per l'entità restituita da **GetViewExtent * * *.*  
  
- **DVASPECT_OPAQUE** oggetti con un'area rettangolare opaco restituire il rettangolo. Altri esito negativo.  
  
- **DVASPECT_TRANSPARENT** rettangolo che copre tutte le parti transparent o irregolari.  
  
 *pRect*  
 Punta ai [RECTL](http://msdn.microsoft.com/library/windows/desktop/dd162907) struttura che specifica il rettangolo in cui l'oggetto deve essere disegnato. Questo parametro controlla il posizionamento e l'adattamento dell'oggetto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il rettangolo di dimensioni per l'oggetto viene restituito correttamente; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Le dimensioni dell'oggetto viene convertita da `OnGetViewRect` in un rettangolo a partire dalla posizione specifico (il valore predefinito è l'angolo superiore sinistro dello schermo). Eseguire l'override di questa funzione se il controllo utilizza disegno a due passaggi e le parti opache e trasparente hanno dimensioni diverse.  
  
##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus  
 Chiamato dal framework in risposta a un contenitore **IViewObjectEx::GetViewStatus** richiesta.  
  
```  
virtual DWORD OnGetViewStatus();
```  
  
### <a name="return-value"></a>Valore restituito  
 Uno dei valori del **VIEWSTATUS** enumerazione se l'esito positivo; in caso contrario, 0. I valori possibili sono qualsiasi combinazione delle operazioni seguenti:  
  
 **VIEWSTATUS_OPAQUE**  
 Oggetto è completamente opaco. Se questo bit non è impostato, l'oggetto contiene parti trasparenti. Questo bit viene applicata solo sugli aspetti relativi al contenuto e non al **DVASPECT_ICON** oppure **DVASPECT_DOCPRINT**.  
  
 **VIEWSTATUS_SOLIDBKGND**  
 Oggetto ha uno sfondo a tinta unita (costituita da un colore a tinta unita, non un motivo di riempimento). Questo bit è significativo solo se **VIEWSTATUS_OPAQUE** è impostata e si applica solo a sugli aspetti relativi al contenuto e non ai **DVASPECT_ICON** oppure **DVASPECT_DOCPRINT**.  
  
 **VIEWSTATUS_DVASPECTOPAQUE**  
 Oggetto supporta **DVASPECT_OPAQUE**. Tutti i **IViewObjectEx** i metodi che accettano una caratteristica di disegno, come un parametro può essere chiamato con questo aspetto.  
  
 **VIEWSTATUS_DVASPECTTRANSPARENT**  
 Oggetto supporta **DVASPECT_TRANSPARENT**. Tutti i **IViewObjectEx** i metodi che accettano una caratteristica di disegno, come un parametro può essere chiamato con questo aspetto.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione se il controllo utilizza disegno a due passaggi. L'implementazione predefinita restituisce **VIEWSTATUS_OPAQUE**.  
  
##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars  
 Chiamato dal framework quando il controllo è disattivata l'interfaccia utente.  
  
```  
virtual void OnHideToolBars();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione deve nascondere tutte le barre degli strumenti visualizzate da `OnShowToolbars`.  
  
##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove  
 Chiamato dal contenitore per l'oggetto sotto il puntatore del mouse al momento della ricezione di un messaggio WM_MOUSEMOVE inattiva.  
  
```  
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```  
  
### <a name="parameters"></a>Parametri  
 *lprcBounds*  
 L'oggetto di delimitazione rettangolo, nelle coordinate client della finestra contenitore. Indica l'oggetto la posizione esatta e le dimensioni dello schermo quando è stato ricevuto il messaggio WM_MOUSEMOVE.  
  
 *x*  
 La coordinata x della posizione del mouse in coordinate client della finestra contenitore.  
  
 *y*  
 La coordinata y della posizione del mouse in coordinate client della finestra contenitore.  
  
 *dwKeyState*  
 Identifica lo stato corrente dei tasti di modifica della tastiera sulla tastiera. I valori validi possono essere una combinazione di uno o più flag **MK_CONTROL**, **MK_SHIFT**, **MK_ALT**, **MK_BUTTON**, **MK_ LBUTTON**, **MK_MBUTTON**, e **MK_RBUTTON**.  
  
### <a name="remarks"></a>Note  
 Si noti che nelle coordinate client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Ciò viene realizzato, anche passando il rettangolo di delimitazione dell'oggetto nello stesso sistema di coordinate.  
  
##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor  
 Chiamato dal contenitore per l'oggetto sotto il puntatore del mouse al momento della ricezione di un messaggio WM_SETCURSOR inattiva.  
  
```  
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```  
  
### <a name="parameters"></a>Parametri  
 *lprcBounds*  
 L'oggetto di delimitazione rettangolo, nelle coordinate client della finestra contenitore. Indica l'oggetto la posizione esatta e le dimensioni dello schermo quando è stato ricevuto il messaggio WM_SETCURSOR.  
  
 *x*  
 La coordinata x della posizione del mouse in coordinate client della finestra contenitore.  
  
 *y*  
 La coordinata y della posizione del mouse in coordinate client della finestra contenitore.  
  
 *dwMouseMsg*  
 L'identificatore del messaggio del mouse per il quale si è verificato un messaggio WM_SETCURSOR.  
  
 *bSetAlways*  
 Specifica se l'oggetto deve impostare il cursore. Se **TRUE**, l'oggetto deve impostare il cursore; se **FALSE**, il cursore non è obbligato a impostare il cursore e deve restituire **S_FALSE** in questo caso.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Si noti che nelle coordinate client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Ciò viene realizzato, anche passando il rettangolo di delimitazione dell'oggetto nello stesso sistema di coordinate.  
  
##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent  
 Chiamato dal framework dopo l'elaborazione di un evento KeyDown predefinito.  
  
```  
virtual void OnKeyDownEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parametri  
 *nChar*  
 Il codice tasto virtuale valore il tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
### <a name="remarks"></a>Note  
 Se il controllo deve accedere alle informazioni chiave dopo l'evento è stata attivata l'override della funzione.  
  
##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent  
 Chiamato dal framework dopo stock KeyPress (evento) è stata attivata.  
  
```  
virtual void OnKeyPressEvent(USHORT nChar);
```  
  
### <a name="parameters"></a>Parametri  
 *nChar*  
 Contiene il valore di codice tasto virtuale il tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h  
  
### <a name="remarks"></a>Note  
 Si noti che il *nChar* valore potrebbe essere stato modificato dal contenitore.  
  
 Se si vuole notifica dopo questo evento si verifica l'override della funzione.  
  
##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent  
 Chiamato dal framework dopo l'elaborazione di un evento KeyDown predefinito.  
  
```  
virtual void OnKeyUpEvent(
    USHORT nChar,  
    USHORT nShiftState);
```  
  
### <a name="parameters"></a>Parametri  
 *nChar*  
 Il codice tasto virtuale valore il tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h  
  
 *nShiftState*  
 Contiene una combinazione dei flag seguenti:  
  
- **SHIFT_MASK** durante l'azione è stato premuto il tasto MAIUSC.  
  
- **CTRL_MASK** è stato premuto CTRL il tasto durante l'azione.  
  
- **ALT_MASK** ALT il tasto è stato premuto durante l'azione.  
  
### <a name="remarks"></a>Note  
 Se il controllo deve accedere alle informazioni chiave dopo l'evento è stata attivata l'override della funzione.  
  
##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage  
 Chiamato dal framework per ottenere l'ID di classe di una pagina delle proprietà che implementa la modifica della proprietà specificata.  
  
```  
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,  
    LPCLSID lpclsid,  
    BOOL* pbPageOptional);
```  
  
### <a name="parameters"></a>Parametri  
 *DISPID*  
 L'ID di invio di una proprietà del controllo.  
  
 *lpclsid*  
 Puntatore a un **CLSID** struttura tramite cui verrà restituito un ID di classe.  
  
 *pbPageOptional*  
 Restituisce un indicatore di fatto l'utilizzo della pagina delle proprietà specificata è facoltativo.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha restituito un ID di classe *lpclsid*; in caso contrario, 0.  
  
### <a name="remarks"></a>Note  
 Eseguire l'override di questa funzione per fornire un modo per richiamare le pagine delle proprietà del controllo da Visualizzatore di proprietà del contenitore.  
  
##  <a name="onmnemonic"></a>  COleControl::OnMnemonic  
 Chiamato dal framework quando il contenitore ha rilevato che è stato premuto un tasto mnemonico del controllo OLE.  
  
```  
virtual void OnMnemonic(LPMSG pMsg);
```  
  
### <a name="parameters"></a>Parametri  
 *pMsg*  
 Puntatore al messaggio di Windows generato dalla pressione di un tasto mnemonico.  
  
##  <a name="onproperties"></a>  COleControl::OnProperties  
 Chiamato dal framework quando il verbo di proprietà del controllo è stato richiamato dal contenitore.  
  
```  
virtual BOOL OnProperties(
    LPMSG lpMsg,  
    HWND hWndParent,  
    LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *lpMsg*  
 Un puntatore al messaggio di Windows che ha richiamato il verbo.  
  
 *hWndParent*  
 Un handle alla finestra padre del controllo.  
  
 *lpRect*  
 Un puntatore al rettangolo utilizzato dal controllo nel contenitore.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita consente di visualizzare una finestra di dialogo delle proprietà modale.  
  
 È anche possibile utilizzare questa funzione per la visualizzazione delle pagine delle proprietà del controllo. Effettuare una chiamata ai `OnProperties` funzione, passando l'handle dell'elemento padre del controllo nel *hWndParent* parametro. In questo caso, i valori del *lpMsg* e *lpRect* i parametri vengono ignorati.  
  
##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint  
 Chiamato dal framework in risposta a un contenitore **IViewObjectEx::QueryHitPoint** richiesta.  
  
```  
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parametri  
 *dwAspect*  
 Specifica la modalità con cui l'oggetto è rappresentato. I valori validi sono tratti dall'enumerazione [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oppure **DVASPECT2**.  
  
 *pRectBounds*  
 Puntatore a un `RECT` struttura che specifica il rettangolo di delimitazione dell'area client di controllo OLE.  
  
 *ptlLoc*  
 Puntatore ai **punto** struttura che specifica il punto da sottoporre a hit. Il punto viene specificato nelle coordinate dell'area client OLE.  
  
 *lCloseHint*  
 La distanza che definisce "Chiudi" per il punto di ricercare un riscontro.  
  
 *pHitResult*  
 Puntatore al risultato della query hit. Uno dei valori seguenti:  
  
- **HITRESULT_OUTSIDE** `ptlLoc` è di fuori di OLE dell'oggetto e non chiusa.  
  
- **HITRESULT_TRANSPARENT** *ptlLoc* è entro i limiti dell'oggetto OLE, ma non vicino l'immagine. Ad esempio, potrebbe essere un punto all'interno di un cerchio trasparente **HITRESULT_TRANSPARENT**.  
  
- **HITRESULT_CLOSE** `ptlLoc` rientri o meno l'oggetto OLE ma abbastanza vicino all'oggetto da valutare all'interno. Oggetti piccoli, thin o dettagliati possono utilizzare questo valore. Anche se un punto è esterna al riquadro il rettangolo di un oggetto può ancora essere Chiudi (necessarie per il raggiungimento di oggetti di piccole dimensioni).  
  
- **HITRESULT_HIT** `ptlLoc` è all'interno dell'immagine dell'oggetto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se correttamente viene restituito un risultato dall'hit; in caso contrario 0. Un numero di passaggi è un periodo pianificato si sovrappongono con l'area di visualizzazione del controllo OLE.  
  
### <a name="remarks"></a>Note  
 Esegue una query se il punto specificato si sovrappone a rettangolo di visualizzazione dell'oggetto (raggiunge il punto). `QueryHitPoint` può essere sottoposto a override per testare riscontri per gli oggetti non rettangolari.  
  
##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect  
 Chiamato dal framework in risposta a un contenitore **IViewObjectEx::QueryHitRect** richiesta.  
  
```  
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,  
    LPCRECT pRectBounds,  
    LPCRECT prcLoc,  
    LONG lCloseHint,  
    DWORD* pHitResult);
```  
  
### <a name="parameters"></a>Parametri  
 *dwAspect*  
 Specifica la modalità con cui l'oggetto deve essere rappresentato. I valori validi sono tratti dall'enumerazione [DVASPECT](http://msdn.microsoft.com/library/windows/desktop/ms690318) oppure **DVASPECT2**.  
  
 *pRectBounds*  
 Puntatore a un `RECT` struttura che specifica il rettangolo di delimitazione dell'area client di controllo OLE.  
  
 *prcLoc*  
 Puntatore al `RECT` struttura che specifica il rettangolo da sottoporre a hit (periodo pianificato si sovrappongono con il rettangolo di oggetto), rispetto all'angolo superiore sinistro dell'oggetto.  
  
 *lCloseHint*  
 Non usato.  
  
 *pHitResult*  
 Puntatore al risultato della query hit. Uno dei valori seguenti:  
  
- **HITRESULT_OUTSIDE** alcun punto quando il rettangolo non viene raggiunto dall'oggetto OLE.  
  
- **HITRESULT_HIT** almeno un punto nel rettangolo sarebbe un riscontro sull'oggetto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se correttamente viene restituito un risultato dall'hit; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Esegue una query se il rettangolo di visualizzazione di un oggetto si sovrappone a un punto qualsiasi del rettangolo specificato (raggiunge il rettangolo). `QueryHitRect` può essere sottoposto a override per testare riscontri per gli oggetti non rettangolari.  
  
##  <a name="onrenderdata"></a>  COleControl::OnRenderData  
 Chiamato dal framework per recuperare i dati nel formato specificato.  
  
```  
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,  
    LPSTGMEDIUM lpStgMedium);
```  
  
### <a name="parameters"></a>Parametri  
 *lpFormatEtc*  
 Punta ai [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura che specifica il formato in cui vengono richieste informazioni.  
  
 *lpStgMedium*  
 Punta a un [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) struttura in cui i dati da restituire.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il formato specificato è inserito in precedenza nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) oppure [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) le funzioni membro per rendering ritardati. L'implementazione predefinita di questa funzione chiama `OnRenderFileData` o `OnRenderGlobalData`, rispettivamente, se il supporto di archiviazione fornito è un file o memoria. Se il formato richiesto è `CF_METAFILEPICT` o formato di impostare la proprietà permanente, l'implementazione predefinita esegue il rendering dei dati appropriati e restituisce diverso da zero. In caso contrario, restituisce 0 e non esegue alcuna operazione.  
  
 Se *lpStgMedium -> tymed* viene **TYMED_NULL**, il **STGMEDIUM** deve essere allocata e compilato come specificato da *lpFormatEtc -> tymed*. In caso contrario **TYMED_NULL**, la **STGMEDIUM** deve essere compilato con i dati.  
  
 Eseguire l'override di questa funzione per fornire i dati nel formato richiesto e supporto. A seconda dei dati, è possibile eseguire l'override in una delle altre versioni di questa funzione invece. Se i dati sono piccole e ha dimensione fissa, eseguire l'override `OnRenderGlobalData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.  
  
 Per altre informazioni, vedere la **FORMATETC** e **STGMEDIUM** strutture in Windows SDK.  
  
##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData  
 Chiamato dal framework per recuperare i dati nel formato specificato quando il supporto di archiviazione è un file.  
  
```  
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,  
    CFile* pFile);
```  
  
### <a name="parameters"></a>Parametri  
 *lpFormatEtc*  
 Punta ai [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura che specifica il formato in cui vengono richieste informazioni.  
  
 *pFile*  
 Punta a un [CFile](../../mfc/reference/cfile-class.md) oggetto in cui i dati da sottoporre a rendering.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il formato specificato è inserito in precedenza nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funzione membro per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce semplicemente **FALSE**.  
  
 Eseguire l'override di questa funzione per fornire i dati nel formato richiesto e supporto. A seconda dei dati, è possibile eseguire l'override in una delle altre versioni di questa funzione invece. Se si desidera gestire più supporti di archiviazione, eseguire l'override `OnRenderData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.  
  
 Per altre informazioni, vedere la **FORMATETC** struttura in Windows SDK.  
  
##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData  
 Chiamato dal framework per recuperare i dati nel formato specificato quando il supporto di archiviazione specificato è la memoria globale.  
  
```  
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,  
    HGLOBAL* phGlobal);
```  
  
### <a name="parameters"></a>Parametri  
 *lpFormatEtc*  
 Punta ai [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura che specifica il formato in cui vengono richieste informazioni.  
  
 *phGlobal*  
 Punta a un handle per la memoria globale in cui i dati sono da restituire. Se non è stata allocata alcuna memoria, questo parametro può essere **NULL**.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il formato specificato è inserito in precedenza nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funzione membro per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce semplicemente **FALSE**.  
  
 Se *phGlobal* viene **NULL**, quindi un nuovo `HGLOBAL` deve essere allocata e restituita *phGlobal*. In caso contrario, il `HGLOBAL` specificato da *phGlobal* deve essere riempito con i dati. La quantità di dati inseriti nella `HGLOBAL` non deve superare le dimensioni correnti del blocco di memoria. Inoltre, il blocco non può essere riallocato a una dimensione maggiore.  
  
 Eseguire l'override di questa funzione per fornire i dati nel formato richiesto e supporto. A seconda dei dati, è possibile eseguire l'override in una delle altre versioni di questa funzione invece. Se si desidera gestire più supporti di archiviazione, eseguire l'override `OnRenderData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.  
  
 Per altre informazioni, vedere la **FORMATETC** struttura in Windows SDK.  
  
##  <a name="onresetstate"></a>  COleControl::OnResetState  
 Chiamato dal framework quando le proprietà del controllo devono essere impostate su valori predefiniti.  
  
```  
virtual void OnResetState();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama [DoPropExchange](#dopropexchange), passando un `CPropExchange` oggetto che fa sì che le proprietà da impostare sui valori predefiniti.  
  
 Il writer di controllo è possibile inserire il codice di inizializzazione per il controllo OLE in questo sottoponibile a override. Questa funzione viene chiamata quando [IPersistStream:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680568) oppure [IPersistStorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) non riesce, o [IPersistStreamInit::InitNew](http://msdn.microsoft.com/library/windows/desktop/ms690234) o [IPersistStorage: : InitNew](http://msdn.microsoft.com/library/windows/desktop/ms687194) viene chiamato, senza prima una chiamata a **IPersistStream:: Load** o **IPersistStorage:: Load**.  
  
##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite  
 Chiamato dal framework quando il contenitore è chiamato il controllo **IOleControl::SetClientSite** (funzione).  
  
```  
virtual void OnSetClientSite();
```  
  
### <a name="remarks"></a>Note  
 Per impostazione predefinita `OnSetClientSite` controlla se le proprietà del percorso dati vengono caricate e, in caso affermativo, chiama `DoDataPathPropExchange`.  
  
 Eseguire l'override di questa funzione per eseguire qualsiasi elaborazione speciale della notifica. In particolare, le sostituzioni di questa funzione devono chiamare la classe di base.  
  
##  <a name="onsetdata"></a>  COleControl::OnSetData  
 Chiamato dal framework per sostituire i dati del controllo con i dati specificati.  
  
```  
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```  
  
### <a name="parameters"></a>Parametri  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura che specifica il formato dei dati.  
  
 *lpStgMedium*  
 Puntatore a un [STGMEDIUM](http://msdn.microsoft.com/library/windows/desktop/ms683812) struttura in cui risiedono i dati.  
  
 *bRelease*  
 **TRUE** se il controllo deve liberare il supporto di archiviazione; **FALSE** se il controllo non deve liberare il supporto di archiviazione.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se i dati sono impostati nella proprietà permanente formato, l'implementazione predefinita modifica di conseguenza lo stato del controllo. In caso contrario, l'implementazione predefinita non esegue alcuna operazione. Se *bRelease* viene **TRUE**, quindi una chiamata a **ReleaseStgMedium** viene eseguita; in caso contrario non.  
  
 Eseguire l'override di questa funzione per sostituire i dati del controllo con i dati specificati.  
  
 Per altre informazioni, vedere la **FORMATETC** e **STGMEDIUM** strutture in Windows SDK.  
  
##  <a name="onsetextent"></a>  COleControl::OnSetExtent  
 Chiamato dal framework quando l'estensione del controllo deve essere modificato, in seguito a una chiamata a [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330).  
  
```  
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```  
  
### <a name="parameters"></a>Parametri  
 *lpSizeL*  
 Un puntatore per il **SIZEL** struttura che utilizza valori long integer per rappresentare la larghezza e altezza del controllo, espresso in **HIMETRIC** unità.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la modifica delle dimensioni è stata accettata. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita gestisce il ridimensionamento dell'estensione del controllo. Se il controllo è attivo sul posto, una chiamata al contenitore **OnPosRectChanged** viene quindi effettuato.  
  
 Eseguire l'override di questa funzione per modificare il ridimensionamento predefinito del controllo.  
  
##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects  
 Chiamato dal framework per implementare una chiamata a [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767).  
  
```  
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,  
    LPCRECT lpRectClip);
```  
  
### <a name="parameters"></a>Parametri  
 *lpRectPos*  
 Puntatore a una struttura RECT indicando nuova posizione e le dimensioni relative al contenitore del controllo.  
  
 *lpRectClip*  
 Un puntatore a un `RECT` struttura che indica un'area rettangolare in cui il controllo è ridotto.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il riposizionamento è stato accettato. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita restituisce e gestisce il riposizionamento e ridimensionamento della finestra del controllo automaticamente **TRUE**.  
  
 Eseguire l'override di questa funzione per modificare il comportamento predefinito di questa funzione.  
  
##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars  
 Chiamato dal framework quando il controllo è stata attivata l'interfaccia utente.  
  
```  
virtual void OnShowToolBars();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita non esegue alcuna operazione.  
  
##  <a name="ontextchanged"></a>  COleControl::OnTextChanged  
 Chiamato dal framework quando il valore della proprietà azionario didascalia o il testo è stato modificato.  
  
```  
virtual void OnTextChanged();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama `InvalidateControl`.  
  
 Se si desidera notifica dopo questa proprietà viene modificata l'override della funzione.  
  
##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage  
 Chiamato dal framework in risposta a un contenitore **IOleInPlaceObjectWindowless::OnWindowMessage** richiesta.  
  
```  
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```  
  
### <a name="parameters"></a>Parametri  
 *msg*  
 Identificatore del messaggio come superato da Windows.  
  
 *wParam*  
 Valore passato da Windows. Specifica informazioni aggiuntive specifiche di messaggio. Il contenuto di questo parametro dipende dal valore della *msg* parametro.  
  
 *lParam*  
 Valore passato da Windows. Specifica informazioni aggiuntive specifiche di messaggio. Il contenuto di questo parametro dipende dal valore della *msg* parametro.  
  
 *plResult*  
 Codice restituito da Windows. Specifica il risultato dell'elaborazione del messaggio e dipende dal messaggio inviato.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Elabora i messaggi della finestra per i controlli privi di finestra. `COleControl`del `OnWindowlessMessage` deve essere utilizzato per i messaggi della finestra diverso da messaggi di mouse e tastiera. `COleControl` fornisce [SetCapture](#setcapture) e [SetFocus](#setfocus) in particolare per ottenere lo stato attivo della tastiera e acquisizione del mouse per gli oggetti OLE privi di finestra.  
  
 Perché gli oggetti senza finestra non dispone di una finestra, sono necessario un meccanismo per consentire i messaggi di invio contenitore ad essi. Un oggetto OLE privi di finestra riceve i messaggi da relativo contenitore, tramite il `OnWindowMessage` metodo sul `IOleInPlaceObjectWindowless` interfaccia (un'estensione del [IOleInPlaceObject](http://msdn.microsoft.com/library/windows/desktop/ms692646) per il supporto privi di finestra). `OnWindowMessage` non accetta un `HWND` parametro.  
  
##  <a name="parenttoclient"></a>  COleControl::ParentToClient  
 Converte le coordinate del *PowerPoint* nelle coordinate client.  
  
```  
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *lprcBounds*  
 Puntatore ai limiti del controllo OLE all'interno del contenitore. L'area del controllo intera, compresi i bordi e le barre di scorrimento, ma non l'area client.  
  
 *PowerPoint*  
 Puntatore all'elemento padre (contenitore) puntare a essere convertite nelle coordinate dell'area client del controllo.  
  
 *bHitTest*  
 Specifica se è o meno gli hit test da eseguire nel punto di.  
  
### <a name="return-value"></a>Valore restituito  
 Se *bHitTest* viene **FALSE**, restituisce **HTNOWHERE**. Se *bHitTest* viene **TRUE**, restituisce la posizione in cui scegliere l'elemento padre (contenitore) ottenuto nell'area client del controllo OLE e fa parte del puntatore del mouse seguenti valori di hit test:  
  
- **HTBORDER** sul bordo di una finestra che non dispone di un bordo di ridimensionamento.  
  
- **HTBOTTOM** sul bordo orizzontale inferiore della finestra.  
  
- **HTBOTTOMLEFT** nell'angolo in basso a sinistra del bordo della finestra.  
  
- **HTBOTTOMRIGHT** nell'angolo in basso a destra del bordo della finestra.  
  
- **HTCAPTION** In un'area della barra del titolo.  
  
- **HTCLIENT** In un'area client.  
  
- **HTERROR** sullo sfondo della schermata o in una linea di separazione tra windows (uguale a **HTNOWHERE** ad eccezione del fatto che il **DefWndProc** funzione Windows produce un segnale acustico di sistema per indicare un errore).  
  
- **HTGROWBOX** In una finestra di dimensioni.  
  
- **HTHSCROLL** nella barra di scorrimento orizzontale.  
  
- **HTLEFT** sul bordo sinistro della finestra.  
  
- **HTMAXBUTTON** pulsante In un ottimizzare.  
  
- **HTMENU** In un'area del menu.  
  
- **HTMINBUTTON** pulsante In un ridurre al minimo.  
  
- **HTNOWHERE** sullo sfondo della schermata o in una linea di separazione tra le finestre.  
  
- **HTREDUCE** pulsante In un ridurre al minimo.  
  
- **HTRIGHT** sul bordo destro della finestra.  
  
- **HTSIZE** In una finestra di dimensione (uguale a **HTGROWBOX**).  
  
- **HTSYSMENU** In un menu di controllo o in un pulsante Chiudi in una finestra figlio.  
  
- **HTTOP** sul bordo orizzontale superiore della finestra.  
  
- **HTTOPLEFT** nell'angolo superiore sinistro del bordo della finestra.  
  
- **HTTOPRIGHT** nell'angolo superiore destro del bordo della finestra.  
  
- **HTTRANSPARENT** In una finestra attualmente coperta da un'altra finestra.  
  
- **HTVSCROLL** nella barra di scorrimento verticale.  
  
- **HTZOOM** pulsante In un ottimizzare.  
  
### <a name="remarks"></a>Note  
 Nell'input *PowerPoint* è correlato all'origine dell'elemento padre (angolo superiore sinistro del contenitore). Nell'output *PowerPoint* è correlato all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo).  
  
##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog  
 Notifica al contenitore che è stata chiusa una finestra di dialogo modale.  
  
```  
void PostModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *hWndParent*  
 Handle alla finestra padre della finestra di dialogo modale.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione dopo la visualizzazione di qualsiasi finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore può attivare eventuali finestre di primo livello disabilitate per `PreModalDialog`. Questa funzione deve essere abbinata a una chiamata a `PreModalDialog`.  
  
##  <a name="premodaldialog"></a>  COleControl::PreModalDialog  
 Notifica al contenitore che sta per essere visualizzata una finestra di dialogo modale.  
  
```  
void PreModalDialog(HWND hWndParent = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *hWndParent*  
 Handle alla finestra padre della finestra di dialogo modale.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione prima di visualizzare qualsiasi finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore è possibile disabilitare tutte le relative finestre di primo livello. Dopo che è stato visualizzato nella finestra di dialogo modale, è necessario chiamare `PostModalDialog`.  
  
##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow  
 Elimina e ricrea la finestra del controllo.  
  
```  
void RecreateControlWindow();
```  
  
### <a name="remarks"></a>Note  
 Ciò potrebbe essere necessario se è necessario modificare i bit di stile della finestra.  
  
##  <a name="refresh"></a>  COleControl::Refresh  
 Impone un aggiornamento del controllo OLE.  
  
```  
void Refresh();
```  
  
### <a name="remarks"></a>Note  
 Questa funzione è supportata per il `COleControl` classe di base come metodo azionario, chiamato di aggiornamento. Ciò consente agli utenti del controllo OLE ridisegnare il controllo in un momento specifico. Per ulteriori informazioni su questo metodo, vedere l'articolo [controlli ActiveX: metodi](../../mfc/mfc-activex-controls-methods.md).  
  
##  <a name="releasecapture"></a>  COleControl::ReleaseCapture  
 Rilascia lo stato mouse capture.  
  
```  
BOOL ReleaseCapture();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se il controllo ha attualmente lo stato mouse capture, viene rilasciato l'acquisizione. In caso contrario, questa funzione non ha effetto.  
  
##  <a name="releasedc"></a>  COleControl::ReleaseDC  
 Rilascia il contesto di dispositivo di visualizzazione di un contenitore di un controllo senza finestra, liberando il contesto di dispositivo per l'uso da altre applicazioni.  
  
```  
int ReleaseDC(CDC* pDC);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Identifica il contesto di dispositivo contenitore da rilasciare.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'applicazione deve chiamare `ReleaseDC` per ogni chiamata a [GetDC](#getdc).  
  
##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow  
 Imposta l'elemento padre del controllo.  
  
```  
virtual void ReparentControlWindow(
    HWND hWndOuter,  
    HWND hWndParent);
```  
  
### <a name="parameters"></a>Parametri  
 *hWndOuter*  
 L'handle della finestra del controllo.  
  
 *hWndParent*  
 Handle della nuova finestra padre.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione per reimpostare l'elemento padre della finestra del controllo.  
  
##  <a name="resetstockprops"></a>  COleControl::ResetStockProps  
 Inizializza lo stato del `COleControl` proprietà sui rispettivi valori predefiniti predefinite.  
  
```  
void ResetStockProps();
```  
  
### <a name="remarks"></a>Note  
 Le proprietà sono: l'aspetto, BackColor, BorderStyle, didascalia, Enabled, carattere, colore di primo piano, hWnd e testo. Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 Per migliorare le prestazioni di inizializzazione binario di un controllo utilizzando `ResetStockProps` e `ResetVersion` per eseguire l'override `COleControl::OnResetState`. Vedere l'esempio seguente. Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Esempio  
 [!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]  
  
##  <a name="resetversion"></a>  COleControl::ResetVersion  
 Inizializza il numero di versione al valore specificato.  
  
```  
void ResetVersion(DWORD dwVersionDefault);
```  
  
### <a name="parameters"></a>Parametri  
 *dwVersionDefault*  
 Il numero di versione da assegnare al controllo.  
  
### <a name="remarks"></a>Note  
 Per migliorare le prestazioni di inizializzazione binario di un controllo utilizzando `ResetVersion` e `ResetStockProps` per eseguire l'override `COleControl::OnResetState`. Vedere l'esempio nella [ResetStockProps](#resetstockprops). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="scrollwindow"></a>  COleControl::ScrollWindow  
 Consente a un oggetto OLE privi di finestra scorrere un'area all'interno di propria immagine attivo sul posto sullo schermo.  
  
```  
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *xAmount*  
 Specifica la quantità, in unità di dispositivo di scorrimento orizzontale. Questo parametro deve essere un valore negativo a scorrimento a sinistra.  
  
 *yAmount*  
 Specifica la quantità, in unità di dispositivo di scorrimento verticale. Questo parametro deve essere un valore negativo per scorrere verso l'alto.  
  
 *lpRect*  
 Punta a un [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o RECT (struttura) che specifica la parte dell'area client dell'oggetto OLE lo scorrimento, nelle coordinate client della finestra contenitore. Se *lpRect* viene **NULL**, è necessario scorrere area client dell'intero oggetto OLE.  
  
 *lpClipRect*  
 Punta a un `CRect` oggetto o `RECT` struttura che specifica il rettangolo di ritaglio per. Solo i pixel all'interno del rettangolo vengono scorsi. BITS all'esterno del rettangolo non subiscono alcun anche se sono presenti il *lpRect* rettangolo. Se *lpClipRect* viene **NULL**, non viene eseguito Nessuna ritaglio sul rettangolo scorrimento.  
  
##  <a name="selectfontobject"></a>  COleControl::SelectFontObject  
 Seleziona un tipo di carattere in un contesto di dispositivo.  
  
```  
CFont* SelectFontObject(
    CDC* pDC,  
    CFontHolder& fontHolder);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Puntatore a un oggetto di contesto di dispositivo.  
  
 *fontHolder*  
 Riferimento per il [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto che rappresenta il tipo di carattere da selezionare.  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore al tipo di carattere selezionato in precedenza. Quando il chiamante ha completato tutte le operazioni di disegno che utilizzano *fontHolder,* è necessario riselezionare il carattere selezionato in precedenza passandolo come parametro a [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).  
  
##  <a name="selectstockfont"></a>  COleControl::SelectStockFont  
 Seleziona la proprietà predefinita in un contesto di dispositivo.  
  
```  
CFont* SelectStockFont(CDC* pDC);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Il contesto di dispositivo in cui verrà selezionato il tipo di carattere.  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore a selezionato in precedenza `CFont` oggetto. È consigliabile utilizzare [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) per selezionare il tipo di carattere nel contesto di dispositivo al termine.  
  
##  <a name="serializeextent"></a>  COleControl::SerializeExtent  
 Serializza o Inizializza lo stato dello spazio di visualizzazione assegnato al controllo.  
  
```  
void SerializeExtent(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametri  
 *ar*  
 Oggetto `CArchive` oggetto da serializzare in o da.  
  
### <a name="remarks"></a>Note  
 È possibile migliorare le prestazioni della persistenza binaria di un controllo utilizzando `SerializeExtent`, `SerializeStockProps`, e `SerializeVersion` per eseguire l'override `COleControl::Serialize`. Vedere l'esempio seguente. Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
### <a name="example"></a>Esempio  
 [!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]  
  
##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps  
 Serializza o Inizializza lo stato del `COleControl` proprietà predefinite: aspetto, BackColor, BorderStyle, didascalia, Enabled, del tipo di carattere, colore di primo piano e testo.  
  
```  
void SerializeStockProps(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametri  
 *ar*  
 Oggetto `CArchive` oggetto da serializzare in o da.  
  
### <a name="remarks"></a>Note  
 Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).  
  
 È possibile migliorare le prestazioni della persistenza binaria di un controllo utilizzando `SerializeStockProps`, `SerializeExtent`, e `SerializeVersion` per eseguire l'override `COleControl::Serialize`. Per un esempio, vedere il codice in [SerializeExtent](#serializeextent). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="serializeversion"></a>  COleControl::SerializeVersion  
 Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.  
  
```  
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *ar*  
 Oggetto `CArchive` oggetto da serializzare in o da.  
  
 *dwVersionDefault*  
 Il numero di versione corrente del controllo.  
  
 *bConvert*  
 Indica se i dati persistenti devono essere convertiti nel formato più recente quando è stato salvato o gestito nello stesso formato che presentava al momento del caricamento.  
  
### <a name="return-value"></a>Valore restituito  
 Il numero di versione del controllo. Se l'archivio specificato viene caricato, `SerializeVersion` restituisce la versione caricata da tale archivio. In caso contrario, restituisce la versione attualmente caricata.  
  
### <a name="remarks"></a>Note  
 È possibile migliorare le prestazioni della persistenza binaria di un controllo utilizzando `SerializeVersion`, `SerializeExtent`, e `SerializeStockProps` per eseguire l'override `COleControl::Serialize`. Per un esempio, vedere il codice in [SerializeExtent](#serializeextent). Per ulteriori informazioni sull'ottimizzazione dell'inizializzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).  
  
##  <a name="setappearance"></a>  COleControl::SetAppearance  
 Imposta il valore di proprietà predefinito di aspetto del controllo.  
  
```  
void SetAppearance (short sAppearance);
```  
  
### <a name="parameters"></a>Parametri  
 *sAppearance*  
 Un **breve** ( `VT_I2`) valore da utilizzare per l'aspetto del controllo. Un valore pari a zero imposta l'aspetto del controllo su flat e un valore pari a 1 imposta l'aspetto del controllo in 3D.  
  
### <a name="remarks"></a>Note  
 Per ulteriori informazioni sulle proprietà predefinite, vedere [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setbackcolor"></a>  COleControl::SetBackColor  
 Imposta il valore della proprietà BackColor predefinito del controllo.  
  
```  
void SetBackColor(OLE_COLOR dwBackColor);
```  
  
### <a name="parameters"></a>Parametri  
 *dwBackColor*  
 Un' **OLE_COLOR** valore da utilizzare per lo sfondo di disegno del controllo.  
  
### <a name="remarks"></a>Note  
 Per ulteriori informazioni sull'uso di questa proprietà e relative proprietà, vedere l'articolo [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle  
 Imposta il valore della proprietà BorderStyle predefinito del controllo.  
  
```  
void SetBorderStyle(short sBorderStyle);
```  
  
### <a name="parameters"></a>Parametri  
 *sBorderStyle*  
 Il nuovo stile del bordo per il controllo. 0 non indica nessun bordo mentre 1 indica un bordo normale.  
  
### <a name="remarks"></a>Note  
 La finestra di controllo quindi verrà ricreata e `OnBorderStyleChanged` chiamato.  
  
##  <a name="setcapture"></a>  COleControl::SetCapture  
 Fa sì che la finestra del controllo contenitore di prendere possesso dell'acquisizione del mouse per conto del controllo.  
  
```  
CWnd* SetCapture();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore per il **CWnd** oggetto window che in precedenza ha ricevuto un input del mouse.  
  
### <a name="remarks"></a>Note  
 Se il controllo è attivato e privi di finestra, questa funzione provoca la finestra del controllo contenitore da intraprendere possiede lo stato mouse capture, per conto del controllo. In caso contrario, questa funzione provoca il controllo di prendere possesso dell'acquisizione del mouse (uguale a `CWnd::SetCapture`).  
  
##  <a name="setcontrolsize"></a>  COleControl::SetControlSize  
 Imposta le dimensioni della finestra del controllo OLE e notifica il contenitore in cui il sito del controllo in fase di modifica.  
  
```  
BOOL SetControlSize(int cx, int cy);
```  
  
### <a name="parameters"></a>Parametri  
 *CX*  
 Specifica la nuova larghezza del controllo in pixel.  
  
 *CY*  
 Specifica la nuova altezza del controllo in pixel.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione non deve essere usata nel costruttore del controllo.  
  
 Si noti che tutte le coordinate per finestre di controllo sono rispetto all'angolo superiore sinistro del controllo.  
  
##  <a name="setenabled"></a>  COleControl::SetEnabled  
 Imposta il valore della proprietà Enabled del controllo di azioni.  
  
```  
void SetEnabled(BOOL bEnabled);
```  
  
### <a name="parameters"></a>Parametri  
 *bEnabled*  
 **TRUE** se il controllo è abilitata; in caso contrario **FALSE**.  
  
### <a name="remarks"></a>Note  
 Dopo aver impostato questa proprietà, **OnEnabledChange** viene chiamato.  
  
##  <a name="setfocus"></a>  COleControl::SetFocus  
 Fa sì che la finestra del controllo contenitore da intraprendere possiede lo stato attivo di input per conto del controllo.  
  
```  
CWnd* SetFocus();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore per il **CWnd** oggetto window che era attivo per l'input, o **NULL** se nessun tale periodo.  
  
### <a name="remarks"></a>Note  
 Se il controllo è attivato e privi di finestra, questa funzione provoca la finestra del controllo contenitore da intraprendere possiede lo stato attivo, per conto del controllo. Lo stato attivo di input indica input da tastiera alla finestra del contenitore e il contenitore invia tutti i messaggi di tastiera successivi all'oggetto OLE che chiama `SetFocus`. Tutte le finestre che erano attivo per l'input perde.  
  
 Se il controllo non privi di finestra, questa funzione provoca il controllo di prendere possesso dell'elemento attivo di input (uguale a `CWnd::SetFocus`).  
  
##  <a name="setfont"></a>  COleControl::SetFont  
 Imposta la proprietà predefinita del controllo.  
  
```  
void SetFont(LPFONTDISP pFontDisp);
```  
  
### <a name="parameters"></a>Parametri  
 *pFontDisp*  
 Puntatore a un'interfaccia dispatch del tipo di carattere.  
  
##  <a name="setforecolor"></a>  COleControl::SetForeColor  
 Imposta il valore della proprietà ForeColor predefinito del controllo.  
  
```  
void SetForeColor(OLE_COLOR dwForeColor);
```  
  
### <a name="parameters"></a>Parametri  
 *dwForeColor*  
 Un' **OLE_COLOR** valore da usare per primo piano di disegno del controllo.  
  
### <a name="remarks"></a>Note  
 Per ulteriori informazioni sull'uso di questa proprietà e relative proprietà, vedere l'articolo [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).  
  
##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats  
 Chiamato dal framework per inizializzare l'elenco dei formati di dati supportati dal controllo.  
  
```  
virtual void SetInitialDataFormats();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita specifica due formati: `CF_METAFILEPICT` e il set di proprietà persistenti.  
  
##  <a name="setinitialsize"></a>  COleControl::SetInitialSize  
 Imposta le dimensioni di un controllo OLE alla prima visualizzazione in un contenitore.  
  
```  
void SetInitialSize(
    int cx,  
    int cy);
```  
  
### <a name="parameters"></a>Parametri  
 *CX*  
 Larghezza iniziale del controllo OLE in pixel.  
  
 *CY*  
 L'altezza iniziale del controllo OLE in pixel.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione del costruttore per impostare le dimensioni iniziali del controllo. La dimensione iniziale viene misurata in unità di dispositivo o pixel. È consigliabile che questa chiamata venga effettuata nel costruttore del controllo.  
  
##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag  
 Modifica lo stato modificato di un controllo.  
  
```  
void SetModifiedFlag(BOOL bModified = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *bModified*  
 Il nuovo valore per il controllo modificato del flag. **TRUE** indica che lo stato del controllo è stato modificato; **FALSE** indica che è appena stato salvato lo stato del controllo.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione ogni volta che si verifica una modifica che interessa stato persistente del controllo. Ad esempio, se viene modificato il valore di una proprietà permanente, chiamare questa funzione con * bModified ***TRUE**.  
  
##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted  
 Indica che una richiesta di modifica non è riuscito.  
  
```  
void SetNotPermitted();
```  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione quando `BoundPropertyRequestEdit` ha esito negativo. Questa funzione genera un'eccezione di tipo **COleDispScodeException** per indicare che l'operazione di impostazione non è stata permessa.  
  
##  <a name="setnotsupported"></a>  COleControl::SetNotSupported  
 Impedisce la modifica al valore della proprietà di un controllo dall'utente.  
  
```  
void SetNotSupported();
```  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione al posto della funzione di Set di qualsiasi proprietà in cui non è supportata la modifica del valore della proprietà dall'utente del controllo. Un esempio potrebbe essere una proprietà che è di sola lettura.  
  
##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer  
 Imposta le coordinate del rettangolo del controllo rispetto al contenitore, espresso come unità di dispositivo.  
  
```  
BOOL SetRectInContainer(LPCRECT lpRect);
```  
  
### <a name="parameters"></a>Parametri  
 *lpRect*  
 Un puntatore a un rettangolo che contiene le coordinate del controllo rispetto al contenitore.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se il controllo è aperto, viene ridimensionato; in caso contrario, il contenitore **OnPosRectChanged** funzione viene chiamata.  
  
##  <a name="settext"></a>  COleControl::SetText  
 Imposta il valore della proprietà di testo o didascalia predefinita del controllo.  
  
```  
void SetText(LPCTSTR pszText);
```  
  
### <a name="parameters"></a>Parametri  
 *pszText*  
 Puntatore a una stringa di caratteri.  
  
### <a name="remarks"></a>Note  
 Si noti che entrambe le proprietà predefinite di titolo e testo siano mappate sullo stesso valore. Ciò significa che qualsiasi modifica apportata a delle proprietà verrà modificato automaticamente entrambe le proprietà. In generale, un controllo deve supportare le scorte didascalia o Text (proprietà), ma non entrambi.  
  
##  <a name="throwerror"></a>  COleControl::ThrowError  
 Segnala l'occorrenza di un errore nel controllo.  
  
```  
void ThrowError(
    SCODE sc,  
    UINT nDescriptionID,  
    UINT nHelpID = -1);

 
void ThrowError(
    SCODE sc,  
    LPCTSTR pszDescription = NULL,  
    UINT nHelpID = 0);
```  
  
### <a name="parameters"></a>Parametri  
 *SC*  
 Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).  
  
 *nDescriptionID*  
 L'ID risorsa stringa dell'eccezione da segnalare.  
  
 *nHelpID*  
 ID della Guida per l'argomento per il report.  
  
 *pszDescription*  
 Stringa contenente una spiegazione dell'eccezione da segnalare.  
  
### <a name="remarks"></a>Note  
 Questa funzione deve essere chiamata solo all'interno di una funzione Get o Set per una proprietà OLE o l'implementazione di un metodo di automazione OLE. Se si desidera segnalare gli errori che si verificano in altri momenti, si deve generare l'evento di errore predefinito.  
  
##  <a name="transformcoords"></a>  COleControl::TransformCoords  
 Trasformazioni coordinano i valori compresi tra **HIMETRIC** unità e unità native del contenitore.  
  
```  
void TransformCoords(
    POINTL* lpptlHimetric,  
    POINTF* lpptfContainer,  
    DWORD flags);
```  
  
### <a name="parameters"></a>Parametri  
 *lpptlHimetric*  
 Puntatore a un **POINTL** struttura che contiene le coordinate nella **HIMETRIC** unità.  
  
 *lpptfContainer*  
 Puntatore a un **POINTF** struttura che contiene le coordinate nella dimensione dell'unità del contenitore.  
  
 *flags*  
 Una combinazione dei valori seguenti:  
  
- **XFORMCOORDS_POSITION** una posizione nel contenitore.  
  
- **XFORMCOORDS_SIZE** una dimensione nel contenitore.  
  
- **XFORMCOORDS_HIMETRICTOCONTAINER** trasformare **HIMETRIC** unità alle unità del contenitore.  
  
- **XFORMCOORDS_CONTAINERTOHIMETRIC** trasformare unità del contenitore su **HIMETRIC** unità.  
  
### <a name="remarks"></a>Note  
 I primi due flag, **XFORMCOORDS_POSITION** e **XFORMCOORDS_SIZE**, indicare se le coordinate devono essere trattate come una posizione o dimensioni. I flag restanti due indicano la direzione della trasformazione.  
  
##  <a name="translatecolor"></a>  COleControl::TranslateColor  
 Converte un valore di colore dal **OLE_COLOR** del tipo di dati per il [COLORREF](http://msdn.microsoft.com/library/windows/desktop/dd183449) tipo di dati.  
  
```  
COLORREF TranslateColor(
    OLE_COLOR clrColor,  
    HPALETTE hpal = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *clrColor*  
 Un **OLE_COLOR** tipo di dati. Per altre informazioni, vedere le finestre [OleTranslateColor](http://msdn.microsoft.com/library/windows/desktop/ms694353) (funzione).  
  
 *hpal*  
 Un handle per una tavolozza facoltativo; può essere **NULL**.  
  
### <a name="return-value"></a>Valore restituito  
 Un valore di 32 bit colore RGB (red, green, blue) che definisce il continuo colore più vicino per il *clrColor* valore che può rappresentare il dispositivo.  
  
### <a name="remarks"></a>Note  
 Questa funzione è utile per convertire la proprietà ForeColor e BackColor predefinite per **COLORREF** tipi utilizzati dai [CDC](../../mfc/reference/cdc-class.md) funzioni membro.  
  
##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad  
 Determina se il controllo deve utilizzare i valori delle proprietà di ambiente come valori predefiniti, quando viene caricato successivamente dallo stato persistente.  
  
```  
BOOL WillAmbientsBeValidDuringLoad();
```  
  
### <a name="return-value"></a>Valore restituito  
 NonZero indica che le proprietà di ambiente può essere valide. in caso contrario, le proprietà di ambiente non saranno più valide.  
  
### <a name="remarks"></a>Note  
 In alcuni contenitori, il controllo del codice non siano l'accesso alle proprietà di ambiente durante la chiamata iniziale per la sostituzione di `COleControl::DoPropExchange`. Questo è il caso se il contenitore chiama [IPersistStreamInit::Load](http://msdn.microsoft.com/library/windows/desktop/ms680730) oppure [IPersistStorage:: Load](http://msdn.microsoft.com/library/windows/desktop/ms680557) prima di chiamare [IOleObject::SetClientSite](http://msdn.microsoft.com/library/windows/desktop/ms684013) (vale a dire, se non è presente rispettare le **OLEMISC_SETCLIENTSITEFIRST** bit dello stato).  
  
##  <a name="windowproc"></a>  COleControl::WindowProc  
 Fornisce una procedura di Windows per un `COleControl` oggetto.  
  
```  
virtual LRESULT WindowProc(
    UINT message,  
    WPARAM wParam,  
    LPARAM lParam);
```  
  
### <a name="parameters"></a>Parametri  
 *message*  
 Specifica il messaggio di Windows da elaborare.  
  
 *wParam*  
 Fornisce informazioni aggiuntive utilizzate nell'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.  
  
 *lParam*  
 Fornisce informazioni aggiuntive utilizzate nell'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.  
  
### <a name="return-value"></a>Valore restituito  
 Il valore restituito del messaggio inviato.  
  
### <a name="remarks"></a>Note  
 Chiamare questa funzione per l'invio di messaggi specifici tramite mappa messaggi del controllo.  
  
## <a name="see-also"></a>Vedere anche  
 [MFC esempio CIRC3](../../visual-cpp-samples.md)   
 [Esempio MFC TESTHELP](../../visual-cpp-samples.md)   
 [COlePropertyPage (classe)](../../mfc/reference/colepropertypage-class.md)   
 [CWnd (classe)](../../mfc/reference/cwnd-class.md)   
 [Grafico delle gerarchie](../../mfc/hierarchy-chart.md)   
 [Classe CFontHolder](../../mfc/reference/cfontholder-class.md)   
 [Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)
