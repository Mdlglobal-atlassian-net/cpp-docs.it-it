---
title: Classe COleControl | Microsoft Docs
ms.custom: ''
ms.date: 08/27/2018
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleControl
- AFXCTL/COleControl
- AFXCTL/COleControl::COleControl
- AFXCTL/COleControl::AmbientAppearance
- AFXCTL/COleControl::AmbientBackColor
- AFXCTL/COleControl::AmbientDisplayName
- AFXCTL/COleControl::AmbientFont
- AFXCTL/COleControl::AmbientForeColor
- AFXCTL/COleControl::AmbientLocaleID
- AFXCTL/COleControl::AmbientScaleUnits
- AFXCTL/COleControl::AmbientShowGrabHandles
- AFXCTL/COleControl::AmbientShowHatching
- AFXCTL/COleControl::AmbientTextAlign
- AFXCTL/COleControl::AmbientUIDead
- AFXCTL/COleControl::AmbientUserMode
- AFXCTL/COleControl::BoundPropertyChanged
- AFXCTL/COleControl::BoundPropertyRequestEdit
- AFXCTL/COleControl::ClientToParent
- AFXCTL/COleControl::ClipCaretRect
- AFXCTL/COleControl::ControlInfoChanged
- AFXCTL/COleControl::DisplayError
- AFXCTL/COleControl::DoClick
- AFXCTL/COleControl::DoPropExchange
- AFXCTL/COleControl::DoSuperclassPaint
- AFXCTL/COleControl::EnableSimpleFrame
- AFXCTL/COleControl::ExchangeExtent
- AFXCTL/COleControl::ExchangeStockProps
- AFXCTL/COleControl::ExchangeVersion
- AFXCTL/COleControl::FireClick
- AFXCTL/COleControl::FireDblClick
- AFXCTL/COleControl::FireError
- AFXCTL/COleControl::FireEvent
- AFXCTL/COleControl::FireKeyDown
- AFXCTL/COleControl::FireKeyPress
- AFXCTL/COleControl::FireKeyUp
- AFXCTL/COleControl::FireMouseDown
- AFXCTL/COleControl::FireMouseMove
- AFXCTL/COleControl::FireMouseUp
- AFXCTL/COleControl::FireReadyStateChange
- AFXCTL/COleControl::GetActivationPolicy
- AFXCTL/COleControl::GetAmbientProperty
- AFXCTL/COleControl::GetAppearance
- AFXCTL/COleControl::GetBackColor
- AFXCTL/COleControl::GetBorderStyle
- AFXCTL/COleControl::GetCapture
- AFXCTL/COleControl::GetClassID
- AFXCTL/COleControl::GetClientOffset
- AFXCTL/COleControl::GetClientRect
- AFXCTL/COleControl::GetClientSite
- AFXCTL/COleControl::GetControlFlags
- AFXCTL/COleControl::GetControlSize
- AFXCTL/COleControl::GetDC
- AFXCTL/COleControl::GetEnabled
- AFXCTL/COleControl::GetExtendedControl
- AFXCTL/COleControl::GetFocus
- AFXCTL/COleControl::GetFont
- AFXCTL/COleControl::GetFontTextMetrics
- AFXCTL/COleControl::GetForeColor
- AFXCTL/COleControl::GetHwnd
- AFXCTL/COleControl::GetMessageString
- AFXCTL/COleControl::GetNotSupported
- AFXCTL/COleControl::GetReadyState
- AFXCTL/COleControl::GetRectInContainer
- AFXCTL/COleControl::GetStockTextMetrics
- AFXCTL/COleControl::GetText
- AFXCTL/COleControl::GetWindowlessDropTarget
- AFXCTL/COleControl::InitializeIIDs
- AFXCTL/COleControl::InternalGetFont
- AFXCTL/COleControl::InternalGetText
- AFXCTL/COleControl::InternalSetReadyState
- AFXCTL/COleControl::InvalidateControl
- AFXCTL/COleControl::InvalidateRgn
- AFXCTL/COleControl::IsConvertingVBX
- AFXCTL/COleControl::IsModified
- AFXCTL/COleControl::IsOptimizedDraw
- AFXCTL/COleControl::IsSubclassedControl
- AFXCTL/COleControl::Load
- AFXCTL/COleControl::LockInPlaceActive
- AFXCTL/COleControl::OnAmbientPropertyChange
- AFXCTL/COleControl::OnAppearanceChanged
- AFXCTL/COleControl::OnBackColorChanged
- AFXCTL/COleControl::OnBorderStyleChanged
- AFXCTL/COleControl::OnClick
- AFXCTL/COleControl::OnClose
- AFXCTL/COleControl::OnDoVerb
- AFXCTL/COleControl::OnDraw
- AFXCTL/COleControl::OnDrawMetafile
- AFXCTL/COleControl::OnEdit
- AFXCTL/COleControl::OnEnabledChanged
- AFXCTL/COleControl::OnEnumVerbs
- AFXCTL/COleControl::OnEventAdvise
- AFXCTL/COleControl::OnFontChanged
- AFXCTL/COleControl::OnForeColorChanged
- AFXCTL/COleControl::OnFreezeEvents
- AFXCTL/COleControl::OnGetColorSet
- AFXCTL/COleControl::OnGetControlInfo
- AFXCTL/COleControl::OnGetDisplayString
- AFXCTL/COleControl::OnGetInPlaceMenu
- AFXCTL/COleControl::OnGetNaturalExtent
- AFXCTL/COleControl::OnGetPredefinedStrings
- AFXCTL/COleControl::OnGetPredefinedValue
- AFXCTL/COleControl::OnGetViewExtent
- AFXCTL/COleControl::OnGetViewRect
- AFXCTL/COleControl::OnGetViewStatus
- AFXCTL/COleControl::OnHideToolBars
- AFXCTL/COleControl::OnInactiveMouseMove
- AFXCTL/COleControl::OnInactiveSetCursor
- AFXCTL/COleControl::OnKeyDownEvent
- AFXCTL/COleControl::OnKeyPressEvent
- AFXCTL/COleControl::OnKeyUpEvent
- AFXCTL/COleControl::OnMapPropertyToPage
- AFXCTL/COleControl::OnMnemonic
- AFXCTL/COleControl::OnProperties
- AFXCTL/COleControl::OnQueryHitPoint
- AFXCTL/COleControl::OnQueryHitRect
- AFXCTL/COleControl::OnRenderData
- AFXCTL/COleControl::OnRenderFileData
- AFXCTL/COleControl::OnRenderGlobalData
- AFXCTL/COleControl::OnResetState
- AFXCTL/COleControl::OnSetClientSite
- AFXCTL/COleControl::OnSetData
- AFXCTL/COleControl::OnSetExtent
- AFXCTL/COleControl::OnSetObjectRects
- AFXCTL/COleControl::OnShowToolBars
- AFXCTL/COleControl::OnTextChanged
- AFXCTL/COleControl::OnWindowlessMessage
- AFXCTL/COleControl::ParentToClient
- AFXCTL/COleControl::PostModalDialog
- AFXCTL/COleControl::PreModalDialog
- AFXCTL/COleControl::RecreateControlWindow
- AFXCTL/COleControl::Refresh
- AFXCTL/COleControl::ReleaseCapture
- AFXCTL/COleControl::ReleaseDC
- AFXCTL/COleControl::ReparentControlWindow
- AFXCTL/COleControl::ResetStockProps
- AFXCTL/COleControl::ResetVersion
- AFXCTL/COleControl::ScrollWindow
- AFXCTL/COleControl::SelectFontObject
- AFXCTL/COleControl::SelectStockFont
- AFXCTL/COleControl::SerializeExtent
- AFXCTL/COleControl::SerializeStockProps
- AFXCTL/COleControl::SerializeVersion
- AFXCTL/COleControl::SetAppearance
- AFXCTL/COleControl::SetBackColor
- AFXCTL/COleControl::SetBorderStyle
- AFXCTL/COleControl::SetCapture
- AFXCTL/COleControl::SetControlSize
- AFXCTL/COleControl::SetEnabled
- AFXCTL/COleControl::SetFocus
- AFXCTL/COleControl::SetFont
- AFXCTL/COleControl::SetForeColor
- AFXCTL/COleControl::SetInitialSize
- AFXCTL/COleControl::SetModifiedFlag
- AFXCTL/COleControl::SetNotPermitted
- AFXCTL/COleControl::SetNotSupported
- AFXCTL/COleControl::SetRectInContainer
- AFXCTL/COleControl::SetText
- AFXCTL/COleControl::ThrowError
- AFXCTL/COleControl::TransformCoords
- AFXCTL/COleControl::TranslateColor
- AFXCTL/COleControl::WillAmbientsBeValidDuringLoad
- AFXCTL/COleControl::WindowProc
- AFXCTL/COleControl::DrawContent
- AFXCTL/COleControl::DrawMetafile
- AFXCTL/COleControl::IsInvokeAllowed
- AFXCTL/COleControl::SetInitialDataFormats
dev_langs:
- C++
helpviewer_keywords:
- COleControl [MFC], COleControl
- COleControl [MFC], AmbientAppearance
- COleControl [MFC], AmbientBackColor
- COleControl [MFC], AmbientDisplayName
- COleControl [MFC], AmbientFont
- COleControl [MFC], AmbientForeColor
- COleControl [MFC], AmbientLocaleID
- COleControl [MFC], AmbientScaleUnits
- COleControl [MFC], AmbientShowGrabHandles
- COleControl [MFC], AmbientShowHatching
- COleControl [MFC], AmbientTextAlign
- COleControl [MFC], AmbientUIDead
- COleControl [MFC], AmbientUserMode
- COleControl [MFC], BoundPropertyChanged
- COleControl [MFC], BoundPropertyRequestEdit
- COleControl [MFC], ClientToParent
- COleControl [MFC], ClipCaretRect
- COleControl [MFC], ControlInfoChanged
- COleControl [MFC], DisplayError
- COleControl [MFC], DoClick
- COleControl [MFC], DoPropExchange
- COleControl [MFC], DoSuperclassPaint
- COleControl [MFC], EnableSimpleFrame
- COleControl [MFC], ExchangeExtent
- COleControl [MFC], ExchangeStockProps
- COleControl [MFC], ExchangeVersion
- COleControl [MFC], FireClick
- COleControl [MFC], FireDblClick
- COleControl [MFC], FireError
- COleControl [MFC], FireEvent
- COleControl [MFC], FireKeyDown
- COleControl [MFC], FireKeyPress
- COleControl [MFC], FireKeyUp
- COleControl [MFC], FireMouseDown
- COleControl [MFC], FireMouseMove
- COleControl [MFC], FireMouseUp
- COleControl [MFC], FireReadyStateChange
- COleControl [MFC], GetActivationPolicy
- COleControl [MFC], GetAmbientProperty
- COleControl [MFC], GetAppearance
- COleControl [MFC], GetBackColor
- COleControl [MFC], GetBorderStyle
- COleControl [MFC], GetCapture
- COleControl [MFC], GetClassID
- COleControl [MFC], GetClientOffset
- COleControl [MFC], GetClientRect
- COleControl [MFC], GetClientSite
- COleControl [MFC], GetControlFlags
- COleControl [MFC], GetControlSize
- COleControl [MFC], GetDC
- COleControl [MFC], GetEnabled
- COleControl [MFC], GetExtendedControl
- COleControl [MFC], GetFocus
- COleControl [MFC], GetFont
- COleControl [MFC], GetFontTextMetrics
- COleControl [MFC], GetForeColor
- COleControl [MFC], GetHwnd
- COleControl [MFC], GetMessageString
- COleControl [MFC], GetNotSupported
- COleControl [MFC], GetReadyState
- COleControl [MFC], GetRectInContainer
- COleControl [MFC], GetStockTextMetrics
- COleControl [MFC], GetText
- COleControl [MFC], GetWindowlessDropTarget
- COleControl [MFC], InitializeIIDs
- COleControl [MFC], InternalGetFont
- COleControl [MFC], InternalGetText
- COleControl [MFC], InternalSetReadyState
- COleControl [MFC], InvalidateControl
- COleControl [MFC], InvalidateRgn
- COleControl [MFC], IsConvertingVBX
- COleControl [MFC], IsModified
- COleControl [MFC], IsOptimizedDraw
- COleControl [MFC], IsSubclassedControl
- COleControl [MFC], Load
- COleControl [MFC], LockInPlaceActive
- COleControl [MFC], OnAmbientPropertyChange
- COleControl [MFC], OnAppearanceChanged
- COleControl [MFC], OnBackColorChanged
- COleControl [MFC], OnBorderStyleChanged
- COleControl [MFC], OnClick
- COleControl [MFC], OnClose
- COleControl [MFC], OnDoVerb
- COleControl [MFC], OnDraw
- COleControl [MFC], OnDrawMetafile
- COleControl [MFC], OnEdit
- COleControl [MFC], OnEnabledChanged
- COleControl [MFC], OnEnumVerbs
- COleControl [MFC], OnEventAdvise
- COleControl [MFC], OnFontChanged
- COleControl [MFC], OnForeColorChanged
- COleControl [MFC], OnFreezeEvents
- COleControl [MFC], OnGetColorSet
- COleControl [MFC], OnGetControlInfo
- COleControl [MFC], OnGetDisplayString
- COleControl [MFC], OnGetInPlaceMenu
- COleControl [MFC], OnGetNaturalExtent
- COleControl [MFC], OnGetPredefinedStrings
- COleControl [MFC], OnGetPredefinedValue
- COleControl [MFC], OnGetViewExtent
- COleControl [MFC], OnGetViewRect
- COleControl [MFC], OnGetViewStatus
- COleControl [MFC], OnHideToolBars
- COleControl [MFC], OnInactiveMouseMove
- COleControl [MFC], OnInactiveSetCursor
- COleControl [MFC], OnKeyDownEvent
- COleControl [MFC], OnKeyPressEvent
- COleControl [MFC], OnKeyUpEvent
- COleControl [MFC], OnMapPropertyToPage
- COleControl [MFC], OnMnemonic
- COleControl [MFC], OnProperties
- COleControl [MFC], OnQueryHitPoint
- COleControl [MFC], OnQueryHitRect
- COleControl [MFC], OnRenderData
- COleControl [MFC], OnRenderFileData
- COleControl [MFC], OnRenderGlobalData
- COleControl [MFC], OnResetState
- COleControl [MFC], OnSetClientSite
- COleControl [MFC], OnSetData
- COleControl [MFC], OnSetExtent
- COleControl [MFC], OnSetObjectRects
- COleControl [MFC], OnShowToolBars
- COleControl [MFC], OnTextChanged
- COleControl [MFC], OnWindowlessMessage
- COleControl [MFC], ParentToClient
- COleControl [MFC], PostModalDialog
- COleControl [MFC], PreModalDialog
- COleControl [MFC], RecreateControlWindow
- COleControl [MFC], Refresh
- COleControl [MFC], ReleaseCapture
- COleControl [MFC], ReleaseDC
- COleControl [MFC], ReparentControlWindow
- COleControl [MFC], ResetStockProps
- COleControl [MFC], ResetVersion
- COleControl [MFC], ScrollWindow
- COleControl [MFC], SelectFontObject
- COleControl [MFC], SelectStockFont
- COleControl [MFC], SerializeExtent
- COleControl [MFC], SerializeStockProps
- COleControl [MFC], SerializeVersion
- COleControl [MFC], SetAppearance
- COleControl [MFC], SetBackColor
- COleControl [MFC], SetBorderStyle
- COleControl [MFC], SetCapture
- COleControl [MFC], SetControlSize
- COleControl [MFC], SetEnabled
- COleControl [MFC], SetFocus
- COleControl [MFC], SetFont
- COleControl [MFC], SetForeColor
- COleControl [MFC], SetInitialSize
- COleControl [MFC], SetModifiedFlag
- COleControl [MFC], SetNotPermitted
- COleControl [MFC], SetNotSupported
- COleControl [MFC], SetRectInContainer
- COleControl [MFC], SetText
- COleControl [MFC], ThrowError
- COleControl [MFC], TransformCoords
- COleControl [MFC], TranslateColor
- COleControl [MFC], WillAmbientsBeValidDuringLoad
- COleControl [MFC], WindowProc
- COleControl [MFC], DrawContent
- COleControl [MFC], DrawMetafile
- COleControl [MFC], IsInvokeAllowed
- COleControl [MFC], SetInitialDataFormats
ms.assetid: 53e95299-38e8-447b-9c5f-a381d27f5123
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 292121e95b20061e95e85b49c60d4758bd18a568
ms.sourcegitcommit: 799f9b976623a375203ad8b2ad5147bd6a2212f0
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 09/19/2018
ms.locfileid: "46435532"
---
# <a name="colecontrol-class"></a>COleControl (classe)

Classe di base avanzata per lo sviluppo di controlli OLE.

## <a name="syntax"></a>Sintassi

```
class COleControl : public CWnd
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleControl::COleControl](#colecontrol)|Crea un oggetto `COleControl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleControl::AmbientAppearance](#ambientappearance)|Recupera l'aspetto del controllo corrente.|
|[COleControl::AmbientBackColor](#ambientbackcolor)|Restituisce il valore della proprietà di colore di sfondo ambiente.|
|[COleControl::AmbientDisplayName](#ambientdisplayname)|Restituisce il nome del controllo come specificato dal contenitore.|
|[COleControl::AmbientFont](#ambientfont)|Restituisce il valore della proprietà di tipo di carattere ambiente.|
|[COleControl::AmbientForeColor](#ambientforecolor)|Restituisce il valore della proprietà di colore di primo piano di ambiente.|
|[COleControl::AmbientLocaleID](#ambientlocaleid)|Restituisce l'ID impostazioni locali. del contenitore|
|[COleControl::AmbientScaleUnits](#ambientscaleunits)|Restituisce il tipo di unità usate dal contenitore.|
|[COleControl::AmbientShowGrabHandles](#ambientshowgrabhandles)|Determina se i quadratini di ridimensionamento devono essere visualizzati.|
|[COleControl::AmbientShowHatching](#ambientshowhatching)|Determina se verrà visualizzato un tratteggio.|
|[COleControl::AmbientTextAlign](#ambienttextalign)|Restituisce il tipo di allineamento del testo specificato dal contenitore.|
|[COleControl::AmbientUIDead](#ambientuidead)|Determina se il controllo deve rispondere alle azioni dell'interfaccia utente.|
|[COleControl::AmbientUserMode](#ambientusermode)|Determina la modalità del contenitore.|
|[COleControl::BoundPropertyChanged](#boundpropertychanged)|Notifica al contenitore che una proprietà associata è stata modificata.|
|[COleControl::BoundPropertyRequestEdit](#boundpropertyrequestedit)|Chiede l'autorizzazione per modificare il valore della proprietà.|
|[COleControl::ClientToParent](#clienttoparent)|Converte un punto relativo all'origine del controllo a un punto relativo all'origine del relativo contenitore.|
|[COleControl::ClipCaretRect](#clipcaretrect)|Regola un rettangolo di accento circonflesso se di un controllo si sovrapposta.|
|[COleControl::ControlInfoChanged](#controlinfochanged)|Chiamare questa funzione dopo che è stato modificato il set di tasti di scelta gestita dal controllo.|
|[COleControl::DisplayError](#displayerror)|Visualizza eventi di errore predefiniti del controllo.|
|[COleControl::DoClick](#doclick)|Implementazione dell'azione `DoClick` (metodo).|
|[COleControl::DoPropExchange](#dopropexchange)|Serializza le proprietà di un `COleControl` oggetto.|
|[COleControl::DoSuperclassPaint](#dosuperclasspaint)|Consente di ricreare un controllo OLE che è stato sottoclassato da un controllo di Windows.|
|[COleControl::EnableSimpleFrame](#enablesimpleframe)|Abilita il supporto di frame semplice per un controllo.|
|[COleControl::ExchangeExtent](#exchangeextent)|Serializza la larghezza e altezza del controllo.|
|[COleControl::ExchangeStockProps](#exchangestockprops)|Serializza le proprietà predefinite del controllo.|
|[COleControl::ExchangeVersion](#exchangeversion)|Serializza il numero di versione del controllo.|
|[COleControl::FireClick](#fireclick)|Genera le scorte `Click` evento.|
|[COleControl::FireDblClick](#firedblclick)|Genera le scorte `DblClick` evento.|
|[COleControl::FireError](#fireerror)|Genera le scorte `Error` evento.|
|[COleControl::FireEvent](#fireevent)|Genera un evento personalizzato.|
|[COleControl::FireKeyDown](#firekeydown)|Genera le scorte `KeyDown` evento.|
|[COleControl::FireKeyPress](#firekeypress)|Genera le scorte `KeyPress` evento.|
|[COleControl::FireKeyUp](#firekeyup)|Genera le scorte `KeyUp` evento.|
|[COleControl::FireMouseDown](#firemousedown)|Genera le scorte `MouseDown` evento.|
|[COleControl::FireMouseMove](#firemousemove)|Genera le scorte `MouseMove` evento.|
|[COleControl::FireMouseUp](#firemouseup)|Genera le scorte `MouseUp` evento.|
|[COleControl::FireReadyStateChange](#firereadystatechange)|Genera un evento quando viene modificato lo stato del controllo pronto.|
|[COleControl::GetActivationPolicy](#getactivationpolicy)|Modifica il comportamento di attivazione predefinito di un controllo che supporta il `IPointerInactive` interfaccia.|
|[COleControl::GetAmbientProperty](#getambientproperty)|Restituisce il valore della proprietà di ambiente specificata.|
|[COleControl::GetAppearance](#getappearance)|Restituisce il valore della proprietà Appearance azionario.|
|[COleControl::GetBackColor](#getbackcolor)|Restituisce il valore della proprietà BackColor azionario.|
|[COleControl::GetBorderStyle](#getborderstyle)|Restituisce il valore della proprietà BorderStyle azionario.|
|[COleControl::GetCapture](#getcapture)|Determina se un oggetto di un controllo senza finestra e attivato lo stato mouse capture.|
|[COleControl::GetClassID](#getclassid)|Recupera l'ID della classe del controllo OLE.|
|[COleControl::GetClientOffset](#getclientoffset)|Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client.|
|[COleControl::GetClientRect](#getclientrect)|Recupera la dimensione dell'area client del controllo.|
|[COleControl::GetClientSite](#getclientsite)|Esegue una query un oggetto per il puntatore al relativo sito client corrente all'interno del contenitore.|
|[COleControl::GetControlFlags](#getcontrolflags)|Recupera le impostazioni del flag di controllo.|
|[COleControl::GetControlSize](#getcontrolsize)|Restituisce la posizione e dimensioni del controllo OLE.|
|[COleControl::GetDC](#getdc)|Fornisce un mezzo per un controllo senza finestra ottenere un contesto di dispositivo dal relativo contenitore.|
|[COleControl::GetEnabled](#getenabled)|Restituisce il valore della proprietà Enabled di magazzino.|
|[COleControl::GetExtendedControl](#getextendedcontrol)|Recupera un puntatore a un oggetto controllo esteso appartenente al contenitore.|
|[COleControl::GetFocus](#getfocus)|Determina se il controllo ha lo stato attivo.|
|[COleControl::GetFont](#getfont)|Restituisce il valore della proprietà del tipo di carattere azionario.|
|[COleControl::GetFontTextMetrics](#getfonttextmetrics)|Restituisce le metriche relative a un `CFontHolder` oggetto.|
|[COleControl::GetForeColor](#getforecolor)|Restituisce il valore della proprietà ForeColor azionario.|
|[COleControl::GetHwnd](#gethwnd)|Restituisce il valore della proprietà azionario hWnd.|
|[COleControl::GetMessageString](#getmessagestring)|Fornisce testo della barra di stato per una voce di menu.|
|[COleControl::GetNotSupported](#getnotsupported)|Impedisce l'accesso al valore della proprietà di un controllo dall'utente.|
|[COleControl::GetReadyState](#getreadystate)|Restituisce lo stato del controllo dello stato di preparazione.|
|[COleControl::GetRectInContainer](#getrectincontainer)|Restituisce il rettangolo rispetto al suo contenitore.|
|[COleControl::GetStockTextMetrics](#getstocktextmetrics)|Vengono restituite le metriche della proprietà del tipo di carattere azionario.|
|[COleControl::GetText](#gettext)|Restituisce il valore della proprietà Text o Caption azionario.|
|[COleControl::GetWindowlessDropTarget](#getwindowlessdroptarget)|Eseguire l'override per consentire un controllo senza finestra per essere la destinazione di trascinamento e operazioni di trascinamento.|
|[COleControl::InitializeIIDs](#initializeiids)|Indica la classe di base agli ID verrà utilizzato il controllo.|
|[COleControl::InternalGetFont](#internalgetfont)|Restituisce un `CFontHolder` oggetto per la proprietà predefinita.|
|[COleControl::InternalGetText](#internalgettext)|Recupera la didascalia o il testo di proprietà predefinite.|
|[COleControl::InternalSetReadyState](#internalsetreadystate)|Imposta lo stato del controllo dello stato di preparazione e genera l'evento di modifica di stato pronto.|
|[COleControl::InvalidateControl](#invalidatecontrol)|Invalida un'area del controllo visualizzato, in modo da ricreare.|
|[COleControl::InvalidateRgn](#invalidatergn)|Invalida l'area client della finestra contenitore all'interno dell'area specificata. Consente di ridisegnare controlli privi di finestra nell'area.|
|[COleControl::IsConvertingVBX](#isconvertingvbx)|Consente il caricamento specializzato di un controllo OLE.|
|[COleControl::IsModified](#ismodified)|Determina se lo stato del controllo è stato modificato.|
|[COleControl:: IsOptimizedDraw](#isoptimizeddraw)|Indica se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente.|
|[COleControl::IsSubclassedControl](#issubclassedcontrol)|Chiamato per determinare se il controllo è una sottoclasse un Windows il controllo.|
|[COleControl::Load](#load)|Reimposta tutti i dati asincroni precedenti e avvia un nuovo caricamento della proprietà asincrona del controllo.|
|[COleControl::LockInPlaceActive](#lockinplaceactive)|Determina se il controllo può essere disattivato dal contenitore.|
|[COleControl::OnAmbientPropertyChange](#onambientpropertychange)|Chiamato quando viene modificata una proprietà di ambiente.|
|[COleControl::OnAppearanceChanged](#onappearancechanged)|Chiamato quando viene modificata la proprietà di aspetto azionario.|
|[COleControl::OnBackColorChanged](#onbackcolorchanged)|Chiamato quando viene modificata la proprietà BackColor azionario.|
|[COleControl::OnBorderStyleChanged](#onborderstylechanged)|Chiamato quando viene modificata la proprietà BorderStyle azionario.|
|[COleControl::OnClick](#onclick)|Chiamata eseguita per generare le azioni fare clic su eventi.|
|[COleControl::OnClose](#onclose)|Notifica al controllo che `IOleControl::Close` è stato chiamato.|
|[COleControl::OnDoVerb](#ondoverb)|Chiamato dopo l'esecuzione di un verbo di controllo.|
|[COleControl::OnDraw](#ondraw)|Chiamato quando viene richiesto un controllo ridisegnato.|
|[COleControl::OnDrawMetafile](#ondrawmetafile)|Chiamato dal contenitore quando viene richiesto un controllo ridisegnato usando un contesto di dispositivo metafile.|
|[COleControl::OnEdit](#onedit)|Chiamato dal contenitore dell'interfaccia utente di attivare un controllo OLE.|
|[COleControl::OnEnabledChanged](#onenabledchanged)|Chiamato quando viene modificata la proprietà Enabled di magazzino.|
|[COleControl::OnEnumVerbs](#onenumverbs)|Chiamata eseguita dal contenitore da enumerare i verbi del controllo.|
|[COleControl::OnEventAdvise](#oneventadvise)|Chiamata eseguita quando i gestori eventi siano connessi o disconnessi da un controllo.|
|[COleControl::OnFontChanged](#onfontchanged)|Chiamato quando viene modificata la proprietà predefinita.|
|[COleControl::OnForeColorChanged](#onforecolorchanged)|Chiamato quando viene modificata la proprietà ForeColor azionario.|
|[COleControl::OnFreezeEvents](#onfreezeevents)|Chiamato quando gli eventi di un controllo vengono bloccati o non è bloccati.|
|[COleControl::OnGetColorSet](#ongetcolorset)|Notifica al controllo che `IOleObject::GetColorSet` è stato chiamato.|
|[COleControl::OnGetControlInfo](#ongetcontrolinfo)|Vengono fornite informazioni tasti di scelta rapida per il contenitore.|
|[COleControl::OnGetDisplayString](#ongetdisplaystring)|Chiamato per ottenere una stringa per rappresentare un valore della proprietà.|
|[COleControl::OnGetInPlaceMenu](#ongetinplacemenu)|Richiede l'handle del menu del controllo che verranno uniti con il contenitore.|
|[COleControl::OnGetNaturalExtent](#ongetnaturalextent)|Eseguire l'override per recuperare le dimensioni del controllo visualizzato più vicina alla modalità di dimensioni e l'estensione proposta.|
|[COleControl::OnGetPredefinedStrings](#ongetpredefinedstrings)|Restituisce le stringhe che rappresentano i valori possibili per una proprietà.|
|[COleControl::OnGetPredefinedValue](#ongetpredefinedvalue)|Restituisce il valore corrispondente a una stringa predefinita.|
|[COleControl::OnGetViewExtent](#ongetviewextent)|Eseguire l'override per recuperare la dimensione delle aree di visualizzazione del controllo (può essere utilizzata per abilitare il disegno in due passaggi).|
|[COleControl::OnGetViewRect](#ongetviewrect)|Eseguire l'override per convertire le dimensioni del controllo in un rettangolo iniziando in corrispondenza di una posizione specifica.|
|[COleControl::OnGetViewStatus](#ongetviewstatus)|Eseguire l'override per recuperare lo stato di visualizzazione del controllo.|
|[COleControl::OnHideToolBars](#onhidetoolbars)|Chiamato dal contenitore quando il controllo è disattivata l'interfaccia utente.|
|[COleControl::OnInactiveMouseMove](#oninactivemousemove)|Eseguire l'override per il contenitore per il controllo inattivo sotto i messaggi WM_MOUSEMOVE dispatch puntatore del mouse sul controllo.|
|[COleControl::OnInactiveSetCursor](#oninactivesetcursor)|Eseguire l'override per il contenitore per il controllo inattivo sotto i messaggi WM_SETCURSOR dispatch puntatore del mouse sul controllo.|
|[COleControl::OnKeyDownEvent](#onkeydownevent)|Chiamato dopo che è stata attivata l'evento KeyDown.|
|[COleControl::OnKeyPressEvent](#onkeypressevent)|Chiamato dopo che è stato generato l'evento KeyPress azionario.|
|[COleControl::OnKeyUpEvent](#onkeyupevent)|Chiamato dopo che è stata attivata l'evento KeyUp.|
|[COleControl::OnMapPropertyToPage](#onmappropertytopage)|Indica quale pagina delle proprietà da utilizzare per la modifica di una proprietà.|
|[COleControl::OnMnemonic](#onmnemonic)|Chiamato quando è stato premuto un tasto mnemonico del controllo.|
|[COleControl::OnProperties](#onproperties)|Chiamato quando è stato richiamato verbo "Proprietà" del controllo.|
|[COleControl::OnQueryHitPoint](#onqueryhitpoint)|Se la visualizzazione del controllo si sovrappone a una temporizzazione specifica, eseguire l'override a query.|
|[COleControl::OnQueryHitRect](#onqueryhitrect)|Eseguire l'override di query se qualsiasi punto in un rettangolo specificato si sovrappone a una visualizzazione del controllo.|
|[COleControl::OnRenderData](#onrenderdata)|Chiamato dal framework per recuperare i dati nel formato specificato.|
|[COleControl::OnRenderFileData](#onrenderfiledata)|Chiamata eseguita dal framework per recuperare dati da un file nel formato specificato.|
|[COleControl::OnRenderGlobalData](#onrenderglobaldata)|Chiamata eseguita dal framework per recuperare dati dalla memoria globale nel formato specificato.|
|[COleControl::OnResetState](#onresetstate)|Reimposta le proprietà di un controllo per i valori predefiniti.|
|[COleControl::OnSetClientSite](#onsetclientsite)|Notifica al controllo che `IOleControl::SetClientSite` è stato chiamato.|
|[COleControl::OnSetData](#onsetdata)|Sostituisce i dati del controllo con un altro valore.|
|[COleControl::OnSetExtent](#onsetextent)|Chiamato dopo che l'estensione del controllo è stato modificato.|
|[COleControl::OnSetObjectRects](#onsetobjectrects)|Chiamato dopo che sono state modificate le dimensioni del controllo.|
|[COleControl::OnShowToolBars](#onshowtoolbars)|Chiamato quando il controllo è stata attivata l'interfaccia utente.|
|[COleControl::OnTextChanged](#ontextchanged)|Chiamato quando viene modificata il magazzino testo o la proprietà Caption.|
|[COleControl::OnWindowlessMessage](#onwindowlessmessage)|Elabora i messaggi della finestra (ad eccezione dei messaggi del mouse e tastiera) per i controlli privi di finestra.|
|[COleControl::ParentToClient](#parenttoclient)|Converte un punto relativo all'origine del contenitore a un punto relativo all'origine del controllo.|
|[COleControl::PostModalDialog](#postmodaldialog)|Notifica al contenitore che è stata chiusa una finestra di dialogo modale.|
|[COleControl::PreModalDialog](#premodaldialog)|Notifica al contenitore che sta per essere visualizzato una finestra di dialogo modale.|
|[COleControl::RecreateControlWindow](#recreatecontrolwindow)|Elimina e ricrea la finestra del controllo.|
|[COleControl::Refresh](#refresh)|Impone un ridisegno dell'aspetto del controllo.|
|[COleControl::ReleaseCapture](#releasecapture)|Rilascia il mouse capture.|
|[COleControl::ReleaseDC](#releasedc)|Rilascia il contesto di dispositivo di visualizzazione di un contenitore di un controllo senza finestra.|
|[COleControl::ReparentControlWindow](#reparentcontrolwindow)|Reimposta l'elemento padre della finestra del controllo.|
|[COleControl::ResetStockProps](#resetstockprops)|Inizializza `COleControl` azionari proprietà sui rispettivi valori predefiniti.|
|[COleControl::ResetVersion](#resetversion)|Inizializza il numero di versione in un determinato valore.|
|[COleControl::ScrollWindow](#scrollwindow)|Consente a un controllo senza finestra scorrere un'area nella propria immagine attiva in posizione sullo schermo.|
|[COleControl::SelectFontObject](#selectfontobject)|Seleziona una proprietà del tipo di carattere personalizzata in un contesto di dispositivo.|
|[COleControl::SelectStockFont](#selectstockfont)|Seleziona la proprietà predefinita in un contesto di dispositivo.|
|[COleControl::SerializeExtent](#serializeextent)|Serializza o Inizializza lo spazio di visualizzazione per il controllo.|
|[COleControl::SerializeStockProps](#serializestockprops)|Serializza o Inizializza il `COleControl` proprietà predefinite.|
|[COleControl::SerializeVersion](#serializeversion)|Serializza o Inizializza le informazioni sulla versione del controllo.|
|[COleControl::SetAppearance](#setappearance)|Imposta il valore della proprietà Appearance azionario.|
|[COleControl::SetBackColor](#setbackcolor)|Imposta il valore della proprietà BackColor azionario.|
|[COleControl::SetBorderStyle](#setborderstyle)|Imposta il valore della proprietà BorderStyle azionario.|
|[COleControl::SetCapture](#setcapture)|Fa sì che la finestra del controllo contenitore da prendere possesso dell'acquisizione del mouse per conto del controllo.|
|[COleControl::SetControlSize](#setcontrolsize)|Imposta la posizione e dimensioni del controllo OLE.|
|[COleControl::SetEnabled](#setenabled)|Imposta il valore della proprietà Enabled di magazzino.|
|[COleControl::SetFocus](#setfocus)|Fa sì che la finestra del controllo contenitore da prendere possesso dell'elemento attivo di input per conto del controllo.|
|[COleControl::SetFont](#setfont)|Imposta il valore della proprietà del tipo di carattere azionario.|
|[COleControl::SetForeColor](#setforecolor)|Imposta il valore della proprietà ForeColor azionario.|
|[COleControl::SetInitialSize](#setinitialsize)|Imposta le dimensioni di un controllo OLE alla prima visualizzazione in un contenitore.|
|[COleControl::SetModifiedFlag](#setmodifiedflag)|Modifica lo stato modificato di un controllo.|
|[COleControl::SetNotPermitted](#setnotpermitted)|Indica che una richiesta di modifica non è riuscita.|
|[COleControl::SetNotSupported](#setnotsupported)|Impedisce la modifica al valore della proprietà di un controllo dall'utente.|
|[COleControl::SetRectInContainer](#setrectincontainer)|Imposta il rettangolo rispetto al suo contenitore.|
|[COleControl::SetText](#settext)|Imposta il valore della proprietà Text o Caption azionario.|
|[COleControl::ThrowError](#throwerror)|Segnala che si è verificato un errore in un controllo OLE.|
|[COleControl::TransformCoords](#transformcoords)|Trasformazioni di coordinano i valori compresi tra un contenitore e il controllo.|
|[COleControl::TranslateColor](#translatecolor)|Converte un valore OLE_COLOR su un valore COLORREF.|
|[COleControl::WillAmbientsBeValidDuringLoad](#willambientsbevalidduringload)|Determina se le proprietà di ambiente saranno disponibili la volta successiva che viene caricato il controllo.|
|[COleControl::WindowProc](#windowproc)|Fornisce una procedura di Windows per un `COleControl` oggetto.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Descrizione|
|----------|-----------------|
|[COleControl::DrawContent](#drawcontent)|Chiamato dal framework quando l'aspetto del controllo deve essere aggiornato.|
|[COleControl::DrawMetafile](#drawmetafile)|Chiamato dal framework quando viene utilizzato il contesto di dispositivo metafile.|
|[COleControl::IsInvokeAllowed](#isinvokeallowed)|Consente di chiamata al metodo di automazione.|
|[COleControl::SetInitialDataFormats](#setinitialdataformats)|Chiamata eseguita dal framework per inizializzare l'elenco di formati dati supportati dal controllo.|

## <a name="remarks"></a>Note

Derivata da `CWnd`, questa classe eredita tutte le funzionalità di un oggetto finestra di Windows e funzionalità aggiuntive specifiche di OLE, ad esempio di generazione dell'evento e la possibilità di supportare i metodi e proprietà.

OLE controlli possono essere inseriti in applicazioni contenitore OLE e comunicano con il contenitore usando un sistema bidirezionale di generazione dell'evento e che espone metodi e proprietà per il contenitore. Si noti che i contenitori OLE standard supportano solo le funzionalità di base di un controllo OLE. Non sono in grado di supportare le funzionalità estese di un controllo OLE. Generazione dell'evento si verifica quando gli eventi vengono inviati al contenitore come risultato di determinate azioni in esecuzione nel controllo. A sua volta, il contenitore comunica con il controllo tramite un set di metodi e proprietà analoga alle funzioni membro esposto e membri di dati di una classe C++. Questo approccio consente allo sviluppatore di controllare l'aspetto del controllo e notificare al contenitore quando si verificano determinate azioni.

## <a name="windowless-controls"></a>Controlli senza finestra

OLE controlli possano essere usati sul posto attivo senza visualizzare una finestra. Controlli privi di finestra presentano vantaggi significativi:

- Controlli privi di finestra possono essere trasparente e non rettangolari

- Controlli privi di finestra ridurre il tempo di dimensioni e la creazione di istanza dell'oggetto

Controlli che non richiedono una finestra. Servizi che offre una finestra possono essere forniti con facilità tramite un'unica finestra condivisa (in genere del contenitore) e un po' di codice di invio. Disporre di una finestra è principalmente una complicazione non necessari per l'oggetto.

Quando si utilizza l'attivazione senza finestra, il contenitore (che dispone di una finestra) è responsabile di fornire servizi che sarebbero altrimenti forniti dalla finestra del controllo. Ad esempio, se il controllo deve eseguire una query lo stato attivo, eseguire una query dello stato mouse capture o ottenere un contesto di dispositivo, queste operazioni vengono gestite dal contenitore. Il `COleControl` funzioni membro privi di finestra operazione invoke queste operazioni sul contenitore.

Quando è abilitata l'attivazione senza finestra, i delegati del contenitore i messaggi del controllo di input `IOleInPlaceObjectWindowless` interface (un'estensione della [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) per il supporto attivo). `COleControl`dell'implementazione di questa interfaccia verrà inviano questi messaggi tramite mappa messaggi del controllo, dopo la regolazione del mouse coordina in modo appropriato. È possibile elaborare questi messaggi come comuni messaggi di finestra, aggiungendo le voci corrispondenti alla mappa messaggi.

In un controllo senza finestra, è consigliabile usare sempre la `COleControl` funzioni membro anziché corrispondente `CWnd` funzioni membro o le relative funzioni API Windows correlati.

Gli oggetti di controllo OLE possono anche creare una finestra solo quando diventano attivi, ma aumenta la quantità di lavoro necessario per la transizione non attiva-attiva e la velocità della transizione diventa inattivo. Vi sono casi in cui si è verificato un problema: ad esempio, prendere in considerazione una griglia delle caselle di testo. Quando il cursore su e giù intelligente tramite la colonna, ogni controllo deve essere posto attivata e disattivata quindi. La velocità della transizione non attiva/attiva influirà direttamente la velocità di scorrimento.

Per altre informazioni sullo sviluppo di un'infrastruttura di controllo OLE, vedere gli articoli [controlli ActiveX MFC](../../mfc/mfc-activex-controls.md) e [Panoramica: creazione di un programma di controllo ActiveX MFC](../../mfc/reference/mfc-activex-control-wizard.md). Per informazioni sull'ottimizzazione OLE controlli, inclusi i controlli privi di finestra e sfarfallio, vedere [controlli ActiveX MFC: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`COleControl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxctl. h

##  <a name="ambientbackcolor"></a>  COleControl::AmbientBackColor

Restituisce il valore della proprietà di colore di sfondo ambiente.

```
OLE_COLOR AmbientBackColor();
```

### <a name="return-value"></a>Valore restituito

Il valore corrente di proprietà BackColor di ambiente del contenitore, se presente. Se la proprietà non è supportata, questa funzione restituisce il colore di sfondo definito dal sistema Windows.

### <a name="remarks"></a>Note

La proprietà di colore di sfondo ambiente è disponibile per tutti i controlli e viene definita dal contenitore. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientdisplayname"></a>  COleControl::AmbientDisplayName

Il nome che contenitore ha assegnato al controllo può essere utilizzato nei messaggi di errore visualizzati all'utente.

```
CString AmbientDisplayName();
```

### <a name="return-value"></a>Valore restituito

Il nome del controllo OLE. Il valore predefinito è una stringa di lunghezza zero.

### <a name="remarks"></a>Note

Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientfont"></a>  COleControl::AmbientFont

Restituisce il valore della proprietà di tipo di carattere ambiente.

```
LPFONTDISP AmbientFont();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'interfaccia di dispatch del tipo di carattere ambiente del contenitore. Il valore predefinito è NULL. Se il valore restituito non è uguale a NULL, si è responsabile del rilascio il tipo di carattere chiamando relativi [IUnknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) funzione membro.

### <a name="remarks"></a>Note

La proprietà di tipo di carattere ambiente è definita dal contenitore e disponibile a tutti i controlli. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientforecolor"></a>  COleControl::AmbientForeColor

Restituisce il valore della proprietà di colore di primo piano di ambiente.

```
OLE_COLOR AmbientForeColor();
```

### <a name="return-value"></a>Valore restituito

Il valore corrente di proprietà ForeColor di ambiente del contenitore, se presente. Se non è supportata, questa funzione restituisce il colore del testo definito dal sistema Windows.

### <a name="remarks"></a>Note

La proprietà di colore di primo piano di ambiente è disponibile per tutti i controlli e viene definita dal contenitore. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientlocaleid"></a>  COleControl::AmbientLocaleID

Restituisce l'ID impostazioni locali. del contenitore

```
LCID AmbientLocaleID();
```

### <a name="return-value"></a>Valore restituito

Il valore della proprietà LocaleID del contenitore, se presente. Se questa proprietà non è supportata, questa funzione restituisce 0.

### <a name="remarks"></a>Note

Il controllo è possibile usare LocaleID per adattare l'interfaccia utente per le impostazioni locali specifiche. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientappearance"></a>  COleControl::AmbientAppearance

Recupera l'impostazione di aspetto corrente per l'oggetto di controllo.

```
short AmbientAppearance();
```

### <a name="return-value"></a>Valore restituito

L'aspetto del controllo:

- **0** flat aspetto

- **1** aspetto 3D

### <a name="remarks"></a>Note

Chiamare questa funzione per recuperare il valore corrente della proprietà DISPID_AMBIENT_APPEARANCE per il controllo.

##  <a name="ambientscaleunits"></a>  COleControl::AmbientScaleUnits

Restituisce il tipo di unità usate dal contenitore.

```
CString AmbientScaleUnits();
```

### <a name="return-value"></a>Valore restituito

Stringa contenente l'ambiente ScaleUnits del contenitore. Se questa proprietà non è supportata, questa funzione restituisce una stringa di lunghezza zero.

### <a name="remarks"></a>Note

Proprietà ScaleUnits ambiente del contenitore è utilizzabile per visualizzare le posizioni o dimensioni, state assegnate l'unità scelto, ad esempio twip o in centimetri. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientshowgrabhandles"></a>  COleControl::AmbientShowGrabHandles

Determina se il contenitore consente il controllo da visualizzare quadratini di ridimensionamento per se stessa quando è attivo.

```
BOOL AmbientShowGrabHandles();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se devono essere visualizzati quadratini di ridimensionamento, in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce diverso da zero.

### <a name="remarks"></a>Note

Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientshowhatching"></a>  COleControl::AmbientShowHatching

Determina se il contenitore consente il controllo da visualizzare se stesso con un bordo tratteggiato modello quando attivo dell'interfaccia utente.

```
BOOL AmbientShowHatching();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se deve essere visualizzato il motivo a tratteggio; in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce diverso da zero.

### <a name="remarks"></a>Note

Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambienttextalign"></a>  COleControl::AmbientTextAlign

Determina l'allineamento del testo dell'ambiente preferita per il contenitore del controllo.

```
short AmbientTextAlign();
```

### <a name="return-value"></a>Valore restituito

Lo stato della proprietà TextAlign ambiente del contenitore. Se questa proprietà non è supportata, questa funzione restituisce 0.

Di seguito è riportato un elenco di valori validi restituiti:

|Valore restituito|Significato|
|------------------|-------------|
|0|Allineamento generale (numeri in testo di destra, a sinistra).|
|1|Allinea a sinistra|
|2|Al centro|
|3|Allinea a destra|

### <a name="remarks"></a>Note

Questa proprietà è disponibile per tutti i controlli incorporati e viene definita dal contenitore. Si noti che il contenitore non è necessaria per supportare questa proprietà.

##  <a name="ambientuidead"></a>  COleControl::AmbientUIDead

Determina se il contenitore richieda il controllo per rispondere alle azioni dell'interfaccia utente.

```
BOOL AmbientUIDead();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo deve rispondere alle azioni dell'interfaccia utente; in caso contrario 0. Se questa proprietà non è supportata, questa funzione restituisce 0.

### <a name="remarks"></a>Note

Ad esempio, un contenitore potrebbe impostare questo su TRUE nella modalità progettazione.

##  <a name="ambientusermode"></a>  COleControl::AmbientUserMode

Determina se il contenitore è in modalità progettazione o in modalità utente.

```
BOOL AmbientUserMode();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore è in modalità utente. in caso contrario, 0 (in modalità progettazione). Se questa proprietà non è supportata, questa funzione restituisce TRUE.

### <a name="remarks"></a>Note

Ad esempio, un contenitore potrebbe impostare questo su FALSE nella modalità progettazione.

##  <a name="boundpropertychanged"></a>  COleControl::BoundPropertyChanged

Segnala che è stato modificato il valore della proprietà associata.

```
void BoundPropertyChanged(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà associata del controllo.

### <a name="remarks"></a>Note

Deve essere richiamato ogni volta che il valore della proprietà cambia, anche nei casi in cui la modifica non è stata eseguita tramite la proprietà metodo Set. Possibile approfondire la conoscenza delle proprietà associate che vengono mappate alle variabili membro. Ogni volta che questo tipo una variabile le modifiche ai membri, `BoundPropertyChanged` deve essere chiamato.

##  <a name="boundpropertyrequestedit"></a>  COleControl::BoundPropertyRequestEdit

Richiede l'autorizzazione dal `IPropertyNotifySink` interfaccia per modificare un valore della proprietà associata fornito dal controllo.

```
BOOL BoundPropertyRequestEdit(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà associata del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è consentita la modifica; in caso contrario 0. Il valore predefinito è diverso da zero.

### <a name="remarks"></a>Note

Se viene negata l'autorizzazione, il controllo non deve consentire il valore modifica della proprietà. Questa operazione può essere eseguita tramite ignorando o l'azione che ha tentato di modificare il valore della proprietà di esecuzione.

##  <a name="clienttoparent"></a>  COleControl::ClientToParent

Converte le coordinate di *PowerPoint* nelle coordinate padre.

```
virtual void ClientToParent(
    LPCRECT lprcBounds,
    LPPOINT pPoint) const;
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Puntatore ai limiti del controllo OLE all'interno del contenitore. Area non client, ma l'area del controllo intera, compresi i bordi e le barre di scorrimento.

*PowerPoint*<br/>
Puntatore al punto di area client OLE da convertire nelle coordinate dell'elemento padre (contenitore).

### <a name="remarks"></a>Note

Sull'input *PowerPoint* è relativo all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo). Nell'output *PowerPoint* è relativo all'origine dell'elemento padre (angolo superiore sinistro del contenitore).

##  <a name="clipcaretrect"></a>  COleControl::ClipCaretRect

Regola un rettangolo di accento circonflesso se è interamente o parzialmente coperto da oggetti opachi sovrapposti.

```
BOOL ClipCaretRect(LPRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
In input, puntatore a un [RECT](../../mfc/reference/rect-structure1.md) struttura che contiene l'area di accento circonflesso affinché venga regolato. Area di output, il punto di inserimento adattata, o NULL se il rettangolo di accento circonflesso è completamente coperto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Un punto di inserimento è una riga, blocco o bitmap che indica in genere in cui verrà inserita il testo o grafica lampeggiante.

Un oggetto senza finestra non è possibile visualizzare in modo sicuro un punto di inserimento senza prima controllare se il punto di inserimento è parzialmente o completamente nascosto da oggetti sovrapposti. Per assicurarsi che possibili, è possibile usare un oggetto `ClipCaretRect` per ottenere il punto di inserimento regolato (ridotti) per verificare che quest'ultima rientri nell'area di ridimensionamento.

Creazione di un punto di inserimento di oggetti devono inviare il rettangolo di accento circonflesso da `ClipCaretRect` allo stesso modo del rettangolo per il punto di inserimento. Se il cursore è completamente nascosto, questo metodo restituirà FALSE e il punto di inserimento non deve essere visualizzato affatto in questo caso.

##  <a name="colecontrol"></a>  COleControl::COleControl

Costruisce un oggetto `COleControl`.

```
COleControl();
```

### <a name="remarks"></a>Note

Questa funzione in genere non viene chiamata direttamente. Il controllo OLE in genere viene invece creato dalla relativa class factory.

##  <a name="controlinfochanged"></a>  COleControl::ControlInfoChanged

Chiamare questa funzione quando viene modificato il set di tasti di scelta è supportato dal controllo.

```
void ControlInfoChanged();
```

### <a name="remarks"></a>Note

Dopo aver ricevuto questa notifica, il contenitore del controllo ottiene il nuovo set di tasti di scelta effettuando una chiamata a [IOleControl::GetControlInfo](/windows/desktop/api/ocidl/nf-ocidl-iolecontrol-getcontrolinfo). Si noti che il contenitore non è necessario per rispondere a questa notifica.

##  <a name="displayerror"></a>  COleControl::DisplayError

Chiamato dal framework dopo l'evento di errore predefinita è stata gestita (a meno che il gestore dell'evento ha eliminato la visualizzazione dell'errore).

```
virtual void DisplayError(
    SCODE scode,
    LPCTSTR lpszDescription,
    LPCTSTR lpszSource,
    LPCTSTR lpszHelpFile,
    UINT nHelpID);
```

### <a name="parameters"></a>Parametri

*SCODE*<br/>
Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La descrizione dell'errore segnalato.

*lpszSource*<br/>
Il nome del modulo di generazione dell'errore (in genere, il nome del modulo di controllo OLE).

*lpszHelpFile*<br/>
Il nome del file della Guida contenente una descrizione dell'errore.

*nHelpID*<br/>
L'ID contesto della Guida dell'errore segnalato.

### <a name="remarks"></a>Note

Il comportamento predefinito consente di visualizzare una finestra di messaggio contenente la descrizione dell'errore, racchiusa *lpszDescription*.

Eseguire l'override di questa funzione per personalizzare la modalità di visualizzazione degli errori.

##  <a name="doclick"></a>  COleControl::DoClick

Simula un mouse fare clic su azione sul controllo.

```
void DoClick();
```

### <a name="remarks"></a>Note

Il sottoponibile a override `COleControl::OnClick` verrà chiamata la funzione membro e un'azione fare clic su evento verrà generato, se supportato dal controllo.

Questa funzione è supportata per il `COleControl` classe di base come un metodo azionario, denominato DoClick. Per altre informazioni, vedere l'articolo [controlli ActiveX: metodi](../../mfc/mfc-activex-controls-methods.md).

##  <a name="dopropexchange"></a>  COleControl::DoPropExchange

Chiamato dal framework durante il caricamento o l'archiviazione di un controllo da una rappresentazione di un archivio permanente, ad esempio un set di proprietà o di flusso.

```
virtual void DoPropExchange(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Un puntatore a un `CPropExchange` oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="remarks"></a>Note

Questa funzione esegue in genere chiamate per il **px _** della famiglia di funzioni per caricare o archiviare proprietà specifiche definite dall'utente di un controllo OLE.

Se controllo procedura guidata è stato usato per creare il progetto di controllo OLE, la versione sottoposta a override di questa funzione verrà serializzare le proprietà predefinite supportate da `COleControl` con una chiamata alla funzione di classe di base, `COleControl::DoPropExchange`. Quando si aggiungono proprietà definite dall'utente al controllo OLE che sarà necessario modificare questa funzione per serializzare la nuova proprietà. Per altre informazioni sulla serializzazione, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="dosuperclasspaint"></a>  COleControl::DoSuperclassPaint

Consente di ricreare un controllo OLE che è stato sottoclassato da un controllo di Windows.

```
void DoSuperclassPaint(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo del contenitore del controllo.

*rcBounds*<br/>
L'area in cui deve essere disegnato il controllo.

### <a name="remarks"></a>Note

Chiamare questa funzione per gestire correttamente il disegno di un controllo OLE non attivo. Questa funzione deve essere usata solo se l'OLE sottoclassi del controllo un controllo di Windows e deve essere chiamato nel `OnDraw` funzione del controllo.

Per altre informazioni su questa funzione e crea una sottoclasse di un controllo di Windows, vedere l'articolo [controlli ActiveX: crea una sottoclasse di un controllo Windows](../../mfc/mfc-activex-controls-subclassing-a-windows-control.md).

##  <a name="drawcontent"></a>  COleControl::DrawContent

Chiamato dal framework quando l'aspetto del controllo deve essere aggiornato.

```
void DrawContent(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo.

*RC*<br/>
Area rettangolare da disegnare in.

### <a name="remarks"></a>Note

Questa funzione chiama direttamente il sottoponibile a override `OnDraw` (funzione).

##  <a name="drawmetafile"></a>  COleControl::DrawMetafile

Chiamato dal framework quando viene utilizzato il contesto di dispositivo metafile.

```
void DrawMetafile(
    CDC* pDC,
    CRect& rc);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore al contesto di dispositivo metafile.

*RC*<br/>
Area rettangolare da disegnare in.

##  <a name="enablesimpleframe"></a>  COleControl::EnableSimpleFrame

Abilita la caratteristica di frame semplice per un controllo OLE.

```
void EnableSimpleFrame();
```

### <a name="remarks"></a>Note

Questa caratteristica consente a un controllo supportare il contenimento visivo di altri controlli, ma non è true contenimento OLE. Un esempio sarebbe con vari controlli all'interno di una casella di gruppo. Questi controlli non sono contenuti OLE, ma sono nella stessa casella di gruppo.

##  <a name="exchangeextent"></a>  COleControl::ExchangeExtent

Serializza o Inizializza lo stato dell'estensione del controllo (le dimensioni in unità HIMETRIC).

```
BOOL ExchangeExtent(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Un puntatore a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la funzione ha esito positivo. in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione viene in genere chiamata dall'implementazione predefinita di `COleControl::DoPropExchange`.

##  <a name="exchangestockprops"></a>  COleControl::ExchangeStockProps

Serializza o Inizializza lo stato delle proprietà predefinite del controllo.

```
void ExchangeStockProps(CPropExchange* pPX);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Un puntatore a un [CPropExchange](../../mfc/reference/cpropexchange-class.md) oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

### <a name="remarks"></a>Note

Questa funzione viene in genere chiamata dall'implementazione predefinita di `COleControl::DoPropExchange`.

##  <a name="exchangeversion"></a>  COleControl::ExchangeVersion

Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.

```
BOOL ExchangeVersion(
    CPropExchange* pPX,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametri

*pPX*<br/>
Un puntatore a un `CPropExchange` oggetto. Il framework fornisce questo oggetto per stabilire il contesto dello scambio di proprietà, inclusa la relativa direzione.

*dwVersionDefault*<br/>
Il numero di versione corrente del controllo.

*bConvert*<br/>
Indica se i dati persistenti devono essere convertiti nel formato più recente quando salvate o mantenute nello stesso formato che è stato caricato.

### <a name="return-value"></a>Valore restituito

NonZero della funzione ha esito positivo. in caso contrario 0.

### <a name="remarks"></a>Note

In genere, questa sarà la prima funzione chiamata da un override del metodo `COleControl::DoPropExchange`. Durante il caricamento, questa funzione legge il numero di versione dei dati persistenti e imposta l'attributo version del [CPropExchange](../../mfc/reference/cpropexchange-class.md) conseguenza dell'oggetto. Quando si salva, questa funzione scrive il numero di versione dei dati persistenti.

Per altre informazioni sulla persistenza e il controllo delle versioni, vedere l'articolo [controlli ActiveX: serializzazione](../../mfc/mfc-activex-controls-serializing.md).

##  <a name="fireclick"></a>  COleControl::FireClick

Chiamato dal framework quando si fa clic sul passaggio del mouse su un controllo attivo.

```
void FireClick();
```

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento Click, mappa eventi del controllo è necessario fare clic su un titolo evento definito.

##  <a name="firedblclick"></a>  COleControl::FireDblClick

Chiamato dal framework quando il mouse viene fatto doppio clic su un controllo attivo.

```
void FireDblClick();
```

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento DblClick, mappa di eventi del controllo deve avere un evento DblClick predefinito definito.

##  <a name="fireerror"></a>  COleControl::FireError

Genera l'evento di errore predefinita.

```
void FireError(
    SCODE scode,
    LPCTSTR lpszDescription,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametri

*SCODE*<br/>
Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*lpszDescription*<br/>
La descrizione dell'errore segnalato.

*nHelpID*<br/>
L'ID della Guida dell'errore segnalato.

### <a name="remarks"></a>Note

Questo evento fornisce un modo di segnalazione, alla posizione appropriata nel codice, che si è verificato un errore all'interno del controllo. A differenza di altri eventi predefiniti, ad esempio MouseMove, o fare clic su errore non viene mai generato dal framework.

Per segnalare un errore che si verifica durante una funzione get della proprietà, funzione di set di proprietà o metodo di automazione, chiamare [COleControl:: ThrowError](#throwerror).

L'implementazione dell'evento di errore di scorte di un controllo OLE utilizza un valore SCODE. Se il controllo Usa questo evento e dovrà essere utilizzato in Visual Basic 4.0, si riceverà errori perché il valore SCODE non è supportato in Visual Basic.

Per risolvere questo problema, modificare manualmente il parametro SCODE del controllo. File ODL da un **lungo**. Inoltre, qualsiasi evento personalizzato, metodo o proprietà che utilizza un parametro SCODE provoca inoltre lo stesso problema.

##  <a name="fireevent"></a>  COleControl::FireEvent

Genera un evento definito dall'utente dal controllo con un numero qualsiasi di argomenti facoltativi.

```
void AFX_CDECL FireEvent(
    DISPID dispid,
    BYTE* pbParams,
...);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
ID dispatch dell'evento da generare.

*pbParams*<br/>
Un descrittore per i tipi di parametro dell'evento.

### <a name="remarks"></a>Note

In genere questa funzione non deve essere chiamata direttamente. Al contrario si chiamerà le funzioni di generazione dell'evento nella sezione della dichiarazione di classe del controllo mappa eventi.

Il *pbParams* argomento è un elenco delimitato da spazio **VTS _**. Uno o più di questi valori, separati da spazi (non virgole), specificano l'elenco dei parametri della funzione. I valori possibili sono i seguenti:

|Simbolo|Tipo di parametro|
|------------|--------------------|
|VTS_COLOR|OLE_COLOR|
|VTS_FONT|`IFontDisp*`|
|VTS_HANDLE|HWND|
|VTS_PICTURE|`IPictureDisp*`|
|VTS_OPTEXCLUSIVE|OLE_OPTEXCLUSIVE *|
|VTS_TRISTATE|OLE_TRISTATE|
|VTS_XPOS_HIMETRIC|OLE_XPOS_HIMETRIC|
|VTS_YPOS_HIMETRIC|OLE_YPOS_HIMETRIC|
|VTS_XPOS_PIXELS|OLE_XPOS_PIXELS|
|VTS_YPOS_PIXELS|OLE_YPOS_PIXELS|
|VTS_XSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_YSIZE_PIXELS|OLE_XSIZE_PIXELS|
|VTS_XSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|
|VTS_YSIZE_HIMETRIC|OLE_XSIZE_HIMETRIC|

> [!NOTE]
>  Costanti variante aggiuntive sono state definite per tutti i tipi varianti, fatta eccezione per VTS_FONT e VTS_PICTURE, che offrono un puntatore alla costante di dati variant. Queste costanti vengono denominate usando il **VTS_P** `constantname` convenzione. Ad esempio, VTS_PCOLOR è un puntatore a un VTS_COLOR (costante).

##  <a name="firekeydown"></a>  COleControl::FireKeyDown

Chiamato dal framework quando viene premuto un tasto mentre il controllo è attiva nell'interfaccia utente.

```
void FireKeyDown(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Puntatore al valore codice tasto virtuale del tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento KeyDown, mappa di eventi del controllo deve avere un evento KeyDown predefinito definito.

##  <a name="firekeypress"></a>  COleControl::FireKeyPress

Chiamato dal framework quando un tasto viene premuto e rilasciato mentre il controllo personalizzato è attivo dell'interfaccia utente all'interno del contenitore.

```
void FireKeyPress(USHORT* pnChar);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Un puntatore per il valore del carattere del tasto premuto.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Il destinatario dell'evento può modificare *pnChar*, ad esempio, convertire tutti i caratteri minuscoli in caratteri maiuscoli. Se si desidera esaminare il carattere modificato, eseguire l'override `OnKeyPressEvent`.

Per l'attivazione automatica di un evento KeyPress, mappa di eventi del controllo deve avere un evento KeyPress predefinito definito.

##  <a name="firekeyup"></a>  COleControl::FireKeyUp

Chiamato dal framework quando viene rilasciato un tasto mentre il controllo personalizzato è attivo dell'interfaccia utente all'interno del contenitore.

```
void FireKeyUp(
    USHORT* pnChar,
    short nShiftState);
```

### <a name="parameters"></a>Parametri

*pnChar*<br/>
Puntatore al valore della chiave rilasciato codice tasto virtuale. Per un elenco di codici di tasti virtuali standard, vedere winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento KeyUp, mappa di eventi del controllo deve avere un evento KeyUp predefinito definito.

##  <a name="firemousedown"></a>  COleControl::FireMouseDown

Chiamato dal framework quando viene premuto un pulsante del mouse su un controllo personalizzato attivo.

```
void FireMouseDown(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Il valore numerico del pulsante del mouse premuto. Può contenere uno dei valori seguenti:

- LEFT_BUTTON il pulsante sinistro del mouse è stato premuto.

- MIDDLE_BUTTON pulsante centrale del mouse è stato premuto.

- RIGHT_BUTTON il pulsante destro del mouse è stato premuto.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

*x*<br/>
La coordinata x del cursore quando è stato premuto un pulsante del mouse verso il basso. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
La coordinata y del cursore quando è stato premuto un pulsante del mouse verso il basso. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento MouseDown si verifichi, mappa di eventi del controllo deve avere un evento MouseDown predefinito definito.

##  <a name="firemousemove"></a>  COleControl::FireMouseMove

Chiamato dal framework quando il cursore viene spostato su un controllo personalizzato attivo.

```
void FireMouseMove(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Il valore numerico dei pulsanti del mouse premuto. Contiene una combinazione dei valori seguenti:

- LEFT_BUTTON durante l'azione è stato premuto il pulsante sinistro del mouse verso il basso.

- MIDDLE_BUTTON è stato premuto il pulsante centrale del mouse verso il basso durante l'azione.

- RIGHT_BUTTON durante l'azione è stato premuto il pulsante destro del mouse verso il basso.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

*x*<br/>
La coordinata x del cursore. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
La coordinata y del cursore. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento MouseMove, mappa di eventi del controllo deve avere un evento MouseMove predefinito definito.

##  <a name="firemouseup"></a>  COleControl::FireMouseUp

Chiamato dal framework quando viene rilasciato un pulsante del mouse su un controllo personalizzato attivo.

```
void FireMouseUp(
    short nButton,
    short nShiftState,
    OLE_XPOS_PIXELS x,
    OLE_YPOS_PIXELS y);
```

### <a name="parameters"></a>Parametri

*Npulsante*<br/>
Il valore numerico del pulsante del mouse rilasciato. Può avere uno dei valori seguenti:

- LEFT_BUTTON è stato rilasciato il pulsante sinistro del mouse.

- MIDDLE_BUTTON è stato rilasciato il pulsante centrale del mouse.

- RIGHT_BUTTON è stato rilasciato il pulsante destro del mouse.

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

*x*<br/>
La coordinata x del cursore quando è stato rilasciato un pulsante del mouse. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

*y*<br/>
La coordinata y di un cursore quando è stato rilasciato un pulsante del mouse. La coordinata è rispetto all'angolo superiore sinistro della finestra del controllo.

### <a name="remarks"></a>Note

Se questo evento viene definito come un evento personalizzato, determinare quando viene generato l'evento.

Per l'attivazione automatica di un evento MouseUp, mappa di eventi del controllo deve avere un evento MouseUp predefinito definito.

##  <a name="firereadystatechange"></a>  COleControl::FireReadyStateChange

Genera un evento con il valore corrente dello stato pronto del controllo.

```
void FireReadyStateChange();
```

### <a name="remarks"></a>Note

Stato ready può essere uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Controllo sta caricando le relative proprietà|
|READYSTATE_LOADED|Controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Controllo ha dati sufficienti in modo interattivo, ma non tutte asincrone dei dati sono ancora caricati|
|READYSTATE_COMPLETE|Controllo dispone di tutti i relativi dati|

Uso [GetReadyState](#getreadystate) per determinare la conformità corrente del controllo.

[InternalSetReadyState](#internalsetreadystate) modifica lo stato di pronto per il valore fornito, quindi chiama `FireReadyStateChange`.

##  <a name="getactivationpolicy"></a>  COleControl::GetActivationPolicy

Modifica il comportamento di attivazione predefinito di un controllo che supporta il `IPointerInactive` interfaccia.

```
virtual DWORD GetActivationPolicy();
```

### <a name="return-value"></a>Valore restituito

Una combinazione di flag dall'enumerazione POINTERINACTIVE. Flag possibili sono:

|||
|-|-|
|POINTERINACTIVE_ACTIVATEONENTRY|L'oggetto deve essere attivato quando il mouse viene spostato durante un'operazione di spostamento del mouse sul posto.|
|POINTERINACTIVE_DEACTIVATEONLEAVE|L'oggetto deve essere disattivato quando il mouse lascia l'oggetto durante un'operazione di spostamento del mouse.|
|POINTERINACTIVE_ACTIVATEONDRAG|L'oggetto deve essere posto attivato quando si trascina il mouse su di esso durante il trascinamento e l'operazione di eliminazione.|

### <a name="remarks"></a>Note

Quando il `IPointerInactive` interfaccia è abilitata, il contenitore delegherà i messaggi WM_SETCURSOR e WM_MOUSEMOVE ad esso. `COleControl`dell'implementazione di questa interfaccia verrà inviano questi messaggi tramite mappa messaggi del controllo, dopo la regolazione del mouse coordina in modo appropriato.

Ogni volta che il contenitore riceve un messaggio WM_SETCURSOR o WM_MOUSEMOVE con il puntatore del mouse su un oggetto inattivo che supportano `IPointerInactive`, questo deve chiamare `GetActivationPolicy` sull'interfaccia e il flag restituiti dall'enumerazione POINTERINACTIVE.

È possibile elaborare questi messaggi come comuni messaggi di finestra, aggiungendo le voci corrispondenti alla mappa messaggi. Nei gestori, evitare di usare il `m_hWnd` variabile membro (o tutte le funzioni membro che lo utilizza) senza prima verificare che il relativo valore sia diverso da NULL.

Qualsiasi oggetto destinata a più di impostare il cursore del mouse e/o generare un evento di spostamento del mouse, ad esempio fornire indicazioni visive speciali, deve restituire il flag POINTERINACTIVE_ACTIVATEONENTRY e disegnare il feedback solo quando è attivo. Se l'oggetto viene restituito questo flag, il contenitore deve attivarlo posto immediatamente e quindi trasmette il messaggio stesso che ha attivato la chiamata a `GetActivationPolicy`.

Se vengono restituiti i flag POINTERINACTIVE_ACTIVATEONENTRY sia POINTERINACTIVE_DEACTIVATEONLEAVE, quindi l'oggetto sarà attivata solo quando il mouse è posizionato sopra l'oggetto. Se solo il flag POINTERINACTIVE_ACTIVATEONENTRY viene restituito, quindi l'oggetto sarà attivata solo una volta quando il mouse viene posizionato prima di tutto l'oggetto.

È anche possibile un controllo inattivo per essere la destinazione di un trascinamento OLE e l'operazione di eliminazione. Questa operazione richiede l'attivazione del controllo nel momento in cui che l'utente trascina un oggetto su di esso, in modo che la finestra del controllo può essere registrata come destinazione di rilascio. Per causare l'attivazione si verificano durante il trascinamento, restituire il flag POINTERINACTIVE_ACTIVATEONDRAG:

[!code-cpp[NVC_MFCAxCtl#1](../../mfc/reference/codesnippet/cpp/colecontrol-class_1.cpp)]

Le informazioni comunicate dal `GetActivationPolicy` non deve essere memorizzato nella cache da un contenitore. Al contrario, questo metodo deve essere chiamato ogni volta che il mouse viene spostato su un oggetto inattivo.

Se un oggetto inattivo non viene richiesta per essere attivato quando il mouse viene spostato, sul posto, il contenitore deve inviare messaggi WM_SETCURSOR successivi a questo oggetto chiamando [OnInactiveSetCursor](#oninactivesetcursor) fino a quando il puntatore del mouse resta di sopra l'oggetto.

L'abilitazione di `IPointerInactive` interfaccia indica in genere che si desidera il controllo sia in grado di elaborare i messaggi del mouse in qualsiasi momento. Per ottenere questo comportamento in un contenitore che non supporta il `IPointerInactive` interfaccia, è necessario disporre sempre attivo quando visibile, ovvero il controllo deve essere il flag OLEMISC_ACTIVATEWHENVISIBLE tra i vari flag. Tuttavia, per evitare questo flag di entrata in vigore in un contenitore che supporta `IPointerInactive`, è anche possibile specificare il flag OLEMISC_IGNOREACTIVATEWHENVISIBLE:

[!code-cpp[NVC_MFCAxCtl#10](../../mfc/reference/codesnippet/cpp/colecontrol-class_2.cpp)]

##  <a name="getambientproperty"></a>  COleControl::GetAmbientProperty

Ottiene il valore della proprietà di ambiente del contenitore.

```
BOOL GetAmbientProperty(
    DISPID dispid,
    VARTYPE vtProp,
    void* pvProp);
```

### <a name="parameters"></a>Parametri

*dwDispid*<br/>
ID dispatch della proprietà di ambiente desiderata.

*vtProp*<br/>
Un tag di tipo variant che specifica il tipo del valore da restituire in *pvProp*.

*pvProp*<br/>
Un puntatore all'indirizzo della variabile che riceverà il valore della proprietà o valore restituito. Il tipo effettivo del puntatore ' this ' deve corrispondere al tipo specificato da *vtProp*.

|vtProp|Tipo di pvProp|
|------------|--------------------|
|VT_BOOL|`BOOL*`|
|VT_BSTR|`CString*`|
|VT_I2|`short*`|
|VT_I4|`long*`|
|VT_R4|`float*`|
|VT_R8|`double*`|
|VT_CY|`CY*`|
|VT_COLOR|`OLE_COLOR*`|
|VT_DISPATCH|`LPDISPATCH*`|
|VT_FONT|`LPFONTDISP*`|

### <a name="return-value"></a>Valore restituito

Diverso da zero se la proprietà di ambiente è supportata; in caso contrario 0.

### <a name="remarks"></a>Note

Se si usa `GetAmbientProperty` per recuperare le proprietà DisplayName e ScaleUnits ambiente, impostare *vtProp* su VT_BSTR e *pvProp* a `CString*`. Se si stanno recuperando la proprietà di tipo di carattere ambiente, impostare *vtProp* a VT_FONT e *pvProp* a LPFONTDISP *.

Si noti che le funzioni sono già state fornite per le proprietà di ambiente comuni, ad esempio [AmbientBackColor](#ambientbackcolor) e [AmbientFont](#ambientfont).

##  <a name="getappearance"></a>  COleControl::GetAppearance

Implementa la funzione Get della proprietà Appearance predefinite del controllo.

```
short GetAppearance ();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica l'impostazione corrente di aspetto come un **breve** valore (VT_I2), se ha esito positivo. Questo valore è zero se l'aspetto del controllo è fissa e 1 se l'aspetto del controllo è 3D.

##  <a name="getbackcolor"></a>  COleControl::GetBackColor

Implementa la funzione Get della proprietà BackColor predefinite del controllo.

```
OLE_COLOR GetBackColor();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica il colore di sfondo corrente come valore OLE_COLOR, se ha esito positivo. Questo valore può essere convertito in un valore COLORREF con una chiamata a `TranslateColor`.

##  <a name="getborderstyle"></a>  COleControl::GetBorderStyle

Implementa la funzione Get della proprietà BorderStyle predefinite del controllo.

```
short GetBorderStyle();
```

### <a name="return-value"></a>Valore restituito

1 se il controllo ha un bordo normale. 0 se il controllo dispone di alcun bordo.

##  <a name="getcapture"></a>  COleControl::GetCapture

Determina se il `COleControl` oggetto lo stato mouse capture.

```
CWnd* GetCapture();
```

### <a name="return-value"></a>Valore restituito

Se il controllo è attivato e privi di finestra, restituisce **ciò** se il controllo dispone attualmente il puntatore del mouse capture (come determinato dal contenitore del controllo), oppure NULL se non ha l'acquisizione.

In caso contrario, restituisce il `CWnd` oggetto che lo stato mouse capture (uguale a `CWnd::GetCapture`).

### <a name="remarks"></a>Note

Un controllo senza finestra attivato riceve il puntatore del mouse capture quando [SetCapture](#setcapture) viene chiamato.

##  <a name="getclassid"></a>  COleControl::GetClassID

Chiamata eseguita dal framework per recuperare l'ID della classe del controllo OLE.

```
virtual HRESULT GetClassID(LPCLSID pclsid) = 0;
```

### <a name="parameters"></a>Parametri

*pclsid*<br/>
Puntatore alla posizione dell'ID di classe.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata non è riuscita; in caso contrario 0.

### <a name="remarks"></a>Note

In genere implementata dal [IMPLEMENT_OLECREATE_EX](class-factories-and-licensing.md#implement_olecreate_ex).

##  <a name="getclientoffset"></a>  COleControl::GetClientOffset

Recupera la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client.

```
virtual void GetClientOffset(long* pdxOffset, long* pdyOffset) const;
```

### <a name="parameters"></a>Parametri

*pdxOffset*<br/>
Puntatore all'offset orizzontale dell'area client del controllo OLE.

*pdyOffset*<br/>
Puntatore all'offset verticale dell'area client del controllo OLE.

### <a name="remarks"></a>Note

Il controllo OLE ha un'area rettangolare all'interno del contenitore. L'area client del controllo è l'area di controllo ad eccezione di bordi e le barre di scorrimento. L'offset recuperato da `GetClientOffset` è la differenza tra l'angolo superiore sinistro dell'area rettangolare del controllo e l'angolo superiore sinistro della relativa area client. Se il controllo contiene gli elementi non client diversi dai bordi standard e le barre di scorrimento, eseguire l'override di questa funzione membro per specificare l'offset.

##  <a name="getclientrect"></a>  COleControl::GetClientRect

Recupera la dimensione dell'area client del controllo.

```
virtual void GetClientRect(LPRECT lpRect) const;
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore a un `RECT` struttura contenente le dimensioni dell'area client del controllo senza finestra, vale a dire le dimensioni del controllo + /-bordi della finestra, frame, le barre di scorrimento e così via. Il *lpRect* parametro indica le dimensioni del rettangolo client del controllo, non la posizione.

##  <a name="getclientsite"></a>  COleControl::GetClientSite

Esegue una query un oggetto per il puntatore al relativo sito client corrente all'interno del contenitore.

```
LPOLECLIENTSITE GetClientSite();
```

### <a name="return-value"></a>Valore restituito

Puntatore al sito client corrente del controllo relativo contenitore.

### <a name="remarks"></a>Note

Il puntatore restituito punta a un'istanza di `IOleClientSite`. Il `IOleClientSite` interfaccia implementata da contenitori, è la visualizzazione dell'oggetto di contesto: in cui è ancorata nel documento, in cui Ottiene lo spazio di archiviazione, interfaccia utente e altre risorse.

##  <a name="getcontrolflags"></a>  COleControl::GetControlFlags

Recupera le impostazioni del flag di controllo.

```
virtual DWORD GetControlFlags();
```

### <a name="return-value"></a>Valore restituito

Una combinazione ORed dei flag dell'enumerazione ControlFlags:

```
enum ControlFlags {
    fastBeginPaint = 0x0001,
    clipPaintDC = 0x0002,
    pointerInactive = 0x0004,
    noFlickerActivate = 0x0008,
    windowlessActivate = 0x0010,
    canOptimizeDraw = 0x0020,
    };
```

### <a name="remarks"></a>Note

Per impostazione predefinita `GetControlFlags` restituisce `fastBeginPaint | clipPaintDC`.

|||
|-|-|
|`fastBeginPaint`|Se impostato, viene utilizzato un begin-paint (funzione) pensata su misura per controlli OLE anziché il [BeginPaint](/windows/desktop/api/winuser/nf-winuser-beginpaint) API (impostazione predefinita).|
|`clipPaintDC`|Se non impostato, disabilita la chiamata a `IntersectClipRect` effettuate da `COleControl` e garantisce una maggiore velocità. Se si utilizza l'attivazione senza finestra, il flag non ha alcun effetto.|
|`pointerInactive`|Se impostato, fornisce l'interazione del mouse mentre il controllo è inattivo, consentendo `COleControl`dell'implementazione del `IPointerInactive` interfaccia, che è disabilitata per impostazione predefinita.|
|`noFlickerActivate`|Se impostato, Elimina le operazioni di disegno aggiuntivi e lo sfarfallio. Utilizzarlo quando il controllo disegna se stesso in modo identico negli stati attivi e inattivi. Se si utilizza l'attivazione senza finestra, il flag non ha alcun effetto.|
|`windowlessActivate`|Se impostato, indica che il controllo utilizza l'attivazione senza finestra.|
|`canOptimizeDraw`|Se impostato, indica che il controllo eseguirà il disegno ottimizzato, se il contenitore lo supporta.|

Per altre informazioni sulle `GetControlFlags` e altre ottimizzazioni di controlli OLE, vedere [dei controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="getcontrolsize"></a>  COleControl::GetControlSize

Recupera la dimensione della finestra del controllo OLE.

```
void GetControlSize(
    int* pcx,
    int* pcy);
```

### <a name="parameters"></a>Parametri

*pcx*<br/>
Specifica la larghezza del controllo in pixel.

*pcy*<br/>
Specifica l'altezza del controllo in pixel.

### <a name="remarks"></a>Note

Si noti che tutte le coordinate per finestre di controllo rispetto all'angolo superiore sinistro del controllo.

##  <a name="getdc"></a>  COleControl::GetDC

Fornisce per un oggetto senza finestra per il contesto di periferica get una schermata (o compatibile) dal relativo contenitore.

```
CDC* GetDC(
    LPCRECT lprcRect = NULL,
    DWORD dwFlags = OLEDC_PAINTBKGND);
```

### <a name="parameters"></a>Parametri

*lprcRect*<br/>
Un puntatore al rettangolo il controllo senza finestra deve essere ridisegnato, nelle coordinate del client del controllo. NULL indica che l'estensione dell'oggetto completo.

*dwFlags*<br/>
Gli attributi del contesto di dispositivo di disegno. Opzioni disponibili sono:

- OLEDC_NODRAW indica che l'oggetto non utilizza il contesto di dispositivo per eseguire qualsiasi ma semplicemente di disegno per ottenere informazioni sul dispositivo di visualizzazione. Il contenitore deve semplicemente passare controller di dominio della finestra senza ulteriore elaborazione.

- OLEDC_PAINTBKGND richiede che il contenitore di disegnare lo sfondo prima della restituzione del controller di dominio. Un oggetto deve usare questo flag se sta richiedendo un controller di dominio per il disegno di un'area con sfondo trasparente.

- OLEDC_OFFSCREEN informa il contenitore in cui l'oggetto desidera eseguire il rendering in una bitmap fuori schermo che deve essere copiata quindi alla schermata. Un oggetto deve usare questo flag quando sta per eseguire l'operazione di disegno genera molti lo sfarfallio. Il contenitore è disponibile soddisfare questa richiesta o non. Tuttavia, se questo flag non è impostato, il contenitore deve passare nuovamente sullo schermo controller di dominio. In questo modo gli oggetti eseguire operazioni dirette dello schermo, ad esempio che mostra una selezione (tramite un **XOR** operazione).

### <a name="return-value"></a>Valore restituito

Puntatore al contesto di dispositivo di visualizzazione per il contenitore `CWnd` area client se ha esito positivo; in caso contrario, il valore restituito è NULL. Contesto di dispositivo di visualizzazione è utilizzabile nelle funzioni GDI successive per disegnare l'area client della finestra del contenitore.

### <a name="remarks"></a>Note

Il [ReleaseDC](#releasedc) funzione membro deve essere chiamata per rilasciare il contesto dopo il disegno. Quando si chiama `GetDC`, gli oggetti passano il rettangolo in cui per disegnare nelle proprie coordinate del client. `GetDC` Converte le coordinate dell'area client di contenitore. L'oggetto non deve richiedere un rettangolo di disegno desiderato più rettangolo la propria area client, le cui dimensioni possono essere recuperate con grande [GetClientRect](#getclientrect). In questo modo si impedisce che gli oggetti inavvertitamente disegno in cui non sono tenuti a.

##  <a name="getenabled"></a>  COleControl::GetEnabled

Implementa la funzione Get di scorta del controllo proprietà Enabled.

```
BOOL GetEnabled();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è abilitato; in caso contrario 0.

##  <a name="getextendedcontrol"></a>  COleControl::GetExtendedControl

Ottiene un puntatore a un oggetto gestito dal contenitore che rappresenta il controllo con un set di proprietà estese.

```
LPDISPATCH GetExtendedControl();
```

### <a name="return-value"></a>Valore restituito

Un puntatore al contenitore dell'esteso oggetto controllo. Se è presente alcun oggetto disponibile, il valore è NULL.

Questo oggetto può essere modificato tramite relativo `IDispatch` interfaccia. È anche possibile usare `QueryInterface` per ottenere altre interfacce disponibili fornite dall'oggetto. Tuttavia, l'oggetto non è necessario per supportare un set specifico di interfacce. Si noti che basarsi su funzionalità specifiche dell'oggetto controllo esteso del contenitore limita la portabilità del controllo in altri contenitori arbitrari.

### <a name="remarks"></a>Note

La funzione che chiama questa funzione è responsabile del rilascio il puntatore al termine con l'oggetto. Si noti che il contenitore non è necessaria per supportare questo oggetto.

##  <a name="getfocus"></a>  COleControl::GetFocus

Determina se il `COleControl` oggetto ha lo stato attivo.

```
CWnd* GetFocus();
```

### <a name="return-value"></a>Valore restituito

Se il controllo è attivato e privi di finestra, restituisce **ciò** se il controllo dispone attualmente della tastiera concentrarsi (come determinato dal contenitore del controllo), oppure NULL se non ha lo stato attivo.

In caso contrario, restituisce il `CWnd` oggetto con lo stato attivo (uguale a `CWnd::GetFocus`).

### <a name="remarks"></a>Note

Un controllo senza finestra attivato riceve lo stato attivo quando [SetFocus](#setfocus) viene chiamato.

##  <a name="getfont"></a>  COleControl::GetFont

Implementa la funzione Get della proprietà del tipo di carattere azionario.

```
LPFONTDISP GetFont();
```

### <a name="return-value"></a>Valore restituito

Un puntatore all'interfaccia dispatch del tipo di carattere del titolo del controllo proprietà Font.

### <a name="remarks"></a>Note

Si noti che il chiamante deve rilasciare l'oggetto al termine. All'interno dell'implementazione del controllo, usare `InternalGetFont` per accedere all'oggetto del tipo di carattere azionario del controllo. Per altre informazioni sull'uso di tipi di carattere nel controllo, vedere l'articolo [controlli ActiveX: usando i tipi di carattere in un controllo ActiveX](../../mfc/mfc-activex-controls-using-fonts.md).

##  <a name="getfonttextmetrics"></a>  COleControl::GetFontTextMetrics

Misurare le metriche di testo per qualsiasi `CFontHolder` oggetto di proprietà dal controllo.

```
void GetFontTextMetrics(
    LPTEXTMETRIC lptm,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametri

*lptm*<br/>
Puntatore a un [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) struttura.

*fontHolder*<br/>
Fare riferimento a un [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto.

### <a name="remarks"></a>Note

È possibile selezionare un tipo di carattere con la [COleControl::SelectFontObject](#selectfontobject) (funzione). `GetFontTextMetrics` verrà inizializzato il `TEXTMETRIC` struttura a cui punta *lptm* con informazioni di metriche valide su `fontHolder`del tipo di carattere se ha esito positivo, o struttura viene riempita con zeri se l'operazione non riesce. È consigliabile usare questa funzione anziché [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) quando disegno del controllo perché i controlli, ad esempio qualsiasi incorporato oggetto OLE, possono essere necessari per eseguire il rendering di se stessi in un metafile.

Il `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornato quando il [SelectFontObject](#selectfontobject) funzione viene chiamata. È necessario chiamare `GetFontTextMetrics` solo dopo aver selezionando la proprietà predefinita per garantire le informazione disponibili è valido.

##  <a name="getforecolor"></a>  COleControl::GetForeColor

Implementa la funzione Get della proprietà ForeColor azionario.

```
OLE_COLOR GetForeColor();
```

### <a name="return-value"></a>Valore restituito

Il valore restituito specifica il colore di primo piano corrente come valore OLE_COLOR, se ha esito positivo. Questo valore può essere convertito in un [COLORREF](/windows/desktop/gdi/colorref) valore con una chiamata a `TranslateColor`.

##  <a name="gethwnd"></a>  COleControl::GetHwnd

Implementa la funzione Get della proprietà azionario hWnd.

```
OLE_HANDLE GetHwnd();
```

### <a name="return-value"></a>Valore restituito

Handle della finestra del controllo OLE, se presente. in caso contrario NULL.

##  <a name="getmessagestring"></a>  COleControl::GetMessageString

Chiamato dal framework per ottenere una stringa breve che descrive lo scopo della voce di menu identificato da *nID*.

```
virtual void GetMessageString(
    UINT nID,
    CString& rMessage) const;
```

### <a name="parameters"></a>Parametri

*nID*<br/>
Un ID di elemento menu.

*rMessage*<br/>
Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite cui verrà restituita una stringa dell'oggetto.

### <a name="remarks"></a>Note

Utilizzabile per ottenere un messaggio per la visualizzazione in una barra di stato, la voce di menu viene evidenziata. L'implementazione predefinita tenta di caricare una risorsa stringa identificata da *nID*.

##  <a name="getnotsupported"></a>  COleControl::GetNotSupported

Impedisce l'accesso al valore della proprietà di un controllo dall'utente.

```
void GetNotSupported();
```

### <a name="remarks"></a>Note

Chiamare questa funzione anziché la funzione Get di qualsiasi proprietà in cui non è supportato il recupero della proprietà dall'utente del controllo. Un esempio sarebbe una proprietà di sola scrittura.

##  <a name="getreadystate"></a>  COleControl::GetReadyState

Restituisce lo stato di conformità del controllo.

```
long GetReadyState();
```

### <a name="return-value"></a>Valore restituito

Lo stato di conformità del controllo, uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Controllo sta caricando le relative proprietà|
|READYSTATE_LOADED|Controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Controllo ha dati sufficienti in modo interattivo, ma non tutte asincrone dei dati sono ancora caricati|
|READYSTATE_COMPLETE|Controllo dispone di tutti i relativi dati|

### <a name="remarks"></a>Note

La maggior parte dei controlli semplici mai necessario distinguere tra LOADED e INTERACTIVE. Tuttavia, i controlli che supportano le proprietà del percorso dei dati potrebbero non essere pronti per essere interattivo fino alla ricezione di almeno alcuni dati in modo asincrono. Un controllo deve tentare di diventare interattiva appena possibile.

##  <a name="getrectincontainer"></a>  COleControl::GetRectInContainer

Ottiene le coordinate del rettangolo relativo per il contenitore, espresso in unità dispositivo.

```
BOOL GetRectInContainer(LPRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Puntatore alla struttura rettangolo in cui verranno copiate le coordinate del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è attivo sul posto; in caso contrario 0.

### <a name="remarks"></a>Note

Il rettangolo è valido solo se il controllo è attivo sul posto.

##  <a name="getstocktextmetrics"></a>  COleControl::GetStockTextMetrics

Misurare le metriche di testo per la proprietà del carattere predefinite del controllo, che può essere selezionata con il [SelectStockFont](#selectstockfont) (funzione).

```
void GetStockTextMetrics(LPTEXTMETRIC lptm);
```

### <a name="parameters"></a>Parametri

*lptm*<br/>
Un puntatore a un [TEXTMETRIC](/windows/desktop/api/wingdi/ns-wingdi-tagtextmetrica) struttura.

### <a name="remarks"></a>Note

Il `GetStockTextMetrics` funzione inizializzerà il `TEXTMETRIC` struttura a cui punta *lptm* con le informazioni sulle metriche valide se ha esito positivo oppure riempimento con zeri in caso contrario la struttura. Utilizzare questa funzione anziché [GetTextMetrics](/windows/desktop/api/wingdi/nf-wingdi-gettextmetrics) quando disegno del controllo perché i controlli, ad esempio qualsiasi incorporato oggetto OLE, possono essere necessari per eseguire il rendering di se stessi in un metafile.

Il `TEXTMETRIC` struttura per il tipo di carattere predefinito viene aggiornato quando il `SelectStockFont` funzione viene chiamata. È necessario chiamare questa funzione solo dopo che selezionando il tipo di carattere azionario per assicurare che le informazione che disponibili è valido.

##  <a name="gettext"></a>  COleControl::GetText

Implementa la funzione Get della proprietà Text o Caption azionario.

```
BSTR GetText();
```

### <a name="return-value"></a>Valore restituito

Il valore corrente della stringa di testo di controllo o una stringa di lunghezza zero se non è presente alcuna stringa.

> [!NOTE]
>  Per altre informazioni sul tipo di dati BSTR, vedere [tipi di dati](../../mfc/reference/data-types-mfc.md) nella sezione macro e funzioni globali.

### <a name="remarks"></a>Note

Si noti che il chiamante di questa funzione deve chiamare `SysFreeString` la stringa restituita al fine di gratuitamente la risorsa. All'interno dell'implementazione del controllo, usare `InternalGetText` per accedere alle proprietà di testo o didascalia predefinita del controllo.

##  <a name="getwindowlessdroptarget"></a>  COleControl::GetWindowlessDropTarget

Eseguire l'override `GetWindowlessDropTarget` cui vuoi eseguire un controllo senza finestra per essere la destinazione di un oggetto OLE trascinamento della selezione operazione.

```
virtual IDropTarget* GetWindowlessDropTarget();
```

### <a name="return-value"></a>Valore restituito

Puntatore all'oggetto `IDropTarget` interfaccia. Poiché non dispone di una finestra, non è possibile registrare un oggetto senza un `IDropTarget` interfaccia. Tuttavia, per partecipare al trascinamento della selezione, un oggetto senza può comunque implementare l'interfaccia e restituirlo in `GetWindowlessDropTarget`.

### <a name="remarks"></a>Note

In genere, ciò richiede che la finestra del controllo sia stata registrata come obiettivo di rilascio. Ma poiché il controllo non dispone di alcuna finestra propria, il contenitore userà la propria finestra come obiettivo di rilascio. Il controllo deve semplicemente fornire un'implementazione del `IDropTarget` interfaccia a cui il contenitore può delegare le chiamate al momento opportuno. Ad esempio:

[!code-cpp[NVC_MFCAxCtl#2](../../mfc/reference/codesnippet/cpp/colecontrol-class_3.cpp)]

##  <a name="initializeiids"></a>  COleControl::InitializeIIDs

Indica la classe di base agli ID verrà utilizzato il controllo.

```
void InitializeIIDs(
    const IID* piidPrimary,
    const IID* piidEvents);
```

### <a name="parameters"></a>Parametri

*piidPrimary*<br/>
Puntatore all'ID di interfaccia dell'interfaccia dispatch principale del controllo.

*piidEvents*<br/>
Puntatore all'ID di interfaccia dell'interfaccia di eventi del controllo.

### <a name="remarks"></a>Note

Chiamare questa funzione nel costruttore del controllo per indicare la classe di base dell'interfaccia ID verrà utilizzato il controllo.

##  <a name="internalgetfont"></a>  COleControl::InternalGetFont

Accede alla proprietà del tipo di carattere azionario del controllo

```
CFontHolder& InternalGetFont();
```

### <a name="return-value"></a>Valore restituito

Un riferimento a un [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto che contiene l'oggetto del tipo di carattere azionario.

##  <a name="internalgettext"></a>  COleControl::InternalGetText

Accede alla proprietà Text o Caption predefinita del controllo.

```
const CString& InternalGetText();
```

### <a name="return-value"></a>Valore restituito

Riferimento per la stringa di testo del controllo.

##  <a name="internalsetreadystate"></a>  COleControl::InternalSetReadyState

Imposta lo stato di conformità del controllo.

```
void InternalSetReadyState(long lNewReadyState);
```

### <a name="parameters"></a>Parametri

*lNewReadyState*<br/>
Lo stato di conformità da impostare per il controllo, in uno dei valori seguenti:

|||
|-|-|
|READYSTATE_UNINITIALIZED|Stato di inizializzazione predefinito|
|READYSTATE_LOADING|Controllo sta caricando le relative proprietà|
|READYSTATE_LOADED|Controllo è stato inizializzato|
|READYSTATE_INTERACTIVE|Controllo ha dati sufficienti in modo interattivo, ma non tutte asincrone dei dati sono ancora caricati|
|READYSTATE_COMPLETE|Controllo dispone di tutti i relativi dati|

### <a name="remarks"></a>Note

La maggior parte dei controlli semplici mai necessario distinguere tra LOADED e INTERACTIVE. Tuttavia, i controlli che supportano le proprietà del percorso dei dati potrebbero non essere pronti per essere interattivo fino alla ricezione di almeno alcuni dati in modo asincrono. Un controllo deve tentare di diventare interattiva appena possibile.

##  <a name="invalidatecontrol"></a>  COleControl::InvalidateControl

Forza il controllo venga ricreato.

```
void InvalidateControl(
    LPCRECT lpRect = NULL,
    BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Un puntatore all'area del controllo da invalidare.

*bErase*<br/>
Specifica se lo sfondo all'interno dell'area di aggiornamento deve essere eliminato quando viene elaborata la regione di aggiornamento.

### <a name="remarks"></a>Note

Se *lpRect* ha un valore NULL, l'intero controllo viene ridisegnato. Se *lpRect* non è NULL, indica la parte del rettangolo del controllo che deve essere invalidata. Nei casi in cui il controllo dispone di alcuna finestra o non è attualmente attivo, il rettangolo viene ignorato e viene eseguita una chiamata del sito client [IAdviseSink::OnViewChange](/windows/desktop/api/objidl/nf-objidl-iadvisesink-onviewchange) funzione membro. Utilizzare questa funzione anziché `CWnd::InvalidateRect` o `InvalidateRect`.

##  <a name="invalidatergn"></a>  COleControl::InvalidateRgn

Invalida l'area client della finestra contenitore all'interno dell'area specificata.

```
void InvalidateRgn(CRgn* pRgn, BOOL bErase = TRUE);
```

### <a name="parameters"></a>Parametri

*pRgn*<br/>
Un puntatore a un [CRgn](../../mfc/reference/crgn-class.md) oggetto che identifica l'area di visualizzazione dell'oggetto OLE da invalidare, nelle coordinate client della finestra contenitore. Se questo parametro è NULL, l'extent è l'intero oggetto.

*bErase*<br/>
Specifica se lo sfondo all'interno dell'area invalidato da cancellare. Se TRUE, lo sfondo viene cancellato. Se FALSE, lo sfondo rimane invariato.

### <a name="remarks"></a>Note

Ciò consente di ridisegnare controlli privi di finestra all'interno del contenitore. L'area invalidata, insieme a tutte le altre aree nell'area di aggiornamento, è contrassegnata per il disegno quando la prossima [WM_PAINT](/windows/desktop/gdi/wm-paint) messaggio viene inviato.

Se *bErase* è TRUE per qualsiasi parte dell'area di aggiornamento, lo sfondo nell'intera area, non solo nella parte specificata, viene cancellato.

##  <a name="isconvertingvbx"></a>  COleControl::IsConvertingVBX

Consente il caricamento specializzato di un controllo OLE.

```
BOOL IsConvertingVBX();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo esegue la conversione; in caso contrario 0.

### <a name="remarks"></a>Note

Durante la conversione di un form che usa VBX dei controlli a uno che usa i controlli OLE, il codice di caricamento speciali per i controlli OLE potrebbe essere necessario. Ad esempio, se si sta caricando un'istanza del controllo OLE, potrebbe essere una chiamata a [PX_Font](persistence-of-ole-controls.md#px_font) nel `DoPropExchange`:

[!code-cpp[NVC_MFCAxCtl#3](../../mfc/reference/codesnippet/cpp/colecontrol-class_4.cpp)]

Tuttavia, i controlli VBX non è un oggetto del tipo di carattere. ogni proprietà del tipo di carattere è stato salvato singolarmente. In questo caso, si utilizzerebbe `IsConvertingVBX` per distinguere tra questi due casi:

[!code-cpp[NVC_MFCAxCtl#4](../../mfc/reference/codesnippet/cpp/colecontrol-class_5.cpp)]

Un altro caso sarebbe se il controllo VBX salvato proprietari dati binari (nel relativo gestore di messaggi VBM_SAVEPROPERTY) e il controllo OLE Salva i dati binari in un formato diverso. Se si desidera che il controllo OLE sia compatibile con il controllo VBX, è possibile leggere sia i vecchi e nuovi formati utilizzando i `IsConvertingVBX` funzione distinguendo se il controllo VBX o del controllo OLE è stato caricato.

Il controllo `DoPropExchange` (funzione), è possibile verificare questa condizione e se è true, eseguire il codice di caricamento specifiche per questa conversione (ad esempio, negli esempi precedenti). Se il controllo non verrà convertito, è possibile eseguire codice carico normale. Questa possibilità è applicabile solo ai controlli convertiti da controparti VBX.

##  <a name="isinvokeallowed"></a>  COleControl::IsInvokeAllowed

Consente di chiamata al metodo di automazione.

```
BOOL IsInvokeAllowed(DISPID dispid);
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è stato inizializzato; in caso contrario 0.

### <a name="remarks"></a>Note

Implementazione del framework del `IDispatch::Invoke` chiamate `IsInvokeAllowed` per determinare se una funzione specificata (identificato dal `dispid`) può essere richiamato. Il comportamento predefinito per un controllo OLE è consentire o meno i metodi di automazione deve essere richiamato solo se il controllo è stato inizializzato; Tuttavia, `IsInvokeAllowed` è una funzione virtuale e può essere sottoposto a override se necessario (ad esempio, quando il controllo viene utilizzato come server di automazione). Per altre informazioni, vedere l'articolo della Knowledge Base Q166472, "procedura: usare un controllo OLE come Server di automazione." Articoli della Knowledge Base sono disponibili in [ http://support.microsoft.com ](http://support.microsoft.com/).

##  <a name="ismodified"></a>  COleControl::IsModified

Determina se è stato modificato lo stato del controllo.

```
BOOL IsModified();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se lo stato del controllo è stato modificato dopo l'ultimo salvataggio; in caso contrario 0.

### <a name="remarks"></a>Note

Lo stato di un controllo viene modificato quando un valore della proprietà.

##  <a name="isoptimizeddraw"></a>  COleControl::IsOptimizedDraw

Determina se il contenitore supporta il disegno ottimizzato per l'operazione di disegno corrente.

```
BOOL IsOptimizedDraw();
```

### <a name="return-value"></a>Valore restituito

TRUE se il contenitore supporta disegno ottimizzato per l'operazione di disegno corrente. in caso contrario, FALSE.

### <a name="remarks"></a>Note

Se disegno ottimizzato è supportato, il controllo necessario non selezionare gli oggetti meno recenti (penne, pennelli, tipi di carattere e così via) nel contesto di dispositivo al termine di disegno.

##  <a name="issubclassedcontrol"></a>  COleControl::IsSubclassedControl

Chiamato dal framework per determinare se il controllo è una sottoclasse un Windows il controllo.

```
virtual BOOL IsSubclassedControl();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se il controllo è una sottoclasse; in caso contrario 0.

### <a name="remarks"></a>Note

È necessario eseguire l'override di questa funzione e restituiscono TRUE se l'OLE controllare sottoclassi di un controllo di Windows.

##  <a name="load"></a>  COleControl::Load

Reimposta i precedenti dati caricati in modo asincrono e avvia un nuovo caricamento della proprietà asincrona del controllo.

```
void Load(LPCTSTR strNewPath, CDataPathProperty& prop);
```

### <a name="parameters"></a>Parametri

*strNewPath*<br/>
Un puntatore a una stringa contenente il percorso che fa riferimento il percorso assoluto della proprietà del controllo asincrono.

*prop*<br/>
Oggetto [CDataPathProperty](../../mfc/reference/cdatapathproperty-class.md) oggetto che implementa una proprietà di controllo asincrono.

##  <a name="lockinplaceactive"></a>  COleControl::LockInPlaceActive

Impedisce la disattivazione del controllo contenitore.

```
BOOL LockInPlaceActive(BOOL bLock);
```

### <a name="parameters"></a>Parametri

*Blocco*<br/>
TRUE se lo stato attivo sul posto del controllo deve essere bloccato. FALSE se deve essere sbloccato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il blocco è stato completato. in caso contrario 0.

### <a name="remarks"></a>Note

Si noti che ogni blocco di controllo deve essere associato un sblocco del controllo al termine. È solo necessario bloccare il controllo per brevi periodi, ad esempio durante la generazione di un evento.

##  <a name="onambientpropertychange"></a>  COleControl::OnAmbientPropertyChange

Chiamato dal framework quando una proprietà di ambiente del contenitore è stato modificato valore.

```
virtual void OnAmbientPropertyChange(DISPID dispid);
```

### <a name="parameters"></a>Parametri

*dispID*<br/>
ID dispatch della proprietà di ambiente che è stato modificato o DISPID_UNKNOWN se più proprietà sono state modificate.

##  <a name="onappearancechanged"></a>  COleControl::OnAppearanceChanged

Chiamato dal framework quando è stato modificato il valore della proprietà Appearance azionario.

```
virtual void OnAppearanceChanged ();
```

### <a name="remarks"></a>Note

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama `InvalidateControl`.

##  <a name="onbackcolorchanged"></a>  COleControl::OnBackColorChanged

Chiamato dal framework quando è stato modificato il valore della proprietà BackColor azionario.

```
virtual void OnBackColorChanged();
```

### <a name="remarks"></a>Note

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama `InvalidateControl`.

##  <a name="onborderstylechanged"></a>  COleControl::OnBorderStyleChanged

Chiamato dal framework quando è stato modificato il valore della proprietà BorderStyle azionario.

```
virtual void OnBorderStyleChanged();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama `InvalidateControl`.

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione.

##  <a name="onclick"></a>  COleControl::OnClick

Chiamato dal framework quando è stato fatto clic del pulsante del mouse o il metodo predefinito DoClick è stato richiamato.

```
virtual void OnClick(USHORT iButton);
```

### <a name="parameters"></a>Parametri

*iButton*<br/>
Indice di un pulsante del mouse. Può avere uno dei valori seguenti:

- LEFT_BUTTON è stato scelto il pulsante sinistro del mouse.

- MIDDLE_BUTTON è stato scelto il pulsante centrale del mouse.

- RIGHT_BUTTON è stato scelto il pulsante destro del mouse.

### <a name="remarks"></a>Note

L'implementazione predefinita chiama `COleControl::FireClick`.

Eseguire l'override di questa funzione membro per modificare o estendere la gestione predefinita.

##  <a name="onclose"></a>  COleControl::OnClose

Chiamato dal framework quando il contenitore ha chiamato il controllo `IOleControl::Close` (funzione).

```
virtual void OnClose(DWORD dwSaveOption);
```

### <a name="parameters"></a>Parametri

*dwSaveOption*<br/>
Flag che indica se l'oggetto deve essere salvato prima del caricamento. I valori validi sono:

- OLECLOSE_SAVEIFDIRTY

- OLECLOSE_NOSAVE

- OLECLOSE_PROMPTSAVE

### <a name="remarks"></a>Note

Per impostazione predefinita `OnClose` Salva l'oggetto di controllo se è stato modificato e *dwSaveOption* è OLECLOSE_SAVEIFDIRTY o OLECLOSE_PROMPTSAVE.

##  <a name="ondoverb"></a>  COleControl::OnDoVerb

Chiamato dal framework quando il contenitore chiama il `IOleObject::DoVerb` funzione membro.

```
virtual BOOL OnDoVerb(
    LONG iVerb,
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*iVerb*<br/>
L'indice del verbo di controllo da richiamare.

*lpMsg*<br/>
Un puntatore al messaggio di Windows che ha causato il verbo da richiamare.

*hWndParent*<br/>
Handle alla finestra padre del controllo. Se l'esecuzione del verbo crea una finestra (o windows), *hWndParent* deve essere utilizzato come padre.

*lpRect*<br/>
Un puntatore a una struttura RECT in cui le coordinate del controllo, in relazione il contenitore, verranno copiate.

### <a name="return-value"></a>Valore restituito

Diverso da zero se chiamata ha esito positivo. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita utilizza le voci della mappa messaggi ON_OLEVERB e ON_STDOLEVERB per determinare la corretta funzione da richiamare.

Eseguire l'override di questa funzione per modificare la gestione predefinita del verbo.

##  <a name="ondraw"></a>  COleControl::OnDraw

Chiamato dal framework per disegnare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.

```
virtual void OnDraw(
    CDC* pDC,
    const CRect& rcBounds,
    const CRect& rcInvalid);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Il contesto di dispositivo in cui si verifica il disegno.

*rcBounds*<br/>
L'area rettangolare del controllo, inclusi il bordo.

*rcInvalid*<br/>
L'area rettangolare del controllo che non è valido.

### <a name="remarks"></a>Note

`OnDraw` in genere viene chiamato per la visualizzazione su schermo, passando un contesto di dispositivo dello schermo come *pDC*. Il *rcBounds* parametro identifica il rettangolo nel contesto di dispositivo di destinazione (rispetto alla relativa modalità di mapping corrente). Il *rcInvalid* parametro è il rettangolo effettivo che non è valido. In alcuni casi sarà un'area più piccola *rcBounds*.

##  <a name="ondrawmetafile"></a>  COleControl::OnDrawMetafile

Chiamato dal framework per disegnare il controllo OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo metafile specificato.

```
virtual void OnDrawMetafile(
    CDC* pDC,
    const CRect& rcBounds);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Il contesto di dispositivo in cui si verifica il disegno.

*rcBounds*<br/>
L'area rettangolare del controllo, inclusi il bordo.

### <a name="remarks"></a>Note

L'implementazione predefinita chiama il [OnDraw](#ondraw) (funzione).

##  <a name="onedit"></a>  COleControl::OnEdit

Fa sì che il controllo sia attivata l'interfaccia utente.

```
virtual BOOL OnEdit(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpMsg*<br/>
Un puntatore al messaggio di Windows richiamato dal verbo.

*hWndParent*<br/>
Handle alla finestra padre del controllo.

*lpRect*<br/>
Un puntatore al rettangolo utilizzato dal controllo nel contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha esito positivo. in caso contrario 0.

### <a name="remarks"></a>Note

Questo è lo stesso effetto di richiamare verbo OLEIVERB_UIACTIVATE del controllo.

Questa funzione viene in genere utilizzata come funzione del gestore per una voce della mappa messaggi ON_OLEVERB. Questo rende disponibile un verbo di "Modifica" dal menu di "Object" del controllo. Ad esempio:

[!code-cpp[NVC_MFCAxCtl#5](../../mfc/reference/codesnippet/cpp/colecontrol-class_6.cpp)]

##  <a name="onenabledchanged"></a>  COleControl::OnEnabledChanged

Chiamato dal framework quando è stato modificato il valore della proprietà Enabled di magazzino.

```
virtual void OnEnabledChanged();
```

### <a name="remarks"></a>Note

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione. L'implementazione predefinita chiama [InvalidateControl](#invalidatecontrol).

##  <a name="onenumverbs"></a>  COleControl::OnEnumVerbs

Chiamato dal framework quando il contenitore chiama il `IOleObject::EnumVerbs` funzione membro.

```
virtual BOOL OnEnumVerbs(LPENUMOLEVERB* ppenumOleVerb);
```

### <a name="parameters"></a>Parametri

*ppenumOleVerb*<br/>
Un puntatore al `IEnumOLEVERB` oggetto che enumera i verbi del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se i verbi sono disponibili. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita consente di enumerare le voci ON_OLEVERB nella mappa messaggi.

Eseguire l'override di questa funzione per modificare la modalità predefinita di enumerazione dei verbi.

##  <a name="oneventadvise"></a>  COleControl::OnEventAdvise

Chiamato dal framework quando un gestore eventi è connesso o disconnesso da un controllo OLE.

```
virtual void OnEventAdvise(BOOL bAdvise);
```

### <a name="parameters"></a>Parametri

*bAdvise*<br/>
TRUE indica che un gestore eventi è stato connesso al controllo. FALSE indica che un gestore eventi è stato disconnesso dal controllo.

##  <a name="onfontchanged"></a>  COleControl::OnFontChanged

Chiamato dal framework quando è stato modificato il valore della proprietà del tipo di carattere azionario.

```
virtual void OnFontChanged();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama `COleControl::InvalidateControl`. Se il controllo Crea una sottoclasse un controllo di Windows, l'implementazione predefinita invia anche un messaggio WM_SETFONT alla finestra del controllo.

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#6](../../mfc/reference/codesnippet/cpp/colecontrol-class_7.cpp)]

##  <a name="onforecolorchanged"></a>  COleControl::OnForeColorChanged

Chiamato dal framework quando è stato modificato il valore della proprietà ForeColor azionario.

```
virtual void OnForeColorChanged();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama `InvalidateControl`.

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione.

##  <a name="onfreezeevents"></a>  COleControl::OnFreezeEvents

Chiamato dal framework dopo le chiamate di contenitore `IOleControl::FreezeEvents`.

```
virtual void OnFreezeEvents(BOOL bFreeze);
```

### <a name="parameters"></a>Parametri

*bFreeze*<br/>
TRUE se il controllo viene bloccata la gestione degli eventi; in caso contrario, FALSE.

### <a name="remarks"></a>Note

L'implementazione predefinita non esegue alcuna operazione.

Eseguire l'override di questa funzione se si desidera comportamenti aggiuntivi quando la gestione degli eventi è bloccato o sbloccato.

##  <a name="ongetcolorset"></a>  COleControl::OnGetColorSet

Chiamato dal framework quando il contenitore chiama il `IViewObject::GetColorSet` funzione membro.

```
virtual BOOL OnGetColorSet(
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    LPLOGPALETTE* ppColorSet);
```

### <a name="parameters"></a>Parametri

*ptd*<br/>
Punta al dispositivo di destinazione per cui è necessario eseguire il rendering dell'immagine. Se questo valore è NULL, l'immagine deve essere sottoposto a rendering per un dispositivo di destinazione predefinito, in genere un dispositivo di visualizzazione.

*hicTargetDev*<br/>
Specifica il contesto delle informazioni sul dispositivo di destinazione indicato dal *ptd*. Questo parametro può essere un contesto di dispositivo, ma non è necessariamente. Se *ptd* sia impostato su NULL *hicTargetDev* deve anche essere NULL.

*ppColorSet*<br/>
Un puntatore alla posizione in cui deve essere copiato il set di colori che verrebbe utilizzato. Se la funzione non restituisce il set di colori, viene restituito NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene restituito un set di colore valido. in caso contrario 0.

### <a name="remarks"></a>Note

Il contenitore chiama questa funzione per recuperare tutti i colori necessari per disegnare il controllo OLE. Il contenitore può usare i set di colori ottenuti in combinazione con i colori, che è necessario impostare la tavolozza dei colori complessiva. L'implementazione predefinita restituisce FALSE.

Eseguire l'override di questa funzione per eseguire qualsiasi elaborazione speciale della richiesta.

##  <a name="ongetcontrolinfo"></a>  COleControl::OnGetControlInfo

Chiamato dal framework quando il contenitore del controllo richiede informazioni sul controllo.

```
virtual void OnGetControlInfo(LPCONTROLINFO pControlInfo);
```

### <a name="parameters"></a>Parametri

*pControlInfo*<br/>
Puntatore a un [CONTROLINFO](/windows/desktop/api/ocidl/ns-ocidl-tagcontrolinfo) struttura da compilare.

### <a name="remarks"></a>Note

Queste informazioni è costituita principalmente da una descrizione dei tasti di scelta rapida del controllo. Riempie l'implementazione predefinita *pControlInfo* con le informazioni predefinite.

Eseguire l'override di questa funzione se il controllo deve elaborare i tasti di scelta.

##  <a name="ongetdisplaystring"></a>  COleControl::OnGetDisplayString

Chiamato dal framework per ottenere una stringa che rappresenta il valore corrente della proprietà identificata da *dispid*.

```
virtual BOOL OnGetDisplayString(
    DISPID dispid,
    CString& strValue);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*strValue*<br/>
Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) tramite cui verrà restituita una stringa dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stata restituita una stringa *strValue;* in caso contrario 0.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo dispone di una proprietà il cui valore non può essere convertito direttamente in una stringa e si desidera il valore della proprietà da visualizzare in un visualizzatore proprietà fornito dal contenitore.

##  <a name="ongetinplacemenu"></a>  COleControl::OnGetInPlaceMenu

Chiamato dal framework quando il controllo è attivato per ottenere il menu da unire in menu esistenti del contenitore dell'interfaccia utente.

```
virtual HMENU OnGetInPlaceMenu();
```

### <a name="return-value"></a>Valore restituito

L'handle del menu del controllo o NULL se il controllo è none. L'implementazione predefinita restituisce NULL.

### <a name="remarks"></a>Note

Per altre informazioni sull'unione di risorse OLE, vedere l'articolo [menu e risorse (OLE)](../../mfc/menus-and-resources-ole.md).

##  <a name="ongetnaturalextent"></a>  COleControl::OnGetNaturalExtent

Chiamato dal framework in risposta a un contenitore `IViewObjectEx::GetNaturalExtent` richiesta.

```
virtual BOOL OnGetNaturalExtent(
    DWORD dwAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    HDC hicTargetDev,
    DVEXTENTINFO* pExtentInfo,
    LPSIZEL psizel);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità con cui l'oggetto deve essere rappresentato. Le rappresentazioni di includono il contenuto, un'icona, un'immagine di anteprima o un documento stampato. I valori validi provengono dall'enumerazione [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) o DVASPECT2.

*lindex*<br/>
La parte dell'oggetto di interesse. Attualmente solo -1 è valida.

*ptd*<br/>
Punta al [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struttura che definisce il dispositivo di destinazione per cui devono essere restituite le dimensioni dell'oggetto.

*hicTargetDev*<br/>
Specifica il contesto di informazioni per il dispositivo di destinazione indicato dal *ptd* parametro dal quale l'oggetto può estrarre la metrica del dispositivo e testare le funzionalità del dispositivo. Se *ptd* è NULL, l'oggetto deve ignorare il valore di *hicTargetDev* parametro.

*pExtentInfo*<br/>
Punta al `DVEXTENTINFO` struttura che specifica i dati di ridimensionamento. Il `DVEXTENTINFO` struttura è:

```cpp
typedef struct tagExtentInfo
{
    UINT cb;
    DWORD dwExtentMode;
    SIZEL sizelProposed;
}   DVEXTENTINFO;
```

Il membro della struttura `dwExtentMode` può assumere uno dei due valori:

- DVEXTENT_CONTENT chiedere qual è il controllo deve essere in base esattamente al contenuto (snap-a-size)

- DVEXTENT_INTEGRAL durante il ridimensionamento, dimensione proposta di passare al controllo

*psizel*<br/>
Punta al ridimensionamento dei dati restituiti dal controllo. I dati di ridimensionamento restituito sono impostati su -1 per qualsiasi dimensione che non è stato modificato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se restituisce correttamente o adegua le dimensioni; in caso contrario 0.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione per restituire più vicino alla modalità di dimensioni e l'estensione proposta in dimensioni di visualizzazione dell'oggetto di `DVEXTENTINFO` struttura. L'implementazione predefinita restituisce FALSE e non rende rettifiche alla dimensione.

##  <a name="ongetpredefinedstrings"></a>  COleControl::OnGetPredefinedStrings

Chiamato dal framework per ottenere un set di stringhe predefinite che rappresenta i valori possibili per una proprietà.

```
virtual BOOL OnGetPredefinedStrings(
    DISPID dispid,
    CStringArray* pStringArray,
    CDWordArray* pCookieArray);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*pStringArray*<br/>
Una matrice di stringhe deve essere compilato con i valori restituiti.

*pCookieArray*<br/>
Una matrice DWORD deve essere compilato con i valori restituiti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se gli elementi sono stati aggiunti al *pStringArray* e *pCookieArray*.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo ha una proprietà con un set di valori possibili che possono essere rappresentati da stringhe. Per ogni elemento aggiunto alla *pStringArray*, è necessario aggiungere un elemento "cookie" corrispondente a *pCookieArray.* Questi valori "cookie" in un secondo momento possono essere passati dal framework per il `COleControl::OnGetPredefinedValue` (funzione).

##  <a name="ongetpredefinedvalue"></a>  COleControl::OnGetPredefinedValue

Chiamato dal framework per ottenere il valore corrispondente a una delle stringhe predefinite precedentemente restituite da una sostituzione di `COleControl::OnGetPredefinedStrings`.

```
virtual BOOL OnGetPredefinedValue(
    DISPID dispid,
    DWORD dwCookie,
    VARIANT* lpvarOut);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*dwCookie*<br/>
Un valore del cookie restituito in precedenza da un override di `COleControl::OnGetPredefinedStrings`.

*lpvarOut*<br/>
Puntatore a un `VARIANT` struttura tramite cui verrà restituito un valore della proprietà.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stato restituito un valore *lpvarOut*; in caso contrario, 0.

##  <a name="ongetviewextent"></a>  COleControl::OnGetViewExtent

Chiamato dal framework in risposta a un contenitore [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) richiesta.

```
virtual BOOL OnGetViewExtent(
    DWORD dwDrawAspect,
    LONG lindex,
    DVTARGETDEVICE* ptd,
    LPSIZEL lpsizel);
```

### <a name="parameters"></a>Parametri

*dwDrawAspect*<br/>
DWORD che descrive quale form o, aspetto di un oggetto deve essere visualizzato. I valori validi provengono dall'enumerazione [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) o DVASPECT2.

*lindex*<br/>
La parte dell'oggetto di interesse. Attualmente solo -1 è valida.

*ptd*<br/>
Punta al [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struttura che definisce il dispositivo di destinazione per cui devono essere restituite le dimensioni dell'oggetto.

*lpsizel*<br/>
Punta alla posizione in cui viene restituita le dimensioni dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene restituite correttamente le informazioni di extent; in caso contrario 0.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo Usa il disegno in due passaggi e le parti trasparenti e opache hanno dimensioni diverse.

##  <a name="ongetviewrect"></a>  COleControl::OnGetViewRect

Chiamato dal framework in risposta a un contenitore `IViewObjectEx::GetRect` richiesta.

```
virtual BOOL OnGetViewRect(DWORD dwAspect, LPRECTL pRect);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
DWORD che descrive quale form o, aspetto di un oggetto deve essere visualizzato. I valori validi provengono dall'enumerazione [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) o DVASPECT2:

- Rettangolo di delimitazione DVASPECT_CONTENT dell'intero oggetto. Nell'angolo superiore sinistro all'origine dell'oggetto e dimensioni uguali per l'entità restituita dalla `GetViewExtent` *.*

- Gli oggetti DVASPECT_OPAQUE con un'area rettangolare opaca restituiscono quel rettangolo. Altre hanno esito negativo.

- Rettangolo DVASPECT_TRANSPARENT che copre tutte le parti trasparenti o irregolare.

*pRect*<br/>
Punta al [RECTL](https://msdn.microsoft.com/library/windows/desktop/dd162907) struttura che specifica il rettangolo in cui l'oggetto deve essere disegnato. Questo parametro controlla il posizionamento e l'adattamento dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il rettangolo ridimensionata in base all'oggetto viene restituito correttamente. in caso contrario 0.

### <a name="remarks"></a>Note

Le dimensioni dell'oggetto viene convertita da `OnGetViewRect` in un rettangolo a partire dalla posizione specifico (il valore predefinito è l'angolo superiore sinistro dello schermo). Eseguire l'override di questa funzione se il controllo Usa il disegno in due passaggi e le parti trasparenti e opache hanno dimensioni diverse.

##  <a name="ongetviewstatus"></a>  COleControl::OnGetViewStatus

Chiamato dal framework in risposta a un contenitore `IViewObjectEx::GetViewStatus` richiesta.

```
virtual DWORD OnGetViewStatus();
```

### <a name="return-value"></a>Valore restituito

Uno dei valori dell'enumerazione VIEWSTATUS se ha esito positivo. in caso contrario 0. I valori possibili sono qualsiasi combinazione delle operazioni seguenti:

|||
|-|-|
|VIEWSTATUS_OPAQUE|Oggetto è completamente opaco. Se questo bit non è impostato, l'oggetto contiene parti trasparenti. Questo bit viene applicato solo a aspetti relativi al contenuto e non a DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_SOLIDBKGND|Oggetto ha uno sfondo a tinta unita (costituito da un colore a tinta unita, non un motivo di riempimento). Questo bit è significativo solo se VIEWSTATUS_OPAQUE è impostata e si applica solo agli aspetti relativi al contenuto e non a DVASPECT_ICON o DVASPECT_DOCPRINT.|
|VIEWSTATUS_DVASPECTOPAQUE|L'oggetto supporta DVASPECT_OPAQUE. Tutti i metodi IViewObjectEx che accettano una caratteristica di disegno, come un parametro può essere chiamato con questo aspetto.|
|VIEWSTATUS_DVASPECTTRANSPARENT|L'oggetto supporta DVASPECT_TRANSPARENT. Tutti i `IViewObjectEx` metodi che accettano una caratteristica di disegno, come un parametro può essere chiamato con questo aspetto.|

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo utilizza disegno in due passaggi. L'implementazione predefinita restituisce VIEWSTATUS_OPAQUE.

##  <a name="onhidetoolbars"></a>  COleControl::OnHideToolBars

Chiamato dal framework quando il controllo viene disattivata l'interfaccia utente.

```
virtual void OnHideToolBars();
```

### <a name="remarks"></a>Note

L'implementazione deve nascondere tutte le barre degli strumenti visualizzate da `OnShowToolbars`.

##  <a name="oninactivemousemove"></a>  COleControl::OnInactiveMouseMove

Chiamata eseguita dal contenitore dell'oggetto posizionato sotto il puntatore del mouse al momento della ricezione di un messaggio WM_MOUSEMOVE inattiva.

```
virtual void OnInactiveMouseMove(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwKeyState);
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
L'oggetto di delimitazione rettangolo, nelle coordinate client della finestra contenitore. Indica all'oggetto la posizione esatta e le dimensioni dello schermo quando è stato ricevuto il messaggio WM_MOUSEMOVE.

*x*<br/>
Coordinata x della posizione del mouse in coordinate client della finestra contenitore.

*y*<br/>
Coordinata y della posizione del mouse in coordinate client della finestra contenitore.

*dwKeyState*<br/>
Identifica lo stato corrente dei tasti di modifica della tastiera sulla tastiera. I valori validi possono essere una combinazione di uno o più flag MK_CONTROL MK_SHIFT, MK_ALT, MK_BUTTON, MK_LBUTTON, MK_MBUTTON e MK_RBUTTON.

### <a name="remarks"></a>Note

Si noti che coordinate client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Questo è reso possibile anche passando il rettangolo di delimitazione dell'oggetto dello stesso sistema di coordinate.

##  <a name="oninactivesetcursor"></a>  COleControl::OnInactiveSetCursor

Chiamata eseguita dal contenitore dell'oggetto posizionato sotto il puntatore del mouse al momento della ricezione di un messaggio WM_SETCURSOR inattiva.

```
virtual BOOL OnInactiveSetCursor(
    LPCRECT lprcBounds,
    long x,
    long y,
    DWORD dwMouseMsg,
    BOOL bSetAlways);
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
L'oggetto di delimitazione rettangolo, nelle coordinate client della finestra contenitore. Indica all'oggetto la posizione esatta e le dimensioni dello schermo quando è stato ricevuto il messaggio WM_SETCURSOR.

*x*<br/>
Coordinata x della posizione del mouse in coordinate client della finestra contenitore.

*y*<br/>
Coordinata y della posizione del mouse in coordinate client della finestra contenitore.

*dwMouseMsg*<br/>
L'identificatore del messaggio del mouse per il quale si è verificato un messaggio WM_SETCURSOR.

*bSetAlways*<br/>
Specifica se l'oggetto è necessario impostare il cursore. Se TRUE, l'oggetto deve impostare il cursore. Se FALSE, il cursore non è obbligato a impostare il cursore e dovrebbe in tal caso, restituisce S_FALSE.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Si noti che coordinate client della finestra (pixel) vengono utilizzate per passare la posizione del cursore del mouse. Questo è reso possibile anche passando il rettangolo di delimitazione dell'oggetto dello stesso sistema di coordinate.

##  <a name="onkeydownevent"></a>  COleControl::OnKeyDownEvent

Chiamato dal framework dopo l'elaborazione di un evento KeyDown.

```
virtual void OnKeyDownEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametri

*NChar*<br/>
Il valore di codice tasto virtuale del tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo deve accedere alle informazioni chiave dopo che è stato generato l'evento.

##  <a name="onkeypressevent"></a>  COleControl::OnKeyPressEvent

Chiamato dal framework dopo l'azione è stata attivata l'evento KeyPress.

```
virtual void OnKeyPressEvent(USHORT nChar);
```

### <a name="parameters"></a>Parametri

*NChar*<br/>
Contiene il valore di codice tasto virtuale del tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h

### <a name="remarks"></a>Note

Si noti che il *nChar* valore potrebbe essere stato modificato dal contenitore.

Se si vuole notifica dopo questo evento si verifica l'override della funzione.

##  <a name="onkeyupevent"></a>  COleControl::OnKeyUpEvent

Chiamato dal framework dopo l'elaborazione di un evento KeyDown.

```
virtual void OnKeyUpEvent(
    USHORT nChar,
    USHORT nShiftState);
```

### <a name="parameters"></a>Parametri

*NChar*<br/>
Il valore di codice tasto virtuale del tasto premuto. Per un elenco di codici di tasti virtuali standard, vedere winuser. h

*nShiftState*<br/>
Contiene una combinazione dei flag seguenti:

- È stato premuto MAIUSC The SHIFT_MASK durante l'azione.

- CTRL_MASK The è stato premuto CTRL durante l'azione.

- ALT_MASK The ALT era premuto durante l'azione.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione se il controllo deve accedere alle informazioni chiave dopo che è stato generato l'evento.

##  <a name="onmappropertytopage"></a>  COleControl::OnMapPropertyToPage

Chiamato dal framework per ottenere l'ID di classe della pagina delle proprietà che implementa la modifica della proprietà specificata.

```
virtual BOOL OnMapPropertyToPage(
    DISPID dispid,
    LPCLSID lpclsid,
    BOOL* pbPageOptional);
```

### <a name="parameters"></a>Parametri

*DISPID*<br/>
L'ID di invio di una proprietà del controllo.

*lpclsid*<br/>
Puntatore a un `CLSID` struttura tramite cui verrà restituito un ID di classe.

*pbPageOptional*<br/>
Restituisce un indicatore del fatto che l'utilizzo della pagina delle proprietà specificata è facoltativo.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha restituito un ID di classe *lpclsid*; in caso contrario, 0.

### <a name="remarks"></a>Note

Eseguire l'override di questa funzione per fornire un modo per richiamare pagine delle proprietà del controllo dal browser delle proprietà del contenitore.

##  <a name="onmnemonic"></a>  COleControl::OnMnemonic

Chiamato dal framework quando il contenitore ha rilevato che è stato premuto un tasto mnemonico del controllo OLE.

```
virtual void OnMnemonic(LPMSG pMsg);
```

### <a name="parameters"></a>Parametri

*pMsg*<br/>
Puntatore al messaggio di Windows generato dalla pressione di un tasto mnemonico.

##  <a name="onproperties"></a>  COleControl::OnProperties

Chiamato dal framework quando il verbo di proprietà del controllo è stato richiamato dal contenitore.

```
virtual BOOL OnProperties(
    LPMSG lpMsg,
    HWND hWndParent,
    LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpMsg*<br/>
Un puntatore al messaggio di Windows richiamato dal verbo.

*hWndParent*<br/>
Handle alla finestra padre del controllo.

*lpRect*<br/>
Un puntatore al rettangolo utilizzato dal controllo nel contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha esito positivo. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita consente di visualizzare una finestra di dialogo delle proprietà modale.

È anche possibile usare questa funzione per fare in modo la visualizzazione delle pagine delle proprietà del controllo. Effettuare una chiamata per il `OnProperties` funzione, passando l'handle dell'elemento padre del controllo nel *hWndParent* parametro. In questo caso, i valori del *lpMsg* e *lpRect* i parametri vengono ignorati.

##  <a name="onqueryhitpoint"></a>  COleControl::OnQueryHitPoint

Chiamato dal framework in risposta a un contenitore `IViewObjectEx::QueryHitPoint` richiesta.

```
virtual BOOL OnQueryHitPoint(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    POINT ptlLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità con cui l'oggetto è rappresentato. I valori validi provengono dall'enumerazione [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntatore a un `RECT` struttura che specifica il rettangolo di delimitazione dell'area client di controllo OLE.

*ptlLoc*<br/>
Puntatore al `POINT` struttura che specifica il punto da sottoporre a hit. Il punto viene specificato nelle coordinate dell'area client OLE.

*lCloseHint*<br/>
La distanza che definisce "Chiudi" per il punto selezionato per un riscontro.

*pHitResult*<br/>
Puntatore al risultato della query hit. Uno dei valori seguenti:

- HITRESULT_OUTSIDE *ptlLoc* è di fuori di OLE dell'oggetto e non chiusa.

- HITRESULT_TRANSPARENT *ptlLoc* è entro i limiti dell'oggetto OLE, ma non in prossimità dell'immagine. Un punto all'interno di un cerchio trasparente, ad esempio, potrebbe essere HITRESULT_TRANSPARENT.

- HITRESULT_CLOSE *ptlLoc* interna o esterna rispetto l'oggetto OLE ma abbastanza vicino all'oggetto per essere considerati interni. Gli oggetti di piccole dimensioni, thin o dettagliati possono utilizzare questo valore. Anche se un punto è esterna al riquadro rettangolo di un oggetto può comunque essere Chiudi (questa è necessaria per raggiungere gli oggetti piccoli).

- HITRESULT_HIT *ptlLoc* è all'interno dell'immagine dell'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stato restituito un risultato hit; in caso contrario 0. Un tentativo di accesso è una sovrapposizione con l'area di visualizzazione del controllo OLE.

### <a name="remarks"></a>Note

Esegue una query se il punto specificato si sovrappone a rettangolo di visualizzazione dell'oggetto (raggiunge il punto). `QueryHitPoint` può essere sottoposto a override per testare riscontri per gli oggetti non rettangolari.

##  <a name="onqueryhitrect"></a>  COleControl::OnQueryHitRect

Chiamato dal framework in risposta a un contenitore `IViewObjectEx::QueryHitRect` richiesta.

```
virtual BOOL OnQueryHitRect(
    DWORD dwAspect,
    LPCRECT pRectBounds,
    LPCRECT prcLoc,
    LONG lCloseHint,
    DWORD* pHitResult);
```

### <a name="parameters"></a>Parametri

*dwAspect*<br/>
Specifica la modalità con cui l'oggetto deve essere rappresentato. I valori validi provengono dall'enumerazione [DVASPECT](/windows/desktop/api/wtypes/ne-wtypes-tagdvaspect) o DVASPECT2.

*pRectBounds*<br/>
Puntatore a un `RECT` struttura che specifica il rettangolo di delimitazione dell'area client di controllo OLE.

*prcLoc*<br/>
Puntatore al `RECT` struttura che specifica il rettangolo da sottoporre a hit (sovrapposizione con il rettangolo di oggetto), rispetto all'angolo superiore sinistro dell'oggetto.

*lCloseHint*<br/>
Non usato.

*pHitResult*<br/>
Puntatore al risultato della query hit. Uno dei valori seguenti:

- HITRESULT_OUTSIDE alcun punto nel rettangolo non viene raggiunto dall'oggetto OLE.

- HITRESULT_HIT almeno un punto nel rettangolo sarebbe un ostacolo per l'oggetto.

### <a name="return-value"></a>Valore restituito

Diverso da zero se è stato restituito un risultato hit; in caso contrario 0.

### <a name="remarks"></a>Note

Esegue una query se il rettangolo di visualizzazione di un oggetto si sovrappone a un punto qualsiasi del rettangolo specificato (raggiunge il rettangolo). `QueryHitRect` può essere sottoposto a override per testare riscontri per gli oggetti non rettangolari.

##  <a name="onrenderdata"></a>  COleControl::OnRenderData

Chiamato dal framework per recuperare i dati nel formato specificato.

```
virtual BOOL OnRenderData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta al [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura che specifica il formato in cui vengono richieste informazioni.

*lpStgMedium*<br/>
Punta a un [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) struttura in cui i dati sono da restituire.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Il formato specificato è uno precedentemente spostata nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) oppure [DelayRenderFileData](../../mfc/reference/coledatasource-class.md#delayrenderfiledata) funzioni membro per rendering ritardati. L'implementazione predefinita di questa funzione chiama `OnRenderFileData` o `OnRenderGlobalData`, rispettivamente, se il supporto di archiviazione fornito è un file o della memoria. Se il formato richiesto è CF_EMBEDSOURCE o il formato di set di proprietà permanente, l'implementazione predefinita esegue il rendering dei dati appropriati e restituisce diverso da zero. In caso contrario, restituisce 0 e non esegue alcuna operazione.

Se *lpStgMedium -> tymed* TYMED_NULL, è il STGMEDIUM deve essere allocato e compilato come specificato da *lpFormatEtc -> tymed*. In caso contrario TYMED_NULL, il STGMEDIUM devono essere compilate con i dati.

Eseguire l'override di questa funzione per fornire i dati nel formato richiesto delle medie. A seconda dei dati, è possibile eseguire l'override in una delle altre versioni di questa funzione invece. Se i dati sono piccole e ha dimensione fissa, eseguire l'override `OnRenderGlobalData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.

Per altre informazioni, vedere la `FORMATETC` e `STGMEDIUM` strutture nel SDK di Windows.

##  <a name="onrenderfiledata"></a>  COleControl::OnRenderFileData

Chiamato dal framework per recuperare i dati nel formato specificato quando il supporto di archiviazione è un file.

```
virtual BOOL OnRenderFileData(
    LPFORMATETC lpFormatEtc,
    CFile* pFile);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta al [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura che specifica il formato in cui vengono richieste informazioni.

*pFile*<br/>
Punta a un [CFile](../../mfc/reference/cfile-class.md) oggetto in cui i dati da sottoporre a rendering.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Il formato specificato è uno precedentemente spostata nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funzione membro per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce FALSE.

Eseguire l'override di questa funzione per fornire i dati nel formato richiesto delle medie. A seconda dei dati, si potrebbe voler eseguire l'override in una delle altre versioni di questa funzione invece. Se si desidera gestire più supporti di archiviazione, eseguire l'override `OnRenderData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.

Per altre informazioni, vedere il `FORMATETC` struttura nel SDK di Windows.

##  <a name="onrenderglobaldata"></a>  COleControl::OnRenderGlobalData

Chiamato dal framework per recuperare i dati nel formato specificato quando il supporto di archiviazione specificato è la memoria globale.

```
virtual BOOL OnRenderGlobalData(
    LPFORMATETC lpFormatEtc,
    HGLOBAL* phGlobal);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Punta al [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura che specifica il formato in cui vengono richieste informazioni.

*phGlobal*<br/>
Punta a un handle per la memoria globale in cui i dati sono da restituire. Se non è stata allocata alcuna memoria, questo parametro può essere NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Il formato specificato è uno precedentemente spostata nell'oggetto di controllo usando il [DelayRenderData](../../mfc/reference/coledatasource-class.md#delayrenderdata) funzione membro per il rendering ritardato. L'implementazione predefinita di questa funzione restituisce FALSE.

Se *phGlobal* è NULL, un nuovo HGLOBAL deve essere allocato e restituito nella *phGlobal*. In caso contrario, il HGLOBAL specificato da *phGlobal* deve essere riempito con i dati. La quantità di dati inseriti nel HGLOBAL non deve superare la dimensione corrente del blocco di memoria. Inoltre, il blocco non può essere riallocato a una dimensione maggiore.

Eseguire l'override di questa funzione per fornire i dati nel formato richiesto delle medie. A seconda dei dati, è possibile eseguire l'override in una delle altre versioni di questa funzione invece. Se si desidera gestire più supporti di archiviazione, eseguire l'override `OnRenderData`. Se i dati in un file o sono di dimensioni variabili, eseguire l'override `OnRenderFileData`.

Per altre informazioni, vedere il `FORMATETC` struttura nel SDK di Windows.

##  <a name="onresetstate"></a>  COleControl::OnResetState

Chiamato dal framework quando le proprietà del controllo devono essere impostate su valori predefiniti.

```
virtual void OnResetState();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama [DoPropExchange](#dopropexchange), passando un `CPropExchange` oggetto che fa sì che le proprietà da impostare sui valori predefiniti.

Il writer di controllo è possibile inserire il codice di inizializzazione per il controllo OLE in questo sottoponibile a override. Questa funzione viene chiamata quando [IPersistStream:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststream-load) oppure [IPersistStorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) ha esito negativo, o [IPersistStreamInit](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-initnew) o [IPersistStorage: : InitNew](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-initnew) viene chiamato senza chiamare prima uno `IPersistStream::Load` o `IPersistStorage::Load`.

##  <a name="onsetclientsite"></a>  COleControl::OnSetClientSite

Chiamato dal framework quando il contenitore ha chiamato il controllo `IOleControl::SetClientSite` (funzione).

```
virtual void OnSetClientSite();
```

### <a name="remarks"></a>Note

Per impostazione predefinita `OnSetClientSite` controlla se le proprietà del percorso dei dati vengono caricate e, in tal caso, chiama `DoDataPathPropExchange`.

Eseguire l'override di questa funzione per eseguire qualsiasi elaborazione speciale della notifica. In particolare, gli override di questa funzione devono chiamare la classe di base.

##  <a name="onsetdata"></a>  COleControl::OnSetData

Chiamato dal framework per sostituire i dati del controllo con i dati specificati.

```
virtual BOOL OnSetData(
    LPFORMATETC lpFormatEtc,
    LPSTGMEDIUM lpStgMedium,
    BOOL bRelease);
```

### <a name="parameters"></a>Parametri

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura che specifica il formato dei dati.

*lpStgMedium*<br/>
Puntatore a un [STGMEDIUM](/windows/desktop/api/objidl/ns-objidl-tagstgmedium) struttura in cui si trovano i dati.

*bRelease*<br/>
TRUE se il controllo deve liberare il supporto di archiviazione; FALSO se il controllo non deve liberare il supporto di archiviazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se i dati sono impostati nella proprietà persistenti formato, l'implementazione predefinita consente di modificare lo stato del controllo di conseguenza. In caso contrario, l'implementazione predefinita non esegue alcuna operazione. Se *bRelease* è TRUE, una chiamata a `ReleaseStgMedium` viene eseguita; in caso contrario non.

Eseguire l'override di questa funzione per sostituire i dati del controllo con i dati specificati.

Per altre informazioni, vedere la `FORMATETC` e `STGMEDIUM` strutture nel SDK di Windows.

##  <a name="onsetextent"></a>  COleControl::OnSetExtent

Chiamato dal framework quando deve essere modificato, in seguito a una chiamata all'estensione del controllo [IOleObject:: SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent).

```
virtual BOOL OnSetExtent(LPSIZEL lpSizeL);
```

### <a name="parameters"></a>Parametri

*lpSizeL*<br/>
Un puntatore al `SIZEL` struttura che utilizza valori long integer per rappresentare la larghezza e altezza del controllo, espresso in unità HIMETRIC.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la modifica delle dimensioni è stata accettata. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita gestisce il ridimensionamento dell'estensione del controllo. Se il controllo è attivo sul posto, una chiamata al contenitore `OnPosRectChanged` viene quindi reso.

Eseguire l'override di questa funzione per modificare il ridimensionamento predefinito del controllo.

##  <a name="onsetobjectrects"></a>  COleControl::OnSetObjectRects

Chiamato dal framework per implementare una chiamata a [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects).

```
virtual BOOL OnSetObjectRects(
    LPCRECT lpRectPos,
    LPCRECT lpRectClip);
```

### <a name="parameters"></a>Parametri

*lpRectPos*<br/>
Un puntatore a un `RECT` struttura indicante nuova posizione e dimensioni relativo per il contenitore del controllo.

*lpRectClip*<br/>
Un puntatore a un `RECT` struttura che indica un'area rettangolare in cui il controllo è da ritagliare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il riposizionamento è stato accettato. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita automaticamente gestisce il riposizionamento e il ridimensionamento della finestra del controllo e restituisce TRUE.

Eseguire l'override di questa funzione per modificare il comportamento predefinito di questa funzione.

##  <a name="onshowtoolbars"></a>  COleControl::OnShowToolBars

Chiamato dal framework quando il controllo è stata attivata l'interfaccia utente.

```
virtual void OnShowToolBars();
```

### <a name="remarks"></a>Note

L'implementazione predefinita non esegue alcuna operazione.

##  <a name="ontextchanged"></a>  COleControl::OnTextChanged

Chiamato dal framework quando è stato modificato il valore della proprietà Caption o di testo predefinito.

```
virtual void OnTextChanged();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama `InvalidateControl`.

Se si desidera che notifica dopo questa proprietà viene modificata l'override della funzione.

##  <a name="onwindowlessmessage"></a>  COleControl::OnWindowlessMessage

Chiamato dal framework in risposta a un contenitore `IOleInPlaceObjectWindowless::OnWindowMessage` richiesta.

```
virtual BOOL OnWindowlessMessage(
    UINT msg,
    WPARAM wParam,
    LPARAM lParam,
    LRESULT* plResult);
```

### <a name="parameters"></a>Parametri

*msg*<br/>
Identificatore del messaggio come passato da Windows.

*wParam*<br/>
Come passato da Windows. Specifica informazioni aggiuntive specifiche del messaggio. Il contenuto di questo parametro dipende dal valore della *msg* parametro.

*lParam*<br/>
Come passato da Windows. Specifica informazioni aggiuntive specifiche del messaggio. Il contenuto di questo parametro dipende dal valore della *msg* parametro.

*plResult*<br/>
Codice di risultato di Windows. Specifica il risultato dell'elaborazione del messaggio e dipende dal messaggio inviato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Elabora i messaggi della finestra per i controlli privi di finestra. `COleControl`del `OnWindowlessMessage` deve essere utilizzato per i messaggi della finestra diverso da messaggi del mouse e tastiera. `COleControl` fornisce [SetCapture](#setcapture) e [SetFocus](#setfocus) in modo specifico per ottenere lo stato attivo della tastiera e acquisizione del mouse per gli oggetti OLE privi di finestra.

Poiché gli oggetti senza finestra non dispongono di una finestra, è necessario un meccanismo per consentire i messaggi di invio il contenitore a tali. Un oggetto OLE senza Ottiene i messaggi dal relativo contenitore, tramite il `OnWindowMessage` metodo sul `IOleInPlaceObjectWindowless` interfaccia (un'estensione della [IOleInPlaceObject](/windows/desktop/api/oleidl/nn-oleidl-ioleinplaceobject) per il supporto senza finestra). `OnWindowMessage` non accetta un `HWND` parametro.

##  <a name="parenttoclient"></a>  COleControl::ParentToClient

Converte le coordinate di *PowerPoint* alle coordinate del client.

```
virtual UINT ParentToClient(
    LPCRECT lprcBounds,
    LPPOINT pPoint,
    BOOL bHitTest = FALSE) const;
```

### <a name="parameters"></a>Parametri

*lprcBounds*<br/>
Puntatore ai limiti del controllo OLE all'interno del contenitore. Area non client, ma l'area del controllo intera, compresi i bordi e le barre di scorrimento.

*PowerPoint*<br/>
Puntatore all'elemento padre (contenitore) punto di essere convertito in coordinate dell'area client del controllo.

*bHitTest*<br/>
Specifica se è o meno hit test da eseguire nel punto di.

### <a name="return-value"></a>Valore restituito

Se *bHitTest* è FALSE, restituisce HTNOWHERE. Se *bHitTest* è TRUE, restituisce la posizione in cui l'elemento padre (contenitore) punto visualizzata nell'area client del controllo OLE ed è uno dei seguente mouse i valori di hit test:

- HTBORDER nel bordo di una finestra che non ha un bordo di ridimensionamento.

- HTBOTTOM nel bordo orizzontale inferiore della finestra.

- HTBOTTOMLEFT nell'angolo in basso a sinistra del bordo della finestra.

- HTBOTTOMRIGHT nell'angolo in basso a destra del bordo della finestra.

- HTCAPTION In un'area della barra del titolo.

- HTCLIENT In un'area client.

- HTERROR sullo sfondo della schermata o in una linea di demarcazione tra windows (stesso HTNOWHERE, eccetto il `DefWndProc` Windows funzione produce un segnale acustico per indicare un errore).

- HTGROWBOX In una finestra di dimensione.

- HTHSCROLL nella barra di scorrimento orizzontale.

- HTLEFT nel bordo sinistro della finestra.

- HTMAXBUTTON nell'ottimizzare un pulsante.

- HTMENU In un'area del menu.

- Pulsante HTMINBUTTON In a ridurre al minimo.

- HTNOWHERE sullo sfondo della schermata o in una linea di demarcazione tra windows.

- Pulsante HTREDUCE In a ridurre al minimo.

- HTRIGHT nel bordo destro della finestra.

- HTSIZE In una finestra di dimensione (uguale a HTGROWBOX).

- Menu HTSYSMENU In un controllo o in un pulsante Chiudi in una finestra figlio.

- HTTOP In orizzontale bordo superiore della finestra.

- HTTOPLEFT nell'angolo superiore sinistro del bordo della finestra.

- HTTOPRIGHT nell'angolo superiore destro del bordo della finestra.

- HTTRANSPARENT In una finestra attualmente coperta da un'altra finestra.

- HTVSCROLL nella barra di scorrimento verticale.

- HTZOOM nell'ottimizzare un pulsante.

### <a name="remarks"></a>Note

Sull'input *PowerPoint* è relativo all'origine dell'elemento padre (angolo superiore sinistro del contenitore). Nell'output *PowerPoint* è relativo all'origine dell'area client del controllo OLE (angolo superiore sinistro dell'area client del controllo).

##  <a name="postmodaldialog"></a>  COleControl::PostModalDialog

Notifica al contenitore che è stata chiusa una finestra di dialogo modale.

```
void PostModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametri

*hWndParent*<br/>
Handle alla finestra padre della finestra di dialogo modale.

### <a name="remarks"></a>Note

Chiamare questa funzione dopo la visualizzazione di qualsiasi finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore può abilitare eventuali finestre di primo livello per disabilitato `PreModalDialog`. Questa funzione deve essere abbinata a una chiamata a `PreModalDialog`.

##  <a name="premodaldialog"></a>  COleControl::PreModalDialog

Notifica al contenitore che sta per essere visualizzato una finestra di dialogo modale.

```
void PreModalDialog(HWND hWndParent = NULL);
```

### <a name="parameters"></a>Parametri

*hWndParent*<br/>
Handle alla finestra padre della finestra di dialogo modale.

### <a name="remarks"></a>Note

Chiamare questa funzione prima di visualizzare qualsiasi finestra di dialogo modale. È necessario chiamare questa funzione in modo che il contenitore è possibile disabilitare tutte le relative finestre di primo livello. Dopo che è stato visualizzato nella finestra di dialogo modale, è necessario quindi chiamare `PostModalDialog`.

##  <a name="recreatecontrolwindow"></a>  COleControl::RecreateControlWindow

Elimina e ricrea la finestra del controllo.

```
void RecreateControlWindow();
```

### <a name="remarks"></a>Note

Ciò potrebbe essere necessario se è necessario modificare i bit di stile della finestra.

##  <a name="refresh"></a>  COleControl::Refresh

Impone un ridisegno del controllo OLE.

```
void Refresh();
```

### <a name="remarks"></a>Note

Questa funzione è supportata per il `COleControl` classe di base come un metodo azionario, chiamato di aggiornamento. Ciò consente agli utenti del controllo OLE ridisegnare il controllo in un momento specifico. Per altre informazioni su questo metodo, vedere l'articolo [controlli ActiveX: metodi](../../mfc/mfc-activex-controls-methods.md).

##  <a name="releasecapture"></a>  COleControl::ReleaseCapture

Rilascia il mouse capture.

```
BOOL ReleaseCapture();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se il controllo dispone attualmente dello stato mouse capture, l'acquisizione viene rilasciato. In caso contrario, questa funzione non ha effetto.

##  <a name="releasedc"></a>  COleControl::ReleaseDC

Rilascia il contesto di dispositivo di visualizzazione di un contenitore di un controllo senza finestra, liberando il contesto di dispositivo per l'uso da altre applicazioni.

```
int ReleaseDC(CDC* pDC);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Identifica il contesto di dispositivo contenitore deve essere rilasciato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

L'applicazione deve chiamare `ReleaseDC` per ogni chiamata a [GetDC](#getdc).

##  <a name="reparentcontrolwindow"></a>  COleControl::ReparentControlWindow

Imposta l'elemento padre del controllo.

```
virtual void ReparentControlWindow(
    HWND hWndOuter,
    HWND hWndParent);
```

### <a name="parameters"></a>Parametri

*hWndOuter*<br/>
L'handle della finestra del controllo.

*hWndParent*<br/>
L'handle della finestra padre nuovo.

### <a name="remarks"></a>Note

Chiamare questa funzione per reimpostare l'elemento padre della finestra del controllo.

##  <a name="resetstockprops"></a>  COleControl::ResetStockProps

Inizializza lo stato del `COleControl` azionari proprietà sui rispettivi valori predefiniti.

```
void ResetStockProps();
```

### <a name="remarks"></a>Note

Le proprietà sono: aspetto, colore di sfondo, BorderStyle, didascalia, Enabled, del tipo di carattere, colore di primo piano, hWnd e testo. Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).

Per migliorare le prestazioni di inizializzazione binaria di un controllo usando `ResetStockProps` e `ResetVersion` per eseguire l'override `COleControl::OnResetState`. Vedere l'esempio seguente. Per ulteriori informazioni sull'inizializzazione di ottimizzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#7](../../mfc/reference/codesnippet/cpp/colecontrol-class_8.cpp)]

##  <a name="resetversion"></a>  COleControl::ResetVersion

Inizializza il numero di versione al valore specificato.

```
void ResetVersion(DWORD dwVersionDefault);
```

### <a name="parameters"></a>Parametri

*dwVersionDefault*<br/>
Il numero di versione da assegnare al controllo.

### <a name="remarks"></a>Note

Per migliorare le prestazioni di inizializzazione binaria di un controllo usando `ResetVersion` e `ResetStockProps` per eseguire l'override `COleControl::OnResetState`. Vedere l'esempio dal [ResetStockProps](#resetstockprops). Per ulteriori informazioni sull'inizializzazione di ottimizzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="scrollwindow"></a>  COleControl::ScrollWindow

Consente a un oggetto OLE privi di finestra scorrere un'area nella propria immagine attiva in posizione sullo schermo.

```
void ScrollWindow(
    int xAmount,
    int yAmount,
    LPCRECT lpRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametri

*xAmount*<br/>
Specifica la quantità, in unità di dispositivo di scorrimento orizzontale. Questo parametro deve essere un valore negativo per scorrere a sinistra.

*yAmount*<br/>
Specifica la quantità, in unità di dispositivo di scorrimento verticale. Questo parametro deve essere un valore negativo a scorrere verso l'alto.

*lpRect*<br/>
Punta a un [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o una struttura RECT che specifica la parte dell'area client dell'oggetto OLE da scorrere, nelle coordinate del client della finestra contenitore. Se *lpRect* è NULL, è necessario scorrere area client dell'intero oggetto OLE.

*lpClipRect*<br/>
Punta a un `CRect` oggetto o `RECT` struttura che specifica il rettangolo da ritagliare. Solo i pixel all'interno del rettangolo vengono eseguito lo scorrimento. BITS all'esterno del rettangolo non sono interessati anche se sono nel *lpRect* rettangolo. Se *lpClipRect* è NULL, non viene eseguita alcuna ritaglio sul rettangolo di scorrimento.

##  <a name="selectfontobject"></a>  COleControl::SelectFontObject

Seleziona un tipo di carattere in un contesto di dispositivo.

```
CFont* SelectFontObject(
    CDC* pDC,
    CFontHolder& fontHolder);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore a un oggetto di contesto di dispositivo.

*fontHolder*<br/>
Riferimento per la [CFontHolder](../../mfc/reference/cfontholder-class.md) oggetto che rappresenta il tipo di carattere da selezionare.

### <a name="return-value"></a>Valore restituito

Puntatore al tipo di carattere selezionato in precedenza. Quando il chiamante ha completato tutte le operazioni di disegno che usano *fontHolder,* deve selezionare di nuovo il tipo di carattere selezionato in precedenza passandolo come parametro al [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject).

##  <a name="selectstockfont"></a>  COleControl::SelectStockFont

Seleziona la proprietà predefinita in un contesto di dispositivo.

```
CFont* SelectStockFont(CDC* pDC);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Il contesto di dispositivo in cui verrà selezionato il tipo di carattere.

### <a name="return-value"></a>Valore restituito

Un puntatore a selezionato in precedenza `CFont` oggetto. È consigliabile usare [CDC:: SelectObject](../../mfc/reference/cdc-class.md#selectobject) selezionare questo tipo di carattere nel contesto di dispositivo al termine.

##  <a name="serializeextent"></a>  COleControl::SerializeExtent

Serializza o Inizializza lo stato dello spazio di visualizzazione assegnato al controllo.

```
void SerializeExtent(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*ar*<br/>
Oggetto `CArchive` oggetto da serializzare da o verso.

### <a name="remarks"></a>Note

È possibile migliorare le prestazioni della persistenza binario di un controllo usando `SerializeExtent`, `SerializeStockProps`, e `SerializeVersion` per eseguire l'override `COleControl::Serialize`. Vedere l'esempio seguente. Per ulteriori informazioni sull'inizializzazione di ottimizzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFCAxCtl#8](../../mfc/reference/codesnippet/cpp/colecontrol-class_9.cpp)]

##  <a name="serializestockprops"></a>  COleControl::SerializeStockProps

Serializza o Inizializza lo stato del `COleControl` proprietà predefinite: aspetto, colore di sfondo, BorderStyle, didascalia, Enabled, del tipo di carattere, colore di primo piano e testo.

```
void SerializeStockProps(CArchive& ar);
```

### <a name="parameters"></a>Parametri

*ar*<br/>
Oggetto `CArchive` oggetto da serializzare da o verso.

### <a name="remarks"></a>Note

Per una descrizione delle proprietà predefinite, vedere [controlli ActiveX: aggiunta di proprietà predefinite](../../mfc/mfc-activex-controls-adding-stock-properties.md).

È possibile migliorare le prestazioni della persistenza binario di un controllo usando `SerializeStockProps`, `SerializeExtent`, e `SerializeVersion` per eseguire l'override `COleControl::Serialize`. Per un esempio, vedere il codice in [SerializeExtent](#serializeextent). Per ulteriori informazioni sull'inizializzazione di ottimizzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="serializeversion"></a>  COleControl::SerializeVersion

Serializza o Inizializza lo stato delle informazioni sulla versione di un controllo.

```
DWORD SerializeVersion(
    CArchive& ar,
    DWORD dwVersionDefault,
    BOOL bConvert = TRUE);
```

### <a name="parameters"></a>Parametri

*ar*<br/>
Oggetto `CArchive` oggetto da serializzare da o verso.

*dwVersionDefault*<br/>
Il numero di versione corrente del controllo.

*bConvert*<br/>
Indica se i dati persistenti devono essere convertiti nel formato più recente quando è stato salvato o mantenuto nello stesso formato che si trovava al momento è stato caricato.

### <a name="return-value"></a>Valore restituito

Il numero di versione del controllo. Se l'archivio specificato viene caricato, `SerializeVersion` restituisce la versione caricata da tale archivio. In caso contrario, restituisce la versione attualmente caricata.

### <a name="remarks"></a>Note

È possibile migliorare le prestazioni della persistenza binario di un controllo usando `SerializeVersion`, `SerializeExtent`, e `SerializeStockProps` per eseguire l'override `COleControl::Serialize`. Per un esempio, vedere il codice in [SerializeExtent](#serializeextent). Per ulteriori informazioni sull'inizializzazione di ottimizzazione, vedere [controlli ActiveX: ottimizzazione](../../mfc/mfc-activex-controls-optimization.md).

##  <a name="setappearance"></a>  COleControl::SetAppearance

Imposta il valore della proprietà azionario aspetto del controllo.

```
void SetAppearance (short sAppearance);
```

### <a name="parameters"></a>Parametri

*sAppearance*<br/>
Oggetto **breve** valore (VT_I2) da utilizzare per l'aspetto del controllo. Un valore pari a zero imposta l'aspetto del controllo su flat e il valore 1 imposta l'aspetto del controllo a 3D.

### <a name="remarks"></a>Note

Per altre informazioni sulle proprietà predefinite, vedere [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setbackcolor"></a>  COleControl::SetBackColor

Imposta il valore della proprietà predefinito colore di sfondo del controllo.

```
void SetBackColor(OLE_COLOR dwBackColor);
```

### <a name="parameters"></a>Parametri

*dwBackColor*<br/>
Un valore OLE_COLOR da utilizzare per lo sfondo di disegno del controllo.

### <a name="remarks"></a>Note

Per altre informazioni sull'uso di questa proprietà e relative proprietà, vedere l'articolo [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setborderstyle"></a>  COleControl::SetBorderStyle

Imposta il valore della proprietà BorderStyle predefinito del controllo.

```
void SetBorderStyle(short sBorderStyle);
```

### <a name="parameters"></a>Parametri

*sBorderStyle*<br/>
Il nuovo stile del bordo per il controllo; 0 non indica nessun bordo mentre 1 indica un bordo normale.

### <a name="remarks"></a>Note

La finestra di controllo verrà quindi ricreata e `OnBorderStyleChanged` chiamato.

##  <a name="setcapture"></a>  COleControl::SetCapture

Fa sì che la finestra del controllo contenitore da prendere possesso dell'acquisizione del mouse per conto del controllo.

```
CWnd* SetCapture();
```

### <a name="return-value"></a>Valore restituito

Un puntatore al `CWnd` oggetto window che in precedenza ha ricevuto un input del mouse.

### <a name="remarks"></a>Note

Se il controllo è attivato e privi di finestra, questa funzione provoca la finestra del controllo contenitore da prendere possesso dell'acquisizione del mouse, per conto del controllo. In caso contrario, questa funzione, il controllo in modo da prendere possesso dell'acquisizione del mouse (uguale a `CWnd::SetCapture`).

##  <a name="setcontrolsize"></a>  COleControl::SetControlSize

Imposta le dimensioni della finestra del controllo OLE e notifica al contenitore il sito del controllo in fase di modifica.

```
BOOL SetControlSize(int cx, int cy);
```

### <a name="parameters"></a>Parametri

*CX*<br/>
Specifica la nuova larghezza del controllo in pixel.

*CY*<br/>
Specifica la nuova altezza del controllo in pixel.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha avuto esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione non deve essere utilizzata nel costruttore del controllo.

Si noti che tutte le coordinate per finestre di controllo rispetto all'angolo superiore sinistro del controllo.

##  <a name="setenabled"></a>  COleControl::SetEnabled

Imposta il valore della proprietà Enabled del controllo stock.

```
void SetEnabled(BOOL bEnabled);
```

### <a name="parameters"></a>Parametri

*bEnabled*<br/>
TRUE se il controllo deve essere abilitato; in caso contrario, FALSE.

### <a name="remarks"></a>Note

Dopo aver impostato questa proprietà, `OnEnabledChange` viene chiamato.

##  <a name="setfocus"></a>  COleControl::SetFocus

Fa sì che la finestra del controllo contenitore da prendere possesso dell'elemento attivo di input per conto del controllo.

```
CWnd* SetFocus();
```

### <a name="return-value"></a>Valore restituito

Un puntatore al `CWnd` oggetto window che in precedenza era l'input concentrarsi, o NULL se non esiste alcun intervallo di questo tipo.

### <a name="remarks"></a>Note

Se il controllo è attivato e privi di finestra, questa funzione determina la finestra del controllo contenitore da prendere possesso dell'elemento attivo di input, per conto del controllo. Lo stato attivo di input indirizza l'input da tastiera per la finestra del contenitore e il contenitore invia tutti i messaggi della tastiera successivi all'oggetto OLE che chiama `SetFocus`. Qualsiasi finestra in cui in precedenza era lo stato attivo perde lo.

Se il controllo non è attivo, questa funzione, il controllo in modo da prendere possesso dell'elemento attivo di input (uguale a `CWnd::SetFocus`).

##  <a name="setfont"></a>  COleControl::SetFont

Imposta la proprietà predefinita del controllo.

```
void SetFont(LPFONTDISP pFontDisp);
```

### <a name="parameters"></a>Parametri

*pFontDisp*<br/>
Puntatore a un'interfaccia di dispatch del tipo di carattere.

##  <a name="setforecolor"></a>  COleControl::SetForeColor

Imposta il valore della proprietà ForeColor predefinito del controllo.

```
void SetForeColor(OLE_COLOR dwForeColor);
```

### <a name="parameters"></a>Parametri

*dwForeColor*<br/>
Un valore OLE_COLOR da utilizzare per la creazione del controllo in primo piano.

### <a name="remarks"></a>Note

Per altre informazioni sull'uso di questa proprietà e relative proprietà, vedere l'articolo [controlli ActiveX: proprietà](../../mfc/mfc-activex-controls-properties.md).

##  <a name="setinitialdataformats"></a>  COleControl::SetInitialDataFormats

Chiamata eseguita dal framework per inizializzare l'elenco di formati dati supportati dal controllo.

```
virtual void SetInitialDataFormats();
```

### <a name="remarks"></a>Note

L'implementazione predefinita specifica due formati: CF_EMBEDSOURCE e la proprietà permanente impostata.

##  <a name="setinitialsize"></a>  COleControl::SetInitialSize

Imposta le dimensioni di un controllo OLE alla prima visualizzazione in un contenitore.

```
void SetInitialSize(
    int cx,
    int cy);
```

### <a name="parameters"></a>Parametri

*CX*<br/>
Larghezza iniziale del controllo OLE in pixel.

*CY*<br/>
Altezza iniziale del controllo OLE in pixel.

### <a name="remarks"></a>Note

Chiamare questa funzione del costruttore impostare le dimensioni iniziali del controllo. La dimensione iniziale viene misurata in unità di dispositivo o pixel. È consigliabile che questa chiamata venga effettuata nel costruttore del controllo.

##  <a name="setmodifiedflag"></a>  COleControl::SetModifiedFlag

Modifica lo stato modificato di un controllo.

```
void SetModifiedFlag(BOOL bModified = TRUE);
```

### <a name="parameters"></a>Parametri

*bModified*<br/>
Il nuovo valore per il controllo modificato del flag. TRUE indica che è stato modificato lo stato del controllo. FALSE indica che è appena stato salvato lo stato del controllo.

### <a name="remarks"></a>Note

Chiamare questa funzione ogni volta che si verifica una modifica che influirebbe stato persistente del controllo. Ad esempio, se viene modificato il valore di una proprietà persistente, chiamare questa funzione con *bModified* **TRUE**.

##  <a name="setnotpermitted"></a>  COleControl::SetNotPermitted

Indica che una richiesta di modifica non è riuscita.

```
void SetNotPermitted();
```

### <a name="remarks"></a>Note

Chiamare questa funzione quando `BoundPropertyRequestEdit` ha esito negativo. Questa funzione genera un'eccezione di tipo `COleDispScodeException` per indicare che l'operazione di impostazione non è stata permessa.

##  <a name="setnotsupported"></a>  COleControl::SetNotSupported

Impedisce la modifica al valore della proprietà di un controllo dall'utente.

```
void SetNotSupported();
```

### <a name="remarks"></a>Note

Chiamare questa funzione anziché la funzione di Set di qualsiasi proprietà in cui non è supportata la modifica del valore della proprietà dall'utente del controllo. Un esempio sarebbe una proprietà che è di sola lettura.

##  <a name="setrectincontainer"></a>  COleControl::SetRectInContainer

Imposta le coordinate del rettangolo relativo per il contenitore, espresso in unità dispositivo.

```
BOOL SetRectInContainer(LPCRECT lpRect);
```

### <a name="parameters"></a>Parametri

*lpRect*<br/>
Un puntatore a un rettangolo che contiene le coordinate di nuovo del controllo relativo per il contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata ha avuto esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se il controllo è aperto, viene ridimensionato; in caso contrario, il contenitore `OnPosRectChanged` funzione viene chiamata.

##  <a name="settext"></a>  COleControl::SetText

Imposta il valore della proprietà di testo o didascalia predefinita del controllo.

```
void SetText(LPCTSTR pszText);
```

### <a name="parameters"></a>Parametri

*pszText*<br/>
Puntatore a una stringa di caratteri.

### <a name="remarks"></a>Note

Si noti che la didascalia e il testo di proprietà predefinite sono entrambi mappate allo stesso valore. Ciò significa che tutte le modifiche apportate a delle proprietà cambierà automaticamente entrambe le proprietà. In generale, un controllo deve supportare le scorte didascalia o proprietà di testo, ma non entrambi.

##  <a name="throwerror"></a>  COleControl::ThrowError

Segnala l'occorrenza di un errore nel controllo.

```
void ThrowError(
    SCODE sc,
    UINT nDescriptionID,
    UINT nHelpID = -1);


void ThrowError(
    SCODE sc,
    LPCTSTR pszDescription = NULL,
    UINT nHelpID = 0);
```

### <a name="parameters"></a>Parametri

*SC*<br/>
Il valore di codice di stato da segnalare. Per un elenco completo dei possibili codici, vedere l'articolo [controlli ActiveX: argomenti avanzati](../../mfc/mfc-activex-controls-advanced-topics.md).

*nDescriptionID*<br/>
La stringa ID risorsa dell'eccezione da segnalare.

*nHelpID*<br/>
ID della Guida dell'argomento da includere nel report.

*pszDescription*<br/>
Stringa contenente una spiegazione dell'eccezione da segnalare.

### <a name="remarks"></a>Note

Questa funzione deve essere chiamata solo all'interno di una funzione Get o Set per una proprietà OLE o l'implementazione di un metodo di automazione OLE. Se si desidera segnalare gli errori che si verificano in altri casi, si deve essere attivata l'evento di errore predefinita.

##  <a name="transformcoords"></a>  COleControl::TransformCoords

Trasformazioni di coordinano i valori compresi tra unità HIMETRIC e unità native del contenitore.

```
void TransformCoords(
    POINTL* lpptlHimetric,
    POINTF* lpptfContainer,
    DWORD flags);
```

### <a name="parameters"></a>Parametri

*lpptlHimetric*<br/>
Puntatore a un `POINTL` struttura che contiene le coordinate in unità HIMETRIC.

*lpptfContainer*<br/>
Puntatore a un `POINTF` struttura che contiene le coordinate in dimensioni dell'unità del contenitore.

*flags*<br/>
Una combinazione dei valori seguenti:

- Posizione XFORMCOORDS_POSITION oggetto nel contenitore.

- Dimensioni oggetto XFORMCOORDS_SIZE nel contenitore.

- Unità HIMETRIC trasformare XFORMCOORDS_HIMETRICTOCONTAINER alle unità del contenitore.

- XFORMCOORDS_CONTAINERTOHIMETRIC trasformare le unità del contenitore di unità HIMETRIC.

### <a name="remarks"></a>Note

I primi due flag, XFORMCOORDS_POSITION e XFORMCOORDS_SIZE, indicano se le coordinate devono essere considerate una posizione o una dimensione. I flag restanti due indicano la direzione della trasformazione.

##  <a name="translatecolor"></a>  COleControl::TranslateColor

Converte un valore di colore dal tipo di dati OLE_COLOR per il [COLORREF](/windows/desktop/gdi/colorref) tipo di dati.

```
COLORREF TranslateColor(
    OLE_COLOR clrColor,
    HPALETTE hpal = NULL);
```

### <a name="parameters"></a>Parametri

*clrColor*<br/>
Un tipo di dati OLE_COLOR. Per altre informazioni, vedere il Windows [OleTranslateColor](/windows/desktop/api/olectl/nf-olectl-oletranslatecolor) (funzione).

*hpal*<br/>
Un handle per una tavolozza facoltativo; può essere NULL.

### <a name="return-value"></a>Valore restituito

Un valore di 32 bit colore RGB (rosso, verde, blu) che definisce il solido colore più simile al *clrColor* valore che può rappresentare il dispositivo.

### <a name="remarks"></a>Note

Questa funzione è utile per tradurre le proprietà predefinite colore di primo piano e colore di sfondo a tipi COLORREF utilizzati da [CDC](../../mfc/reference/cdc-class.md) funzioni membro.

##  <a name="willambientsbevalidduringload"></a>  COleControl::WillAmbientsBeValidDuringLoad

Determina se il controllo deve utilizzare i valori delle proprietà di ambiente come valori predefiniti, quando successivamente viene caricato dal relativo stato permanente.

```
BOOL WillAmbientsBeValidDuringLoad();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero indica che le proprietà di ambiente sarà valide. in caso contrario, le proprietà di ambiente non saranno valide.

### <a name="remarks"></a>Note

In alcuni contenitori, il controllo non abbia accesso alle relative proprietà di ambiente durante la chiamata iniziale per l'override del `COleControl::DoPropExchange`. Ciò avviene se il contenitore chiama [IPersistStreamInit::Load](/windows/desktop/api/ocidl/nf-ocidl-ipersiststreaminit-load) oppure [IPersistStorage:: Load](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-load) prima di chiamare [:: SetClientSite](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setclientsite) (vale a dire, se non esiste rispettano il bit di stato OLEMISC_SETCLIENTSITEFIRST).

##  <a name="windowproc"></a>  COleControl::WindowProc

Fornisce una procedura di Windows per un `COleControl` oggetto.

```
virtual LRESULT WindowProc(
    UINT message,
    WPARAM wParam,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametri

*message*<br/>
Specifica il messaggio di Windows da elaborare.

*wParam*<br/>
Fornisce informazioni aggiuntive utilizzate nell'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.

*lParam*<br/>
Fornisce informazioni aggiuntive utilizzate nell'elaborazione del messaggio. Il valore del parametro dipende dal messaggio.

### <a name="return-value"></a>Valore restituito

Il valore restituito del messaggio inviato.

### <a name="remarks"></a>Note

Chiamare questa funzione per l'invio di messaggi specifici tramite la mappa dei messaggi del controllo.

## <a name="see-also"></a>Vedere anche

[MFC esempio CIRC3](../../visual-cpp-samples.md)<br/>
[Esempio MFC TESTHELP](../../visual-cpp-samples.md)<br/>
[Classe COlePropertyPage](../../mfc/reference/colepropertypage-class.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Classe CFontHolder](../../mfc/reference/cfontholder-class.md)<br/>
[Classe CPictureHolder](../../mfc/reference/cpictureholder-class.md)<br/>
