---
title: Classe COleClientItem | Documenti Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
dev_langs:
- C++
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 69836eb254b23c05f2405c8f11b55a6d6293a9cb
ms.sourcegitcommit: f1b051abb1de3fe96350be0563aaf4e960da13c3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/27/2018
ms.locfileid: "37039336"
---
# <a name="coleclientitem-class"></a>Classe COleClientItem
Definisce l'interfaccia del contenitore per gli elementi OLE.  
  
## <a name="syntax"></a>Sintassi  
  
```  
class COleClientItem : public CDocItem  
```  
  
## <a name="members"></a>Membri  
  
### <a name="public-constructors"></a>Costruttori pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleClientItem::COleClientItem](#coleclientitem)|Costruisce un oggetto `COleClientItem`.|  
  
### <a name="public-methods"></a>Metodi pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleClientItem::Activate](#activate)|Apre l'elemento OLE per un'operazione e quindi esegue il verbo specificato.|  
|[COleClientItem::ActivateAs](#activateas)|Attiva l'elemento di un altro tipo.|  
|[COleClientItem::AttachDataObject](#attachdataobject)|Accede ai dati nell'oggetto OLE.|  
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica se un'applicazione contenitore può creare un oggetto incorporato.|  
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica se un'applicazione contenitore può creare un oggetto collegato.|  
|[COleClientItem::CanPaste](#canpaste)|Indica se gli Appunti contengono un elemento OLE incorporabile o statico.|  
|[COleClientItem::CanPasteLink](#canpastelink)|Indica se gli Appunti contengono un elemento OLE collegabile.|  
|[COleClientItem::Close](#close)|Chiude un collegamento a un server ma non elimina l'elemento OLE.|  
|[COleClientItem::ConvertTo](#convertto)|Converte l'elemento a un altro tipo.|  
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia l'elemento OLE negli Appunti.|  
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicato di un elemento esistente.|  
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incorporato dagli Appunti.|  
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incorporato da un oggetto dati.|  
|[CreateFromFile](#createfromfile)|Crea un elemento incorporato da un file.|  
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento collegato dagli Appunti.|  
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento collegato da un oggetto dati.|  
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento collegato da un file.|  
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuovo elemento incorporato avviando l'applicazione server.|  
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento statico dagli Appunti.|  
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento statico da un oggetto dati.|  
|[COleClientItem::Deactivate](#deactivate)|Disattiva l'elemento.|  
|[COleClientItem::DeactivateUI](#deactivateui)|Ripristina lo stato originale dell'interfaccia utente dell'applicazione contenitore.|  
|[COleClientItem::Delete](#delete)|Elimina o si chiude l'elemento OLE se si trattasse di un elemento collegato.|  
|[COleClientItem::DoDragDrop](#dodragdrop)|Esegue un'operazione di trascinamento e rilascio.|  
|[COleClientItem::DoVerb](#doverb)|Esegue il verbo specificato.|  
|[COleClientItem::Draw](#draw)|Disegna l'elemento OLE.|  
|[COleClientItem::GetActiveView](#getactiveview)|Ottiene la vista in cui l'elemento viene attivato sul posto.|  
|[COleClientItem::GetCachedExtent](#getcachedextent)|Restituisce i limiti del rettangolo di un elemento OLE.|  
|[COleClientItem::GetClassID](#getclassid)|Ottiene l'ID di classe. dell'elemento presente|  
|[COleClientItem::GetClipboardData](#getclipboarddata)|Ottiene i dati che sarebbero stati posizionati negli Appunti chiamando il `CopyToClipboard` funzione membro.|  
|[COleClientItem::GetDocument](#getdocument)|Restituisce il `COleDocument` oggetto che contiene l'elemento presenta.|  
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Ottiene la visualizzazione corrente dell'elemento per il rendering.|  
|[COleClientItem::GetExtent](#getextent)|Restituisce i limiti del rettangolo di un elemento OLE.|  
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Consente di recuperare un handle per un'icona associata con il server di un CLSID particolare.|  
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Ottiene il metafile utilizzato per disegnare l'icona dell'elemento.|  
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Restituisce un puntatore alla finestra di modifica sul posto dell'elemento.|  
|[COleClientItem::GetItemState](#getitemstate)|Ottiene lo stato dell'elemento corrente.|  
|[COleClientItem::GetLastStatus](#getlaststatus)|Restituisce lo stato dell'ultima operazione OLE.|  
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Restituisce la modalità di aggiornamento per un elemento collegato (funzionalità avanzata).|  
|[COleClientItem::GetType](#gettype)|Restituisce il tipo dell'elemento OLE (incorporato, collegato o statico).|  
|[COleClientItem::GetUserType](#getusertype)|Ottiene una stringa che descrive il tipo dell'elemento.|  
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Restituisce `TRUE` se l'elemento è attivo sul posto.|  
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Restituisce **TRUE** se un elemento collegato viene aggiornato con il documento di origine.|  
|[COleClientItem::IsModified](#ismodified)|Restituisce `TRUE` se l'elemento è stato modificato dopo l'ultimo salvataggio.|  
|[COleClientItem::IsOpen](#isopen)|Restituisce `TRUE` se l'elemento è attualmente aperto nell'applicazione server.|  
|[COleClientItem::IsRunning](#isrunning)|Restituisce `TRUE` se è in esecuzione dell'applicazione server dell'elemento.|  
|[COleClientItem::OnActivate](#onactivate)|Chiamato dal framework per notificare l'elemento che è attivato.|  
|[COleClientItem::OnActivateUI](#onactivateui)|Chiamato dal framework per notificare l'elemento che viene attivata e dovrebbe visualizzare la relativa interfaccia utente.|  
|[COleClientItem:: OnChange](#onchange)|Chiamato quando il server viene modificato l'elemento OLE. Implementazione necessaria.|  
|[COleClientItem::OnDeactivate](#ondeactivate)|Chiamato dal framework quando un elemento viene disattivato.|  
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Chiamato dal framework quando il server ha rimosso la relativa interfaccia utente sul posto.|  
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Chiamato dal framework per ottenere i dati da copiare negli Appunti.|  
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Chiamata eseguita dal framework per creare un menu composto.|  
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Chiamata eseguita dal framework per rimuovere i menu del contenitore da un menu composto.|  
|[COleClientItem::OnSetMenu](#onsetmenu)|Chiamato dal framework per installare e rimuovere un menu composto.|  
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Chiamato dal framework per mostrare e nascondere le barre di controllo.|  
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Chiamato dal framework per aggiornare barra del titolo della finestra cornice.|  
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Riattiva l'elemento e Annulla l'ultima operazione di modifica sul posto.|  
|[COleClientItem::Release](#release)|Rilascia la connessione a un OLE elemento collegato e lo chiuda se era aperta. Non elimina definitivamente l'elemento client.|  
|[COleClientItem::Reload](#reload)|Ricarica l'elemento dopo una chiamata a `ActivateAs`.|  
|[COleClientItem::Run](#run)|Esegue l'applicazione associato all'elemento.|  
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Imposta visualizzazione corrente dell'elemento per il rendering.|  
|[COleClientItem::SetExtent](#setextent)|Imposta il rettangolo di delimitazione dell'elemento OLE.|  
|[COleClientItem::SetHostNames](#sethostnames)|Imposta i nomi visualizzati dal server quando si modifica l'elemento OLE.|  
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.|  
|[COleClientItem::SetItemRects](#setitemrects)|Imposta rettangolo di delimitazione dell'elemento.|  
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Imposta la modalità di aggiornamento per un elemento collegato (funzionalità avanzata).|  
|[COleClientItem::SetPrintDevice](#setprintdevice)|Imposta il dispositivo di destinazione di stampa per questo elemento di client.|  
|[COleClientItem::UpdateLink](#updatelink)|Aggiorna la cache di presentazione di un elemento.|  
  
### <a name="protected-methods"></a>Metodi protetti  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[COleClientItem:: CanActivate](#canactivate)|Chiamato dal framework per determinare se è consentita l'attivazione sul posto.|  
|[COleClientItem:: OnChangeItemPosition](#onchangeitemposition)|Chiamato dal framework quando viene modificata la posizione dell'elemento.|  
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Chiamato dal framework per annullare dopo l'attivazione.|  
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Chiamato dal framework per rimuovere le informazioni sullo stato di annullamento dell'elemento.|  
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Chiamato dal framework per ottenere coordinate del rettangolo di ridimensionamento dell'elemento.|  
|[OnGetItemPosition](#ongetitemposition)|Chiamato dal framework per ottenere la posizione dell'elemento rispetto alla vista.|  
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Chiamato dal framework quando un elemento viene attivato sul posto.|  
|[COleClientItem::OnScrollBy](#onscrollby)|Chiamato dal framework per scorrere l'elemento nella visualizzazione.|  
|[COleClientItem::OnShowItem](#onshowitem)|Chiamata eseguita dal framework per visualizzare l'elemento OLE.|  
  
## <a name="remarks"></a>Note  
 Un elemento OLE rappresenta i dati, creati e gestiti con un'applicazione server, che può essere incorporata "perfettamente" in un documento in modo che venga visualizzato per l'utente sia un singolo documento. Il risultato è un "documento composito" costituito da un documento che lo contiene e l'elemento OLE.  
  
 Un elemento OLE può essere incorporato o collegato. Se è incorporato, i relativi dati vengono archiviati come parte del documento composito. Se è stata collegata, relativi dati vengono archiviati come parte di un file separato creato dall'applicazione server e solo un collegamento a tale file viene archiviato nel documento composito. Tutti gli elementi OLE contengono informazioni che specificano l'applicazione server che deve essere chiamato per modificarli.  
  
 `COleClientItem` definisce diverse funzioni sottoponibili a override che vengono chiamate in risposta alle richieste dall'applicazione server. Questi sottoponibili a override è generalmente fungono da notifiche. In questo modo l'applicazione server per informare il contenitore delle modifiche apportate dall'utente quando si modifica l'elemento OLE o per recuperare le informazioni necessarie durante la modifica.  
  
 `COleClientItem` può essere utilizzato con il [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) classe. Per utilizzare `COleClientItem`, derivare una classe e implementare il [OnChange](#onchange) funzione membro, che definisce una modalità di risposta alle modifiche apportate all'elemento contenitore. Per supportare l'attivazione sul posto, eseguire l'override di [Container_item_class5D;::OnGetItemPosition](#ongetitemposition) funzione membro. Questa funzione fornisce informazioni sulla posizione dell'elemento OLE visualizzata.  
  
 Per ulteriori informazioni sull'utilizzo l'interfaccia del contenitore, vedere gli articoli [contenitori: implementazione di un contenitore](../../mfc/containers-implementing-a-container.md) e [attivazione](../../mfc/activation-cpp.md).  
  
> [!NOTE]
>  Windows SDK fa riferimento agli elementi incorporati e collegati come "oggetti" e fa riferimento ai tipi di elementi come "classi". Questo riferimento viene utilizzato il termine "item" per distinguere l'entità OLE da oggetto C++ corrispondente e il termine "type" per distinguere la categoria OLE dalla classe C++.  
  
## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà  
 [CObject](../../mfc/reference/cobject-class.md)  
  
 [CCmdTarget](../../mfc/reference/ccmdtarget-class.md)  
  
 [CDocItem](../../mfc/reference/cdocitem-class.md)  
  
 `COleClientItem`  
  
## <a name="requirements"></a>Requisiti  
 **Intestazione:** AFXOLE. h  
  
##  <a name="activate"></a>  COleClientItem::Activate  
 Chiamare questa funzione per eseguire il verbo specificato anziché [DoVerb](#doverb) in modo che è possibile eseguire la propria elaborazione quando viene generata un'eccezione.  
  
```  
void Activate(
    LONG nVerb,  
    CView* pView,  
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *nVerb*  
 Specifica il verbo da eseguire. Può essere uno dei valori seguenti:  
  
|Valore|Significato|Simbolo|  
|-----------|-------------|------------|  
|- 0|verbo primario|`OLEIVERB_PRIMARY`|  
|- 1|Verbo secondario|(Nessuno)|  
|- 1|Elemento visualizzato per la modifica|`OLEIVERB_SHOW`|  
|- 2|Modificare l'elemento in una finestra separata|`OLEIVERB_OPEN`|  
|- 3|Nascondere elementi|`OLEIVERB_HIDE`|  
  
 Il valore-1 è in genere un alias per un altro verbo. Se non è supportata la modifica aperta, -2 ha lo stesso effetto di -1. Per i valori aggiuntivi, vedere [IOleObject:: DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) in Windows SDK.  
  
 *pView*  
 Puntatore alla finestra di visualizzazione contenitore che contiene l'elemento OLE; viene utilizzato dall'applicazione server per l'attivazione sul posto. Questo parametro deve essere **NULL** se il contenitore non supporta l'attivazione sul posto.  
  
 *lpMsg*  
 Puntatore al messaggio che ha causato l'elemento da attivare.  
  
### <a name="remarks"></a>Note  
 Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione provoca il [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) funzione membro del corrispondente `COleServerItem` oggetto da eseguire.  
  
 Se il verbo primario è modifica e viene specificato zero nel *nVerb* parametro, l'applicazione server viene avviato per consentire l'elemento OLE da modificare. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo Open), il server viene avviato in una finestra separata e la modifica può essere eseguita non esiste. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore per il verbo primario nel *nVerb* parametro determina l'azione può richiedere all'utente. Tuttavia, se il server supporta solo un'azione, impiegati tale azione, indipendentemente dal quale viene specificato nella *nVerb* parametro.  
  
 Per altre informazioni, vedere [IOleObject:: DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) in Windows SDK.  
  
##  <a name="activateas"></a>  COleClientItem::ActivateAs  
 Usa le funzionalità di conversione di oggetti OLE per attivare l'elemento come se fosse un elemento del tipo specificato da *clsidNew*.  
  
```  
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,  
    REFCLSID clsidOld,  
    REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Parametri  
 *lpszUserType*  
 Puntatore a una stringa che rappresenta il tipo di utente di destinazione, ad esempio "Documento di Word".  
  
 *clsidOld*  
 ID di un riferimento alla classe dell'elemento. L'ID di classe deve rappresentare il tipo dell'oggetto attuale, così come viene archiviato, a meno che non si tratta di un collegamento. In tal caso, deve essere il CLSID dell'elemento a cui fa riferimento il collegamento. Il [classe COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fornisce automaticamente l'ID di classe corretto per l'elemento.  
  
 *clsidNew*  
 Un riferimento per l'ID di classe di destinazione.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Ciò viene chiamato automaticamente da [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Non viene in genere chiamato direttamente.  
  
##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject  
 Chiamare questa funzione per inizializzare un [COleDataObject](../../mfc/reference/coledataobject-class.md) per l'accesso ai dati dell'elemento OLE.  
  
```  
void AttachDataObject(COleDataObject& rDataObject) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *rDataObject*  
 Riferimento a un `COleDataObject` oggetto che verrà inizializzata per consentire l'accesso ai dati dell'elemento OLE.  
  
##  <a name="canactivate"></a>  COleClientItem:: CanActivate  
 Chiamato dal framework quando l'utente richiede l'attivazione sul posto dell'elemento OLE; valore restituito della funzione determina se è consentita l'attivazione sul posto.  
  
```  
virtual BOOL CanActivate();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se è consentita l'attivazione sul posto; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita consente l'attivazione sul posto se il contenitore dispone di una finestra valida. Eseguire l'override di questa funzione per implementare una logica speciale per accettare o rifiutare la richiesta di attivazione. Ad esempio, una richiesta di attivazione può essere rifiutata se l'elemento OLE è troppo piccolo o non è attualmente visibile.  
  
 Per altre informazioni, vedere [IOleInPlaceSite::CanInPlaceActivate](http://msdn.microsoft.com/library/windows/desktop/ms691236) in Windows SDK.  
  
##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData  
 Controlla se un'applicazione contenitore può creare un oggetto incorporato il determinato `COleDataObject` oggetto.  
  
```  
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataObject*  
 Puntatore ai [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui deve essere creato l'elemento OLE.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il contenitore può creare un oggetto incorporato di `COleDataObject` oggetto; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero in diversi formati dagli Appunti, mediante il trascinamento della selezione o da un elemento OLE incorporato.  
  
 I contenitori possono utilizzare questa funzione per decidere di abilitare o disabilitare i comandi di modifica Incolla e modificare Incolla speciale.  
  
 Per altre informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData  
 Controlla se un'applicazione contenitore può creare un oggetto collegato il determinato `COleDataObject` oggetto.  
  
```  
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataObject*  
 Puntatore ai [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui deve essere creato l'elemento OLE.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il contenitore può creare un oggetto collegato il `COleDataObject` oggetto.  
  
### <a name="remarks"></a>Note  
 Il `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero in diversi formati dagli Appunti, mediante il trascinamento della selezione o da un elemento OLE incorporato.  
  
 I contenitori possono utilizzare questa funzione per decidere di abilitare o disabilitare i comandi di modifica Incolla speciale e modificare Incolla collegamento.  
  
 Per altre informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).  
  
##  <a name="canpaste"></a>  COleClientItem::CanPaste  
 Chiamare questa funzione per vedere se un elemento OLE incorporato può essere incollato dagli Appunti.  
  
```  
static BOOL PASCAL CanPaste();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se un elemento OLE incorporato può essere incollato dagli Appunti; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Per altre informazioni, vedere [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) e [OleQueryCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms683739) in Windows SDK.  
  
##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink  
 Chiamare questa funzione per vedere se un elemento OLE collegato può essere incollato dagli Appunti.  
  
```  
static BOOL PASCAL CanPasteLink();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se un elemento OLE collegato può essere incollato dagli Appunti. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Per altre informazioni, vedere [OleGetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms692778) e [OleQueryLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms690244) in Windows SDK.  
  
##  <a name="close"></a>  COleClientItem::Close  
 Chiamare questa funzione per modificare lo stato di un elemento OLE dallo stato di esecuzione allo stato di caricamento, vale a dire, caricato con il relativo gestore in memoria, ma con il server non è in esecuzione.  
  
```  
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```  
  
### <a name="parameters"></a>Parametri  
 *dwCloseOption*  
 Flag che specifica le condizioni dell'elemento OLE viene salvato quando torna allo stato caricato. Può avere uno dei valori seguenti:  
  
- `OLECLOSE_SAVEIFDIRTY` Salvare l'elemento OLE.  
  
- `OLECLOSE_NOSAVE` Non salvare l'elemento OLE.  
  
- `OLECLOSE_PROMPTSAVE` Richiedere all'utente se salvare l'elemento OLE.  
  
### <a name="remarks"></a>Note  
 Questa funzione non ha effetto quando l'elemento OLE non è in esecuzione.  
  
 Per altre informazioni, vedere [IOleObject::Close](http://msdn.microsoft.com/library/windows/desktop/ms683922) in Windows SDK.  
  
##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem  
 Costruisce un `COleClientItem` e lo aggiunge alla raccolta del documento contenitore di elementi del documento, che costruisce solo l'oggetto di C++ e non esegue le operazioni di inizializzazione OLE.  
  
```  
COleClientItem(COleDocument* pContainerDoc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *pContainerDoc*  
 Puntatore al documento contenitore che conterrà questo elemento. Può trattarsi di qualsiasi [COleDocument](../../mfc/reference/coledocument-class.md) derivato.  
  
### <a name="remarks"></a>Note  
 Se si passa un **NULL** puntatore, non viene eseguita alcuna aggiunta al documento contenitore. È necessario chiamare esplicitamente [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).  
  
 Prima di usare l'elemento OLE, è necessario chiamare una delle funzioni membro creazione seguenti:  
  
- [CreateFromClipboard](#createfromclipboard)  
  
- [CreateFromData](#createfromdata)  
  
- [CreateFromFile](#createfromfile)  
  
- [CreateStaticFromClipboard](#createstaticfromclipboard)  
  
- [CreateStaticFromData](#createstaticfromdata)  
  
- [CreateLinkFromClipboard](#createlinkfromclipboard)  
  
- [CreateLinkFromData](#createlinkfromdata)  
  
- [CreateLinkFromFile](#createlinkfromfile)  
  
- [CreateNewItem](#createnewitem)  
  
- [CreateCloneFrom](#createclonefrom)  
  
##  <a name="convertto"></a>  COleClientItem::ConvertTo  
 Chiamare questa funzione membro per convertire l'elemento nel tipo specificato da *clsidNew*.  
  
```  
virtual BOOL ConvertTo(REFCLSID clsidNew);
```  
  
### <a name="parameters"></a>Parametri  
 *clsidNew*  
 L'ID di classe del tipo di destinazione.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Ciò viene chiamato automaticamente da [classe COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Non è necessario chiamarlo direttamente.  
  
##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard  
 Chiamare questa funzione per copiare l'elemento OLE negli Appunti.  
  
```  
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```  
  
### <a name="parameters"></a>Parametri  
 *bIncludeLink*  
 **TRUE** se le informazioni di collegamento devono essere copiate negli Appunti, consentendo un elemento collegato essere incollato; in caso contrario **FALSE**.  
  
### <a name="remarks"></a>Note  
 In genere, si chiama questa funzione durante la scrittura di gestori di messaggi per i comandi di copia o Taglia del menu Modifica. Se si desidera implementare i comandi Taglia o copia, è necessario implementare la selezione di elementi nell'applicazione contenitore.  
  
 Per altre informazioni, vedere [OleSetClipboard](http://msdn.microsoft.com/library/windows/desktop/ms686623) in Windows SDK.  
  
##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom  
 Chiamare questa funzione per creare una copia dell'elemento OLE specificata.  
  
```  
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```  
  
### <a name="parameters"></a>Parametri  
 *pSrcItem*  
 Puntatore all'elemento OLE da duplicare.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 La copia è identica all'elemento di origine. È possibile utilizzare questa funzione per supportare le operazioni di annullamento.  
  
##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard  
 Chiamare questa funzione per creare un elemento incorporato dal contenuto degli Appunti.  
  
```  
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione in genere chiamato dal gestore di messaggi per il comando Incolla del menu Modifica. (Il comando Incolla è abilitato per il framework se il [CanPaste](#canpaste) funzione membro restituisce diverso da zero.)  
  
 Per altre informazioni, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createfromdata"></a>  COleClientItem::CreateFromData  
 Chiamare questa funzione per creare un elemento incorporato da un `COleDataObject` oggetto.  
  
```  
BOOL CreateFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataObject*  
 Puntatore ai [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui deve essere creato l'elemento OLE.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Operazioni di trasferimento dei dati, ad esempio un'operazione Incolla dagli Appunti o le operazioni di trascinamento e rilascio, forniscono `COleDataObject` gli oggetti che contiene le informazioni offerti da un'applicazione server. In genere viene utilizzato nell'override della [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).  
  
 Per altre informazioni, vedere [OleCreateFromData](http://msdn.microsoft.com/library/windows/desktop/ms691211), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createfromfile"></a>  CreateFromFile  
 Chiamare questa funzione per creare un elemento OLE incorporato da un file.  
  
```  
BOOL CreateFromFile(
    LPCTSTR lpszFileName,  
    REFCLSID clsid = CLSID_NULL,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *lpszFileName*  
 Puntatore al nome del file da cui si desidera creare l'elemento OLE.  
  
 *clsid*  
 Riservato per utilizzi futuri.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questa funzione dalla [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando è selezionata la creazione dal pulsante di File.  
  
 Per altre informazioni, vedere [OleCreateFromFile](http://msdn.microsoft.com/library/windows/desktop/ms690116), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard  
 Chiamare questa funzione per creare un elemento collegato dal contenuto degli Appunti.  
  
```  
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione in genere chiamato dal gestore di messaggi per il comando Incolla collegamento dal menu Modifica. (Il comando Incolla collegamento è abilitato nell'implementazione predefinita di [COleDocument](../../mfc/reference/coledocument-class.md) se gli Appunti contengono un elemento OLE che può essere collegato a.)  
  
 Per altre informazioni, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData  
 Chiamare questa funzione per creare un elemento collegato da un `COleDataObject` oggetto.  
  
```  
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataObject*  
 Puntatore ai [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui deve essere creato l'elemento OLE.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Chiamare questo metodo durante un'operazione di rilascio quando l'utente indicato che deve essere creato un collegamento. E può essere utilizzato anche per gestire il comando Modifica Incolla. Viene chiamato dal framework nella `COleClientItem::CreateLinkFromClipboard` e nel [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando è stata selezionata l'opzione di collegamento.  
  
 Per altre informazioni, vedere [OleCreateLinkFromData](http://msdn.microsoft.com/library/windows/desktop/ms680731), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile  
 Chiamare questa funzione per creare un elemento OLE collegato da un file.  
  
```  
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *lpszFileName*  
 Puntatore al nome del file da cui si desidera creare l'elemento OLE.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando è selezionato Create dal pulsante di File e la casella di controllo di collegamento è selezionata, il framework chiama questa funzione. Viene chiamato dal [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).  
  
 Per altre informazioni, vedere [OleCreateLinkToFile](http://msdn.microsoft.com/library/windows/desktop/ms678434), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem  
 Chiamare questa funzione per creare un elemento incorporato; Questa funzione consente di avviare l'applicazione server che consente all'utente creare l'elemento OLE.  
  
```  
BOOL CreateNewItem(
    REFCLSID clsid,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *clsid*  
 ID che identifica in modo univoco il tipo di elemento OLE da creare.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questa funzione se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il pulsante Crea nuovo.  
  
 Per altre informazioni, vedere [OleCreate](http://msdn.microsoft.com/library/windows/desktop/ms678409), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard  
 Chiamare questa funzione per creare un elemento statico dal contenuto degli Appunti.  
  
```  
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Un elemento statico contiene i dati della presentazione ma non i dati nativi. di conseguenza non è possibile modificarla. Chiamare questa funzione in genere se il [CreateFromClipboard](#createfromclipboard) membro funzione ha esito negativo.  
  
 Per altre informazioni, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData  
 Chiamare questa funzione per creare un elemento statico da un `COleDataObject` oggetto.  
  
```  
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,  
    OLERENDER render = OLERENDER_DRAW,  
    CLIPFORMAT cfFormat = 0,  
    LPFORMATETC lpFormatEtc = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataObject*  
 Puntatore ai [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui deve essere creato l'elemento OLE.  
  
 *Eseguire il rendering*  
 Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507) in Windows SDK.  
  
 *cfFormat*  
 Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.  
  
 *lpFormatEtc*  
 Puntatore a un [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) struttura usata se *eseguire il rendering* è **OLERENDER_FORMAT** oppure **OLERENDER_DRAW**. Specificare un valore per questo parametro solo se si desidera specificare ulteriori informazioni sul formato oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono utilizzati valori predefiniti per gli altri campi di **FORMATETC** struttura.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Un elemento statico contiene i dati della presentazione ma non i dati nativi. di conseguenza, non è possibile modificarla. Si tratta essenzialmente identico [CreateStaticFromClipboard](#createstaticfromclipboard) ad eccezione del fatto che un elemento statico può essere creato da un oggetto arbitrario `COleDataObject`, non solo dagli Appunti.  
  
 Utilizzato [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando è selezionata statico.  
  
 Per altre informazioni, vedere [OleCreateStaticFromData](http://msdn.microsoft.com/library/windows/desktop/ms687290), [OLERENDER](http://msdn.microsoft.com/library/windows/desktop/ms691507), e [FORMATETC](http://msdn.microsoft.com/library/windows/desktop/ms682177) in Windows SDK.  
  
##  <a name="deactivate"></a>  COleClientItem::Deactivate  
 Chiamare questa funzione per disattivare l'elemento OLE e liberare le risorse associate.  
  
```  
void Deactivate();
```  
  
### <a name="remarks"></a>Note  
 È in genere possibile disattivare un elemento OLE sul posto attivo quando l'utente fa clic del mouse sull'area client all'esterno dei limiti dell'elemento. Si noti che la disattivazione dell'elemento OLE eliminerà lo stato di annullamento, rendendo impossibile chiamare il [ReactivateAndUndo](#reactivateandundo) funzione membro.  
  
 Se l'applicazione supporta l'annullamento, non chiamare `Deactivate`; in alternativa, chiamare [DeactivateUI](#deactivateui).  
  
 Per altre informazioni, vedere [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) in Windows SDK.  
  
##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI  
 Chiamare questa funzione quando l'utente disattiva un elemento che è stato attivato sul posto.  
  
```  
void DeactivateUI();
```  
  
### <a name="remarks"></a>Note  
 Interfaccia utente dell'applicazione contenitore ripristinato lo stato originale, nascondere tutti i menu e altri controlli che sono stati creati per l'attivazione sul posto di questa funzione.  
  
 Questa funzione non consente di scaricare le informazioni sullo stato di annullamento per l'elemento. Che le informazioni vengono conservate in modo che [ReactivateAndUndo](#reactivateandundo) in un secondo momento può essere utilizzato per eseguire un comando di annullamento nell'applicazione server, nel caso in cui il comando di annullamento del contenitore viene scelto immediatamente dopo aver disattivato l'elemento.  
  
 Per altre informazioni, vedere [IOleInPlaceObject::InPlaceDeactivate](http://msdn.microsoft.com/library/windows/desktop/ms679700) in Windows SDK.  
  
##  <a name="delete"></a>  COleClientItem::Delete  
 Chiamare questa funzione per eliminare l'elemento OLE dal documento contenitore.  
  
```  
void Delete(BOOL bAutoDelete = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 *bAutoDelete*  
 Specifica se l'elemento deve essere rimosso dal documento.  
  
### <a name="remarks"></a>Note  
 Questa funzione chiama la [versione](#release) funzione membro, che a sua volta Elimina l'oggetto di C++ per l'elemento, in modo permanente la rimozione dell'elemento OLE dal documento. Se l'elemento OLE è incorporato, i dati nativi per l'elemento viene eliminati. Chiude sempre un server in esecuzione. Pertanto, se l'elemento è un collegamento di aprire, questa funzione lo chiuderà.  
  
##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop  
 Chiamare il `DoDragDrop` funzione membro per eseguire un'operazione di trascinamento e rilascio.  
  
```  
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,  
    CPoint ptOffset,  
    BOOL bIncludeLink = FALSE,  
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,  
    LPCRECT lpRectStartDrag = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *lpItemRect*  
 Rettangolo dell'elemento sullo schermo in coordinate del client (pixel).  
  
 *ptOffset*  
 L'offset dal *lpItemRect* in cui la posizione del mouse è al momento dell'operazione di trascinamento.  
  
 *bIncludeLink*  
 Impostare questa proprietà su **TRUE** se i dati di collegamento devono essere copiati negli Appunti. Impostarla su **FALSE** se l'applicazione server non supporta i collegamenti.  
  
 *dwEffects*  
 Determina gli effetti che consentirà all'origine del trascinamento nell'operazione di trascinamento.  
  
 *lpRectStartDrag*  
 Puntatore al rettangolo che definisce dove viene avviato effettivamente l'operazione di trascinamento. Per ulteriori informazioni, vedere la sezione Osservazioni successiva.  
  
### <a name="return-value"></a>Valore restituito  
 Valore `DROPEFFECT`. Se è `DROPEFFECT_MOVE`, i dati originali devono essere rimossi.  
  
### <a name="remarks"></a>Note  
 L'operazione di trascinamento e rilascio non viene avviato immediatamente. Attende che il cursore del mouse viene spostato il rettangolo specificato da *lpRectStartDrag* o fino a quando un numero specificato di millisecondi trascorsi. Se *lpRectStartDrag* viene **NULL**, le dimensioni del rettangolo sono 1 pixel.  
  
 Il tempo di ritardo viene specificato dall'impostazione della chiave del Registro di sistema. È possibile modificare il tempo di ritardo chiamando [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) oppure [CWinApp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint). Se non si specifica l'intervallo di tempo, viene utilizzato un valore predefinito pari a 200 millisecondi. Trascinare Ritarda ora verrà archiviato come segue:  
  
-   Ritarda ora di Windows NT trascinamento viene archiviato in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.  
  
-   Ritarda ora di Windows 3.x trascinamento viene archiviato nel file WIN. File INI, la sezione [Windows}.  
  
-   Ritarda ora di Windows 95/98 trascinamento viene archiviato in una versione memorizzata nella cache di WIN. INI.  
  
 Per altre informazioni su come trascinare ritardo informazioni vengono archiviate nel Registro di sistema o di. File. INI, vedere [WriteProfileString](http://msdn.microsoft.com/library/windows/desktop/ms725504) in Windows SDK.  
  
##  <a name="doverb"></a>  COleClientItem::DoVerb  
 Chiamare `DoVerb` per eseguire il verbo specificato.  
  
```  
virtual BOOL DoVerb(
    LONG nVerb,  
    CView* pView,
    LPMSG lpMsg = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *nVerb*  
 Specifica il verbo da eseguire. Può includere uno dei valori seguenti:  
  
|Valore|Significato|Simbolo|  
|-----------|-------------|------------|  
|- 0|verbo primario|`OLEIVERB_PRIMARY`|  
|- 1|Verbo secondario|(Nessuno)|  
|- 1|Elemento visualizzato per la modifica|`OLEIVERB_SHOW`|  
|- 2|Modificare l'elemento in una finestra separata|`OLEIVERB_OPEN`|  
|- 3|Nascondere elementi|`OLEIVERB_HIDE`|  
  
 Il valore-1 è in genere un alias per un altro verbo. Se non è supportata la modifica aperta, -2 ha lo stesso effetto di -1. Per i valori aggiuntivi, vedere [IOleObject:: DoVerb](http://msdn.microsoft.com/library/windows/desktop/ms694508) in Windows SDK.  
  
 *pView*  
 Puntatore alla finestra di visualizzazione; viene utilizzato dal server per l'attivazione sul posto. Questo parametro deve essere **NULL** se l'applicazione contenitore non consente l'attivazione sul posto.  
  
 *lpMsg*  
 Puntatore al messaggio che ha causato l'elemento da attivare.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se il verbo è stato eseguito correttamente; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione chiama la [Activate](#activate) funzione membro per eseguire il verbo. Inoltre, intercetta le eccezioni e visualizza una finestra di messaggio all'utente se genera un'eccezione.  
  
 Se il verbo primario è modifica e viene specificato zero nel *nVerb* parametro, l'applicazione server viene avviato per consentire l'elemento OLE da modificare. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo Open), il server viene avviato in una finestra separata e la modifica può essere eseguita non esiste. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore per il verbo primario nel *nVerb* parametro determina l'azione può richiedere all'utente. Tuttavia, se il server supporta solo un'azione, impiegati tale azione, indipendentemente dal quale viene specificato nella *nVerb* parametro.  
  
##  <a name="draw"></a>  COleClientItem::Draw  
 Chiamare questa funzione per disegnare l'elemento OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.  
  
```  
BOOL Draw(
    CDC* pDC,  
    LPCRECT lpBounds,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Parametri  
 *pDC*  
 Puntatore a un [CDC](../../mfc/reference/cdc-class.md) oggetto utilizzato per il disegno dell'elemento OLE.  
  
 *lpBounds*  
 Puntatore a un [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o `RECT` struttura che definisce il rettangolo di delimitazione in cui disegnare l'elemento OLE (in unità logiche determinata dal contesto di dispositivo).  
  
 *nDrawAspect*  
 Specifica l'aspetto di OLE di elemento, vale a dire, la modalità di visualizzazione. Se *nDrawAspect* è -1, l'aspetto ultimo impostata tramite [SetDrawAspect](#setdrawaspect) viene utilizzato. Per ulteriori informazioni sui possibili valori per questo flag, vedere [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 La funzione può utilizzare la rappresentazione del metafile dell'elemento OLE creata mediante il [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) funzione membro di `COleServerItem`.  
  
 In genere si usa **disegnare** per la visualizzazione su schermo, passando il contesto di dispositivo dello schermo come *pDC*. In questo caso, è necessario specificare solo i primi due parametri.  
  
 Il *lpBounds* parametro identifica il rettangolo nel contesto di dispositivo di destinazione (rispetto alla relativa modalità di mapping corrente). Per il rendering può comportare il ridimensionamento dell'immagine e può essere utilizzato dalle applicazioni contenitore per imporre una vista che consente una scalabilità tra la visualizzazione e l'immagine stampata finale.  
  
 Per altre informazioni, vedere [IViewObject](http://msdn.microsoft.com/library/windows/desktop/ms688655) in Windows SDK.  
  
##  <a name="getactiveview"></a>  COleClientItem::GetActiveView  
 Restituisce la vista in cui l'elemento è attivato sul posto.  
  
```  
CView* GetActiveView() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore a della visualizzazione. in caso contrario **NULL** se l'elemento non è attivato sul posto.  
  
##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent  
 Chiamare questa funzione per recuperare la dimensione dell'elemento OLE.  
  
```  
BOOL GetCachedExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)-1);
```  
  
### <a name="parameters"></a>Parametri  
 *lpSize*  
 Puntatore a un **dimensioni** struttura o una [CSize](../../atl-mfc-shared/reference/csize-class.md) oggetto che riceverà le informazioni sulle dimensioni.  
  
 *nDrawAspect*  
 Specifica l'aspetto dell'elemento OLE cui limiti devono essere recuperate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo. 0 se l'elemento OLE è vuoto.  
  
### <a name="remarks"></a>Note  
 Questa funzione fornisce le stesse informazioni [GetExtent](#getextent). Tuttavia, è possibile chiamare `GetCachedExtent` per ottenere informazioni di extent durante l'elaborazione di altri gestori OLE, ad esempio [OnChange](#onchange). Le dimensioni non sono `MM_HIMETRIC` unità.  
  
 Ciò è possibile perché `GetCachedExtent` Usa la [IViewObject2](http://msdn.microsoft.com/library/windows/desktop/ms691318) interfaccia piuttosto che utilizzare il [IOleObject](http://msdn.microsoft.com/library/windows/desktop/dd542709) interfaccia per ottenere l'ambito di questo elemento. Il **IViewObject2** oggetto COM memorizza nella cache le informazioni di extent utilizzate nella chiamata precedente a [IViewObject](http://msdn.microsoft.com/library/windows/desktop/ms688655).  
  
 Per altre informazioni, vedere [IViewObject2::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms684032) in Windows SDK.  
  
##  <a name="getclassid"></a>  COleClientItem::GetClassID  
 Restituisce l'ID di classe dell'elemento nella memoria a cui puntata *pClassID*.  
  
```  
void GetClassID(CLSID* pClassID) const;  
```  
  
### <a name="parameters"></a>Parametri  
 *pClassID*  
 Puntatore a un identificatore di tipo [CLSID](http://msdn.microsoft.com/library/windows/desktop/ms691424) per recuperare l'ID di classe. Per informazioni sul **CLSID**, vedi il Windows SDK.  
  
### <a name="remarks"></a>Note  
 L'ID di classe è un numero a 128 bit che identifica in modo univoco l'applicazione che modifica l'elemento.  
  
 Per altre informazioni, vedere [IPersist:: GetClassID](http://msdn.microsoft.com/library/windows/desktop/ms688664) in Windows SDK.  
  
##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData  
 Chiamare questa funzione per ottenere un `COleDataSource` oggetto che contiene tutti i dati che sarebbero stati posizionati negli Appunti da una chiamata per il [CopyToClipboard](#copytoclipboard) funzione membro.  
  
```  
void GetClipboardData(
    COleDataSource* pDataSource,  
    BOOL bIncludeLink = FALSE,  
    LPPOINT lpOffset = NULL,  
    LPSIZE lpSize = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *pDataSource*  
 Puntatore a un [COleDataSource](../../mfc/reference/coledatasource-class.md) oggetto che riceverà i dati contenuti nell'elemento OLE.  
  
 *bIncludeLink*  
 **TRUE** se i dati di collegamento devono essere incluse; in caso contrario **FALSE**.  
  
 *lpOffset*  
 L'offset del cursore del mouse dall'origine dell'oggetto in pixel.  
  
 *lpSize*  
 Le dimensioni dell'oggetto in pixel.  
  
### <a name="remarks"></a>Note  
 `GetClipboardData` viene chiamata come l'implementazione predefinita di [OnGetClipboardData](#ongetclipboarddata). Eseguire l'override `OnGetClipboardData` solo se si desidera offrire i formati di dati oltre a quelli offerti da `CopyToClipboard`. Inserire tali formati nel `COleDataSource` oggetto prima o dopo la chiamata `CopyToClipboard`, quindi passare il `COleDataSource` dell'oggetto per il [SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) (funzione). Ad esempio, se si desidera che la posizione dell'elemento OLE nel documento dei contenitori di accompagnamento negli Appunti per, si sarebbe definire un formato personalizzato per passare tali informazioni e posizionarlo nel `COleDataSource` prima di chiamare `CopyToClipboard`.  
  
##  <a name="getdocument"></a>  COleClientItem::GetDocument  
 Chiamare questa funzione per ottenere un puntatore al documento che contiene l'elemento OLE.  
  
```  
COleDocument* GetDocument() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore al documento che contiene l'elemento OLE. **NULL** se l'elemento non fa parte di un documento.  
  
### <a name="remarks"></a>Note  
 L'indicatore di misura consente di accedere ai `COleDocument` oggetto che è stato passato come argomento per il `COleClientItem` costruttore.  
  
##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect  
 Chiamare il `GetDrawAspect` funzione membro per determinare la corrente "aspetto", o la vista dell'elemento.  
  
```  
DVASPECT GetDrawAspect() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un valore di `DVASPECT` enumerazione, i cui valori sono elencati nella Guida di riferimento per [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Note  
 L'aspetto specifica come l'elemento è da sottoporre a rendering.  
  
##  <a name="getextent"></a>  COleClientItem::GetExtent  
 Chiamare questa funzione per recuperare la dimensione dell'elemento OLE.  
  
```  
BOOL GetExtent(
    LPSIZE lpSize,  
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```  
  
### <a name="parameters"></a>Parametri  
 *lpSize*  
 Puntatore a un **dimensioni** struttura o un `CSize` oggetto che riceverà le informazioni sulle dimensioni.  
  
 *nDrawAspect*  
 Specifica l'aspetto dell'elemento OLE cui limiti devono essere recuperate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo. 0 se l'elemento OLE è vuoto.  
  
### <a name="remarks"></a>Note  
 Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione provoca il [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) funzione membro del corrispondente `COleServerItem` oggetto da chiamare. Si noti che le dimensioni recuperata differiscano dalle dimensioni ultima impostazione il [SetExtent](#setextent) funzione membro; le dimensioni specificate dal `SetExtent` viene considerato come un suggerimento. Le dimensioni non sono `MM_HIMETRIC` unità.  
  
> [!NOTE]
>  Non chiamare `GetExtent` durante l'elaborazione di un gestore OLE, ad esempio [OnChange](#onchange). Chiamare [GetCachedExtent](#getcachedextent) invece.  
  
 Per altre informazioni, vedere [IOleObject::GetExtent](http://msdn.microsoft.com/library/windows/desktop/ms692325) in Windows SDK.  
  
##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry  
 Chiamare questa funzione membro per recuperare un handle a una risorsa dell'icona associata con il server di un CLSID particolare.  
  
```  
HICON GetIconFromRegistry() const;  
  
static HICON GetIconFromRegistry(CLSID& clsid);
```  
  
### <a name="parameters"></a>Parametri  
 *clsid*  
 Riferimento per il CLSID per il server associato all'icona.  
  
### <a name="return-value"></a>Valore restituito  
 Un handle valido per la risorsa dell'icona, o **NULL** se sull'icona del server o un'icona predefinita, non viene trovata.  
  
### <a name="remarks"></a>Note  
 Questa funzione membro non verrà avviato il server né ottenere un'icona in modo dinamico, anche se il server è già in esecuzione. Al contrario, questa funzione membro apre immagine eseguibile del server e recupera l'icona statico associato al server come è stata registrata.  
  
##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile  
 Recupera il metafile utilizzato per disegnare l'icona dell'elemento.  
  
```  
HGLOBAL GetIconicMetafile();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un handle per il metafile se ha esito positivo. in caso contrario **NULL**.  
  
### <a name="remarks"></a>Note  
 Se è presente alcuna icona corrente, viene restituita un'icona predefinita. Questo viene chiamato automaticamente dalle finestre di dialogo MFC/OLE e in genere non viene chiamato direttamente.  
  
 Questa funzione chiama anche [SetIconicMetafile](#seticonicmetafile) per memorizzare nella cache il metafile per un uso successivo.  
  
##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow  
 Chiamare il `GetInPlaceWindow` funzione membro per ottenere un puntatore alla finestra in cui l'elemento è stato aperto per la modifica sul posto.  
  
```  
CWnd* GetInPlaceWindow();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore alla finestra di modifica sul posto dell'elemento; **NULL** se l'elemento non è attivo o se il server è disponibile.  
  
### <a name="remarks"></a>Note  
 Questa funzione deve essere chiamata solo per gli elementi che sono attivi sul posto.  
  
##  <a name="getitemstate"></a>  COleClientItem::GetItemState  
 Chiamare questa funzione per ottenere lo stato corrente dell'elemento OLE.  
  
```  
UINT GetItemState() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un **COleClientItem:: ItemState** enumerato valore, che può essere uno dei seguenti: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Per informazioni su questi stati, vedere l'articolo [contenitori: stati Client-Item](../../mfc/containers-client-item-states.md).  
  
### <a name="remarks"></a>Note  
 Per essere notificato quando cambia lo stato dell'elemento OLE, utilizzare il [OnChange](#onchange) funzione membro.  
  
 Per altre informazioni, vedere l'articolo [contenitori: stati Client-Item](../../mfc/containers-client-item-states.md).  
  
##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus  
 Restituisce il codice di stato dell'ultima operazione OLE.  
  
```  
SCODE GetLastStatus() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Valore `SCODE`.  
  
### <a name="remarks"></a>Note  
 Per il membro funzioni che restituiscono un **BOOL** pari a **FALSE**, o altri membri funzioni che restituiscono **NULL**, `GetLastStatus` restituisce ulteriori informazioni sull'errore. Tenere presente che la maggior parte delle funzioni di membro OLE non generano eccezioni per gli errori più gravi. Le informazioni specifiche sull'interpretazione del `SCODE` varia a seconda della chiamata OLE sottostante che ultimo ha restituito un `SCODE` valore.  
  
 Per ulteriori informazioni sul `SCODE`, vedere [struttura of COM Error Codes](http://msdn.microsoft.com/library/windows/desktop/ms690088) nella documentazione di Windows SDK.  
  
##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions  
 Chiamare questa funzione per ottenere il valore corrente dell'opzione di aggiornamento di collegamento per l'elemento OLE.  
  
```  
OLEUPDATE GetLinkUpdateOptions();
```  
  
### <a name="return-value"></a>Valore restituito  
 Uno dei valori seguenti:  
  
- `OLEUPDATE_ALWAYS` Aggiornare l'elemento collegato laddove possibile. Questa opzione supporta il pulsante di opzione di aggiornamento di collegamento automatico nella finestra di dialogo collegamenti.  
  
- `OLEUPDATE_ONCALL` Aggiornare l'elemento collegato solo su richiesta da un'applicazione contenitore (quando il [UpdateLink](#updatelink) funzione membro viene chiamata). Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento manuale nella finestra di dialogo collegamenti.  
  
### <a name="remarks"></a>Note  
 Si tratta di un'operazione avanzata.  
  
 Questa funzione viene chiamata automaticamente dal [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) classe.  
  
 Per altre informazioni, vedere [IOleLink::GetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680100) in Windows SDK.  
  
##  <a name="gettype"></a>  COleClientItem::GetType  
 Chiamare questa funzione per determinare se l'elemento OLE incorporato o collegato o static.  
  
```  
OLE_OBJTYPE GetType() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Intero senza segno con uno dei valori seguenti:  
  
- `OT_LINK` L'elemento OLE è un collegamento.  
  
- `OT_EMBEDDED` L'elemento OLE incorporato.  
  
- `OT_STATIC` L'elemento OLE è statico, vale a dire, contiene solo dati di presentazione, dati non nativi e pertanto non può essere modificato.  
  
##  <a name="getusertype"></a>  COleClientItem::GetUserType  
 Chiamare questa funzione per ottenere la stringa visibile dall'utente che descrive il tipo di un elemento OLE, ad esempio "Documento di Word".  
  
```  
void GetUserType(
    USERCLASSTYPE nUserClassType,  
    CString& rString);
```  
  
### <a name="parameters"></a>Parametri  
 *nUserClassType*  
 Un valore che indica la variante desiderata della stringa che descrive il tipo dell'elemento OLE. Ciò può avere uno dei valori seguenti:  
  
- `USERCLASSTYPE_FULL` Il nome completo del tipo visualizzato all'utente.  
  
- `USERCLASSTYPE_SHORT` Un nome breve (massimo 15 caratteri) per l'utilizzo nei menu a comparsa e la finestra di dialogo Modifica collegamenti.  
  
- `USERCLASSTYPE_APPNAME` Nome dell'applicazione per la manutenzione della classe.  
  
 *rString*  
 Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) oggetto a cui è necessario restituire la stringa che descrive il tipo dell'elemento OLE.  
  
### <a name="remarks"></a>Note  
 Si tratta spesso della voce nel database di registrazione di sistema.  
  
 Se il nome completo del tipo è richiesta ma non è disponibile, viene utilizzato il nome breve. Se viene trovata alcuna voce per il tipo di elemento OLE nel database di registrazione o se non sono disponibili tipi di utente registrati per il tipo di elemento OLE, quindi il tipo di utente attualmente archiviati nel viene usato l'elemento OLE. Se il nome del tipo di utente è una stringa vuota, viene utilizzato "Oggetto sconosciuto".  
  
 Per altre informazioni, vedere [IOleObject::GetUserType](http://msdn.microsoft.com/library/windows/desktop/ms688643) in Windows SDK.  
  
##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive  
 Chiamare questa funzione per determinare se l'elemento OLE è attivo sul posto.  
  
```  
BOOL IsInPlaceActive() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento OLE è attivo sul posto; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 È comune per eseguire una logica diversa a seconda se l'elemento viene modificata sul posto. La funzione controlla se lo stato dell'elemento corrente è uguale ai `activeState` o `activeUIState`.  
  
##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate  
 Chiamare questa funzione per determinare se l'elemento OLE è aggiornato.  
  
```  
BOOL IsLinkUpToDate() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento OLE è aggiornato. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Un elemento collegato può essere aggiornato se il documento di origine è stato aggiornato. Un elemento incorporato che contiene i collegamenti all'interno di esso in modo analogo può diventare non aggiornato. La funzione esegue un controllo ricorsivo dell'elemento OLE. Si noti che determina se un elemento OLE non è aggiornato può essere più costosa di quella effettivamente eseguendo un aggiornamento.  
  
 Ciò viene chiamato automaticamente dal [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementazione.  
  
 Per altre informazioni, vedere [IOleObject::IsUpToDate](http://msdn.microsoft.com/library/windows/desktop/ms686624) in Windows SDK.  
  
##  <a name="ismodified"></a>  COleClientItem::IsModified  
 Chiamare questa funzione per determinare se l'elemento OLE è dirty (modificata dall'ultimo salvataggio).  
  
```  
BOOL IsModified() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento OLE è dirty; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Per altre informazioni, vedere [IPersistStorage::IsDirty](http://msdn.microsoft.com/library/windows/desktop/ms683910) in Windows SDK.  
  
##  <a name="isopen"></a>  COleClientItem::IsOpen  
 Chiamare questa funzione per vedere se l'elemento OLE è aperta; vale a dire, aperto in un'istanza dell'applicazione server in esecuzione in una finestra separata.  
  
```  
BOOL IsOpen() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento OLE è aperta; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 E viene utilizzato per determinare quando disegnare l'oggetto con un motivo di tratteggio. Un oggetto aperto deve avere un motivo a tratteggio disegnato sopra l'oggetto. È possibile utilizzare un [CRectTracker](../../mfc/reference/crecttracker-class.md) oggetto per eseguire questa operazione.  
  
##  <a name="isrunning"></a>  COleClientItem::IsRunning  
 Chiamare questa funzione per vedere se l'elemento OLE è in esecuzione. indica se l'elemento è caricato e in esecuzione nell'applicazione server.  
  
```  
BOOL IsRunning() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento OLE è in esecuzione. in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Per altre informazioni, vedere [OleIsRunning](http://msdn.microsoft.com/library/windows/desktop/ms688705) in Windows SDK.  
  
##  <a name="onactivate"></a>  COleClientItem::OnActivate  
 Chiamato dal framework per notificare l'elemento che è stato attivato solo posto.  
  
```  
virtual void OnActivate();
```  
  
### <a name="remarks"></a>Note  
 Si noti che questa funzione viene chiamata per indicare che il server sia in esecuzione, non per indicare che la relativa interfaccia utente sia stato installato in un'applicazione contenitore. A questo punto, l'oggetto non ha un'interfaccia utente attivo (non `activeUIState`). Non è stato installato il relativo menu o sulla barra degli strumenti. Il [OnActivateUI](#onactivateui) funzione membro viene chiamata in questo caso.  
  
 L'implementazione predefinita chiama la [OnChange](#onchange) funzione membro con **OLE_CHANGEDSTATE** come parametro. Eseguire l'override di questa funzione per eseguire elaborazioni personalizzate quando un elemento diventa attivo sul posto.  
  
##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI  
 Il framework chiama `OnActivateUI` quando l'oggetto entrato nello stato attivo dell'interfaccia utente.  
  
```  
virtual void OnActivateUI();
```  
  
### <a name="remarks"></a>Note  
 L'oggetto è ora installato relativa barra degli strumenti e menu.  
  
 L'implementazione predefinita del server viene memorizzata `HWND` per un momento successivo **GetServerWindow** chiamate.  
  
##  <a name="onchange"></a>  COleClientItem:: OnChange  
 Chiamato dal framework quando l'utente modifica, Salva o chiude l'elemento OLE.  
  
```  
virtual void OnChange(
    OLE_NOTIFICATION nCode,  
    DWORD dwParam);
```  
  
### <a name="parameters"></a>Parametri  
 *nCode*  
 Il motivo per il server modificato questo elemento. Può avere uno dei valori seguenti:  
  
- `OLE_CHANGED` L'aspetto dell'elemento OLE è stato modificato.  
  
- `OLE_SAVED` L'elemento OLE è stato salvato.  
  
- `OLE_CLOSED` L'elemento OLE è stato chiuso.  
  
- `OLE_CHANGED_STATE` L'elemento OLE è cambiato da uno stato a un altro.  
  
 *dwParam*  
 Se *nCode* viene `OLE_SAVED` o `OLE_CLOSED`, questo parametro non viene usato. Se *nCode* è `OLE_CHANGED`, questo parametro specifica l'aspetto dell'elemento OLE che è stato modificato. Per i valori possibili, vedere la *dwParam* parametro della [COleClientItem::Draw](#draw). Se *nCode* viene `OLE_CHANGED_STATE`, questo parametro è un **COleClientItem:: ItemState** valore enumerato e descrive lo stato. Può avere uno dei seguenti valori: `emptyState`, `loadedState`, `openState`, `activeState`, o `activeUIState`.  
  
### <a name="remarks"></a>Note  
 (Se l'applicazione server viene scritta utilizzando la libreria Microsoft Foundation Class, questa funzione viene chiamata in risposta ai `Notify` funzioni membro di `COleServerDoc` o `COleServerItem`.) L'implementazione predefinita Contrassegna il documento contenitore come modificati se *nCode* viene `OLE_CHANGED` o `OLE_SAVED`.  
  
 Per `OLE_CHANGED_STATE`, lo stato corrente restituito da [GetItemState](#getitemstate) saranno ancora lo stato precedente, vale a dire lo stato corrente prima di questa modifica dello stato.  
  
 Eseguire l'override di questa funzione per rispondere alle modifiche di stato dell'elemento OLE. In genere viene aggiornato l'aspetto dell'elemento invalida l'area in cui viene visualizzato l'elemento. Chiamare l'implementazione della classe base all'inizio della sostituzione.  
  
##  <a name="onchangeitemposition"></a>  COleClientItem:: OnChangeItemPosition  
 Chiamato dal framework per notificare al contenitore che extent dell'elemento OLE è stato modificato durante l'attivazione sul posto.  
  
```  
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```  
  
### <a name="parameters"></a>Parametri  
 *rectPos*  
 Indica la posizione dell'elemento relative rispetto all'area client dell'applicazione contenitore.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la posizione dell'elemento viene modificata correttamente; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita determina il nuovo rettangolo visibile dell'elemento OLE e le chiamate [Container_item_base_class5D;::SetItemRects](#setitemrects) con i nuovi valori. L'implementazione predefinita calcola il rettangolo visibile per l'elemento e passa l'informazione al server.  
  
 Eseguire l'override di questa funzione per applicare regole speciali per l'operazione di ridimensionamento o spostamento. Se l'applicazione viene scritta in MFC, la chiamata dei risultati perché il server denominato [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).  
  
##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate  
 Chiamato dal framework quando l'elemento OLE esegue la transizione dallo stato attivo sul posto ( `activeState`) allo stato di caricamento, vale a dire che è disattivato dopo l'attivazione sul posto.  
  
```  
virtual void OnDeactivate();
```  
  
### <a name="remarks"></a>Note  
 Si noti che questa funzione viene chiamata per indicare che l'elemento OLE è chiuso, non che la relativa interfaccia utente è stato rimosso dall'applicazione contenitore. In questo caso, il [OnDeactivateUI](#ondeactivateui) funzione membro viene chiamata.  
  
 L'implementazione predefinita chiama la [OnChange](#onchange) funzione membro con **OLE_CHANGEDSTATE** come parametro. Eseguire l'override di questa funzione per eseguire elaborazioni personalizzate quando un elemento attivo sul posto è disattivato. Ad esempio, se si supporta il comando Annulla contenitore nell'applicazione in uso, è possibile ignorare questa funzione per eliminare lo stato di annullamento, che indica che l'ultima operazione eseguita sull'elemento OLE non può essere annullata dopo l'elemento viene disattivato.  
  
##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo  
 Chiamato dal framework quando l'utente richiama il comando Annulla dopo aver attivato l'elemento OLE posto.  
  
```  
virtual void OnDeactivateAndUndo();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita chiama [DeactivateUI](#deactivateui) per disattivare l'interfaccia utente del server. Eseguire l'override di questa funzione se si sta implementando il comando Annulla nell'applicazione contenitore. Nell'override, chiamare la versione della classe base della funzione e quindi annullare l'ultimo comando eseguito nell'applicazione.  
  
 Per altre informazioni, vedere [IOleInPlaceSite::DeactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms683743) in Windows SDK.  
  
##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI  
 Chiamata eseguita quando l'utente disattiva un elemento che è stato attivato sul posto.  
  
```  
virtual void OnDeactivateUI(BOOL bUndoable);
```  
  
### <a name="parameters"></a>Parametri  
 *bUndoable*  
 Specifica se le modifiche sono annullabili.  
  
### <a name="remarks"></a>Note  
 Interfaccia utente dell'applicazione contenitore ripristinato lo stato originale, nascondere tutti i menu e altri controlli che sono stati creati per l'attivazione sul posto di questa funzione.  
  
 Se *bUndoable* viene **FALSE**, il contenitore è necessario disabilitare il comando Annulla, annullando in effetti lo stato di annullamento del contenitore, perché si indica che l'ultima operazione eseguita dal server non è annullabile.  
  
##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState  
 Chiamato dal framework quando l'utente esegue un'azione che elimina lo stato di annullamento durante la modifica dell'elemento OLE.  
  
```  
virtual void OnDiscardUndoState();
```  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione se si sta implementando il comando Annulla nell'applicazione contenitore. Nell'override, eliminare lo stato di annullamento dell'applicazione contenitore.  
  
 Se il server è stato scritto con la libreria Microsoft Foundation Class, il server può provocare questo funzione da chiamare chiamando [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).  
  
 Per altre informazioni, vedere [IOleInPlaceSite::DiscardUndoState](http://msdn.microsoft.com/library/windows/desktop/ms688642) in Windows SDK.  
  
##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData  
 Chiamato dal framework per ottenere un `COleDataSource` oggetto che contiene tutti i dati che sarebbero stati posizionati negli Appunti da una chiamata a uno il [CopyToClipboard](#copytoclipboard) o il [DoDragDrop](#dodragdrop) funzione membro.  
  
```  
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,  
    LPPOINT lpOffset,  
    LPSIZE lpSize);
```  
  
### <a name="parameters"></a>Parametri  
 *bIncludeLink*  
 Impostare questa proprietà su **TRUE** se i dati di collegamento devono essere copiati negli Appunti. Impostare questa proprietà su **FALSE** se l'applicazione server non supporta i collegamenti.  
  
 *lpOffset*  
 Puntatore all'offset del cursore del mouse dall'origine dell'oggetto in pixel.  
  
 *lpSize*  
 Puntatore alla dimensione dell'oggetto in pixel.  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore a un [COleDataSource](../../mfc/reference/coledatasource-class.md) oggetto che contiene i dati negli Appunti.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita di questa funzione chiama [GetClipboardData](#getclipboarddata).  
  
##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect  
 Il framework chiama la `OnGetClipRect` funzione membro per ottenere le coordinate del rettangolo di ridimensionamento dell'elemento che viene modificato sul posto.  
  
```  
virtual void OnGetClipRect(CRect& rClipRect);
```  
  
### <a name="parameters"></a>Parametri  
 *rClipRect*  
 Puntatore a un oggetto della classe [CRect](../../atl-mfc-shared/reference/crect-class.md) che conterrà le coordinate del rettangolo di ridimensionamento dell'elemento.  
  
### <a name="remarks"></a>Note  
 Coordinate sono espresse in pixel relativo all'area client della finestra dell'applicazione contenitore.  
  
 L'implementazione predefinita restituisce semplicemente il rettangolo client della vista in cui l'elemento è attivo sul posto.  
  
##  <a name="ongetitemposition"></a>  OnGetItemPosition  
 Il framework chiama la `OnGetItemPosition` funzione membro per ottenere le coordinate dell'elemento che viene modificato sul posto.  
  
```  
virtual void OnGetItemPosition(CRect& rPosition);
```  
  
### <a name="parameters"></a>Parametri  
 *rPosition.*  
 Riferimento per il [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto contenenti le coordinate della posizione dell'elemento.  
  
### <a name="remarks"></a>Note  
 Coordinate sono espresse in pixel relativo all'area client della finestra dell'applicazione contenitore.  
  
 L'implementazione predefinita di questa funzione non esegue alcuna operazione. Le applicazioni che supportano la modifica sul posto richiedono la relativa implementazione.  
  
##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext  
 Chiamato dal framework quando un elemento viene attivato sul posto.  
  
```  
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,  
    CFrameWnd** ppDocFrame,  
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```  
  
### <a name="parameters"></a>Parametri  
 *ppMainFrame*  
 Puntatore a un puntatore alla finestra cornice principale.  
  
 *ppDocFrame*  
 Puntatore a un puntatore alla finestra cornice del documento.  
  
 *lpFrameInfo*  
 Puntatore a un [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) struttura che riceverà informazioni della finestra cornice.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione viene utilizzata per recuperare informazioni sulla finestra padre dell'elemento OLE.  
  
 Se il contenitore è un'applicazione MDI, l'implementazione predefinita restituisce un puntatore per il [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) oggetto *ppMainFrame* e un puntatore a attivo [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)dell'oggetto *ppDocFrame*. Se il contenitore è un'applicazione SDI, l'implementazione predefinita restituisce un puntatore per il [CFrameWnd](../../mfc/reference/cframewnd-class.md) oggetto *ppMainFrame* e restituisce **NULL** in  *ppDocFrame*. L'implementazione predefinita riempie anche nei membri di *lpFrameInfo*.  
  
 Eseguire l'override di questa funzione solo se l'implementazione predefinita non esigenze della propria applicazione; ad esempio, se l'applicazione presenta un paradigma dell'interfaccia utente che è diverso dal SDI o MDI. Si tratta di un'avanzata sottoponibile a override.  
  
 Per altre informazioni, vedere [IOleInPlaceSite::GetWindowContext](http://msdn.microsoft.com/library/windows/desktop/ms694366) e il [OLEINPLACEFRAMEINFO](http://msdn.microsoft.com/library/windows/desktop/ms693737) struttura in Windows SDK.  
  
##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus  
 Chiamato dal framework durante l'attivazione sul posto per inserire i menu dell'applicazione contenitore in un menu vuoto.  
  
```  
virtual void OnInsertMenus(
    CMenu* pMenuShared,  
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```  
  
### <a name="parameters"></a>Parametri  
 *pMenuShared*  
 Punta a un menu vuoto.  
  
 *lpMenuWidths*  
 Punta a una matrice di sei **lungo** valori che indicano quanti i menu sono visualizzati ognuno dei gruppi di menu seguenti: File, modificare e contenitore, oggetto, finestra della Guida. L'applicazione contenitore è responsabile per i gruppi di menu File, il contenitore e finestra, corrispondenti a elementi di 0, 2 e 4 di questa matrice.  
  
### <a name="remarks"></a>Note  
 Questo menu viene quindi passato al server, che inserisce il proprio menu, creazione di un menu composto. Questa funzione può essere chiamata più volte per compilare diversi menu compositi.  
  
 L'implementazione predefinita inserisce *pMenuShared* i menu del contenitore sul posto, vale a dire i gruppi di menu File, il contenitore e finestra. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) utilizzato per impostare questa risorsa di menu. L'implementazione predefinita assegna inoltre i valori appropriati per gli elementi 0, 2 e 4 *lpMenuWidths*, a seconda della risorsa di menu. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. ad esempio, se l'applicazione non utilizza i modelli di documento per l'associazione di risorse con tipi di documento. Se si esegue l'override di questa funzione, deve anche eseguire l'override [OnSetMenu](#onsetmenu) e [OnRemoveMenus](#onremovemenus). Si tratta di un'avanzata sottoponibile a override.  
  
 Per altre informazioni, vedere [IOleInPlaceFrame:: InsertMenus](http://msdn.microsoft.com/library/windows/desktop/ms683987) in Windows SDK.  
  
##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus  
 Chiamata eseguita dal framework per rimuovere i menu del contenitore dal menu di scelta composito specificato al termine dell'attivazione sul posto.  
  
```  
virtual void OnRemoveMenus(CMenu* pMenuShared);
```  
  
### <a name="parameters"></a>Parametri  
 *pMenuShared*  
 Punta al menu composito costruito tramite chiamate ai [OnInsertMenus](#oninsertmenus) funzione membro.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita rimuove *pMenuShared* i menu del contenitore sul posto, ovvero, i gruppi di menu File, il contenitore e finestra. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. ad esempio, se l'applicazione non utilizza i modelli di documento per l'associazione di risorse con tipi di documento. Se si esegue l'override di questa funzione, è probabile che eseguire l'override [OnInsertMenus](#oninsertmenus) e [OnSetMenu](#onsetmenu) anche. Si tratta di un'avanzata sottoponibile a override.  
  
 I sottomenu nei *pMenuShared* può essere condiviso da più di un menu composto se il server è chiamato ripetutamente `OnInsertMenus`. Di conseguenza non è necessario eliminare eventuali sottomenu nell'override della `OnRemoveMenus`; deve solo scollegarli.  
  
 Per altre informazioni, vedere [IOleInPlaceFrame::RemoveMenus](http://msdn.microsoft.com/library/windows/desktop/ms688685) in Windows SDK.  
  
##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy  
 Chiamato dal framework per scorrere l'elemento OLE in risposta alle richieste dal server.  
  
```  
virtual BOOL OnScrollBy(CSize sizeExtent);
```  
  
### <a name="parameters"></a>Parametri  
 *sizeExtent*  
 Specifica la distanza in pixel, per scorrere le direzioni x e y.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se l'elemento è stato sottoposto a scorrimento; 0 se l'elemento non è possibile scorrere.  
  
### <a name="remarks"></a>Note  
 Ad esempio, se l'elemento OLE è parzialmente visibile e l'utente si sposta all'esterno dell'area visibile durante la modifica sul posto, questa funzione viene chiamata per mantenere visibile il cursore. L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione per scorrere l'elemento di base al valore specificato. Si noti che in seguito a scorrimento, può modificare la parte visibile dell'elemento OLE. Chiamare [Container_item_base_class5D;::SetItemRects](#setitemrects) aggiornare rettangolo visibile dell'elemento.  
  
 Per altre informazioni, vedere [IOleInPlaceSite::Scroll](http://msdn.microsoft.com/library/windows/desktop/ms690291) in Windows SDK.  
  
##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu  
 Chiamato dal framework due volte quando l'attivazione sul posto inizia e finisce; la prima volta per installare il menu composto e la seconda volta (con *holemenu* uguale a **NULL**) per rimuoverlo.  
  
```  
virtual void OnSetMenu(
    CMenu* pMenuShared,  
    HOLEMENU holemenu,  
    HWND hwndActiveObject);
```  
  
### <a name="parameters"></a>Parametri  
 *pMenuShared*  
 Puntatore al menu composito costruito tramite chiamate ai [OnInsertMenus](#oninsertmenus) funzione membro e il `InsertMenu` (funzione).  
  
 *holemenu*  
 Handle per il descrittore di menu restituito dal **OleCreateMenuDescriptor** funzione, o **NULL** se il codice di invio deve essere rimossa.  
  
 *hwndActiveObject*  
 Handle di finestra di modifica per l'elemento OLE. Questa è la finestra che riceverà i comandi di modifica da OLE.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita installa o rimuove il menu composto e quindi chiama il [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831) funzione per installare o rimuovere il codice di invio. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. Se si esegue l'override di questa funzione, è probabile che eseguire l'override [OnInsertMenus](#oninsertmenus) e [OnRemoveMenus](#onremovemenus) anche. Si tratta di un'avanzata sottoponibile a override.  
  
 Per altre informazioni, vedere [OleCreateMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms691415), [OleSetMenuDescriptor](http://msdn.microsoft.com/library/windows/desktop/ms692831), e [SetMenu](http://msdn.microsoft.com/library/windows/desktop/ms693713) in Windows SDK.  
  
##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars  
 Chiamato dal framework per mostrare e nascondere le barre di controllo dell'applicazione contenitore.  
  
```  
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,  
    BOOL bShow);
```  
  
### <a name="parameters"></a>Parametri  
 *pFrameWnd*  
 Puntatore alla finestra cornice dell'applicazione contenitore. Può trattarsi di una finestra cornice principale o una finestra figlio MDI.  
  
 *bMostra*  
 Specifica se le barre di controllo devono essere mostrati o nascosti.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la chiamata di funzione provoca una modifica in stato le barre di controllo. 0 se la chiamata non comporta alcuna modifica o se *pFrameWnd* non fa riferimento alla finestra cornice del contenitore.  
  
### <a name="remarks"></a>Note  
 Questa funzione restituisce 0 se le barre di controllo si trovano già nello stato specificato da *bMostra.* Questa situazione si verifica, ad esempio, se le barre di controllo sono nascosti e *bMostra* viene **FALSE**.  
  
 L'implementazione predefinita rimuove la barra degli strumenti dalla finestra cornice di primo livello.  
  
##  <a name="onshowitem"></a>  COleClientItem::OnShowItem  
 Chiamato dal framework per visualizzare l'elemento OLE, rendendolo completamente visibile durante la modifica.  
  
```  
virtual void OnShowItem();
```  
  
### <a name="remarks"></a>Note  
 Viene utilizzato quando l'applicazione contenitore supporta i collegamenti agli elementi incorporati (vale a dire, se è stata derivata la classe del documento dal [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Questa funzione viene chiamata durante l'attivazione sul posto o quando l'elemento OLE è un'origine del collegamento e l'utente desidera modificarlo. L'implementazione predefinita è attiva la prima visualizzazione del documento contenitore. Eseguire l'override di questa funzione per scorrere il documento in modo che l'elemento OLE è visibile.  
  
##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle  
 Chiamato dal framework durante l'attivazione sul posto per aggiornare barra del titolo della finestra cornice.  
  
```  
virtual BOOL OnUpdateFrameTitle();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se questa funzione è stato aggiornato il titolo del frame, in caso contrario, zero.  
  
### <a name="remarks"></a>Note  
 L'implementazione predefinita non modifica il titolo della finestra cornice. Eseguire l'override di questa funzione se si desidera che un titolo diverso frame per l'applicazione, ad esempio " *app server* - *elemento* in *NomeMedico*" (ad esempio, "Microsoft Excel - foglio di calcolo nel REPORT. DOC"). Si tratta di un'avanzata sottoponibile a override.  
  
##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo  
 Chiamare questa funzione per riattivare l'elemento OLE e annullare l'ultima operazione eseguita dall'utente durante la modifica sul posto.  
  
```  
BOOL ReactivateAndUndo();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Se l'applicazione contenitore supporta il comando di annullamento, chiamare questa funzione se l'utente sceglie il comando Annulla immediatamente dopo la disattivazione dell'elemento OLE.  
  
 Se l'applicazione server viene scritto con le librerie di classi Microsoft Foundation, questa funzione consente al server di chiamare [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).  
  
 Per altre informazioni, vedere [IOleInPlaceObject::ReactivateAndUndo](http://msdn.microsoft.com/library/windows/desktop/ms691372) in Windows SDK.  
  
##  <a name="release"></a>  COleClientItem::Release  
 Chiamare questa funzione per pulire le risorse usate dall'elemento OLE.  
  
```  
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```  
  
### <a name="parameters"></a>Parametri  
 *dwCloseOption*  
 Flag che specifica le condizioni dell'elemento OLE viene salvato quando torna allo stato caricato. Per un elenco di valori possibili, vedere [COleClientItem::Close](#close).  
  
### <a name="remarks"></a>Note  
 `Release` viene chiamato dal `COleClientItem` distruttore.  
  
 Per altre informazioni, vedere [IUnknown:: Release](http://msdn.microsoft.com/library/windows/desktop/ms682317) in Windows SDK.  
  
##  <a name="reload"></a>  COleClientItem::Reload  
 Chiude e ricarica l'elemento.  
  
```  
BOOL Reload();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Chiamare il `Reload` funzione dopo l'attivazione dell'elemento come elemento di un altro tipo mediante una chiamata a [ActivateAs](#activateas).  
  
##  <a name="run"></a>  COleClientItem::Run  
 Esegue l'applicazione associata a questo elemento.  
  
```  
void Run();
```  
  
### <a name="remarks"></a>Note  
 Chiamare il `Run` funzione membro per avviare l'applicazione server prima di attivare l'elemento. Questa operazione viene eseguita automaticamente da [Activate](#activate) e [DoVerb](#doverb), pertanto in genere non è necessario chiamare questa funzione. Chiamare questa funzione se è necessario eseguire il server per impostare un attributo dell'elemento, ad esempio [SetExtent](#setextent), prima di eseguire [DoVerb](#doverb).  
  
##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect  
 Chiamare il `SetDrawAspect` funzione membro per impostare la "aspetto", o la vista dell'elemento.  
  
```  
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```  
  
### <a name="parameters"></a>Parametri  
 *nDrawAspect*  
 Valore ricavato dall'enumerazione `DVASPECT`. Per il parametro è possibile specificare uno dei valori riportati di seguito:  
  
- `DVASPECT_CONTENT` Elemento è rappresentato in modo tale che può essere visualizzato come oggetto incorporato all'interno del relativo contenitore.  
  
- `DVASPECT_THUMBNAIL` Elemento viene visualizzato in una rappresentazione "anteprima" in modo che possa essere visualizzata in uno strumento di esplorazione.  
  
- `DVASPECT_ICON` Elemento è rappresentato da un'icona.  
  
- `DVASPECT_DOCPRINT` Elemento è rappresentato come se fosse stampato utilizzando il comando Stampa dal menu File.  
  
### <a name="remarks"></a>Note  
 L'aspetto specifica come l'elemento deve essere sottoposto a rendering dal [disegnare](#draw) quando il valore predefinito per tale funzione `nDrawAspect` viene utilizzato l'argomento.  
  
 Questa funzione viene chiamata automaticamente l'icona di modifica (e altre finestre di dialogo che chiamano direttamente la finestra di dialogo Cambia icona) per abilitare l'aspetto delle icone di visualizzazione quando richiesto dall'utente.  
  
##  <a name="setextent"></a>  COleClientItem::SetExtent  
 Chiamare questa funzione per specificare la quantità di spazio è disponibile per l'elemento OLE.  
  
```  
void SetExtent(
    const CSize& size,  
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```  
  
### <a name="parameters"></a>Parametri  
 *size*  
 Un [CSize](../../atl-mfc-shared/reference/csize-class.md) oggetto che contiene le informazioni sulle dimensioni.  
  
 *nDrawAspect*  
 Specifica l'aspetto dell'elemento OLE cui limiti devono essere impostate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).  
  
### <a name="remarks"></a>Note  
 Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, viene generato il [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) funzione membro del corrispondente `COleServerItem` oggetto da chiamare. L'elemento OLE può quindi regolare la visualizzazione. Le dimensioni devono essere `MM_HIMETRIC` unità. Chiamare questa funzione quando l'utente ridimensiona l'elemento OLE o se si supporta una forma di negoziazione di layout.  
  
 Per altre informazioni, vedere [IOleObject::SetExtent](http://msdn.microsoft.com/library/windows/desktop/ms694330) in Windows SDK.  
  
##  <a name="sethostnames"></a>  COleClientItem::SetHostNames  
 Chiamare questa funzione per specificare il nome dell'applicazione contenitore e il nome del contenitore per un elemento OLE incorporato.  
  
```  
void SetHostNames(
    LPCTSTR lpszHost,  
    LPCTSTR lpszHostObj);
```  
  
### <a name="parameters"></a>Parametri  
 *lpszHost*  
 Puntatore al nome visibile dall'utente dell'applicazione contenitore.  
  
 *lpszHostObj*  
 Puntatore a una stringa di identificazione del contenitore che contiene l'elemento OLE.  
  
### <a name="remarks"></a>Note  
 Se l'applicazione server è stata scritta utilizzando la libreria Microsoft Foundation Class, questa funzione chiama la [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) funzione membro del `COleServerDoc` documento che contiene l'elemento OLE. Queste informazioni vengono utilizzate nei titoli finestra quando l'elemento OLE viene modificato. Ogni volta che viene caricato un documento contenitore, il framework chiama questa funzione per tutti gli elementi OLE nel documento. `SetHostNames` è applicabile solo agli elementi incorporati. Non è necessario chiamare questa funzione ogni volta che viene attivato un elemento OLE incorporato per la modifica.  
  
 Ciò viene anche chiamato automaticamente con il nome dell'applicazione e il nome di documento quando viene caricato un oggetto o un file viene salvato con un nome diverso. Non è di conseguenza, in genere necessario chiamare direttamente questa funzione.  
  
 Per altre informazioni, vedere [IOleObject::SetHostNames](http://msdn.microsoft.com/library/windows/desktop/ms680642) in Windows SDK.  
  
##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile  
 Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.  
  
```  
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```  
  
### <a name="parameters"></a>Parametri  
 *hMetaPict*  
 Handle per il metafile utilizzato per disegnare l'icona dell'elemento.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Uso [GetIconicMetafile](#geticonicmetafile) per recuperare il metafile.  
  
 Il *hMetaPict* parametro viene copiato in un elemento; pertanto *hMetaPict* deve essere liberata dal chiamante.  
  
##  <a name="setitemrects"></a>  COleClientItem::SetItemRects  
 Chiamare questa funzione per impostare il rettangolo di delimitazione o il rettangolo visibile dell'elemento OLE.  
  
```  
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,  
    LPCRECT lpClipRect = NULL);
```  
  
### <a name="parameters"></a>Parametri  
 *lprcPosRect*  
 Puntatore al rettangolo contenente i limiti dell'elemento OLE rispetto alla finestra padre, nelle coordinate client.  
  
 *lprcClipRect*  
 Puntatore al rettangolo contenente i limiti della parte visibile dell'elemento OLE rispetto alla finestra padre, nelle coordinate client.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se ha esito positivo. in caso contrario, 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione viene chiamata dall'implementazione predefinita del [Container_item_class5D;::OnChangeItemPosition](#onchangeitemposition) funzione membro. È necessario chiamare questa funzione ogni volta che la posizione o la parte visibile del OLE elemento cambia. In genere ciò significa chiamarlo della vista [OnSize](../../mfc/reference/cwnd-class.md#onsize) e [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funzioni membro.  
  
 Per altre informazioni, vedere [IOleInPlaceObject::SetObjectRects](http://msdn.microsoft.com/library/windows/desktop/ms683767) in Windows SDK.  
  
##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions  
 Chiamare questa funzione per impostare l'opzione di aggiornamento di collegamento per la presentazione dell'elemento collegato specificato.  
  
```  
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```  
  
### <a name="parameters"></a>Parametri  
 *dwUpdateOpt*  
 Il valore dell'opzione di aggiornamento di collegamento per questo elemento. Questo valore deve essere uno dei valori seguenti:  
  
- `OLEUPDATE_ALWAYS` Aggiornare l'elemento collegato laddove possibile. Questa opzione supporta il pulsante di opzione di aggiornamento di collegamento automatico nella finestra di dialogo collegamenti.  
  
- `OLEUPDATE_ONCALL` Aggiornare l'elemento collegato solo su richiesta da un'applicazione contenitore (quando il [UpdateLink](#updatelink) funzione membro viene chiamata). Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento manuale nella finestra di dialogo collegamenti.  
  
### <a name="remarks"></a>Note  
 In genere, non è necessario modificare le opzioni di aggiornamento scelte dall'utente nella finestra di dialogo collegamenti.  
  
 Per altre informazioni, vedere [IOleLink::SetUpdateOptions](http://msdn.microsoft.com/library/windows/desktop/ms680120) in Windows SDK.  
  
##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice  
 Chiamare questa funzione per modificare il dispositivo di destinazione di stampa per questo elemento.  
  
```  
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);  
BOOL SetPrintDevice(const PRINTDLG* ppd);
```  
  
### <a name="parameters"></a>Parametri  
 *ptd*  
 Puntatore a un [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) struttura dei dati, che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere **NULL**.  
  
 *PPD*  
 Puntatore a un [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646940) struttura dei dati, che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere **NULL**.  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero se la funzione ha esito positivo; in caso contrario 0.  
  
### <a name="remarks"></a>Note  
 Questa funzione Aggiorna il dispositivo di destinazione di stampa per l'elemento ma non aggiorna la cache di presentazione. Per aggiornare la cache di presentazione per un elemento, chiamare [UpdateLink](#updatelink).  
  
 Gli argomenti di questa funzione contengono informazioni che il sistema OLE viene utilizzato per identificare il dispositivo di destinazione. Il **PRINTDLG** struttura contiene informazioni che Windows utilizza per inizializzare la finestra di dialogo Stampa comune. Dopo che l'utente chiude la finestra di dialogo, Windows restituisce informazioni sulle selezioni dell'utente in questa struttura. Il `m_pd` membro di un [CPrintDialog](../../mfc/reference/cprintdialog-class.md) oggetto è un **PRINTDLG** struttura.  
  
 Per ulteriori informazioni su questa struttura, vedere [PRINTDLG](http://msdn.microsoft.com/library/windows/desktop/ms646843) in Windows SDK.  
  
 Per altre informazioni, vedere [DVTARGETDEVICE](http://msdn.microsoft.com/library/windows/desktop/ms686613) in Windows SDK.  
  
##  <a name="updatelink"></a>  COleClientItem::UpdateLink  
 Chiamare questa funzione per aggiornare immediatamente i dati della presentazione dell'elemento OLE.  
  
```  
BOOL UpdateLink();
```  
  
### <a name="return-value"></a>Valore restituito  
 Diverso da zero in caso di esito positivo; in caso contrario, 0.  
  
### <a name="remarks"></a>Note  
 Gli elementi collegati, la funzione consente di individuare l'origine del collegamento per ottenere una nuova presentazione per l'elemento OLE. Questo processo potrebbe richiedere l'esecuzione di uno o più applicazioni server, potrebbero richiedere molto tempo. Per gli elementi incorporati, la funzione viene eseguita in modo ricorsivo, verifica se l'elemento incorporato contiene i collegamenti che potrebbero essere aggiornati e aggiornarli. L'utente può aggiornare anche manualmente utilizzando la finestra di dialogo collegamenti singoli collegamenti.  
  
 Per altre informazioni, vedere [IOleLink::Update](http://msdn.microsoft.com/library/windows/desktop/ms692660) in Windows SDK.  
  
## <a name="see-also"></a>Vedere anche  
 [Esempio MFC MFCBIND](../../visual-cpp-samples.md)   
 [Esempio MFC OCLIENT](../../visual-cpp-samples.md)   
 [Classe CDocItem](../../mfc/reference/cdocitem-class.md)   
 [Grafico delle gerarchie](../../mfc/hierarchy-chart.md)   
 [Classe COleServerItem](../../mfc/reference/coleserveritem-class.md)
