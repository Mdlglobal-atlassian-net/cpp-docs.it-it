---
title: Classe COleClientItem
ms.date: 11/04/2016
f1_keywords:
- COleClientItem
- AFXOLE/COleClientItem
- AFXOLE/COleClientItem::COleClientItem
- AFXOLE/COleClientItem::Activate
- AFXOLE/COleClientItem::ActivateAs
- AFXOLE/COleClientItem::AttachDataObject
- AFXOLE/COleClientItem::CanCreateFromData
- AFXOLE/COleClientItem::CanCreateLinkFromData
- AFXOLE/COleClientItem::CanPaste
- AFXOLE/COleClientItem::CanPasteLink
- AFXOLE/COleClientItem::Close
- AFXOLE/COleClientItem::ConvertTo
- AFXOLE/COleClientItem::CopyToClipboard
- AFXOLE/COleClientItem::CreateCloneFrom
- AFXOLE/COleClientItem::CreateFromClipboard
- AFXOLE/COleClientItem::CreateFromData
- AFXOLE/COleClientItem::CreateFromFile
- AFXOLE/COleClientItem::CreateLinkFromClipboard
- AFXOLE/COleClientItem::CreateLinkFromData
- AFXOLE/COleClientItem::CreateLinkFromFile
- AFXOLE/COleClientItem::CreateNewItem
- AFXOLE/COleClientItem::CreateStaticFromClipboard
- AFXOLE/COleClientItem::CreateStaticFromData
- AFXOLE/COleClientItem::Deactivate
- AFXOLE/COleClientItem::DeactivateUI
- AFXOLE/COleClientItem::Delete
- AFXOLE/COleClientItem::DoDragDrop
- AFXOLE/COleClientItem::DoVerb
- AFXOLE/COleClientItem::Draw
- AFXOLE/COleClientItem::GetActiveView
- AFXOLE/COleClientItem::GetCachedExtent
- AFXOLE/COleClientItem::GetClassID
- AFXOLE/COleClientItem::GetClipboardData
- AFXOLE/COleClientItem::GetDocument
- AFXOLE/COleClientItem::GetDrawAspect
- AFXOLE/COleClientItem::GetExtent
- AFXOLE/COleClientItem::GetIconFromRegistry
- AFXOLE/COleClientItem::GetIconicMetafile
- AFXOLE/COleClientItem::GetInPlaceWindow
- AFXOLE/COleClientItem::GetItemState
- AFXOLE/COleClientItem::GetLastStatus
- AFXOLE/COleClientItem::GetLinkUpdateOptions
- AFXOLE/COleClientItem::GetType
- AFXOLE/COleClientItem::GetUserType
- AFXOLE/COleClientItem::IsInPlaceActive
- AFXOLE/COleClientItem::IsLinkUpToDate
- AFXOLE/COleClientItem::IsModified
- AFXOLE/COleClientItem::IsOpen
- AFXOLE/COleClientItem::IsRunning
- AFXOLE/COleClientItem::OnActivate
- AFXOLE/COleClientItem::OnActivateUI
- AFXOLE/COleClientItem::OnChange
- AFXOLE/COleClientItem::OnDeactivate
- AFXOLE/COleClientItem::OnDeactivateUI
- AFXOLE/COleClientItem::OnGetClipboardData
- AFXOLE/COleClientItem::OnInsertMenus
- AFXOLE/COleClientItem::OnRemoveMenus
- AFXOLE/COleClientItem::OnSetMenu
- AFXOLE/COleClientItem::OnShowControlBars
- AFXOLE/COleClientItem::OnUpdateFrameTitle
- AFXOLE/COleClientItem::ReactivateAndUndo
- AFXOLE/COleClientItem::Release
- AFXOLE/COleClientItem::Reload
- AFXOLE/COleClientItem::Run
- AFXOLE/COleClientItem::SetDrawAspect
- AFXOLE/COleClientItem::SetExtent
- AFXOLE/COleClientItem::SetHostNames
- AFXOLE/COleClientItem::SetIconicMetafile
- AFXOLE/COleClientItem::SetItemRects
- AFXOLE/COleClientItem::SetLinkUpdateOptions
- AFXOLE/COleClientItem::SetPrintDevice
- AFXOLE/COleClientItem::UpdateLink
- AFXOLE/COleClientItem::CanActivate
- AFXOLE/COleClientItem::OnChangeItemPosition
- AFXOLE/COleClientItem::OnDeactivateAndUndo
- AFXOLE/COleClientItem::OnDiscardUndoState
- AFXOLE/COleClientItem::OnGetClipRect
- AFXOLE/COleClientItem::OnGetItemPosition
- AFXOLE/COleClientItem::OnGetWindowContext
- AFXOLE/COleClientItem::OnScrollBy
- AFXOLE/COleClientItem::OnShowItem
helpviewer_keywords:
- COleClientItem [MFC], COleClientItem
- COleClientItem [MFC], Activate
- COleClientItem [MFC], ActivateAs
- COleClientItem [MFC], AttachDataObject
- COleClientItem [MFC], CanCreateFromData
- COleClientItem [MFC], CanCreateLinkFromData
- COleClientItem [MFC], CanPaste
- COleClientItem [MFC], CanPasteLink
- COleClientItem [MFC], Close
- COleClientItem [MFC], ConvertTo
- COleClientItem [MFC], CopyToClipboard
- COleClientItem [MFC], CreateCloneFrom
- COleClientItem [MFC], CreateFromClipboard
- COleClientItem [MFC], CreateFromData
- COleClientItem [MFC], CreateFromFile
- COleClientItem [MFC], CreateLinkFromClipboard
- COleClientItem [MFC], CreateLinkFromData
- COleClientItem [MFC], CreateLinkFromFile
- COleClientItem [MFC], CreateNewItem
- COleClientItem [MFC], CreateStaticFromClipboard
- COleClientItem [MFC], CreateStaticFromData
- COleClientItem [MFC], Deactivate
- COleClientItem [MFC], DeactivateUI
- COleClientItem [MFC], Delete
- COleClientItem [MFC], DoDragDrop
- COleClientItem [MFC], DoVerb
- COleClientItem [MFC], Draw
- COleClientItem [MFC], GetActiveView
- COleClientItem [MFC], GetCachedExtent
- COleClientItem [MFC], GetClassID
- COleClientItem [MFC], GetClipboardData
- COleClientItem [MFC], GetDocument
- COleClientItem [MFC], GetDrawAspect
- COleClientItem [MFC], GetExtent
- COleClientItem [MFC], GetIconFromRegistry
- COleClientItem [MFC], GetIconicMetafile
- COleClientItem [MFC], GetInPlaceWindow
- COleClientItem [MFC], GetItemState
- COleClientItem [MFC], GetLastStatus
- COleClientItem [MFC], GetLinkUpdateOptions
- COleClientItem [MFC], GetType
- COleClientItem [MFC], GetUserType
- COleClientItem [MFC], IsInPlaceActive
- COleClientItem [MFC], IsLinkUpToDate
- COleClientItem [MFC], IsModified
- COleClientItem [MFC], IsOpen
- COleClientItem [MFC], IsRunning
- COleClientItem [MFC], OnActivate
- COleClientItem [MFC], OnActivateUI
- COleClientItem [MFC], OnChange
- COleClientItem [MFC], OnDeactivate
- COleClientItem [MFC], OnDeactivateUI
- COleClientItem [MFC], OnGetClipboardData
- COleClientItem [MFC], OnInsertMenus
- COleClientItem [MFC], OnRemoveMenus
- COleClientItem [MFC], OnSetMenu
- COleClientItem [MFC], OnShowControlBars
- COleClientItem [MFC], OnUpdateFrameTitle
- COleClientItem [MFC], ReactivateAndUndo
- COleClientItem [MFC], Release
- COleClientItem [MFC], Reload
- COleClientItem [MFC], Run
- COleClientItem [MFC], SetDrawAspect
- COleClientItem [MFC], SetExtent
- COleClientItem [MFC], SetHostNames
- COleClientItem [MFC], SetIconicMetafile
- COleClientItem [MFC], SetItemRects
- COleClientItem [MFC], SetLinkUpdateOptions
- COleClientItem [MFC], SetPrintDevice
- COleClientItem [MFC], UpdateLink
- COleClientItem [MFC], CanActivate
- COleClientItem [MFC], OnChangeItemPosition
- COleClientItem [MFC], OnDeactivateAndUndo
- COleClientItem [MFC], OnDiscardUndoState
- COleClientItem [MFC], OnGetClipRect
- COleClientItem [MFC], OnGetItemPosition
- COleClientItem [MFC], OnGetWindowContext
- COleClientItem [MFC], OnScrollBy
- COleClientItem [MFC], OnShowItem
ms.assetid: 7f571b7c-2758-4839-847a-0cf1ef643128
ms.openlocfilehash: cd04b2aa6dd1d539e357a69666bafc80e3ea5eba
ms.sourcegitcommit: fc1de63a39f7fcbfe2234e3f372b5e1c6a286087
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/15/2019
ms.locfileid: "65708164"
---
# <a name="coleclientitem-class"></a>Classe COleClientItem

Definisce l'interfaccia del contenitore per gli elementi OLE.

## <a name="syntax"></a>Sintassi

```
class COleClientItem : public CDocItem
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleClientItem::COleClientItem](#coleclientitem)|Costruisce un oggetto `COleClientItem`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[COleClientItem::Activate](#activate)|Apre l'elemento OLE per un'operazione e quindi esegue il verbo specificato.|
|[COleClientItem::ActivateAs](#activateas)|Attiva l'elemento come un altro tipo.|
|[COleClientItem::AttachDataObject](#attachdataobject)|Accede ai dati nell'oggetto OLE.|
|[COleClientItem::CanCreateFromData](#cancreatefromdata)|Indica se un'applicazione contenitore può creare un oggetto incorporato.|
|[COleClientItem::CanCreateLinkFromData](#cancreatelinkfromdata)|Indica se un'applicazione contenitore può creare un oggetto collegato.|
|[COleClientItem::CanPaste](#canpaste)|Indica se gli Appunti contengono un elemento OLE incorporabile o statico.|
|[COleClientItem::CanPasteLink](#canpastelink)|Indica se gli Appunti contengono un elemento OLE collegabile.|
|[COleClientItem::Close](#close)|Chiude un collegamento a un server, ma non elimina definitivamente l'elemento OLE.|
|[COleClientItem::ConvertTo](#convertto)|Converte l'elemento in un altro tipo.|
|[COleClientItem::CopyToClipboard](#copytoclipboard)|Copia negli Appunti l'elemento OLE.|
|[COleClientItem::CreateCloneFrom](#createclonefrom)|Crea un duplicato di un elemento esistente.|
|[COleClientItem::CreateFromClipboard](#createfromclipboard)|Crea un elemento incorporato dagli Appunti.|
|[COleClientItem::CreateFromData](#createfromdata)|Crea un elemento incorporato da un oggetto dati.|
|[COleClientItem::CreateFromFile](#createfromfile)|Crea un elemento incorporato da un file.|
|[COleClientItem::CreateLinkFromClipboard](#createlinkfromclipboard)|Crea un elemento collegato dagli Appunti.|
|[COleClientItem::CreateLinkFromData](#createlinkfromdata)|Crea un elemento collegato da un oggetto dati.|
|[COleClientItem::CreateLinkFromFile](#createlinkfromfile)|Crea un elemento collegato da un file.|
|[COleClientItem::CreateNewItem](#createnewitem)|Crea un nuovo elemento incorporato avviando l'applicazione server.|
|[COleClientItem::CreateStaticFromClipboard](#createstaticfromclipboard)|Crea un elemento statico dagli Appunti.|
|[COleClientItem::CreateStaticFromData](#createstaticfromdata)|Crea un elemento statico da un oggetto dati.|
|[COleClientItem::Deactivate](#deactivate)|Disattiva l'elemento.|
|[COleClientItem::DeactivateUI](#deactivateui)|Ripristina lo stato originale dell'interfaccia utente dell'applicazione contenitore.|
|[COleClientItem::Delete](#delete)|Elimina o si chiude l'elemento OLE, se si tratta di un elemento collegato.|
|[COleClientItem::DoDragDrop](#dodragdrop)|Esegue un'operazione di trascinamento e rilascio.|
|[COleClientItem::DoVerb](#doverb)|Esegue il verbo specificato.|
|[COleClientItem::Draw](#draw)|Consente di disegnare l'elemento OLE.|
|[COleClientItem::GetActiveView](#getactiveview)|Ottiene la visualizzazione in cui l'elemento è attivato sul posto.|
|[COleClientItem::GetCachedExtent](#getcachedextent)|Restituisce i limiti del rettangolo dell'elemento OLE.|
|[COleClientItem::GetClassID](#getclassid)|Ottiene l'ID della classe. dell'elemento presente|
|[COleClientItem::GetClipboardData](#getclipboarddata)|Ottiene i dati che verranno inseriti negli Appunti, chiamare il `CopyToClipboard` funzione membro.|
|[COleClientItem::GetDocument](#getdocument)|Restituisce il `COleDocument` oggetto che contiene l'elemento presenta.|
|[COleClientItem::GetDrawAspect](#getdrawaspect)|Ottiene la visualizzazione corrente dell'elemento per il rendering.|
|[COleClientItem::GetExtent](#getextent)|Restituisce i limiti del rettangolo dell'elemento OLE.|
|[COleClientItem::GetIconFromRegistry](#geticonfromregistry)|Recupera un handle per un'icona associato al server di un CLSID particolare.|
|[COleClientItem::GetIconicMetafile](#geticonicmetafile)|Ottiene il metafile utilizzato per disegnare l'icona dell'elemento.|
|[COleClientItem::GetInPlaceWindow](#getinplacewindow)|Restituisce un puntatore alla finestra di modifica sul posto dell'elemento.|
|[COleClientItem::GetItemState](#getitemstate)|Ottiene lo stato dell'elemento corrente.|
|[COleClientItem::GetLastStatus](#getlaststatus)|Restituisce lo stato dell'ultima operazione OLE.|
|[COleClientItem::GetLinkUpdateOptions](#getlinkupdateoptions)|Restituisce la modalità di aggiornamento per un elemento collegato (funzionalità avanzate).|
|[COleClientItem::GetType](#gettype)|Restituisce il tipo dell'elemento OLE (incorporato, collegato o statico).|
|[COleClientItem::GetUserType](#getusertype)|Ottiene una stringa che descrive il tipo di elemento.|
|[COleClientItem::IsInPlaceActive](#isinplaceactive)|Restituisce TRUE se l'elemento è attivo sul posto.|
|[COleClientItem::IsLinkUpToDate](#islinkuptodate)|Restituisce TRUE se un elemento collegato è aggiornato con il documento di origine.|
|[COleClientItem::IsModified](#ismodified)|Restituisce TRUE se l'elemento è stato modificato dall'ultimo salvato.|
|[COleClientItem::IsOpen](#isopen)|Restituisce TRUE se l'elemento è attualmente aperti nell'applicazione server.|
|[COleClientItem::IsRunning](#isrunning)|Restituisce TRUE se l'applicazione server dell'elemento è in esecuzione.|
|[COleClientItem::OnActivate](#onactivate)|Chiamato dal framework per notificare l'elemento che viene attivato.|
|[COleClientItem::OnActivateUI](#onactivateui)|Chiamato dal framework per notificare l'elemento che viene attivato e dovrebbe visualizzare la relativa interfaccia utente.|
|[COleClientItem::OnChange](#onchange)|Chiamato quando il server viene modificato l'elemento OLE. Implementazione necessaria.|
|[COleClientItem::OnDeactivate](#ondeactivate)|Chiamato dal framework quando un elemento viene disattivato.|
|[COleClientItem::OnDeactivateUI](#ondeactivateui)|Chiamato dal framework quando il server ha rimosso la relativa interfaccia utente sul posto.|
|[COleClientItem::OnGetClipboardData](#ongetclipboarddata)|Chiamato dal framework per ottenere i dati da copiare negli Appunti.|
|[COleClientItem::OnInsertMenus](#oninsertmenus)|Chiamata eseguita dal framework per creare un menu composto.|
|[COleClientItem::OnRemoveMenus](#onremovemenus)|Chiamata eseguita dal framework per rimuovere i menu del contenitore da un menu composto.|
|[COleClientItem::OnSetMenu](#onsetmenu)|Chiamato dal framework per installare e rimuovere un menu composto.|
|[COleClientItem::OnShowControlBars](#onshowcontrolbars)|Chiamato dal framework per mostrare e nascondere le barre di controllo.|
|[COleClientItem::OnUpdateFrameTitle](#onupdateframetitle)|Chiamato dal framework per aggiornare barra del titolo della finestra cornice.|
|[COleClientItem::ReactivateAndUndo](#reactivateandundo)|Riattiva l'elemento e Annulla l'ultima operazione di modifica sul posto.|
|[COleClientItem::Release](#release)|Rilascia la connessione a un elemento collegato oggetto OLE e lo chiude se era aperta. Non elimina definitivamente l'elemento client.|
|[COleClientItem::Reload](#reload)|Ricarica l'elemento dopo una chiamata a `ActivateAs`.|
|[COleClientItem::Run](#run)|Esegue l'applicazione associato all'elemento.|
|[COleClientItem::SetDrawAspect](#setdrawaspect)|Imposta visualizzazione corrente dell'elemento per il rendering.|
|[COleClientItem::SetExtent](#setextent)|Imposta il rettangolo di delimitazione dell'elemento OLE.|
|[COleClientItem::SetHostNames](#sethostnames)|Imposta i nomi sul server viene visualizzata quando si modifica l'elemento OLE.|
|[COleClientItem::SetIconicMetafile](#seticonicmetafile)|Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.|
|[COleClientItem::SetItemRects](#setitemrects)|Imposta rettangolo di delimitazione dell'elemento.|
|[COleClientItem::SetLinkUpdateOptions](#setlinkupdateoptions)|Imposta la modalità di aggiornamento per un elemento collegato (funzionalità avanzate).|
|[COleClientItem::SetPrintDevice](#setprintdevice)|Imposta il dispositivo di destinazione di stampa per questo elemento di client.|
|[COleClientItem::UpdateLink](#updatelink)|Aggiorna la cache di presentazione di un elemento.|

### <a name="protected-methods"></a>Metodi protetti

|Nome|Descrizione|
|----------|-----------------|
|[COleClientItem::CanActivate](#canactivate)|Chiamato dal framework per determinare se è consentita l'attivazione sul posto.|
|[COleClientItem::OnChangeItemPosition](#onchangeitemposition)|Chiamato dal framework quando cambia posizione di un elemento.|
|[COleClientItem::OnDeactivateAndUndo](#ondeactivateandundo)|Chiamato dal framework per annullare dopo l'attivazione.|
|[COleClientItem::OnDiscardUndoState](#ondiscardundostate)|Chiamato dal framework per rimuovere le informazioni sullo stato di annullamento dell'elemento.|
|[COleClientItem::OnGetClipRect](#ongetcliprect)|Chiamato dal framework per ottenere coordinate del rettangolo di ridimensionamento dell'elemento.|
|[COleClientItem::OnGetItemPosition](#ongetitemposition)|Chiamato dal framework per ottenere la posizione dell'elemento rispetto alla visualizzazione.|
|[COleClientItem::OnGetWindowContext](#ongetwindowcontext)|Chiamato dal framework quando un elemento è attivato sul posto.|
|[COleClientItem::OnScrollBy](#onscrollby)|Chiamato dal framework per scorrere l'elemento all'interno della visualizzazione.|
|[COleClientItem::OnShowItem](#onshowitem)|Chiamata eseguita dal framework per visualizzare l'elemento OLE.|

## <a name="remarks"></a>Note

Un elemento OLE rappresenta i dati, creati e gestiti da un'applicazione server, che può essere incorporata "senza problemi" in un documento in modo che venga visualizzato all'utente a un singolo documento. Il risultato è un "documento composito" costituito da un documento che lo contiene e l'elemento OLE.

Un elemento OLE può essere incorporato o collegato. Se è incorporato, i relativi dati vengono archiviati come parte del documento composito. Se è collegato, i dati viene archiviati come parte di un file separato creato dall'applicazione server e solo un collegamento a tale file viene archiviato nel documento composito. Tutti gli elementi OLE contengono informazioni che specificano l'applicazione server che deve essere chiamato per modificarli.

`COleClientItem` definisce diverse funzioni sottoponibili a override che vengono chiamate in risposta alle richieste dall'applicazione server. sui sottoponibili a override in genere fungono da notifiche. In questo modo l'applicazione server per informare il contenitore delle modifiche apportate dall'utente quando si modifica l'elemento OLE o per recuperare le informazioni necessarie durante la modifica.

`COleClientItem` può essere utilizzato con il [COleDocument](../../mfc/reference/coledocument-class.md), [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md), o [COleServerDoc](../../mfc/reference/coleserverdoc-class.md) classe. Per utilizzare `COleClientItem`, una classe derivata da esso e implementare il [OnChange](#onchange) funzione membro, che definisce come il contenitore risponde alle modifiche apportate all'elemento. Per supportare l'attivazione sul posto, eseguire l'override di [OnGetItemPosition](#ongetitemposition) funzione membro. Questa funzione fornisce informazioni sulla posizione dell'elemento OLE visualizzata.

Per altre informazioni sull'uso dell'interfaccia del contenitore, vedere gli articoli [contenitori: Implementazione di un contenitore](../../mfc/containers-implementing-a-container.md) e [attivazione](../../mfc/activation-cpp.md).

> [!NOTE]
>  il SDK di Windows fa riferimento a elementi collegati e incorporati come "oggetti" che fa riferimento a tipi di elementi come "classi". Questo riferimento viene utilizzato il termine "item" per distinguere l'entità OLE da oggetto C++ corrispondente e il termine "type" per distinguere la categoria OLE dalla classe C++.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CDocItem](../../mfc/reference/cdocitem-class.md)

`COleClientItem`

## <a name="requirements"></a>Requisiti

**Intestazione:** AFXOLE. h

##  <a name="activate"></a>  COleClientItem::Activate

Chiamare questa funzione per eseguire il verbo specificato anziché [DoVerb](#doverb) in modo da poter eseguire il proprio un'elaborazione quando viene generata un'eccezione.

```
void Activate(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametri

*nVerb*<br/>
Specifica il verbo da eseguire. Può essere uno dei seguenti:

|Value|Significato|Simbolo|
|-----------|-------------|------------|
|- 0|verbo primario|OLEIVERB_PRIMARY|
|- 1|Verbo secondario|(Nessuno)|
|- 1|Elemento visualizzato per la modifica|OLEIVERB_SHOW|
|- 2|Modifica elemento nella finestra separata|OLEIVERB_OPEN|
|- 3|Nascondere elementi|OLEIVERB_HIDE|

Il valore-1 è in genere un alias per un altro verbo. Se Apri modifica non è supportata, -2 ha lo stesso effetto di -1. Per i valori aggiuntivi, vedere [IOleObject:: DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) nel SDK di Windows.

*pView*<br/>
Puntatore alla finestra di visualizzazione del contenitore che contiene l'elemento OLE; viene utilizzato dall'applicazione server per l'attivazione sul posto. Questo parametro deve essere NULL se il contenitore non supporta l'attivazione sul posto.

*lpMsg*<br/>
Puntatore al messaggio che ha causato l'elemento da attivare.

### <a name="remarks"></a>Note

Se l'applicazione server è stata scritta usando la libreria Microsoft Foundation Class, questa funzione provoca la [OnDoVerb](../../mfc/reference/coleserveritem-class.md#ondoverb) funzione di membro del corrispondente `COleServerItem` oggetto da eseguire.

Se il verbo primario è modifica e cui viene specificato zero il *nVerb* parametro, l'applicazione server viene avviato per consentire l'elemento OLE da modificare. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo Open), il server viene avviato in una finestra separata e la modifica può essere eseguita non esiste. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore per il verbo primario nel *nVerb* parametro determina l'azione può richiedere all'utente. Tuttavia, se il server supporta solo un'azione, è necessario tale azione, indipendentemente da quale valore è espresso nel *nVerb* parametro.

Per altre informazioni, vedere [IOleObject:: DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) nel SDK di Windows.

##  <a name="activateas"></a>  COleClientItem::ActivateAs

Utilizza le funzionalità di conversione di oggetti OLE per attivare l'elemento come se fosse un elemento del tipo specificato da *clsidNew*.

```
virtual BOOL ActivateAs(
    LPCTSTR lpszUserType,
    REFCLSID clsidOld,
    REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametri

*lpszUserType*<br/>
Puntatore a una stringa che rappresenta il tipo di utente di destinazione, ad esempio "Documento di Word".

*clsidOld*<br/>
ID di un riferimento alla classe corrente dell'elemento. L'ID della classe deve rappresentare il tipo dell'oggetto effettivo, poiché archiviati, a meno che non si tratta di un collegamento. In tal caso, deve essere il CLSID dell'elemento a cui fa riferimento il collegamento. Il [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md) fornisce automaticamente l'ID di classe corretto per l'elemento.

*clsidNew*<br/>
Un riferimento all'ID classe di destinazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questo viene chiamato automaticamente da [COleConvertDialog::DoConvert](../../mfc/reference/coleconvertdialog-class.md#doconvert). Non viene in genere chiamato direttamente.

##  <a name="attachdataobject"></a>  COleClientItem::AttachDataObject

Chiamare questa funzione per inizializzare un [COleDataObject](../../mfc/reference/coledataobject-class.md) per l'accesso ai dati dell'elemento OLE.

```
void AttachDataObject(COleDataObject& rDataObject) const;
```

### <a name="parameters"></a>Parametri

*rDataObject*<br/>
Fare riferimento a un `COleDataObject` oggetto che verrà inizializzato per consentire l'accesso ai dati dell'elemento OLE.

##  <a name="canactivate"></a>  COleClientItem::CanActivate

Chiamato dal framework quando l'utente richiede l'attivazione sul posto dell'elemento OLE; valore restituito della funzione determina se è consentita l'attivazione sul posto.

```
virtual BOOL CanActivate();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se è consentita l'attivazione sul posto. in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita consente l'attivazione sul posto se il contenitore dispone di una finestra valida. Eseguire l'override di questa funzione per implementare una logica speciale per accettare o rifiutare la richiesta di attivazione. Ad esempio, una richiesta di attivazione può essere rifiutata se l'elemento OLE è troppo piccolo o non è attualmente visibile.

Per altre informazioni, vedere [IOleInPlaceSite::CanInPlaceActivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-caninplaceactivate) nel SDK di Windows.

##  <a name="cancreatefromdata"></a>  COleClientItem::CanCreateFromData

Controlla se un'applicazione contenitore può creare un oggetto incorporato il determinato `COleDataObject` oggetto.

```
static BOOL PASCAL CanCreateFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore per il [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui è possibile creare l'elemento OLE.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore può creare un oggetto incorporato di `COleDataObject` oggetto; in caso contrario 0.

### <a name="remarks"></a>Note

Il `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero dei dati in diversi formati dagli Appunti, mediante trascinamento della selezione o da un elemento OLE incorporato.

I contenitori possono utilizzare questa funzione per decidere di abilitare o disabilitare i comandi di modifica Incolla e modificare Incolla speciale.

Per altre informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="cancreatelinkfromdata"></a>  COleClientItem::CanCreateLinkFromData

Controlla se un'applicazione contenitore può creare un oggetto collegato dal determinato `COleDataObject` oggetto.

```
static BOOL PASCAL CanCreateLinkFromData(const COleDataObject* pDataObject);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore per il [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui è possibile creare l'elemento OLE.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il contenitore può creare un oggetto collegato dal `COleDataObject` oggetto.

### <a name="remarks"></a>Note

Il `COleDataObject` classe viene utilizzata nei trasferimenti di dati per il recupero dei dati in diversi formati dagli Appunti, mediante trascinamento della selezione o da un elemento OLE incorporato.

I contenitori possono utilizzare questa funzione per decidere di abilitare o disabilitare i comandi di modifica Incolla speciale e modificare Incolla collegamento.

Per altre informazioni, vedere l'articolo [oggetti dati e origini dati (OLE)](../../mfc/data-objects-and-data-sources-ole.md).

##  <a name="canpaste"></a>  COleClientItem::CanPaste

Chiamare questa funzione per vedere se un elemento OLE incorporato può essere incollato dagli Appunti.

```
static BOOL PASCAL CanPaste();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un elemento OLE incorporato può essere incollato dagli Appunti. in caso contrario 0.

### <a name="remarks"></a>Note

Per altre informazioni, vedere [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) e [OleQueryCreateFromData](/windows/desktop/api/ole2/nf-ole2-olequerycreatefromdata) nel SDK di Windows.

##  <a name="canpastelink"></a>  COleClientItem::CanPasteLink

Chiamare questa funzione per vedere se un elemento OLE collegato può essere incollato dagli Appunti.

```
static BOOL PASCAL CanPasteLink();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se un elemento OLE collegato può essere incollato dagli Appunti. in caso contrario 0.

### <a name="remarks"></a>Note

Per altre informazioni, vedere [OleGetClipboard](/windows/desktop/api/ole2/nf-ole2-olegetclipboard) e [OleQueryLinkFromData](/windows/desktop/api/ole2/nf-ole2-olequerylinkfromdata) nel SDK di Windows.

##  <a name="close"></a>  COleClientItem::Close

Chiamare questa funzione per modificare lo stato di un elemento OLE dallo stato di esecuzione allo stato caricato, vale a dire, caricato con il relativo gestore in memoria, ma con il server non è in esecuzione.

```
void Close(OLECLOSE dwCloseOption = OLECLOSE_SAVEIFDIRTY);
```

### <a name="parameters"></a>Parametri

*dwCloseOption*<br/>
Flag che specifica le condizioni dell'elemento OLE viene salvato quando tornerà allo stato caricato. Può avere uno dei valori seguenti:

- Elemento OLECLOSE_SAVEIFDIRTY salvare the OLE.

- OLECLOSE_NOSAVE non salvare l'elemento OLE.

- OLECLOSE_PROMPTSAVE richiedere all'utente se desidera salvare l'elemento OLE.

### <a name="remarks"></a>Note

Questa funzione non ha alcun effetto quando l'elemento OLE non è in esecuzione.

Per altre informazioni, vedere [IOleObject::Close](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-close) nel SDK di Windows.

##  <a name="coleclientitem"></a>  COleClientItem::COleClientItem

Costruisce un `COleClientItem` dell'oggetto e lo aggiunge alla raccolta del documento contenitore di elementi del documento, che crea solo l'oggetto di C++ e non esegue qualsiasi inizializzazione OLE.

```
COleClientItem(COleDocument* pContainerDoc = NULL);
```

### <a name="parameters"></a>Parametri

*pContainerDoc*<br/>
Puntatore al documento contenitore che conterrà questo elemento. Può trattarsi di qualsiasi [COleDocument](../../mfc/reference/coledocument-class.md) derivato.

### <a name="remarks"></a>Note

Se si passa un puntatore NULL, non viene eseguita alcuna aggiunta per il documento contenitore. È necessario chiamare esplicitamente [COleDocument::AddItem](../../mfc/reference/coledocument-class.md#additem).

Prima di usare l'elemento OLE, è necessario chiamare una delle funzioni membro creazione seguenti:

- [CreateFromClipboard](#createfromclipboard)

- [CreateFromData](#createfromdata)

- [CreateFromFile](#createfromfile)

- [CreateStaticFromClipboard](#createstaticfromclipboard)

- [CreateStaticFromData](#createstaticfromdata)

- [CreateLinkFromClipboard](#createlinkfromclipboard)

- [CreateLinkFromData](#createlinkfromdata)

- [CreateLinkFromFile](#createlinkfromfile)

- [CreateNewItem](#createnewitem)

- [CreateCloneFrom](#createclonefrom)

##  <a name="convertto"></a>  COleClientItem::ConvertTo

Chiamare questa funzione membro per convertire l'elemento nel tipo specificato da *clsidNew*.

```
virtual BOOL ConvertTo(REFCLSID clsidNew);
```

### <a name="parameters"></a>Parametri

*clsidNew*<br/>
L'ID di classe del tipo di destinazione.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questo viene chiamato automaticamente da [COleConvertDialog](../../mfc/reference/coleconvertdialog-class.md). Non è necessario chiamarlo direttamente.

##  <a name="copytoclipboard"></a>  COleClientItem::CopyToClipboard

Chiamare questa funzione per copiare negli Appunti l'elemento OLE.

```
void CopyToClipboard(BOOL bIncludeLink = FALSE);
```

### <a name="parameters"></a>Parametri

*bIncludeLink*<br/>
TRUE se le informazioni di collegamento devono essere copiate negli Appunti, consentendo un elemento collegato possono essere incollati; in caso contrario, FALSE.

### <a name="remarks"></a>Note

In genere, si chiama questa funzione durante la scrittura di gestori di messaggi per i comandi Copia o Taglia del menu Modifica. Se si desidera implementare i comandi Taglia o copia, è necessario implementare la selezione di elementi nell'applicazione contenitore.

Per altre informazioni, vedere [OleSetClipboard](/windows/desktop/api/ole2/nf-ole2-olesetclipboard) nel SDK di Windows.

##  <a name="createclonefrom"></a>  COleClientItem::CreateCloneFrom

Chiamare questa funzione per creare una copia dell'elemento OLE specificato.

```
BOOL CreateCloneFrom(const COleClientItem* pSrcItem);
```

### <a name="parameters"></a>Parametri

*pSrcItem*<br/>
Puntatore all'elemento OLE da duplicare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

La copia è identica all'elemento di origine. È possibile utilizzare questa funzione per supportare le operazioni di annullamento.

##  <a name="createfromclipboard"></a>  COleClientItem::CreateFromClipboard

Chiamare questa funzione per creare un elemento incorporato dal contenuto degli Appunti.

```
BOOL CreateFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione in genere chiamato dal gestore di messaggi per il comando Incolla del menu Modifica. (Il comando Incolla viene abilitato per il framework se la [CanPaste](#canpaste) funzione membro restituisce diverso da zero.)

Per altre informazioni, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createfromdata"></a>  COleClientItem::CreateFromData

Chiamare questa funzione per creare un elemento incorporato da un `COleDataObject` oggetto.

```
BOOL CreateFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore per il [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui è possibile creare l'elemento OLE.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Operazioni di trasferimento dei dati, ad esempio un'operazione Incolla dagli Appunti o operazioni di trascinamento e rilascio, forniscono `COleDataObject` gli oggetti che contiene le informazioni offerte da un'applicazione server. In genere viene utilizzato nell'override della [CView::OnDrop](../../mfc/reference/cview-class.md#ondrop).

Per altre informazioni, vedere [OleCreateFromData](/windows/desktop/api/ole2/nf-ole2-olecreatefromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createfromfile"></a>  COleClientItem::CreateFromFile

Chiamare questa funzione per creare un elemento OLE incorporato da un file.

```
BOOL CreateFromFile(
    LPCTSTR lpszFileName,
    REFCLSID clsid = CLSID_NULL,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*lpszFileName*<br/>
Puntatore al nome del file da cui è possibile creare l'elemento OLE.

*clsid*<br/>
Riservato per usi futuri.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questa funzione dalla [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem) se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il Create dal pulsante di File.

Per altre informazioni, vedere [OleCreateFromFile](/windows/desktop/api/ole/nf-ole-olecreatefromfile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createlinkfromclipboard"></a>  COleClientItem::CreateLinkFromClipboard

Chiamare questa funzione per creare un elemento collegato dal contenuto degli Appunti.

```
BOOL CreateLinkFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione in genere chiamato dal gestore di messaggi per il comando Incolla collegamento del menu Modifica. (Il comando Incolla collegamento è abilitato nell'implementazione predefinita del [COleDocument](../../mfc/reference/coledocument-class.md) se gli Appunti contengono un elemento OLE che può essere collegato a.)

Per altre informazioni, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createlinkfromdata"></a>  COleClientItem::CreateLinkFromData

Chiamare questa funzione per creare un elemento collegato da una `COleDataObject` oggetto.

```
BOOL CreateLinkFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore per il [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui è possibile creare l'elemento OLE.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Chiamare questo metodo durante un'operazione di rilascio quando l'utente indica che deve essere creato un collegamento. Può essere utilizzato anche per gestire il comando Incolla modifica. Viene chiamato dal framework nella `COleClientItem::CreateLinkFromClipboard` e nella [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando è stata selezionata l'opzione di collegamento.

Per altre informazioni, vedere [OleCreateLinkFromData](/windows/desktop/api/ole2/nf-ole2-olecreatelinkfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createlinkfromfile"></a>  COleClientItem::CreateLinkFromFile

Chiamare questa funzione per creare un elemento OLE collegato da un file.

```
BOOL CreateLinkFromFile(
    LPCTSTR lpszFileName,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*lpszFileName*<br/>
Puntatore al nome del file da cui è possibile creare l'elemento OLE.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando viene selezionato il Create dal pulsante File e viene selezionata la casella di controllo di collegamento, il framework chiama questa funzione. Viene richiamato [COleInsertDialog::CreateItem](../../mfc/reference/coleinsertdialog-class.md#createitem).

Per altre informazioni, vedere [OleCreateLinkToFile](/windows/desktop/api/ole2/nf-ole2-olecreatelinktofile), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createnewitem"></a>  COleClientItem::CreateNewItem

Chiamare questa funzione per creare un elemento incorporato; Questa funzione avvia l'applicazione server che consente all'utente creare l'elemento OLE.

```
BOOL CreateNewItem(
    REFCLSID clsid,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*clsid*<br/>
ID che identifica in modo univoco il tipo di elemento OLE da creare.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Il framework chiama questa funzione se l'utente sceglie OK nella finestra di dialogo Inserisci oggetto quando si seleziona il pulsante Crea nuovo.

Per altre informazioni, vedere [OleCreate](/windows/desktop/api/ole/nf-ole-olecreate), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createstaticfromclipboard"></a>  COleClientItem::CreateStaticFromClipboard

Chiamare questa funzione per creare un elemento statico dal contenuto degli Appunti.

```
BOOL CreateStaticFromClipboard(
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Un elemento statico contiene i dati della presentazione ma non i dati nativi. di conseguenza non può essere modificato. Chiamare questa funzione in genere se il [CreateFromClipboard](#createfromclipboard) membro funzione ha esito negativo.

Per altre informazioni, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="createstaticfromdata"></a>  COleClientItem::CreateStaticFromData

Chiamare questa funzione per creare un elemento statico da un `COleDataObject` oggetto.

```
BOOL CreateStaticFromData(
    COleDataObject* pDataObject,
    OLERENDER render = OLERENDER_DRAW,
    CLIPFORMAT cfFormat = 0,
    LPFORMATETC lpFormatEtc = NULL);
```

### <a name="parameters"></a>Parametri

*pDataObject*<br/>
Puntatore per il [COleDataObject](../../mfc/reference/coledataobject-class.md) oggetto da cui è possibile creare l'elemento OLE.

*render*<br/>
Flag che specifica come il server eseguirà il rendering dell'elemento OLE. Per i valori possibili, vedere [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender) nel SDK di Windows.

*cfFormat*<br/>
Specifica il formato di dati negli Appunti da memorizzare nella cache durante la creazione dell'elemento OLE.

*lpFormatEtc*<br/>
Puntatore a un [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) struttura usata se *eseguire il rendering* è OLERENDER_FORMAT o OLERENDER_DRAW. Specificare un valore per questo parametro solo se si desidera specificare le informazioni sul formato aggiuntive oltre il formato degli Appunti specificato da *cfFormat*. Se si omette questo parametro, vengono usati valori predefiniti per gli altri campi di `FORMATETC` struttura.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Un elemento statico contiene i dati della presentazione ma non i dati nativi. di conseguenza, non può essere modificato. Si tratta essenzialmente identico [CreateStaticFromClipboard](#createstaticfromclipboard) ad eccezione del fatto che sia possibile creare un elemento statico da un oggetto arbitrario `COleDataObject`, non solo dagli Appunti.

Usato nel [COlePasteSpecialDialog::CreateItem](../../mfc/reference/colepastespecialdialog-class.md#createitem) quando viene selezionato statico.

Per altre informazioni, vedere [OleCreateStaticFromData](/windows/desktop/api/ole2/nf-ole2-olecreatestaticfromdata), [OLERENDER](/windows/desktop/api/oleidl/ne-oleidl-tagolerender), e [FORMATETC](/windows/desktop/api/objidl/ns-objidl-tagformatetc) nel SDK di Windows.

##  <a name="deactivate"></a>  COleClientItem::Deactivate

Chiamare questa funzione per disattivare l'elemento OLE e liberare qualsiasi risorsa associata.

```
void Deactivate();
```

### <a name="remarks"></a>Note

In genere disattivare elemento OLE sul posto attivo quando l'utente fa clic sull'area client rientra nei limiti dell'elemento. Si noti che la disattivazione dell'elemento OLE eliminerà lo stato di annullamento, rendendo impossibile chiamare il [ReactivateAndUndo](#reactivateandundo) funzione membro.

Se l'applicazione supporta l'annullamento, non chiamare `Deactivate`; in alternativa, chiamare [DeactivateUI](#deactivateui).

Per altre informazioni, vedere [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) nel SDK di Windows.

##  <a name="deactivateui"></a>  COleClientItem::DeactivateUI

Chiamare questa funzione quando l'utente disattiva un elemento a cui è stato attivato sul posto.

```
void DeactivateUI();
```

### <a name="remarks"></a>Note

Questa funzione consente di ripristinare lo stato originale, se si nasconde tutti i menu e altri controlli che sono stati creati per l'attivazione sul posto dell'interfaccia utente dell'applicazione contenitore.

Questa funzione non consente di scaricare le informazioni sullo stato di annullamento per l'elemento. Che le informazioni vengono conservate in modo che [ReactivateAndUndo](#reactivateandundo) in un secondo momento può essere utilizzato per eseguire un comando di annullamento nell'applicazione server, nel caso in cui viene scelto il comando di annullamento del contenitore immediatamente dopo la disattivazione di elemento.

Per altre informazioni, vedere [IOleInPlaceObject::InPlaceDeactivate](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-inplacedeactivate) nel SDK di Windows.

##  <a name="delete"></a>  COleClientItem::Delete

Chiamare questa funzione per eliminare l'elemento OLE dal documento contenitore.

```
void Delete(BOOL bAutoDelete = TRUE);
```

### <a name="parameters"></a>Parametri

*bAutoDelete*<br/>
Specifica se l'elemento deve essere rimosso dal documento.

### <a name="remarks"></a>Note

Questa funzione chiama il [rilascio](#release) funzione membro, che a sua volta Elimina l'oggetto di C++ per l'elemento, in modo permanente la rimozione dell'elemento OLE dal documento. Se l'elemento OLE è incorporato, i dati nativi per l'elemento viene eliminati. Viene sempre chiusa un server in esecuzione. Pertanto, se l'elemento è un collegamento aperto, questa funzione lo chiuda.

##  <a name="dodragdrop"></a>  COleClientItem::DoDragDrop

Chiamare il `DoDragDrop` funzione membro per eseguire un'operazione di trascinamento e rilascio.

```
DROPEFFECT DoDragDrop(
    LPCRECT lpItemRect,
    CPoint ptOffset,
    BOOL bIncludeLink = FALSE,
    DWORD dwEffects = DROPEFFECT_COPY | DROPEFFECT_MOVE,
    LPCRECT lpRectStartDrag = NULL);
```

### <a name="parameters"></a>Parametri

*lpItemRect*<br/>
Rettangolo dell'elemento sullo schermo nelle coordinate del client (pixel).

*ptOffset*<br/>
L'offset dal *lpItemRect* in cui è stata la posizione del mouse al momento dell'operazione di trascinamento.

*bIncludeLink*<br/>
Impostare su TRUE se il collegamento dati devono essere copiati negli Appunti. Impostarla su FALSE se l'applicazione server non supporta i collegamenti.

*dwEffects*<br/>
Determina gli effetti che verranno consentiti dall'origine di trascinamento nell'operazione di trascinamento.

*lpRectStartDrag*<br/>
Puntatore al rettangolo che definisce dove viene avviato effettivamente il trascinamento. Per ulteriori informazioni, vedere la sezione Osservazioni successiva.

### <a name="return-value"></a>Valore restituito

Valore DROPEFFECT. Se è DROPEFFECT_MOVE, i dati originali devono essere rimossi.

### <a name="remarks"></a>Note

L'operazione di trascinamento e rilascio non verrà avviato immediatamente. È in attesa fino a quando il cursore del mouse lascia il rettangolo specificato da *lpRectStartDrag* o fino a quando un numero specificato di millisecondi trascorsi. Se *lpRectStartDrag* è NULL, le dimensioni del rettangolo sono 1 pixel.

L'intervallo di tempo viene specificato dall'impostazione della chiave del Registro di sistema. È possibile modificare l'intervallo di tempo chiamando [CWinApp::WriteProfileString](../../mfc/reference/cwinapp-class.md#writeprofilestring) oppure [CWinApp:: Writeprofileint](../../mfc/reference/cwinapp-class.md#writeprofileint). Se non si specifica l'intervallo di tempo, viene utilizzato un valore predefinito di 200 millisecondi. Ritarda ora di trascinamento viene archiviato come indicato di seguito:

- Ritarda ora di Windows NT trascinamento viene archiviato in HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\NT\CurrentVersion\IniFileMapping\win.ini\Windows\DragDelay.

- Ritarda ora di Windows 3.x trascinamento viene archiviato nel file WIN. File INI, la sezione [Windows}.

- Ritarda ora di Windows 95 o 98 trascinamento viene archiviato in una versione memorizzata nella cache di WIN. INI.

Per altre informazioni su come trascinare ritardo informazioni vengono archiviate nel Registro di sistema o di. File con estensione INI, vedere [WriteProfileString](/windows/desktop/api/winbase/nf-winbase-writeprofilestringa) nel SDK di Windows.

##  <a name="doverb"></a>  COleClientItem::DoVerb

Chiamare `DoVerb` per eseguire il verbo specificato.

```
virtual BOOL DoVerb(
    LONG nVerb,
    CView* pView,
    LPMSG lpMsg = NULL);
```

### <a name="parameters"></a>Parametri

*nVerb*<br/>
Specifica il verbo da eseguire. Può includere uno dei seguenti:

|Value|Significato|Simbolo|
|-----------|-------------|------------|
|- 0|verbo primario|OLEIVERB_PRIMARY|
|- 1|Verbo secondario|(Nessuno)|
|- 1|Elemento visualizzato per la modifica|OLEIVERB_SHOW|
|- 2|Modifica elemento nella finestra separata|OLEIVERB_OPEN|
|- 3|Nascondere elementi|OLEIVERB_HIDE|

Il valore-1 è in genere un alias per un altro verbo. Se Apri modifica non è supportata, -2 ha lo stesso effetto di -1. Per i valori aggiuntivi, vedere [IOleObject:: DoVerb](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-doverb) nel SDK di Windows.

*pView*<br/>
Puntatore alla finestra di visualizzazione. viene utilizzato dal server per l'attivazione sul posto. Questo parametro deve essere NULL se l'applicazione contenitore non consente l'attivazione sul posto.

*lpMsg*<br/>
Puntatore al messaggio che ha causato l'elemento da attivare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se il verbo è stato eseguito correttamente; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione chiama il [Activate](#activate) funzione membro per eseguire il verbo. Inoltre intercetta le eccezioni e visualizza una finestra di messaggio all'utente se genera un'eccezione.

Se il verbo primario è modifica e cui viene specificato zero il *nVerb* parametro, l'applicazione server viene avviato per consentire l'elemento OLE da modificare. Se l'applicazione contenitore supporta l'attivazione sul posto, la modifica può essere eseguita sul posto. Se il contenitore non supporta l'attivazione sul posto (o se viene specificato il verbo Open), il server viene avviato in una finestra separata e la modifica può essere eseguita non esiste. In genere, quando l'utente dell'applicazione contenitore fa doppio clic sull'elemento OLE, il valore per il verbo primario nel *nVerb* parametro determina l'azione può richiedere all'utente. Tuttavia, se il server supporta solo un'azione, è necessario tale azione, indipendentemente da quale valore è espresso nel *nVerb* parametro.

##  <a name="draw"></a>  COleClientItem::Draw

Chiamare questa funzione per disegnare l'elemento OLE nel rettangolo di delimitazione specificato utilizzando il contesto di dispositivo specificato.

```
BOOL Draw(
    CDC* pDC,
    LPCRECT lpBounds,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametri

*pDC*<br/>
Puntatore a un [CDC](../../mfc/reference/cdc-class.md) oggetto utilizzato per disegnare l'elemento OLE.

*lpBounds*<br/>
Puntatore a un [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o `RECT` struttura che definisce il rettangolo di delimitazione in cui disegnare l'elemento OLE (in unità logiche determinata dal contesto di dispositivo).

*nDrawAspect*<br/>
Specifica l'aspetto di OLE di elemento, vale a dire come deve essere visualizzato. Se *nDrawAspect* è -1, l'ultimo aspetto impostata tramite [SetDrawAspect](#setdrawaspect) viene usato. Per altre informazioni sui valori possibili per questo flag, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

La funzione potrebbe usare la rappresentazione del metafile dell'elemento OLE creata mediante il [OnDraw](../../mfc/reference/coleserveritem-class.md#ondraw) funzione membro di `COleServerItem`.

In genere si usa `Draw` per la visualizzazione su schermo, passando il contesto di dispositivo dello schermo come *pDC*. In questo caso, è necessario specificare solo i primi due parametri.

Il *lpBounds* parametro identifica il rettangolo nel contesto di dispositivo di destinazione (rispetto alla relativa modalità di mapping corrente). Il rendering può comportare il ridimensionamento dell'immagine e può essere utilizzato dalle applicazioni contenitore per imporre una vista che esegue il ridimensionamento tra la visualizzazione e l'immagine stampata finale.

Per altre informazioni, vedere [IViewObject](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw) nel SDK di Windows.

##  <a name="getactiveview"></a>  COleClientItem::GetActiveView

Restituisce la visualizzazione in cui l'elemento è attivato sul posto.

```
CView* GetActiveView() const;
```

### <a name="return-value"></a>Valore restituito

Un puntatore alla visualizzazione. in caso contrario, NULL se l'elemento non è attivato sul posto.

##  <a name="getcachedextent"></a>  COleClientItem::GetCachedExtent

Chiamare questa funzione per recuperare le dimensioni dell'elemento OLE.

```
BOOL GetCachedExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)-1);
```

### <a name="parameters"></a>Parametri

*lpSize*<br/>
Puntatore a un `SIZE` struttura o un' [CSize](../../atl-mfc-shared/reference/csize-class.md) oggetto che riceverà le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE cui limiti devono essere recuperate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo. 0 se l'elemento OLE è vuoto.

### <a name="remarks"></a>Note

Questa funzione fornisce le stesse informazioni [GetExtent](#getextent). Tuttavia, è possibile chiamare `GetCachedExtent` per ottenere informazioni di extent durante l'elaborazione di altri gestori OLE, ad esempio [OnChange](#onchange). Le dimensioni sono espressi in unità come MM_HIMETRIC.

Ciò è possibile perché `GetCachedExtent` Usa il [IViewObject2](/windows/desktop/api/oleidl/nn-oleidl-iviewobject2) interfaccia invece di usare i [IOleObject](/windows/desktop/api/oleidl/nn-oleidl-ioleobject) interfaccia per ottenere l'ambito di questo elemento. Il `IViewObject2` oggetto COM memorizza nella cache le informazioni di extent utilizzate nella chiamata precedente a [IViewObject](/windows/desktop/api/oleidl/nf-oleidl-iviewobject-draw).

Per altre informazioni, vedere [IViewObject2::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-iviewobject2-getextent) nel SDK di Windows.

##  <a name="getclassid"></a>  COleClientItem::GetClassID

Restituisce l'ID di classe dell'elemento nella memoria a cui punta *pClassID*.

```
void GetClassID(CLSID* pClassID) const;
```

### <a name="parameters"></a>Parametri

*pClassID*<br/>
Puntatore a un identificatore di tipo [CLSID](/windows/desktop/com/clsid-key-hklm) per recuperare l'ID della classe. Per informazioni su CLSID, vedere il SDK di Windows.

### <a name="remarks"></a>Note

L'ID della classe è un numero a 128 bit che identifica in modo univoco l'applicazione che consente di modificare l'elemento.

Per altre informazioni, vedere [IPersist:: GetClassID](/windows/desktop/api/objidl/nf-objidl-ipersist-getclassid) nel SDK di Windows.

##  <a name="getclipboarddata"></a>  COleClientItem::GetClipboardData

Chiamare questa funzione per ottenere un `COleDataSource` oggetto che contiene tutti i dati verranno inseriti negli Appunti da una chiamata per il [CopyToClipboard](#copytoclipboard) funzione membro.

```
void GetClipboardData(
    COleDataSource* pDataSource,
    BOOL bIncludeLink = FALSE,
    LPPOINT lpOffset = NULL,
    LPSIZE lpSize = NULL);
```

### <a name="parameters"></a>Parametri

*pDataSource*<br/>
Puntatore a un [COleDataSource](../../mfc/reference/coledatasource-class.md) oggetto che riceverà i dati contenuti nell'elemento OLE.

*bIncludeLink*<br/>
TRUE se i dati del collegamento devono essere inclusi. in caso contrario, FALSE.

*lpOffset*<br/>
L'offset del cursore del mouse rispetto all'origine dell'oggetto in pixel.

*lpSize*<br/>
Le dimensioni dell'oggetto in pixel.

### <a name="remarks"></a>Note

`GetClipboardData` viene chiamato come l'implementazione predefinita di [OnGetClipboardData](#ongetclipboarddata). Eseguire l'override `OnGetClipboardData` solo se si desidera offrire i formati di dati oltre a quelle offerte da `CopyToClipboard`. Inserire tali formati nella `COleDataSource` oggetto prima o dopo la chiamata `CopyToClipboard`e quindi passare il `COleDataSource` dell'oggetto per il [SetClipboard](../../mfc/reference/coledatasource-class.md#setclipboard) (funzione). Ad esempio, se si desidera che la posizione dell'elemento OLE nel documento relativo contenitore per lo accompagnano negli Appunti, si potrebbe definire il proprio formato per passare tali informazioni e posizionarlo nel `COleDataSource` prima di chiamare `CopyToClipboard`.

##  <a name="getdocument"></a>  COleClientItem::GetDocument

Chiamare questa funzione per ottenere un puntatore al documento che contiene l'elemento OLE.

```
COleDocument* GetDocument() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore al documento che contiene l'elemento OLE. NULL se l'elemento non fa parte di un documento.

### <a name="remarks"></a>Note

Puntatore ' this ' consente l'accesso alla `COleDocument` che è passato come argomento per il `COleClientItem` costruttore.

##  <a name="getdrawaspect"></a>  COleClientItem::GetDrawAspect

Chiamare il `GetDrawAspect` funzione membro per determinare la "aspetto" corrente, o la vista dell'elemento.

```
DVASPECT GetDrawAspect() const;
```

### <a name="return-value"></a>Valore restituito

Un valore ricavato dall'enumerazione DVASPECT, i cui valori sono elencati negli argomenti di riferimento per [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Note

L'aspetto specifica come l'elemento deve essere sottoposto a rendering.

##  <a name="getextent"></a>  COleClientItem::GetExtent

Chiamare questa funzione per recuperare le dimensioni dell'elemento OLE.

```
BOOL GetExtent(
    LPSIZE lpSize,
    DVASPECT nDrawAspect = (DVASPECT)- 1);
```

### <a name="parameters"></a>Parametri

*lpSize*<br/>
Puntatore a un `SIZE` struttura o un `CSize` oggetto che riceverà le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE cui limiti devono essere recuperate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo. 0 se l'elemento OLE è vuoto.

### <a name="remarks"></a>Note

Se l'applicazione server è stata scritta usando la libreria Microsoft Foundation Class, questa funzione provoca la [OnGetExtent](../../mfc/reference/coleserveritem-class.md#ongetextent) funzione di membro del corrispondente `COleServerItem` oggetto da chiamare. Si noti che le dimensioni recuperate possono variare rispetto alla dimensione dell'ultima impostazione il [SetExtent](#setextent) funzione membro; la dimensione specificata dal `SetExtent` viene considerato come un suggerimento. Le dimensioni sono espressi in unità come MM_HIMETRIC.

> [!NOTE]
>  Non chiamare `GetExtent` durante l'elaborazione di un gestore di OLE, ad esempio [OnChange](#onchange). Chiamare [GetCachedExtent](#getcachedextent) invece.

Per altre informazioni, vedere [IOleObject::GetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getextent) nel SDK di Windows.

##  <a name="geticonfromregistry"></a>  COleClientItem::GetIconFromRegistry

Chiamare questa funzione membro per recuperare un handle a una risorsa icona associata al server di un CLSID particolare.

```
HICON GetIconFromRegistry() const;

static HICON GetIconFromRegistry(CLSID& clsid);
```

### <a name="parameters"></a>Parametri

*clsid*<br/>
Un riferimento al CLSID per il server associato all'icona.

### <a name="return-value"></a>Valore restituito

Un valore valido handle per la risorsa icona oppure NULL se l'icona del server o un'icona predefinita, non è stata trovata.

### <a name="remarks"></a>Note

Questa funzione membro non avviare il server o ottenere un'icona in modo dinamico, anche se il server è già in esecuzione. Al contrario, questa funzione membro apre immagine eseguibile del server e recupera l'icona statico associato al server perché è stata registrata.

##  <a name="geticonicmetafile"></a>  COleClientItem::GetIconicMetafile

Recupera il metafile utilizzato per disegnare l'icona dell'elemento.

```
HGLOBAL GetIconicMetafile();
```

### <a name="return-value"></a>Valore restituito

Un handle del metafile se ha esito positivo. in caso contrario NULL.

### <a name="remarks"></a>Note

Se è presente alcuna icona corrente, viene restituita un'icona predefinita. Questo viene chiamato automaticamente dalle finestre di dialogo MFC/OLE e in genere non viene chiamato direttamente.

Questa funzione chiama inoltre [SetIconicMetafile](#seticonicmetafile) per memorizzare nella cache del metafile per un uso successivo.

##  <a name="getinplacewindow"></a>  COleClientItem::GetInPlaceWindow

Chiamare il `GetInPlaceWindow` funzione membro per ottenere un puntatore alla finestra in cui l'elemento è stato aperto per la modifica sul posto.

```
CWnd* GetInPlaceWindow();
```

### <a name="return-value"></a>Valore restituito

Puntatore alla finestra di modifica sul posto dell'elemento; NULL se l'elemento non è attivo o se il server non è disponibile.

### <a name="remarks"></a>Note

Questa funzione deve essere chiamata solo per gli elementi che sono sul posto attivo.

##  <a name="getitemstate"></a>  COleClientItem::GetItemState

Chiamare questa funzione per ottenere lo stato corrente dell'elemento OLE.

```
UINT GetItemState() const;
```

### <a name="return-value"></a>Valore restituito

Oggetto `COleClientItem::ItemState` enumerato valore, che può essere uno dei seguenti: `emptyState`, `loadedState`, `openState`, `activeState`, `activeUIState`. Per informazioni su questi stati, vedere l'articolo [contenitori: Stati elementi client](../../mfc/containers-client-item-states.md).

### <a name="remarks"></a>Note

Per essere notificato quando viene modificato lo stato dell'elemento OLE, utilizzare il [OnChange](#onchange) funzione membro.

Per altre informazioni, vedere l'articolo [contenitori: Stati elementi client](../../mfc/containers-client-item-states.md).

##  <a name="getlaststatus"></a>  COleClientItem::GetLastStatus

Restituisce il codice di stato dell'ultima operazione OLE.

```
SCODE GetLastStatus() const;
```

### <a name="return-value"></a>Valore restituito

Valore di un SCODE.

### <a name="remarks"></a>Note

Per le funzioni membro che restituiscono il valore booleano FALSE, o un altro membro funzioni che restituiscono NULL, `GetLastStatus` restituisce un errore informazioni più dettagliate. Tenere presente che la maggior parte delle funzioni di membro OLE generano eccezioni per gli errori più gravi. Le informazioni specifiche sull'interpretazione del SCODE dipendono la chiamata OLE sottostante che ultima ha restituito un valore SCODE.

Per altre informazioni su SCODE, vedere [Structure of COM Error Codes](/windows/desktop/com/structure-of-com-error-codes) nella documentazione di Windows SDK.

##  <a name="getlinkupdateoptions"></a>  COleClientItem::GetLinkUpdateOptions

Chiamare questa funzione per ottenere il valore corrente dell'opzione di aggiornamento di collegamento per l'elemento OLE.

```
OLEUPDATE GetLinkUpdateOptions();
```

### <a name="return-value"></a>Valore restituito

Uno dei valori seguenti:

- OLEUPDATE_ALWAYS aggiornare l'elemento collegato laddove possibile. Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento automatico nella finestra di dialogo collegamenti.

- OLEUPDATE_ONCALL aggiornare l'elemento collegato solo su richiesta da un'applicazione contenitore (quando il [UpdateLink](#updatelink) viene chiamata la funzione membro). Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento manuale nella finestra di dialogo collegamenti.

### <a name="remarks"></a>Note

Si tratta di un'operazione avanzata.

Questa funzione viene chiamata automaticamente dal [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) classe.

Per altre informazioni, vedere [IOleLink::GetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-getupdateoptions) nel SDK di Windows.

##  <a name="gettype"></a>  COleClientItem::GetType

Chiamare questa funzione per determinare se l'elemento OLE incorporato o collegato o static.

```
OLE_OBJTYPE GetType() const;
```

### <a name="return-value"></a>Valore restituito

Intero senza segno con uno dei valori seguenti:

- L'elemento OT_LINK The OLE è un collegamento.

- Elemento OT_EMBEDDED The OLE è incorporato.

- Elemento OT_STATIC The OLE è statico, vale a dire, contiene solo dati di presentazione, dati non nativo e pertanto non può essere modificato.

##  <a name="getusertype"></a>  COleClientItem::GetUserType

Chiamare questa funzione per ottenere la stringa visibile all'utente che descrive il tipo di un elemento OLE, ad esempio "Documento di Word".

```
void GetUserType(
    USERCLASSTYPE nUserClassType,
    CString& rString);
```

### <a name="parameters"></a>Parametri

*nUserClassType*<br/>
Un valore che indica alla variante desiderata della stringa che descrive il tipo dell'elemento OLE. Ciò può avere uno dei valori seguenti:

- USERCLASSTYPE_FULL la versione completa di digitare nome visualizzato all'utente.

- USERCLASSTYPE_SHORT un nome breve (massimo 15 caratteri) per l'utilizzo nella finestra di dialogo Modifica collegamenti e i menu a comparsa.

- Nome USERCLASSTYPE_APPNAME dell'applicazione per la manutenzione della classe.

*rString*<br/>
Un riferimento a un [CString](../../atl-mfc-shared/reference/cstringt-class.md) oggetto a cui deve essere restituita la stringa che descrive il tipo dell'elemento OLE.

### <a name="remarks"></a>Note

Si tratta spesso della voce nel database di registrazione del sistema.

Se il nome completo del tipo è richiesto ma non è disponibile, viene utilizzato il nome breve. Se viene trovata alcuna voce per il tipo di elemento OLE nel database di registrazione o se non sono disponibili tipi di utente registrati per il tipo di elemento OLE, quindi il tipo di utente attualmente archiviato in viene utilizzato l'elemento OLE. Se tale nome di tipo utente è una stringa vuota, viene usato "Oggetto sconosciuto".

Per altre informazioni, vedere [IOleObject::GetUserType](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-getusertype) nel SDK di Windows.

##  <a name="isinplaceactive"></a>  COleClientItem::IsInPlaceActive

Chiamare questa funzione per determinare se l'elemento OLE è attivo sul posto.

```
BOOL IsInPlaceActive() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE sul posto attivo; in caso contrario 0.

### <a name="remarks"></a>Note

È comune per eseguire una logica diversa a seconda del fatto che l'elemento è viene modificata sul posto. La funzione controlla se lo stato dell'elemento corrente è uguale a uno il `activeState` o il `activeUIState`.

##  <a name="islinkuptodate"></a>  COleClientItem::IsLinkUpToDate

Chiamare questa funzione per determinare se l'elemento OLE è aggiornato.

```
BOOL IsLinkUpToDate() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE viene aggiornato. in caso contrario 0.

### <a name="remarks"></a>Note

Un elemento collegato può essere aggiornato se il documento di origine è stato aggiornato. Un elemento incorporato che contiene i collegamenti all'interno di esso in modo analogo può diventare obsoleto. La funzione esegue un controllo ricorsivo dell'elemento OLE. Si noti che determina se un elemento OLE è aggiornato può essere più costosa di quella effettivamente eseguendo un aggiornamento.

Questo viene chiamato automaticamente dal [COleLinksDialog](../../mfc/reference/colelinksdialog-class.md) implementazione.

Per altre informazioni, vedere [IOleObject::IsUpToDate](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-isuptodate) nel SDK di Windows.

##  <a name="ismodified"></a>  COleClientItem::IsModified

Chiamare questa funzione per determinare se l'elemento OLE è dirty (modificata dall'ultimo salvataggio).

```
BOOL IsModified() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è dirty; in caso contrario 0.

### <a name="remarks"></a>Note

Per altre informazioni, vedere [IPersistStorage::IsDirty](/windows/desktop/api/objidl/nf-objidl-ipersiststorage-isdirty) nel SDK di Windows.

##  <a name="isopen"></a>  COleClientItem::IsOpen

Chiamare questa funzione per vedere se l'elemento OLE è aperta; vale a dire, aperto in un'istanza dell'applicazione server in esecuzione in una finestra separata.

```
BOOL IsOpen() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è aperto; in caso contrario 0.

### <a name="remarks"></a>Note

Viene utilizzato per determinare quando disegnare l'oggetto con un motivo di tratteggio. Un oggetto aperto deve avere un motivo a tratteggio disegnato sopra l'oggetto. È possibile usare una [CRectTracker](../../mfc/reference/crecttracker-class.md) oggetto per eseguire questa operazione.

##  <a name="isrunning"></a>  COleClientItem::IsRunning

Chiamare questa funzione per vedere se l'elemento OLE è in esecuzione; ovvero, se l'elemento è caricato e in esecuzione nell'applicazione server.

```
BOOL IsRunning() const;
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento OLE è in esecuzione. in caso contrario 0.

### <a name="remarks"></a>Note

Per altre informazioni, vedere [OleIsRunning](/windows/desktop/api/ole2/nf-ole2-oleisrunning) nel SDK di Windows.

##  <a name="onactivate"></a>  COleClientItem::OnActivate

Chiamato dal framework per notificare l'elemento che è stato attivato solo posto.

```
virtual void OnActivate();
```

### <a name="remarks"></a>Note

Si noti che questa funzione viene chiamata per indicare che il server sia in esecuzione, non per indicare che la relativa interfaccia utente sia stato installato in un'applicazione contenitore. A questo punto, l'oggetto non ha un'interfaccia utente attivo (non `activeUIState`). Non è installato il menu o sulla barra degli strumenti. Il [OnActivateUI](#onactivateui) funzione membro viene chiamata in questo caso.

L'implementazione predefinita chiama il [OnChange](#onchange) funzione membro con OLE_CHANGEDSTATE come parametro. Eseguire l'override di questa funzione per eseguire elaborazioni personalizzate quando un elemento diventa attivo sul posto.

##  <a name="onactivateui"></a>  COleClientItem::OnActivateUI

Il framework chiama `OnActivateUI` quando l'oggetto è diventata attiva dell'interfaccia utente.

```
virtual void OnActivateUI();
```

### <a name="remarks"></a>Note

L'oggetto è ora installato relativa barra degli strumenti e menu.

L'implementazione predefinita ricorda HWND del server per usarlo in seguito `GetServerWindow` chiamate.

##  <a name="onchange"></a>  COleClientItem:: OnChange

Chiamato dal framework quando l'utente modifica, Salva o chiude l'elemento OLE.

```
virtual void OnChange(
    OLE_NOTIFICATION nCode,
    DWORD dwParam);
```

### <a name="parameters"></a>Parametri

*nCode*<br/>
Il motivo per il server modificato questo elemento. Può avere uno dei valori seguenti:

- OLE_CHANGED The OLE dell'aspetto dell'elemento è stato modificato.

- Elemento OLE_SAVED The OLE è stato salvato.

- Elemento OLE_CLOSED The OLE è stato chiuso.

- Elemento OLE_CHANGED_STATE The OLE è stato modificato da uno stato a altro.

*dwParam*<br/>
Se *nCode* è OLE_SAVED o OLE_CLOSED, questo parametro non viene utilizzato. Se *nCode* è OLE_CHANGED, questo parametro specifica l'aspetto dell'elemento OLE che è stato modificato. Per i valori possibili, vedere la *dwParam* del parametro [COleClientItem::Draw](#draw). Se *nCode* è OLE_CHANGED_STATE, questo parametro è un `COleClientItem::ItemState` valore enumerato e viene descritto lo stato venga immesso. Può avere uno dei seguenti valori: `emptyState`, `loadedState`, `openState`, `activeState`, o `activeUIState`.

### <a name="remarks"></a>Note

(Se l'applicazione server viene scritto usando la libreria Microsoft Foundation Class, questa funzione viene chiamata in risposta al `Notify` dalle funzioni membro di `COleServerDoc` o `COleServerItem`.) L'implementazione predefinita Contrassegna il documento contenitore come modificato se *nCode* è OLE_CHANGED o OLE_SAVED.

Per OLE_CHANGED_STATE, lo stato attuale restituito dalla [GetItemState](#getitemstate) continuerà a essere stato precedente, vale a dire lo stato corrente prima di questa modifica di stato.

Eseguire l'override di questa funzione per rispondere alle modifiche in stato di un elemento OLE. In genere si aggiorna l'aspetto dell'elemento da invalidare l'area in cui l'elemento viene visualizzato. Chiamare l'implementazione della classe base all'inizio della sostituzione.

##  <a name="onchangeitemposition"></a>  COleClientItem::OnChangeItemPosition

Chiamato dal framework per notificare al contenitore il cui ambito di un elemento OLE è stato modificato durante l'attivazione sul posto.

```
virtual BOOL OnChangeItemPosition(const CRect& rectPos);
```

### <a name="parameters"></a>Parametri

*rectPos*<br/>
Indica la posizione dell'elemento rispetto all'area client dell'applicazione contenitore.

### <a name="return-value"></a>Valore restituito

Diverso da zero se viene modificata la posizione dell'elemento; in caso contrario 0.

### <a name="remarks"></a>Note

L'implementazione predefinita determina il nuovo rettangolo visibile dell'elemento OLE e le chiamate [SetItemRects](#setitemrects) con i nuovi valori. L'implementazione predefinita consente di calcolare il rettangolo visibile per l'elemento e passa le informazioni al server.

Eseguire l'override di questa funzione per applicare le regole speciali per l'operazione di ridimensionamento o spostamento. Se l'applicazione viene scritta in MFC, questa chiamata risultati perché il server denominato [COleServerDoc::RequestPositionChange](../../mfc/reference/coleserverdoc-class.md#requestpositionchange).

##  <a name="ondeactivate"></a>  COleClientItem::OnDeactivate

Chiamato dal framework quando l'elemento OLE esegue la transizione dallo stato attivo sul posto ( `activeState`) allo stato caricato, vale a dire che viene disattivato dopo l'attivazione sul posto.

```
virtual void OnDeactivate();
```

### <a name="remarks"></a>Note

Si noti che questa funzione viene chiamata per indicare che l'elemento OLE viene chiuso, non che la relativa interfaccia utente è stato rimosso da un'applicazione contenitore. In questo caso, il [OnDeactivateUI](#ondeactivateui) viene chiamata la funzione membro.

L'implementazione predefinita chiama il [OnChange](#onchange) funzione membro con OLE_CHANGEDSTATE come parametro. Eseguire l'override di questa funzione per eseguire elaborazioni personalizzate quando viene disattivato un articolo attivo sul posto. Ad esempio, se si supporta il comando di annullamento nell'applicazione contenitore, è possibile sostituire questa funzione per rimuovere lo stato di annullamento, che indica che l'ultima operazione eseguita sull'elemento OLE non può essere annullata dopo l'elemento viene disattivato.

##  <a name="ondeactivateandundo"></a>  COleClientItem::OnDeactivateAndUndo

Chiamato dal framework quando l'utente richiama il comando Annulla dopo aver attivato l'elemento OLE in posizione.

```
virtual void OnDeactivateAndUndo();
```

### <a name="remarks"></a>Note

L'implementazione predefinita chiama [DeactivateUI](#deactivateui) di disattivazione dell'interfaccia utente del server. Eseguire l'override di questa funzione se si sta implementando il comando di annullamento nell'applicazione contenitore. Nell'override, chiamare la versione della classe base della funzione e quindi annullare l'ultimo comando eseguito nell'applicazione.

Per altre informazioni, vedere [IOleInPlaceSite::DeactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-deactivateandundo) nel SDK di Windows.

##  <a name="ondeactivateui"></a>  COleClientItem::OnDeactivateUI

Chiamato quando l'utente disattiva un elemento che è stato attivato sul posto.

```
virtual void OnDeactivateUI(BOOL bUndoable);
```

### <a name="parameters"></a>Parametri

*bUndoable*<br/>
Specifica se le modifiche sono annullabili.

### <a name="remarks"></a>Note

Questa funzione consente di ripristinare lo stato originale, se si nasconde tutti i menu e altri controlli che sono stati creati per l'attivazione sul posto dell'interfaccia utente dell'applicazione contenitore.

Se *bUndoable* è FALSE, il contenitore è necessario disabilitare il comando di annullamento, attiva ignorando lo stato di annullamento del contenitore, perché indica che l'ultima operazione eseguita dal server non è annullabile.

##  <a name="ondiscardundostate"></a>  COleClientItem::OnDiscardUndoState

Chiamato dal framework quando l'utente esegue un'azione che rimuove lo stato di annullamento durante la modifica dell'elemento OLE.

```
virtual void OnDiscardUndoState();
```

### <a name="remarks"></a>Note

L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione se si sta implementando il comando di annullamento nell'applicazione contenitore. Nell'override, eliminare lo stato di annullamento dell'applicazione contenitore.

Se il server è stato scritto con la libreria Microsoft Foundation Class, il server può causare questa funzione da chiamare chiamando [COleServerDoc::DiscardUndoState](../../mfc/reference/coleserverdoc-class.md#discardundostate).

Per altre informazioni, vedere [IOleInPlaceSite::DiscardUndoState](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-discardundostate) nel SDK di Windows.

##  <a name="ongetclipboarddata"></a>  COleClientItem::OnGetClipboardData

Chiamato dal framework per ottenere un `COleDataSource` oggetto che contiene tutti i dati verranno inseriti negli Appunti da una chiamata a uno il [CopyToClipboard](#copytoclipboard) o il [DoDragDrop](#dodragdrop) funzione membro.

```
virtual COleDataSource* OnGetClipboardData(
    BOOL bIncludeLink,
    LPPOINT lpOffset,
    LPSIZE lpSize);
```

### <a name="parameters"></a>Parametri

*bIncludeLink*<br/>
Impostare questa proprietà su TRUE se i dati di collegamento devono essere copiati negli Appunti. Impostare questa proprietà su FALSE se il server dell'applicazione non supporta i collegamenti.

*lpOffset*<br/>
Puntatore all'offset del cursore del mouse rispetto all'origine dell'oggetto in pixel.

*lpSize*<br/>
Puntatore alla dimensione dell'oggetto in pixel.

### <a name="return-value"></a>Valore restituito

Un puntatore a un [COleDataSource](../../mfc/reference/coledatasource-class.md) oggetto che contiene i dati negli Appunti.

### <a name="remarks"></a>Note

L'implementazione predefinita di questa funzione chiama [GetClipboardData](#getclipboarddata).

##  <a name="ongetcliprect"></a>  COleClientItem::OnGetClipRect

Il framework chiama il `OnGetClipRect` funzione membro per ottenere le coordinate del rettangolo di ridimensionamento dell'elemento che viene modificato sul posto.

```
virtual void OnGetClipRect(CRect& rClipRect);
```

### <a name="parameters"></a>Parametri

*rClipRect*<br/>
Puntatore a un oggetto della classe [CRect](../../atl-mfc-shared/reference/crect-class.md) che conterrà le coordinate del rettangolo di ridimensionamento dell'elemento.

### <a name="remarks"></a>Note

Le coordinate sono espresse in pixel rispetto all'area client della finestra dell'applicazione contenitore.

L'implementazione predefinita restituisce semplicemente il rettangolo client della vista in cui l'elemento è attivo sul posto.

##  <a name="ongetitemposition"></a>  COleClientItem::OnGetItemPosition

Il framework chiama il `OnGetItemPosition` funzione membro per ottenere le coordinate dell'elemento che viene modificato in posizione.

```
virtual void OnGetItemPosition(CRect& rPosition);
```

### <a name="parameters"></a>Parametri

*rPosition*<br/>
Riferimento per la [CRect](../../atl-mfc-shared/reference/crect-class.md) che conterrà le coordinate della posizione dell'elemento.

### <a name="remarks"></a>Note

Le coordinate sono espresse in pixel rispetto all'area client della finestra dell'applicazione contenitore.

L'implementazione predefinita di questa funzione non esegue alcuna operazione. Le applicazioni che supportano la modifica sul posto richiedono l'implementazione.

##  <a name="ongetwindowcontext"></a>  COleClientItem::OnGetWindowContext

Chiamato dal framework quando un elemento è attivato sul posto.

```
virtual BOOL OnGetWindowContext(
    CFrameWnd** ppMainFrame,
    CFrameWnd** ppDocFrame,
    LPOLEINPLACEFRAMEINFO lpFrameInfo);
```

### <a name="parameters"></a>Parametri

*ppMainFrame*<br/>
Puntatore a un puntatore alla finestra cornice principale.

*ppDocFrame*<br/>
Puntatore a un puntatore alla finestra cornice del documento.

*lpFrameInfo*<br/>
Puntatore a un [oleinplaceframeinfo che](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struttura che riceverà le informazioni sulla finestra cornice.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione viene utilizzata per recuperare le informazioni sulla finestra padre dell'elemento OLE.

Se il contenitore è un'applicazione MDI, l'implementazione predefinita restituisce un puntatore per il [CMDIFrameWnd](../../mfc/reference/cmdiframewnd-class.md) dell'oggetto *ppMainFrame* e un puntatore a attivo [CMDIChildWnd](../../mfc/reference/cmdichildwnd-class.md)dell'oggetto *ppDocFrame*. Se il contenitore è un'applicazione SDI, l'implementazione predefinita restituisce un puntatore per il [CFrameWnd](../../mfc/reference/cframewnd-class.md) dell'oggetto *ppMainFrame* e restituisce NULL nel *ppDocFrame*. L'implementazione predefinita viene compilato anche i membri del *lpFrameInfo*.

Eseguire l'override di questa funzione solo se l'implementazione predefinita non in base all'applicazione; ad esempio, se l'applicazione presenta un paradigma dell'interfaccia utente che è diverso da SDI o MDI. Si tratta di un'avanzata sottoponibile a override.

Per altre informazioni, vedere [IOleInPlaceSite::GetWindowContext](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-getwindowcontext) e il [oleinplaceframeinfo che](/windows/desktop/api/oleidl/ns-oleidl-tagoifi) struttura nel SDK di Windows.

##  <a name="oninsertmenus"></a>  COleClientItem::OnInsertMenus

Chiamato dal framework durante l'attivazione sul posto per inserire i menu dell'applicazione contenitore in un menu vuoto.

```
virtual void OnInsertMenus(
    CMenu* pMenuShared,
    LPOLEMENUGROUPWIDTHS lpMenuWidths);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Punta a un menu vuoto.

*lpMenuWidths*<br/>
Punta a una matrice di sei valori LONG che indica quanti i menu sono ognuno dei gruppi di menu seguenti: File, modificare, contenitore, oggetto, finestra della Guida in linea. L'applicazione del contenitore è responsabile per i gruppi di menu File, il contenitore e finestra, corrispondenti agli elementi, 0, 2 e 4 di questa matrice.

### <a name="remarks"></a>Note

Questo menu viene quindi passato al server, che inserisce un proprio menu, creazione di un menu composto. Questa funzione può essere chiamata più volte per creare vari menu composti.

L'implementazione predefinita inserisce *pMenuShared* i menu del contenitore in locale, vale a dire i gruppi di menu File, il contenitore e finestra. [CDocTemplate:: SetContainerInfo](../../mfc/reference/cdoctemplate-class.md#setcontainerinfo) consente di impostare questa risorsa di menu. L'implementazione predefinita assegna inoltre i valori appropriati per gli elementi, 0, 2 e 4 nella *lpMenuWidths*, a seconda della risorsa di menu. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. ad esempio, se l'applicazione non usa i modelli di documento per l'associazione di risorse con i tipi di documento. Se si esegue l'override di questa funzione, è consigliabile anche eseguire l'override [OnSetMenu](#onsetmenu) e [OnRemoveMenus](#onremovemenus). Si tratta di un'avanzata sottoponibile a override.

Per altre informazioni, vedere [IOleInPlaceFrame:: InsertMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-insertmenus) nel SDK di Windows.

##  <a name="onremovemenus"></a>  COleClientItem::OnRemoveMenus

Chiamato dal framework per rimuovere i menu del contenitore dal menu composto specificato al termine dell'attivazione sul posto.

```
virtual void OnRemoveMenus(CMenu* pMenuShared);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Punta al menu composto costruito dalle chiamate al [OnInsertMenus](#oninsertmenus) funzione membro.

### <a name="remarks"></a>Note

L'implementazione predefinita rimuove *pMenuShared* i menu contenitori sul posto, ovvero, i gruppi di menu File, il contenitore e finestra. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. ad esempio, se l'applicazione non usa i modelli di documento per l'associazione di risorse con i tipi di documento. Se si esegue l'override di questa funzione, è necessario sostituire probabilmente [OnInsertMenus](#oninsertmenus) e [OnSetMenu](#onsetmenu) anche. Si tratta di un'avanzata sottoponibile a override.

I sottomenu nel *pMenuShared* potrebbe essere condivisa da più di un menu composto se il server ha chiamato ripetutamente `OnInsertMenus`. Di conseguenza non è necessario eliminare eventuali sottomenu nell'override della `OnRemoveMenus`; è solo necessario scollegarli.

Per altre informazioni, vedere [IOleInPlaceFrame::RemoveMenus](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-removemenus) nel SDK di Windows.

##  <a name="onscrollby"></a>  COleClientItem::OnScrollBy

Chiamato dal framework per scorrere l'elemento OLE in risposta alle richieste dal server.

```
virtual BOOL OnScrollBy(CSize sizeExtent);
```

### <a name="parameters"></a>Parametri

*sizeExtent*<br/>
Specifica le distanze, in pixel, per scorrere le direzioni x e y.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento è stato eseguito lo scorrimento; 0 se non è possibile scorrere l'elemento.

### <a name="remarks"></a>Note

Ad esempio, se l'elemento OLE è parzialmente visibile e l'utente viene spostato all'esterno dell'area visibile durante l'esecuzione di modifica sul posto, questa funzione viene chiamata per mantenere visibile il cursore. L'implementazione predefinita non esegue alcuna operazione. Eseguire l'override di questa funzione per scorrere l'elemento di base al valore specificato. Si noti che in seguito a scorrimento, può modificare la parte visibile dell'elemento OLE. Chiamare [SetItemRects](#setitemrects) aggiornare rettangolo visibile dell'elemento.

Per altre informazioni, vedere [IOleInPlaceSite::Scroll](/windows/desktop/api/oleidl/nf-oleidl-ioleinplacesite-scroll) nel SDK di Windows.

##  <a name="onsetmenu"></a>  COleClientItem::OnSetMenu

Chiamato dal framework due volte durante l'attivazione sul posto inizia e finisce; la prima volta per installare il menu composto e la seconda volta (con *holemenu* uguale a NULL) per rimuoverlo.

```
virtual void OnSetMenu(
    CMenu* pMenuShared,
    HOLEMENU holemenu,
    HWND hwndActiveObject);
```

### <a name="parameters"></a>Parametri

*pMenuShared*<br/>
Puntatore al menu composto costruito dalle chiamate al [OnInsertMenus](#oninsertmenus) funzione membro e il `InsertMenu` (funzione).

*holemenu*<br/>
Handle per il descrittore di menu restituito dai `OleCreateMenuDescriptor` funzione oppure NULL se il codice di invio deve essere rimosso.

*hwndActiveObject*<br/>
Handle della finestra di modifica per l'elemento OLE. Questa è la finestra che riceverà i comandi di modifica da OLE.

### <a name="remarks"></a>Note

L'implementazione predefinita installa o rimuove il menu composto e quindi chiama il [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor) (funzione) per installare o rimuovere il codice di invio. Eseguire l'override di questa funzione se l'implementazione predefinita non è appropriato per l'applicazione. Se si esegue l'override di questa funzione, è necessario sostituire probabilmente [OnInsertMenus](#oninsertmenus) e [OnRemoveMenus](#onremovemenus) anche. Si tratta di un'avanzata sottoponibile a override.

Per altre informazioni, vedere [OleCreateMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olecreatemenudescriptor), [OleSetMenuDescriptor](/windows/desktop/api/ole2/nf-ole2-olesetmenudescriptor), e [SetMenu](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceframe-setmenu) nel SDK di Windows.

##  <a name="onshowcontrolbars"></a>  COleClientItem::OnShowControlBars

Chiamato dal framework per mostrare e nascondere le barre di controllo dell'applicazione contenitore.

```
virtual BOOL OnShowControlBars(
    CFrameWnd* pFrameWnd,
    BOOL bShow);
```

### <a name="parameters"></a>Parametri

*pFrameWnd*<br/>
Puntatore alla finestra cornice dell'applicazione contenitore. Può trattarsi di una finestra cornice principale o una finestra figlio MDI.

*bShow*<br/>
Specifica se le barre di controllo devono essere mostrati o nascosti.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la chiamata di funzione causa una modifica nello stato le barre di controllo; 0 se la chiamata non comporta alcuna modifica o se *pFrameWnd* non fa riferimento alla finestra cornice del contenitore.

### <a name="remarks"></a>Note

Questa funzione restituisce 0 se le barre di controllo sono già nello stato specificato da *bMostra.* Questa situazione si verifica, ad esempio, se le barre di controllo sono nascosti e *bMostra* è FALSE.

L'implementazione predefinita consente di rimuovere la barra degli strumenti nella finestra del frame di primo livello.

##  <a name="onshowitem"></a>  COleClientItem::OnShowItem

Chiamata eseguita dal framework per visualizzare l'elemento OLE, renderlo completamente visibile durante la modifica.

```
virtual void OnShowItem();
```

### <a name="remarks"></a>Note

Viene utilizzato quando l'applicazione contenitore supporta collegamenti a elementi incorporati (ovvero, se è stata derivata la classe del documento dal [COleLinkingDoc](../../mfc/reference/colelinkingdoc-class.md)). Questa funzione viene chiamata durante l'attivazione sul posto o quando l'elemento OLE è un'origine di collegamento e l'utente desidera modificarlo. L'implementazione predefinita attiva la prima visualizzazione del documento contenitore. Eseguire l'override di questa funzione per scorrere il documento in modo che l'elemento OLE è visibile.

##  <a name="onupdateframetitle"></a>  COleClientItem::OnUpdateFrameTitle

Chiamato dal framework durante l'attivazione sul posto per aggiornare barra del titolo della finestra cornice.

```
virtual BOOL OnUpdateFrameTitle();
```

### <a name="return-value"></a>Valore restituito

Funzione diverso da zero se l'oggetto è stato aggiornato il titolo del frame, in caso contrario, zero.

### <a name="remarks"></a>Note

L'implementazione predefinita non modifica il titolo della finestra cornice. Eseguire l'override di questa funzione se si desidera che un titolo di un frame diversa per l'applicazione, ad esempio " *app server* - *elemento* nella *NomeMedico*" (ad esempio, "Microsoft Excel - foglio di calcolo nel REPORT. DOC"). Si tratta di un'avanzata sottoponibile a override.

##  <a name="reactivateandundo"></a>  COleClientItem::ReactivateAndUndo

Chiamare questa funzione per riattivare l'elemento OLE e annullare l'ultima operazione eseguita dall'utente durante la modifica sul posto.

```
BOOL ReactivateAndUndo();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Se l'applicazione contenitore supporta il comando di annullamento, chiamare questa funzione se l'utente sceglie il comando Annulla immediatamente dopo la disattivazione dell'elemento OLE.

Se l'applicazione server viene scritto con le librerie di classi Microsoft Foundation, questa funzione, il server chiamare [COleServerDoc::OnReactivateAndUndo](../../mfc/reference/coleserverdoc-class.md#onreactivateandundo).

Per altre informazioni, vedere [IOleInPlaceObject::ReactivateAndUndo](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-reactivateandundo) nel SDK di Windows.

##  <a name="release"></a>  COleClientItem::Release

Chiamare questa funzione per pulire le risorse usate dall'elemento OLE.

```
virtual void Release(OLECLOSE dwCloseOption = OLECLOSE_NOSAVE);
```

### <a name="parameters"></a>Parametri

*dwCloseOption*<br/>
Flag che specifica le condizioni dell'elemento OLE viene salvato quando tornerà allo stato caricato. Per un elenco di valori possibili, vedere [COleClientItem::Close](#close).

### <a name="remarks"></a>Note

`Release` viene chiamato dal `COleClientItem` distruttore.

Per altre informazioni, vedere [IUnknown:: Release](/windows/desktop/api/unknwn/nf-unknwn-iunknown-release) nel SDK di Windows.

##  <a name="reload"></a>  COleClientItem::Reload

Chiude e ricarica l'elemento.

```
BOOL Reload();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Chiamare il `Reload` dopo aver attivato l'elemento come elemento di un altro tipo da una chiamata alla funzione [ActivateAs](#activateas).

##  <a name="run"></a>  COleClientItem::Run

Esegue l'applicazione associata all'elemento.

```
void Run();
```

### <a name="remarks"></a>Note

Chiamare il `Run` funzione membro per avviare l'applicazione server prima di attivare l'elemento. Questa operazione viene eseguita automaticamente da [Activate](#activate) e [DoVerb](#doverb), in modo che in genere non è necessario chiamare questa funzione. Chiamare questa funzione se è necessario eseguire il server per impostare un attributo dell'elemento, ad esempio [SetExtent](#setextent), prima di eseguire [DoVerb](#doverb).

##  <a name="setdrawaspect"></a>  COleClientItem::SetDrawAspect

Chiamare il `SetDrawAspect` funzione membro per impostare la "aspetto", o la vista dell'elemento.

```
virtual void SetDrawAspect(DVASPECT nDrawAspect);
```

### <a name="parameters"></a>Parametri

*nDrawAspect*<br/>
Valore ricavato dall'enumerazione DVASPECT. Per il parametro è possibile specificare uno dei valori riportati di seguito:

- Elemento DVASPECT_CONTENT è rappresentato in modo tale che possono essere visualizzato come un oggetto incorporato all'interno del relativo contenitore.

- DVASPECT_THUMBNAIL rendering viene eseguito in una rappresentazione di "anteprima" in modo che possa essere visualizzata in uno strumento di esplorazione.

- Elemento DVASPECT_ICON è rappresentato da un'icona.

- Elemento DVASPECT_DOCPRINT viene rappresentata come se fosse stampato utilizzando il comando Stampa dal menu File.

### <a name="remarks"></a>Note

L'aspetto specifica come l'elemento è il rendering [disegnare](#draw) quando il valore predefinito per tale funzione *nDrawAspect* viene utilizzato l'argomento.

Questa funzione viene chiamata automaticamente l'icona di modifica (e altre finestre di dialogo che chiamano direttamente la finestra di dialogo Cambia icona) per abilitare l'aspetto delle icone di visualizzazione quando richiesto dall'utente.

##  <a name="setextent"></a>  COleClientItem::SetExtent

Chiamare questa funzione per specificare la quantità di spazio disponibile per l'elemento OLE.

```
void SetExtent(
    const CSize& size,
    DVASPECT nDrawAspect = DVASPECT_CONTENT);
```

### <a name="parameters"></a>Parametri

*size*<br/>
Oggetto [CSize](../../atl-mfc-shared/reference/csize-class.md) oggetto che contiene le informazioni sulle dimensioni.

*nDrawAspect*<br/>
Specifica l'aspetto dell'elemento OLE cui limiti devono essere impostate. Per i valori possibili, vedere [SetDrawAspect](#setdrawaspect).

### <a name="remarks"></a>Note

Se l'applicazione server è stata scritta usando la libreria Microsoft Foundation Class, ciò fa sì che il [OnSetExtent](../../mfc/reference/coleserveritem-class.md#onsetextent) funzione di membro del corrispondente `COleServerItem` oggetto da chiamare. L'elemento OLE possibile quindi regolare la relativa visualizzazione. Le dimensioni devono essere espressi come MM_HIMETRIC. Chiamare questa funzione quando l'utente ridimensiona l'elemento OLE o se si supporta una qualche forma di negoziazione di layout.

Per altre informazioni, vedere [IOleObject:: SetExtent](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-setextent) nel SDK di Windows.

##  <a name="sethostnames"></a>  COleClientItem::SetHostNames

Chiamare questa funzione per specificare il nome dell'applicazione contenitore e il nome del contenitore per un elemento OLE incorporato.

```
void SetHostNames(
    LPCTSTR lpszHost,
    LPCTSTR lpszHostObj);
```

### <a name="parameters"></a>Parametri

*lpszHost*<br/>
Puntatore al nome visibile all'utente dell'applicazione contenitore.

*lpszHostObj*<br/>
Puntatore a una stringa di identificazione del contenitore che contiene l'elemento OLE.

### <a name="remarks"></a>Note

Se l'applicazione server è stata scritta usando la libreria Microsoft Foundation Class, questa funzione richiama il [OnSetHostNames](../../mfc/reference/coleserverdoc-class.md#onsethostnames) funzione membro del `COleServerDoc` documento che contiene l'elemento OLE. Queste informazioni vengono utilizzate nei titoli di finestra quando viene modificato l'elemento OLE. Ogni volta che viene caricato un documento contenitore, il framework chiama questa funzione per tutti gli elementi OLE nel documento. `SetHostNames` è applicabile solo agli elementi incorporati. Non è necessario chiamare questa funzione ogni volta che viene attivato un elemento OLE incorporato per la modifica.

Questo viene inoltre chiamato automaticamente con il nome dell'applicazione e il nome del documento quando viene caricato un oggetto o un file viene salvato con un nome diverso. Non è di conseguenza, in genere necessario chiamare direttamente questa funzione.

Per altre informazioni, vedere [IOleObject::SetHostNames](/windows/desktop/api/oleidl/nf-oleidl-ioleobject-sethostnames) nel SDK di Windows.

##  <a name="seticonicmetafile"></a>  COleClientItem::SetIconicMetafile

Memorizza nella cache il metafile utilizzato per disegnare l'icona dell'elemento.

```
BOOL SetIconicMetafile(HGLOBAL hMetaPict);
```

### <a name="parameters"></a>Parametri

*hMetaPict*<br/>
Handle del metafile utilizzato per disegnare l'icona dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Uso [GetIconicMetafile](#geticonicmetafile) per recuperare il metafile.

Il *hMetaPict* parametro verrà copiato l'elemento; pertanto *hMetaPict* deve essere liberato dal chiamante.

##  <a name="setitemrects"></a>  COleClientItem::SetItemRects

Chiamare questa funzione per impostare il rettangolo di delimitazione o il rettangolo visibile dell'elemento OLE.

```
BOOL SetItemRects(
    LPCRECT lpPosRect = NULL,
    LPCRECT lpClipRect = NULL);
```

### <a name="parameters"></a>Parametri

*lprcPosRect*<br/>
Puntatore al rettangolo contenente i limiti dell'elemento OLE rispetto alla finestra padre, nelle coordinate del client.

*lprcClipRect*<br/>
Puntatore al rettangolo contenente i limiti della parte visibile dell'elemento OLE rispetto alla finestra padre, nelle coordinate del client.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo. in caso contrario, 0.

### <a name="remarks"></a>Note

Questa funzione viene chiamata dall'implementazione predefinita del [OnChangeItemPosition](#onchangeitemposition) funzione membro. È necessario chiamare questa funzione ogni volta che la posizione o la parte visibile del OLE di elementi. Questo significa in genere chiamarlo della vista [OnSize](../../mfc/reference/cwnd-class.md#onsize) e [OnScrollBy](../../mfc/reference/cview-class.md#onscrollby) funzioni membro.

Per altre informazioni, vedere [IOleInPlaceObject::SetObjectRects](/windows/desktop/api/oleidl/nf-oleidl-ioleinplaceobject-setobjectrects) nel SDK di Windows.

##  <a name="setlinkupdateoptions"></a>  COleClientItem::SetLinkUpdateOptions

Chiamare questa funzione per impostare l'opzione di aggiornamento di collegamento per la presentazione dell'elemento collegato specificato.

```
void SetLinkUpdateOptions(OLEUPDATE dwUpdateOpt);
```

### <a name="parameters"></a>Parametri

*dwUpdateOpt*<br/>
Il valore dell'opzione di aggiornamento di collegamento per questo elemento. Questo valore deve essere uno dei seguenti:

- OLEUPDATE_ALWAYS aggiornare l'elemento collegato laddove possibile. Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento automatico nella finestra di dialogo collegamenti.

- OLEUPDATE_ONCALL aggiornare l'elemento collegato solo su richiesta da un'applicazione contenitore (quando il [UpdateLink](#updatelink) viene chiamata la funzione membro). Questa opzione supporta il pulsante di opzione di collegamento-aggiornamento manuale nella finestra di dialogo collegamenti.

### <a name="remarks"></a>Note

In genere, non è necessario modificare le opzioni di aggiornamento scelte dall'utente nella finestra di dialogo collegamenti.

Per altre informazioni, vedere [IOleLink::SetUpdateOptions](/windows/desktop/api/oleidl/nf-oleidl-iolelink-setupdateoptions) nel SDK di Windows.

##  <a name="setprintdevice"></a>  COleClientItem::SetPrintDevice

Chiamare questa funzione per modificare il dispositivo di destinazione di stampa per questo elemento.

```
BOOL SetPrintDevice(const DVTARGETDEVICE* ptd);
BOOL SetPrintDevice(const PRINTDLG* ppd);
```

### <a name="parameters"></a>Parametri

*ptd*<br/>
Puntatore a un [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) struttura dei dati, che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere NULL.

*ppd*<br/>
Puntatore a un [PRINTDLG](/windows/desktop/ms646940) struttura dei dati, che contiene informazioni sul nuovo dispositivo di destinazione di stampa. Può essere NULL.

### <a name="return-value"></a>Valore restituito

Diverso da zero se la funzione ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Note

Questa funzione Aggiorna il dispositivo di destinazione di stampa per l'elemento ma non aggiorna la cache di presentazione. Per aggiornare la cache di presentazione di un elemento, chiamare [UpdateLink](#updatelink).

Gli argomenti a questa funzione contengono informazioni che il sistema OLE viene utilizzato per identificare il dispositivo di destinazione. Il `PRINTDLG` struttura contiene informazioni che Windows utilizza per inizializzare la finestra di dialogo Stampa comune. Dopo che l'utente chiude la finestra di dialogo, Windows restituisce informazioni sulle selezioni dell'utente in questa struttura. Il `m_pd` membro di un [CPrintDialog](../../mfc/reference/cprintdialog-class.md) oggetto è un `PRINTDLG` struttura.

Per altre informazioni su questa struttura, vedere [PRINTDLG](/windows/desktop/api/commdlg/ns-commdlg-tagpda) nel SDK di Windows.

Per altre informazioni, vedere [DVTARGETDEVICE](/windows/desktop/api/objidl/ns-objidl-tagdvtargetdevice) nel SDK di Windows.

##  <a name="updatelink"></a>  COleClientItem::UpdateLink

Chiamare questa funzione per aggiornare immediatamente i dati di presentazione dell'elemento OLE.

```
BOOL UpdateLink();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero in caso di esito positivo; in caso contrario, 0.

### <a name="remarks"></a>Note

Gli elementi collegati, la funzione consente di individuare l'origine di collegamento per ottenere una presentazione di nuovo per l'elemento OLE. Questo processo può implicare che eseguono uno o più applicazioni server, che potrebbero richiedere molto tempo. Per gli elementi incorporati, la funzione opera in modo ricorsivo, verifica se l'elemento incorporato contiene i collegamenti che potrebbero essere obsoleti e aggiornarli. L'utente può aggiornare manualmente i singoli collegamenti utilizzando la finestra di dialogo collegamenti.

Per altre informazioni, vedere [IOleLink::Update](/windows/desktop/api/oleidl/nf-oleidl-iolelink-update) nel SDK di Windows.

## <a name="see-also"></a>Vedere anche

[Esempio MFC MFCBIND](../../overview/visual-cpp-samples.md)<br/>
[Esempio MFC OCLIENT](../../overview/visual-cpp-samples.md)<br/>
[Classe CDocItem](../../mfc/reference/cdocitem-class.md)<br/>
[Grafico della gerarchia](../../mfc/hierarchy-chart.md)<br/>
[Classe COleServerItem](../../mfc/reference/coleserveritem-class.md)
