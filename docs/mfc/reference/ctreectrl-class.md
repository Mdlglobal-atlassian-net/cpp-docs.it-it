---
title: CTreeCtrl Class
ms.date: 11/04/2016
f1_keywords:
- CTreeCtrl
- AFXCMN/CTreeCtrl
- AFXCMN/CTreeCtrl::CTreeCtrl
- AFXCMN/CTreeCtrl::Create
- AFXCMN/CTreeCtrl::CreateDragImage
- AFXCMN/CTreeCtrl::CreateEx
- AFXCMN/CTreeCtrl::DeleteAllItems
- AFXCMN/CTreeCtrl::DeleteItem
- AFXCMN/CTreeCtrl::EditLabel
- AFXCMN/CTreeCtrl::EndEditLabelNow
- AFXCMN/CTreeCtrl::EnsureVisible
- AFXCMN/CTreeCtrl::Expand
- AFXCMN/CTreeCtrl::GetBkColor
- AFXCMN/CTreeCtrl::GetCheck
- AFXCMN/CTreeCtrl::GetChildItem
- AFXCMN/CTreeCtrl::GetCount
- AFXCMN/CTreeCtrl::GetDropHilightItem
- AFXCMN/CTreeCtrl::GetEditControl
- AFXCMN/CTreeCtrl::GetExtendedStyle
- AFXCMN/CTreeCtrl::GetFirstVisibleItem
- AFXCMN/CTreeCtrl::GetImageList
- AFXCMN/CTreeCtrl::GetIndent
- AFXCMN/CTreeCtrl::GetInsertMarkColor
- AFXCMN/CTreeCtrl::GetItem
- AFXCMN/CTreeCtrl::GetItemData
- AFXCMN/CTreeCtrl::GetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::GetItemHeight
- AFXCMN/CTreeCtrl::GetItemImage
- AFXCMN/CTreeCtrl::GetItemPartRect
- AFXCMN/CTreeCtrl::GetItemRect
- AFXCMN/CTreeCtrl::GetItemState
- AFXCMN/CTreeCtrl::GetItemStateEx
- AFXCMN/CTreeCtrl::GetItemText
- AFXCMN/CTreeCtrl::GetLastVisibleItem
- AFXCMN/CTreeCtrl::GetLineColor
- AFXCMN/CTreeCtrl::GetNextItem
- AFXCMN/CTreeCtrl::GetNextSiblingItem
- AFXCMN/CTreeCtrl::GetNextVisibleItem
- AFXCMN/CTreeCtrl::GetParentItem
- AFXCMN/CTreeCtrl::GetPrevSiblingItem
- AFXCMN/CTreeCtrl::GetPrevVisibleItem
- AFXCMN/CTreeCtrl::GetRootItem
- AFXCMN/CTreeCtrl::GetScrollTime
- AFXCMN/CTreeCtrl::GetSelectedCount
- AFXCMN/CTreeCtrl::GetSelectedItem
- AFXCMN/CTreeCtrl::GetTextColor
- AFXCMN/CTreeCtrl::GetToolTips
- AFXCMN/CTreeCtrl::GetVisibleCount
- AFXCMN/CTreeCtrl::HitTest
- AFXCMN/CTreeCtrl::InsertItem
- AFXCMN/CTreeCtrl::ItemHasChildren
- AFXCMN/CTreeCtrl::MapAccIdToItem
- AFXCMN/CTreeCtrl::MapItemToAccID
- AFXCMN/CTreeCtrl::Select
- AFXCMN/CTreeCtrl::SelectDropTarget
- AFXCMN/CTreeCtrl::SelectItem
- AFXCMN/CTreeCtrl::SelectSetFirstVisible
- AFXCMN/CTreeCtrl::SetAutoscrollInfo
- AFXCMN/CTreeCtrl::SetBkColor
- AFXCMN/CTreeCtrl::SetCheck
- AFXCMN/CTreeCtrl::SetExtendedStyle
- AFXCMN/CTreeCtrl::SetImageList
- AFXCMN/CTreeCtrl::SetIndent
- AFXCMN/CTreeCtrl::SetInsertMark
- AFXCMN/CTreeCtrl::SetInsertMarkColor
- AFXCMN/CTreeCtrl::SetItem
- AFXCMN/CTreeCtrl::SetItemData
- AFXCMN/CTreeCtrl::SetItemExpandedImageIndex
- AFXCMN/CTreeCtrl::SetItemHeight
- AFXCMN/CTreeCtrl::SetItemImage
- AFXCMN/CTreeCtrl::SetItemState
- AFXCMN/CTreeCtrl::SetItemStateEx
- AFXCMN/CTreeCtrl::SetItemText
- AFXCMN/CTreeCtrl::SetLineColor
- AFXCMN/CTreeCtrl::SetScrollTime
- AFXCMN/CTreeCtrl::SetTextColor
- AFXCMN/CTreeCtrl::SetToolTips
- AFXCMN/CTreeCtrl::ShowInfoTip
- AFXCMN/CTreeCtrl::SortChildren
- AFXCMN/CTreeCtrl::SortChildrenCB
helpviewer_keywords:
- CTreeCtrl [MFC], CTreeCtrl
- CTreeCtrl [MFC], Create
- CTreeCtrl [MFC], CreateDragImage
- CTreeCtrl [MFC], CreateEx
- CTreeCtrl [MFC], DeleteAllItems
- CTreeCtrl [MFC], DeleteItem
- CTreeCtrl [MFC], EditLabel
- CTreeCtrl [MFC], EndEditLabelNow
- CTreeCtrl [MFC], EnsureVisible
- CTreeCtrl [MFC], Expand
- CTreeCtrl [MFC], GetBkColor
- CTreeCtrl [MFC], GetCheck
- CTreeCtrl [MFC], GetChildItem
- CTreeCtrl [MFC], GetCount
- CTreeCtrl [MFC], GetDropHilightItem
- CTreeCtrl [MFC], GetEditControl
- CTreeCtrl [MFC], GetExtendedStyle
- CTreeCtrl [MFC], GetFirstVisibleItem
- CTreeCtrl [MFC], GetImageList
- CTreeCtrl [MFC], GetIndent
- CTreeCtrl [MFC], GetInsertMarkColor
- CTreeCtrl [MFC], GetItem
- CTreeCtrl [MFC], GetItemData
- CTreeCtrl [MFC], GetItemExpandedImageIndex
- CTreeCtrl [MFC], GetItemHeight
- CTreeCtrl [MFC], GetItemImage
- CTreeCtrl [MFC], GetItemPartRect
- CTreeCtrl [MFC], GetItemRect
- CTreeCtrl [MFC], GetItemState
- CTreeCtrl [MFC], GetItemStateEx
- CTreeCtrl [MFC], GetItemText
- CTreeCtrl [MFC], GetLastVisibleItem
- CTreeCtrl [MFC], GetLineColor
- CTreeCtrl [MFC], GetNextItem
- CTreeCtrl [MFC], GetNextSiblingItem
- CTreeCtrl [MFC], GetNextVisibleItem
- CTreeCtrl [MFC], GetParentItem
- CTreeCtrl [MFC], GetPrevSiblingItem
- CTreeCtrl [MFC], GetPrevVisibleItem
- CTreeCtrl [MFC], GetRootItem
- CTreeCtrl [MFC], GetScrollTime
- CTreeCtrl [MFC], GetSelectedCount
- CTreeCtrl [MFC], GetSelectedItem
- CTreeCtrl [MFC], GetTextColor
- CTreeCtrl [MFC], GetToolTips
- CTreeCtrl [MFC], GetVisibleCount
- CTreeCtrl [MFC], HitTest
- CTreeCtrl [MFC], InsertItem
- CTreeCtrl [MFC], ItemHasChildren
- CTreeCtrl [MFC], MapAccIdToItem
- CTreeCtrl [MFC], MapItemToAccID
- CTreeCtrl [MFC], Select
- CTreeCtrl [MFC], SelectDropTarget
- CTreeCtrl [MFC], SelectItem
- CTreeCtrl [MFC], SelectSetFirstVisible
- CTreeCtrl [MFC], SetAutoscrollInfo
- CTreeCtrl [MFC], SetBkColor
- CTreeCtrl [MFC], SetCheck
- CTreeCtrl [MFC], SetExtendedStyle
- CTreeCtrl [MFC], SetImageList
- CTreeCtrl [MFC], SetIndent
- CTreeCtrl [MFC], SetInsertMark
- CTreeCtrl [MFC], SetInsertMarkColor
- CTreeCtrl [MFC], SetItem
- CTreeCtrl [MFC], SetItemData
- CTreeCtrl [MFC], SetItemExpandedImageIndex
- CTreeCtrl [MFC], SetItemHeight
- CTreeCtrl [MFC], SetItemImage
- CTreeCtrl [MFC], SetItemState
- CTreeCtrl [MFC], SetItemStateEx
- CTreeCtrl [MFC], SetItemText
- CTreeCtrl [MFC], SetLineColor
- CTreeCtrl [MFC], SetScrollTime
- CTreeCtrl [MFC], SetTextColor
- CTreeCtrl [MFC], SetToolTips
- CTreeCtrl [MFC], ShowInfoTip
- CTreeCtrl [MFC], SortChildren
- CTreeCtrl [MFC], SortChildrenCB
ms.assetid: 96e20031-6161-4143-8c12-8d1816c66d90
ms.openlocfilehash: 2b6c11600010bc9f97ab8c3a531d33c92c94e442
ms.sourcegitcommit: 7a6116e48c3c11b97371b8ae4ecc23adce1f092d
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/22/2020
ms.locfileid: "81752116"
---
# <a name="ctreectrl-class"></a>CTreeCtrl Class

Fornisce la funzionalit√† del controllo di visualizzazione albero comune di Windows.

## <a name="syntax"></a>Sintassi

```
class CTreeCtrl : public CWnd
```

## <a name="members"></a>Membri

### <a name="public-constructors"></a>Costruttori pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl::CTreeCtrl](#ctreectrl)|Costruisce un oggetto `CTreeCtrl`.|

### <a name="public-methods"></a>Metodi pubblici

|Nome|Descrizione|
|----------|-----------------|
|[CTreeCtrl::Creare](#create)|Crea un controllo di visualizzazione ad `CTreeCtrl` albero e lo associa a un oggetto.|
|[CTreeCtrl::CreateDragImage](#createdragimage)|Crea una bitmap di trascinamento per l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::CreateEx](#createex)|Crea un controllo struttura ad albero con gli stili `CTreeCtrl` estesi di Windows specificati e lo associa a un oggetto.|
|[CTreeCtrl::DeleteAllItems](#deleteallitems)|Elimina tutti gli elementi in un controllo di visualizzazione ad albero.|
|[CTreeCtrl::DeleteItem](#deleteitem)|Elimina un nuovo elemento in un controllo di visualizzazione ad albero.|
|[CTreeCtrl::EditLabel](#editlabel)|Modifica un elemento della visualizzazione struttura ad albero specificato sul posto.|
|[CTreeCtrl::EndEditLabelNowCTreeCtrl::EndEditLabelNow](#endeditlabelnow)|Annulla l'operazione di modifica sull'etichetta di un elemento della visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::EnsureVisible](#ensurevisible)|Assicura che un elemento della visualizzazione struttura ad albero sia visibile nel relativo controllo di visualizzazione ad albero.|
|[CTreeCtrl::Espandi](#expand)|Espande o comprime gli elementi figlio dell'elemento della visualizzazione struttura specificata.|
|[CTreeCtrl::GetBkColor](#getbkcolor)|Recupera il colore di sfondo corrente del controllo.|
|[CTreeCtrl::GetCheck](#getcheck)|Recupera lo stato di controllo di un elemento del controllo struttura ad albero.|
|[CTreeCtrl::GetChildItem](#getchilditem)|Recupera l'elemento figlio di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetCount](#getcount)|Recupera il numero di elementi della struttura ad albero associati a un controllo di visualizzazione ad albero.|
|[CTreeCtrl::GetDropHilightItem](#getdrophilightitem)|Recupera la destinazione di un'operazione di trascinamento della selezione.|
|[CTreeCtrl::GetEditControl](#geteditcontrol)|Recupera l'handle del controllo di modifica utilizzato per modificare l'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetExtendedStyle](#getextendedstyle)|Recupera gli stili estesi utilizzato dal controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetFirstVisibleItem](#getfirstvisibleitem)|Recupera il primo elemento visibile dell'elemento della visualizzazione struttura specificata.|
|[CTreeCtrl::GetImageList](#getimagelist)|Recupera l'handle dell'elenco immagini associato a un controllo di visualizzazione ad albero.|
|[CTreeCtrl::GetIndent](#getindent)|Recupera l'offset (in pixel) di un elemento della visualizzazione struttura ad albero dal relativo elemento padre.|
|[CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor)|Recupera il colore utilizzato per disegnare il segno di inserimento per la vista ad albero.|
|[CTreeCtrl::GetItem](#getitem)|Recupera gli attributi di un elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetItemDataCTreeCtrl::GetItemData](#getitemdata)|Restituisce il valore specifico dell'applicazione associato a un elemento.|
|[CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex)|Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.|
|[CTreeCtrl::GetItemHeightC TreeCtrl::GetItemHeight](#getitemheight)|Recupera l'altezza corrente degli elementi della visualizzazione struttura ad albero.|
|[CTreeCtrl::GetItemImage](#getitemimage)|Recupera le immagini associate a un elemento.|
|[CTreeCtrl::GetItemPartRectCTreeCtrl::GetItemPartRect](#getitempartrect)|Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetItemRectCTreeCtrl::GetItemRect](#getitemrect)|Recupera il rettangolo di delimitazione di un elemento della visualizzazione struttura ad albero.|
|[CTreeCtrl::GetItemState](#getitemstate)|Restituisce lo stato di un elemento.|
|[CTreeCtrl::GetItemStateEx](#getitemstateex)|Recupera lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetItemText](#getitemtext)|Restituisce il testo di un elemento.|
|[CTreeCtrl::GetLastVisibleItem](#getlastvisibleitem)|Recupera l'ultimo elemento espanso nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetLineColor](#getlinecolor)|Recupera il colore della linea corrente per il controllo di visualizzazione ad albero.|
|[CTreeCtrl::GetNextItem](#getnextitem)|Recupera l'elemento successivo della visualizzazione albero che corrisponde a una relazione specificata.|
|[CTreeCtrl::GetNextSiblingItem](#getnextsiblingitem)|Recupera l'elemento di pari livello successivo dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetNextVisibleItem](#getnextvisibleitem)|Recupera l'elemento visibile successivo dell'elemento della visualizzazione struttura specificata.|
|[CTreeCtrl::GetParentItem](#getparentitem)|Recupera l'elemento padre dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetPrevSiblingItem](#getprevsiblingitem)|Recupera l'elemento di pari livello precedente dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetPrevVisibleItem](#getprevvisibleitem)|Recupera l'elemento visibile precedente dell'elemento della visualizzazione struttura specificata.|
|[CTreeCtrl::GetRootItem](#getrootitem)|Recupera la radice dell'elemento della visualizzazione struttura ad albero specificato.|
|[CTreeCtrl::GetScrollTime](#getscrolltime)|Recupera il tempo di scorrimento massimo per il controllo di visualizzazione ad albero.|
|[CTreeCtrl::GetSelectedCount](#getselectedcount)|Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::GetSelectedItem](#getselecteditem)|Recupera l'elemento della visualizzazione struttura attualmente selezionato.|
|[CTreeCtrl::GetTextColor](#gettextcolor)|Recupera il colore del testo corrente del controllo.|
|[CTreeCtrl::GetToolTips](#gettooltips)|Recupera l'handle per il controllo ToolTip figlio utilizzato da un controllo di visualizzazione ad albero.|
|[CTreeCtrl::GetVisibleCount](#getvisiblecount)|Recupera il numero di elementi della struttura ad albero visibili associati a un controllo di visualizzazione ad albero.|
|[CTreeCtrl::HitTest](#hittest)|Restituisce la posizione corrente del `CTreeCtrl` cursore correlato all'oggetto.|
|[CTreeCtrl::InsertItem](#insertitem)|Inserisce un nuovo elemento in un controllo di visualizzazione ad albero.|
|[CTreeCtrl::ItemHasChildren](#itemhaschildren)|Restituisce diverso da zero se l'elemento specificato ha elementi figlio.|
|[CTreeCtrl::MapAccIdToItem](#mapaccidtoitem)|Esegue il mapping dell'identificatore di accessibilit√† specificato all'handle a un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::MapItemToAccID](#mapitemtoaccid)|Esegue il mapping dell'handle specificato a un elemento della visualizzazione ad albero nel controllo di visualizzazione ad albero corrente a un identificatore di accessibilit√†.|
|[CTreeCtrl::Selezionare](#select)|Seleziona, scorre nella visualizzazione o ridisegna un elemento della visualizzazione struttura specificato.|
|[CTreeCtrl::SelectDropTarget](#selectdroptarget)|Ridisegna l'elemento della struttura ad albero come destinazione di un'operazione di trascinamento della selezione.|
|[CTreeCtrl::SelectItem](#selectitem)|Seleziona un elemento della visualizzazione struttura specificato.|
|[CTreeCtrl::SelectSetFirstVisible](#selectsetfirstvisible)|Seleziona un elemento della visualizzazione struttura specificato come primo elemento visibile.|
|[CTreeCtrl::SetAutoscrollInfo](#setautoscrollinfo)|Imposta la frequenza di scorrimento automatico del controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetBkColor](#setbkcolor)|Imposta il colore di sfondo del controllo.|
|[CTreeCtrl::SetCheck](#setcheck)|Imposta lo stato di controllo di un elemento del controllo struttura ad albero.|
|[CTreeCtrl::SetExtendedStyle (combinazione di oggetti)](#setextendedstyle)|Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetImageList](#setimagelist)|Imposta l'handle dell'elenco immagini associato a un controllo di visualizzazione ad albero.|
|[CTreeCtrl::SetIndent](#setindent)|Imposta l'offset (in pixel) di un elemento della visualizzazione struttura ad albero dal relativo elemento padre.|
|[CTreeCtrl::SetInsertMark](#setinsertmark)|Imposta il segno di inserimento in un controllo di visualizzazione ad albero.|
|[CTreeCtrl::SetInsertMarkColor](#setinsertmarkcolor)|Imposta il colore utilizzato per disegnare il segno di inserimento per la vista ad albero.|
|[CTreeCtrl::SetItem](#setitem)|Imposta gli attributi di un elemento della visualizzazione struttura specificata.|
|[CTreeCtrl::SetItemData](#setitemdata)|Imposta il valore specifico dell'applicazione associato a un elemento.|
|[CTreeCtrl::SetItemExpandedImageIndex](#setitemexpandedimageindex)|Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.|
|[CTreeCtrl::SetItemHeight](#setitemheight)|Imposta l'altezza degli elementi della vista ad albero.|
|[CTreeCtrl::SetItemImage](#setitemimage)|Associa le immagini a un elemento.|
|[CTreeCtrl::SetItemState](#setitemstate)|Imposta lo stato di un elemento.|
|[CTreeCtrl::SetItemStateEx](#setitemstateex)|Imposta lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SetItemText](#setitemtext)|Imposta il testo di un elemento.|
|[CTreeCtrl::SetLineColor](#setlinecolor)|Imposta il colore della linea corrente per il controllo di visualizzazione ad albero.|
|[CTreeCtrl::SetScrollTime](#setscrolltime)|Imposta il tempo di scorrimento massimo per il controllo di visualizzazione ad albero.|
|[CTreeCtrl::SetTextColor](#settextcolor)|Imposta il colore del testo del controllo.|
|[CTreeCtrl::SetToolTips](#settooltips)|Imposta il controllo ToolTip figlio di un controllo di visualizzazione ad albero.|
|[CTreeCtrl::ShowInfoTip](#showinfotip)|Visualizza l'infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.|
|[CTreeCtrl::SortChildren](#sortchildren)|Ordina gli elementi figlio di un determinato elemento padre.|
|[CTreeCtrl::SortChildrenCB](#sortchildrencb)|Ordina gli elementi figlio di un determinato elemento padre utilizzando una funzione di ordinamento definita dall'applicazione.|

## <a name="remarks"></a>Osservazioni

Un "controllo di visualizzazione ad albero" √® una finestra che visualizza un elenco gerarchico di elementi, ad esempio le intestazioni in un documento, le voci in un indice o i file e le directory su un disco. Ogni elemento √® costituito da un'etichetta e un'immagine bitmap facoltativa e ogni elemento pu√≤ avere un elenco di elementi secondari associati. Facendo clic su un elemento, l'utente pu√≤ espandere e comprimere l'elenco associato di elementi secondari.

Questo controllo (e `CTreeCtrl` quindi la classe) √® disponibile solo per i programmi in esecuzione in Windows 98 e Windows NT versione 4 e successive.

Per ulteriori informazioni `CTreeCtrl`sull'utilizzo di :

- [Controlli](../../mfc/controls-mfc.md)

- [Utilizzo di CTreeCtrl](../../mfc/using-ctreectrl.md)

- [Riferimenti](/windows/win32/Controls/tree-view-control-reference) al controllo visualizzazione albero in Windows SDK.

## <a name="inheritance-hierarchy"></a>Gerarchia di ereditariet√†

[CObject](../../mfc/reference/cobject-class.md)

[CCmdTarget](../../mfc/reference/ccmdtarget-class.md)

[CWnd](../../mfc/reference/cwnd-class.md)

`CTreeCtrl`

## <a name="requirements"></a>Requisiti

**Intestazione:** afxcmn.h

## <a name="ctreectrlcreate"></a><a name="create"></a>CTreeCtrl::Creare

Se si specifica il controllo struttura ad albero in un modello di finestra di dialogo o se si utilizza [CTreeView](../../mfc/reference/ctreeview-class.md), il controllo struttura ad albero viene creato automaticamente quando viene creata la finestra di dialogo o la visualizzazione.

```
virtual BOOL Create(
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*DwStyle (in stile dwStyle)*<br/>
Specifica lo stile del controllo di visualizzazione ad albero. Applicare gli stili di finestra, descritti in [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww), e qualsiasi combinazione di stili del [controllo visualizzazione](/windows/win32/Controls/tree-view-control-window-styles) struttura ad albero come descritto in Windows SDK.

*Rect*<br/>
Specifica le dimensioni e la posizione del controllo di visualizzazione ad albero. Pu√≤ essere un [CRect](../../atl-mfc-shared/reference/crect-class.md) oggetto o un [RECT](/windows/win32/api/windef/ns-windef-rect) struttura.

*pParentWnd (informazioni in due)*<br/>
Specifica la finestra padre del controllo di `CDialog`visualizzazione struttura ad albero, in genere un oggetto . Non deve essere NULL.

*nID*<br/>
Specifica l'ID del controllo di visualizzazione ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'inizializzazione ha avuto esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Se si desidera creare il controllo struttura ad albero come `Create` finestra figlio di un'altra finestra, utilizzare la funzione membro. Se si crea il `Create`controllo struttura ad albero utilizzando , √® necessario passarlo WS_VISIBLE, oltre ad altri stili di visualizzazione struttura.

Costruire un `CTreeCtrl` in due passi. Chiamare innanzitutto il `Create`costruttore , quindi chiamare , che crea `CTreeCtrl` il controllo di visualizzazione ad albero e lo associa all'oggetto .

Per creare un controllo struttura ad albero con `Create`stili di finestra estesi, chiamare [CreateEx](#createex) anzich√© .

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_1.cpp)]

## <a name="ctreectrlcreateex"></a><a name="createex"></a>CTreeCtrl::CreateEx

Chiamare questa funzione per creare un controllo (una `CTreeCtrl` finestra figlio) e associarlo all'oggetto.

```
virtual BOOL CreateEx(
    DWORD dwExStyle,
    DWORD dwStyle,
    const RECT& rect,
    CWnd* pParentWnd,
    UINT nID);
```

### <a name="parameters"></a>Parametri

*DwExStyle (in stile dwExStyle)*<br/>
Specifica lo stile esteso del controllo in fase di creazione. Per un elenco di stili di Windows estesi, vedere il parametro *dwExStyle* per [CreateWindowEx](/windows/win32/api/winuser/nf-winuser-createwindowexw) in Windows SDK.

*DwStyle (in stile dwStyle)*<br/>
Specifica lo stile del controllo di visualizzazione ad albero. Applicare gli stili di finestra, descritti in [CreateWindow](/windows/win32/api/winuser/nf-winuser-createwindoww), e qualsiasi combinazione di stili del [controllo visualizzazione](/windows/win32/Controls/tree-view-control-window-styles) struttura ad albero come descritto in Windows SDK.

*Rect*<br/>
Riferimento a una struttura [RECT](/windows/win32/api/windef/ns-windef-rect) che descrive le dimensioni e la posizione della finestra da creare, nelle coordinate client di *pParentWnd*.

*pParentWnd (informazioni in due)*<br/>
Puntatore alla finestra che √® padre del controllo.

*nID*<br/>
ID della finestra figlio del controllo.

### <a name="return-value"></a>Valore restituito

Diverso da zero in caso di esito positivo 0.

### <a name="remarks"></a>Osservazioni

Utilizzare `CreateEx` invece [di Crea](#create) per applicare stili di Windows estesi, specificati dalla prefazione dello stile esteso di Windows **WS_EX_**.

## <a name="ctreectrlcreatedragimage"></a><a name="createdragimage"></a>CTreeCtrl::CreateDragImage

Chiamare questa funzione per creare una bitmap di trascinamento per l'elemento specificato in un controllo di visualizzazione ad albero, creare un elenco immagini per la bitmap e aggiungere la bitmap all'elenco immagini.

```
CImageList* CreateDragImage(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero da trascinare.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco immagini a cui √® stata aggiunta la bitmap di trascinamento, se ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

Un'applicazione utilizza le funzioni dell'elenco immagini per visualizzare l'immagine quando l'elemento viene trascinato.

L'oggetto `CImageList` √® permanente ed √® necessario eliminarlo al termine dell'operazione. Ad esempio:

[!code-cpp[NVC_MFC_CTreeCtrl#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_2.cpp)]

## <a name="ctreectrlctreectrl"></a><a name="ctreectrl"></a>CTreeCtrl::CTreeCtrl

Costruisce un oggetto `CTreeCtrl`.

```
CTreeCtrl();
```

## <a name="ctreectrldeleteallitems"></a><a name="deleteallitems"></a>CTreeCtrl::DeleteAllItems

Chiamare questa funzione per eliminare tutti gli elementi dal controllo di visualizzazione ad albero.

```
BOOL DeleteAllItems();
```

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_3.cpp)]

## <a name="ctreectrldeleteitem"></a><a name="deleteitem"></a>CTreeCtrl::DeleteItem

Chiamare questa funzione per eliminare un elemento dal controllo di visualizzazione ad albero.

```
BOOL DeleteItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero da eliminare. Se *hitem* ha il valore TVI_ROOT, tutti gli elementi vengono eliminati dal controllo di visualizzazione ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_4.cpp)]

## <a name="ctreectrleditlabel"></a><a name="editlabel"></a>CTreeCtrl::EditLabel

Chiamare questa funzione per iniziare la modifica sul posto del testo dell'elemento specificato.

```
CEdit* EditLabel(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero da modificare.

### <a name="return-value"></a>Valore restituito

Se ha esito `CEdit` positivo, un puntatore all'oggetto utilizzato per modificare il testo dell'elemento; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

La modifica viene eseguita sostituendo il testo dell'elemento con un controllo di modifica a riga singola contenente il testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_5.cpp)]

## <a name="ctreectrlendeditlabelnow"></a><a name="endeditlabelnow"></a>CTreeCtrl::EndEditLabelNowCTreeCtrl::EndEditLabelNow

Conclude l'operazione di modifica sull'etichetta di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.

```
BOOL EndEditLabelNow(BOOL fCancelWithoutSave);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*fCancelWithoutSave*|[in] TRUE per ignorare le modifiche all'elemento della visualizzazione ad albero prima di concludere l'operazione di modifica o FALSE per salvare le modifiche all'elemento di visualizzazione ad albero prima di concludere l'operazione.|

### <a name="return-value"></a>Valore restituito

TRUESe questo metodo ha esito positivo. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il messaggio [TVM_ENDEDITLABELNOW,](/windows/win32/Controls/tvm-endeditlabelnow) descritto in Windows SDK.

## <a name="ctreectrlensurevisible"></a><a name="ensurevisible"></a>CTreeCtrl::EnsureVisible

Chiamare questa funzione per assicurarsi che un elemento della visualizzazione struttura ad albero sia visibile.

```
BOOL EnsureVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero reso visibile.

### <a name="return-value"></a>Valore restituito

Restituisce TRUE se il sistema ha fatto scorrere gli elementi nel controllo di visualizzazione ad albero per garantire che l'elemento specificato sia visibile. In caso contrario, il valore restituito √® FALSE.

### <a name="remarks"></a>Osservazioni

Se necessario, la funzione espande l'elemento padre o scorre il controllo di visualizzazione ad albero in modo che l'elemento sia visibile.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_6.cpp)]

## <a name="ctreectrlexpand"></a><a name="expand"></a>CTreeCtrl::Espandi

Chiamare questa funzione per espandere o comprimere l'elenco di elementi figlio, se presenti, associati all'elemento padre specificato.

```
BOOL Expand(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero in fase di espansione.

*Ncode*<br/>
Flag che indica il tipo di azione da eseguire. Questo flag pu√≤ avere uno dei seguenti valori:

- TVE_COLLAPSE Comprime l'elenco.

- TVE_COLLAPSERESET Comprime l'elenco e rimuove gli elementi figlio. Il flag di stato TVIS_EXPANDEDONCE viene reimpostato. Questo flag deve essere utilizzato con il flag TVE_COLLAPSE.

- TVE_EXPAND espande l'elenco.

- TVE_TOGGLE Comprime l'elenco se √® attualmente espanso o lo espande se √® attualmente compresso.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetbkcolor"></a><a name="getbkcolor"></a>CTreeCtrl::GetBkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETBKCOLOR](/windows/win32/Controls/tvm-getbkcolor), come descritto in Windows SDK.

```
COLORREF GetBkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore di sfondo della finestra corrente per il controllo. Se questo valore √® -1, il controllo utilizza il colore della finestra di sistema. In questo caso, `::GetSysColor(COLOR_WINDOW)` √® possibile utilizzare per ottenere il colore di sistema corrente utilizzato dal controllo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetTextColor](#settextcolor).

## <a name="ctreectrlgetcheck"></a><a name="getcheck"></a>CTreeCtrl::GetCheck

Chiamare questa funzione membro per recuperare lo stato di controllo di un elemento.

```
BOOL GetCheck(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
HTREEITEM su cui ricevere le informazioni sullo stato.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento del controllo struttura ad albero √® selezionato; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetCheck](#setcheck).

## <a name="ctreectrlgetchilditem"></a><a name="getchilditem"></a>CTreeCtrl::GetChildItem

Chiamare questa funzione per recuperare l'elemento della visualizzazione struttura ad albero che √® l'elemento figlio dell'elemento specificato da *hItem*.

```
HTREEITEM GetChildItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento figlio se ha esito positivo; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_7.cpp)]

## <a name="ctreectrlgetcount"></a><a name="getcount"></a>CTreeCtrl::GetCount

Chiamare questa funzione per recuperare un conteggio degli elementi in un controllo di visualizzazione ad albero.

```
UINT GetCount() const;
```

### <a name="return-value"></a>Valore restituito

Numero di elementi nel controllo di visualizzazione ad albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_8.cpp)]

## <a name="ctreectrlgetdrophilightitem"></a><a name="getdrophilightitem"></a>CTreeCtrl::GetDropHilightItem

Chiamare questa funzione per recuperare l'elemento che √® la destinazione di un'operazione di trascinamento della selezione.

```
HTREEITEM GetDropHilightItem() const;
```

### <a name="return-value"></a>Valore restituito

L'handle dell'elemento eliminato se ha esito positivo; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlgeteditcontrol"></a><a name="geteditcontrol"></a>CTreeCtrl::GetEditControl

Chiamare questa funzione per recuperare l'handle del controllo di modifica utilizzato per modificare il testo di un elemento della visualizzazione struttura ad albero.

```
CEdit* GetEditControl() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore al controllo di modifica utilizzato per modificare il testo dell'elemento, in caso di esito positivo; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#10](../../mfc/reference/codesnippet/cpp/ctreectrl-class_10.cpp)]

## <a name="ctreectrlgetextendedstyle"></a><a name="getextendedstyle"></a>CTreeCtrl::GetExtendedStyle

Recupera gli stili estesi utilizzato dal controllo di visualizzazione ad albero corrente.

```
DWORD GetExtendedStyle() const;
```

### <a name="return-value"></a>Valore restituito

Valore che contiene una combinazione bit per bit (OR) degli stili estesi del controllo struttura ad albero corrente. Per ulteriori informazioni, consultate [Stili estesi del controllo Tree-View](/windows/win32/Controls/tree-view-control-window-extended-styles).

### <a name="remarks"></a>Osservazioni

Questo metodo invia il messaggio [TVM_GETEXTENDEDSTYLE,](/windows/win32/Controls/tvm-getextendedstyle) descritto in Windows SDK.

## <a name="ctreectrlgetfirstvisibleitem"></a><a name="getfirstvisibleitem"></a>CTreeCtrl::GetFirstVisibleItem

Chiamare questa funzione per recuperare il primo elemento visibile del controllo di visualizzazione ad albero.

```
HTREEITEM GetFirstVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle del primo elemento visibile; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetCheck](#setcheck).

## <a name="ctreectrlgetimagelist"></a><a name="getimagelist"></a>CTreeCtrl::GetImageList

Chiamare questa funzione per recuperare l'handle dell'elenco immagini normale o di stato associato al controllo di visualizzazione ad albero.

```
CImageList* GetImageList(UINT nImageList) const;
```

### <a name="parameters"></a>Parametri

*nImageList (elenco immagini)*<br/>
Tipo di elenco immagini da recuperare. L'elenco immagini pu√≤ essere uno dei seguenti valori:

- TVSIL_NORMAL Recupera l'elenco di immagini normali, che contiene le immagini selezionate e non selezionate per l'elemento della visualizzazione struttura.

- TVSIL_STATE Recupera l'elenco delle immagini di stato, che contiene le immagini per gli elementi della visualizzazione struttura ad albero che si trovano in uno stato definito dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco immagini del controllo se ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

A ogni elemento in un controllo di visualizzazione ad albero pu√≤ essere associata una coppia di immagini bitmap. Un'immagine viene visualizzata quando l'elemento √® selezionato e l'altra viene visualizzata quando l'elemento non √® selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando √® selezionato e una cartella chiusa quando non √® selezionata.

Per altre informazioni sugli elenchi di immagini, vedere la classe [CImageList.For](../../mfc/reference/cimagelist-class.md) more information on image lists, see the CImageList class.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#11](../../mfc/reference/codesnippet/cpp/ctreectrl-class_11.cpp)]

## <a name="ctreectrlgetindent"></a><a name="getindent"></a>CTreeCtrl::GetIndent

Chiamare questa funzione per recuperare la quantit√†, in pixel, che gli elementi figlio sono rientrati rispetto agli elementi padre.

```
UINT GetIndent() const;
```

### <a name="return-value"></a>Valore restituito

Quantit√† di rientro misurata in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#12](../../mfc/reference/codesnippet/cpp/ctreectrl-class_12.cpp)]

## <a name="ctreectrlgetinsertmarkcolor"></a><a name="getinsertmarkcolor"></a>CTreeCtrl::GetInsertMarkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETINSERTMARKCOLOR](/windows/win32/Controls/tvm-getinsertmarkcolor), come descritto in Windows SDK.

```
COLORREF GetInsertMarkColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#13](../../mfc/reference/codesnippet/cpp/ctreectrl-class_13.cpp)]

## <a name="ctreectrlgetitem"></a><a name="getitem"></a>CTreeCtrl::GetItem

Chiamare questa funzione per recuperare gli attributi dell'elemento della visualizzazione struttura ad albero specificato.

```
BOOL GetItem(TVITEM* pItem) const;
```

### <a name="parameters"></a>Parametri

*pItem (elemento)*<br/>
Puntatore a una struttura [TVITEM,](/windows/win32/api/commctrl/ns-commctrl-tvitemw) come descritto in Windows SDK.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::DeleteItem](#deleteitem).

## <a name="ctreectrlgetitemdata"></a><a name="getitemdata"></a>CTreeCtrl::GetItemDataCTreeCtrl::GetItemData

Chiamare questa funzione per recuperare il valore specifico dell'applicazione associato all'elemento specificato.

```
DWORD_PTR GetItemData(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento i cui dati devono essere recuperati.

### <a name="return-value"></a>Valore restituito

Valore specifico dell'applicazione delle dimensioni del puntatore associato all'elemento specificato da *hItem*.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#14](../../mfc/reference/codesnippet/cpp/ctreectrl-class_14.cpp)]

## <a name="ctreectrlgetitemexpandedimageindex"></a><a name="getitemexpandedimageindex"></a>CTreeCtrl::GetItemExpandedImageIndex

Recupera l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.

```
int GetItemExpandedImageIndex(HTREEITEM hItem)const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle a un elemento del controllo di visualizzazione ad albero.|

### <a name="return-value"></a>Valore restituito

Indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il [messaggio TVM_GETITEM,](/windows/win32/Controls/tvm-getitem) descritto in Windows SDK. Tale messaggio restituisce la struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) che descrive l'elemento del `iExpandedImage` controllo di visualizzazione ad albero e quindi questo metodo recupera il membro da tale struttura.

## <a name="ctreectrlgetitemheight"></a><a name="getitemheight"></a>CTreeCtrl::GetItemHeightC TreeCtrl::GetItemHeight

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETITEMHEIGHT](/windows/win32/Controls/tvm-getitemheight), come descritto in Windows SDK.

```
SHORT GetItemHeight() const;
```

### <a name="return-value"></a>Valore restituito

Altezza dell'elemento, in pixel.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#15](../../mfc/reference/codesnippet/cpp/ctreectrl-class_15.cpp)]

## <a name="ctreectrlgetitemimage"></a><a name="getitemimage"></a>CTreeCtrl::GetItemImage

A ogni elemento in un controllo di visualizzazione ad albero pu√≤ essere associata una coppia di immagini bitmap.

```
BOOL GetItemImage(
    HTREEITEM hItem,
    int& nImage,
    int& nSelectedImage) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento la cui immagine deve essere recuperata.

*nImmagine*<br/>
Intero che riceve l'indice dell'immagine dell'elemento all'interno dell'elenco di immagini del controllo di visualizzazione ad albero.

*nSelectedImage (Immagine)*<br/>
Intero che riceve l'indice dell'immagine selezionata dell'elemento all'interno dell'elenco di immagini del controllo di visualizzazione ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Le immagini vengono visualizzate sul lato sinistro dell'etichetta di un elemento. Un'immagine viene visualizzata quando l'elemento √® selezionato e l'altra viene visualizzata quando l'elemento non √® selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando √® selezionato e una cartella chiusa quando non √® selezionata.

Chiamare questa funzione per recuperare l'indice dell'immagine dell'elemento e l'immagine selezionata all'interno dell'elenco di immagini del controllo di visualizzazione ad albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#16](../../mfc/reference/codesnippet/cpp/ctreectrl-class_16.cpp)]

## <a name="ctreectrlgetitempartrect"></a><a name="getitempartrect"></a>CTreeCtrl::GetItemPartRectCTreeCtrl::GetItemPartRect

Recupera il rettangolo di delimitazione per una parte specificata di un elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL GetItemPartRect(
    HTREEITEM hItem,
    int nPart,
    LPRECT lpRect)const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle a un elemento del controllo di visualizzazione ad albero.|
|*nParte*|[in] Identificatore per la parte. Deve essere impostato su TVGIPR_BUTTON.|
|*Lprect*|[fuori] Puntatore a una struttura [RECT.](/windows/win32/api/windef/ns-windef-rect) Se questo metodo ha esito positivo, la struttura riceve le coordinate del rettangolo della parte specificata da *hItem* e *nPart*.|

### <a name="return-value"></a>Valore restituito

TRUESe questo metodo ha esito positivo. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Ogni elemento del controllo struttura ad albero √® delimitato da un rettangolo di grafica. Ogni volta che si fa clic su un punto in tale rettangolo, si dice che l'elemento venga *premuto.* Questo metodo restituisce il rettangolo pi√π grande in modo che quando si fa clic su un punto nel rettangolo, viene raggiunto l'elemento identificato dal *hItem* parametro.

Questo metodo invia il messaggio TVM_GETITEMPARTRECT, descritto in Windows SDK. Per ulteriori informazioni, vedere la macro [TreeView_GetItemPartRect.](/windows/win32/api/commctrl/nf-commctrl-treeview_getitempartrect)

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito vengono utilizzati un identificatore di accessibilit√† e il metodo [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) per recuperare un handle per l'elemento della visualizzazione albero radice. Quindi l'esempio utilizza l'handle e il [CTreeCtrl::GetItemPartRect](#getitempartrect) metodo per disegnare un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. √à stato utilizzato il [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) metodo per associare l'elemento di visualizzazione albero radice con un identificatore di accessibilit√†.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlgetitemrect"></a><a name="getitemrect"></a>CTreeCtrl::GetItemRectCTreeCtrl::GetItemRect

Chiamare questa funzione per recuperare il rettangolo di delimitazione per *hItem* e determinare se √® visibile o meno.

```
BOOL GetItemRect(
    HTREEITEM hItem,
    LPRECT lpRect,
    BOOL bTextOnly) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento del controllo di visualizzazione ad albero.

*Lprect*<br/>
Puntatore a una struttura [RECT](/windows/win32/api/windef/ns-windef-rect) che riceve il rettangolo di delimitazione. Le coordinate sono relative all'angolo superiore sinistro del controllo di visualizzazione ad albero.

*bTestoSolo*<br/>
Se questo parametro √® diverso da zero, il rettangolo di delimitazione include solo il testo dell'elemento. In caso contrario, include l'intera riga occupata dall'elemento nel controllo di visualizzazione ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento √® visibile, con il rettangolo di delimitazione contenuto in *lpRect*. In caso contrario, 0 con *lpRect* non inizializzato.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#17](../../mfc/reference/codesnippet/cpp/ctreectrl-class_19.cpp)]

## <a name="ctreectrlgetitemstate"></a><a name="getitemstate"></a>CTreeCtrl::GetItemState

Restituisce lo stato dell'elemento specificato da *hItem*.

```
UINT GetItemState(
    HTREEITEM hItem,
    UINT nStateMask) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento il cui stato deve essere recuperato.

*nStateMaschera*<br/>
Maschera che indica uno o pi√π stati da recuperare. Per ulteriori informazioni sui valori possibili per *nStateMask*, vedere la discussione dei membri `state` e `stateMask` della struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) in Windows SDK.

### <a name="return-value"></a>Valore restituito

Oggetto UINT che contiene l'operatore OR bit per bit dei valori specificati da nStateMask. Per informazioni sui valori possibili, vedere [CTreeCtrl::GetItem](#getitem). Per trovare il valore per uno stato specifico, eseguire un'operazione AND bit per bit del valore dello stato e del valore restituito, come illustrato nell'esempio seguente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#18](../../mfc/reference/codesnippet/cpp/ctreectrl-class_20.cpp)]

## <a name="ctreectrlgetitemstateex"></a><a name="getitemstateex"></a>CTreeCtrl::GetItemStateEx

Recupera lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
UINT GetItemStateEx(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle a un elemento del controllo di visualizzazione ad albero.|

### <a name="return-value"></a>Valore restituito

Stato esteso dell'elemento. Per ulteriori informazioni, `uStateEx` vedere il membro della struttura [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)

### <a name="remarks"></a>Osservazioni

Questo metodo invia il [messaggio TVM_GETITEM,](/windows/win32/Controls/tvm-getitem) descritto in Windows SDK. Tale messaggio restituisce la struttura [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) che descrive l'elemento del `uStateEx` controllo di visualizzazione ad albero e questo metodo recupera il membro da tale struttura.

## <a name="ctreectrlgetitemtext"></a><a name="getitemtext"></a>CTreeCtrl::GetItemText

Restituisce il testo dell'elemento specificato da *hItem*.

```
CString GetItemText(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento il cui testo deve essere recuperato.

### <a name="return-value"></a>Valore restituito

Oggetto `CString` contenente il testo dell'elemento.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetNextItem](#getnextitem).

## <a name="ctreectrlgetlastvisibleitem"></a><a name="getlastvisibleitem"></a>CTreeCtrl::GetLastVisibleItem

Recupera l'ultimo elemento del nodo non espanso nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM GetLastVisibleItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle per l'ultimo elemento di nodo non espanso se il metodo ha esito positivo; in caso contrario, NULL.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il [messaggio TVM_GETNEXTITEM,](/windows/win32/Controls/tvm-getnextitem) descritto in Windows SDK. Per ulteriori informazioni, vedere il flag TVGN_LASTVISIBLE nel parametro *flag* del messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Una o pi√π di queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene recuperato un handle per l'ultimo elemento del nodo della visualizzazione albero non espanso e quindi viene disegnato un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#6](../../mfc/reference/codesnippet/cpp/ctreectrl-class_21.cpp)]

## <a name="ctreectrlgetlinecolor"></a><a name="getlinecolor"></a>CTreeCtrl::GetLineColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETLINECOLOR](/windows/win32/Controls/tvm-getlinecolor), come descritto in Windows SDK.

```
COLORREF GetLineColor() const;
```

### <a name="return-value"></a>Valore restituito

Colore della linea corrente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#19](../../mfc/reference/codesnippet/cpp/ctreectrl-class_22.cpp)]

## <a name="ctreectrlgetnextitem"></a><a name="getnextitem"></a>CTreeCtrl::GetNextItem

Chiamare questa funzione per recuperare l'elemento della visualizzazione struttura ad albero con la relazione specificata, indicata dal *nCode* parametro, a *hItem*.

```
HTREEITEM GetNextItem(
    HTREEITEM hItem,
    UINT nCode) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

*Ncode*<br/>
Flag che indica il tipo di relazione con *hItem*. Questo flag pu√≤ essere uno dei seguenti valori:

- TVGN_CARET Recupera l'elemento attualmente selezionato.

- TVGN_CHILD Recupera il primo elemento figlio dell'elemento specificato dal *hItem* parametro.

- TVGN_DROPHILITE Recupera l'elemento che √® la destinazione di un'operazione di trascinamento della selezione.

- TVGN_FIRSTVISIBLE Recupera il primo elemento visibile.

- TVGN_LASTVISIBLE Recupera l'ultimo elemento espanso nella struttura ad albero. In questo modo non viene recuperato l'ultimo elemento visibile nella finestra di visualizzazione ad albero.

- TVGN_NEXT Recupera l'elemento di pari livello successivo.

- TVGN_NEXTVISIBLE Recupera l'elemento visibile successivo che segue l'elemento specificato.

- TVGN_PARENT Recupera l'elemento padre dell'elemento specificato.

- TVGN_PREVIOUS recupera l'elemento di pari livello precedente.

- TVGN_PREVIOUSVISIBLE Recupera il primo elemento visibile che precede l'elemento specificato.

- TVGN_ROOT Recupera il primo elemento figlio dell'elemento radice di cui l'elemento specificato √® una parte.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento successivo se ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

Questa funzione restituir√† NULL se l'elemento da recuperare √® il nodo radice della struttura ad albero. Ad esempio, se si utilizza questo messaggio con il flag di TVGN_PARENT in un elemento figlio di primo livello del nodo radice della visualizzazione struttura ad albero, il messaggio restituir√† NULL.

### <a name="example"></a>Esempio

Per un esempio `GetNextItem` di utilizzo in un ciclo, vedere [CTreeCtrl::DeleteItem](#deleteitem).

[!code-cpp[NVC_MFC_CTreeCtrl#20](../../mfc/reference/codesnippet/cpp/ctreectrl-class_23.cpp)]

## <a name="ctreectrlgetnextsiblingitem"></a><a name="getnextsiblingitem"></a>CTreeCtrl::GetNextSiblingItem

Chiamare questa funzione per recuperare l'elemento di pari livello successivo di *hItem*.

```
HTREEITEM GetNextSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento di pari livello successivo; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#21](../../mfc/reference/codesnippet/cpp/ctreectrl-class_24.cpp)]

## <a name="ctreectrlgetnextvisibleitem"></a><a name="getnextvisibleitem"></a>CTreeCtrl::GetNextVisibleItem

Chiamare questa funzione per recuperare l'elemento visibile successivo di *hItem*.

```
HTREEITEM GetNextVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento visibile successivo; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetCheck](#setcheck).

## <a name="ctreectrlgetparentitem"></a><a name="getparentitem"></a>CTreeCtrl::GetParentItem

Chiamare questa funzione per recuperare l'elemento padre di *hItem*.

```
HTREEITEM GetParentItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento padre; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

Questa funzione restituir√† NULL se l'elemento padre dell'elemento specificato √® il nodo radice della struttura ad albero.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::EnsureVisible](#ensurevisible).

## <a name="ctreectrlgetprevsiblingitem"></a><a name="getprevsiblingitem"></a>CTreeCtrl::GetPrevSiblingItem

Chiamare questa funzione per recuperare l'elemento di pari livello precedente di *hItem*.

```
HTREEITEM GetPrevSiblingItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento di pari livello precedente; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#22](../../mfc/reference/codesnippet/cpp/ctreectrl-class_25.cpp)]

## <a name="ctreectrlgetprevvisibleitem"></a><a name="getprevvisibleitem"></a>CTreeCtrl::GetPrevVisibleItem

Chiamare questa funzione per recuperare l'elemento visibile precedente di *hItem*.

```
HTREEITEM GetPrevVisibleItem(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento visibile precedente; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#23](../../mfc/reference/codesnippet/cpp/ctreectrl-class_26.cpp)]

## <a name="ctreectrlgetrootitem"></a><a name="getrootitem"></a>CTreeCtrl::GetRootItem

Chiamare questa funzione per recuperare l'elemento radice del controllo di visualizzazione ad albero.

```
HTREEITEM GetRootItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle dell'elemento radice; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::EditLabel](#editlabel).

## <a name="ctreectrlgetscrolltime"></a><a name="getscrolltime"></a>CTreeCtrl::GetScrollTime

Chiamare questa funzione membro per recuperare il tempo di scorrimento massimo per il controllo di visualizzazione ad albero.

```
UINT GetScrollTime() const;
```

### <a name="return-value"></a>Valore restituito

Tempo massimo di scorrimento, in millisecondi.

### <a name="remarks"></a>Osservazioni

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETSCROLLTIME](/windows/win32/Controls/tvm-getscrolltime), come descritto in Windows SDK.

## <a name="ctreectrlgetselectedcount"></a><a name="getselectedcount"></a>CTreeCtrl::GetSelectedCount

Recupera il numero di elementi selezionati nel controllo di visualizzazione ad albero corrente.

```
UINT GetSelectedCount();
```

### <a name="return-value"></a>Valore restituito

Il numero di elementi selezionati.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il messaggio [di TVM_GETSELECTEDCOUNT,](/windows/win32/Controls/tvm-getselectedcount) descritto in Windows SDK.

## <a name="ctreectrlgetselecteditem"></a><a name="getselecteditem"></a>CTreeCtrl::GetSelectedItem

Chiamare questa funzione per recuperare l'elemento attualmente selezionato del controllo di visualizzazione ad albero.

```
HTREEITEM GetSelectedItem() const;
```

### <a name="return-value"></a>Valore restituito

Handle dell'elemento selezionato; in caso contrario NULL.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#24](../../mfc/reference/codesnippet/cpp/ctreectrl-class_27.cpp)]

## <a name="ctreectrlgettextcolor"></a><a name="gettextcolor"></a>CTreeCtrl::GetTextColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETTEXTCOLOR](/windows/win32/Controls/tvm-gettextcolor), come descritto in Windows SDK.

```
COLORREF GetTextColor() const;
```

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore √® -1, il controllo utilizza il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetTextColor](#settextcolor).

## <a name="ctreectrlgettooltips"></a><a name="gettooltips"></a>CTreeCtrl::GetToolTips

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_GETTOOLTIPS](/windows/win32/Controls/tvm-gettooltips), come descritto in Windows SDK.

```
CToolTipCtrl* GetToolTips() const;
```

### <a name="return-value"></a>Valore restituito

Puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto che deve essere utilizzato dal controllo struttura ad albero. Se il [Create](#create) funzione membro utilizza lo stile TVS_NOTOOLTIPS, non vengono utilizzate descrizioni comandi e VIENE restituito NULL.

### <a name="remarks"></a>Osservazioni

L'implementazione `GetToolTips` MFC `CToolTipCtrl` di restituisce un oggetto, che viene utilizzato dal controllo struttura ad albero, anzich√© un handle per un controllo descrizione comandi.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#25](../../mfc/reference/codesnippet/cpp/ctreectrl-class_28.cpp)]

## <a name="ctreectrlgetvisiblecount"></a><a name="getvisiblecount"></a>CTreeCtrl::GetVisibleCount

Chiamare questa funzione per recuperare un conteggio degli elementi visibili in un controllo di visualizzazione ad albero.

```
UINT GetVisibleCount() const;
```

### <a name="return-value"></a>Valore restituito

Il numero di elementi visibili nel controllo di visualizzazione ad albero; in caso contrario - 1.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetCheck](#setcheck).

## <a name="ctreectrlhittest"></a><a name="hittest"></a>CTreeCtrl::HitTest

Chiamare questa funzione per determinare la posizione del punto specificato rispetto all'area client di un controllo di visualizzazione ad albero.

```
HTREEITEM HitTest(
    CPoint pt,
    UINT* pFlags = NULL) const;

HTREEITEM HitTest(TVHITTESTINFO* pHitTestInfo) const;
```

### <a name="parameters"></a>Parametri

*pt*<br/>
Coordinate client del punto da testare.

*pFlags (Flag)*<br/>
Puntatore a un numero intero che riceve informazioni sui risultati dell'hit test. Pu√≤ essere uno o pi√π dei `flags` valori elencati sotto il membro nella sezione Osservazioni.

*pHitTestInfo (informazioni in stato in stato in stato in stato*<br/>
Indirizzo di una struttura [TVHITTESTINFO](/windows/win32/api/commctrl/ns-commctrl-tvhittestinfo) che contiene la posizione di hit test e che riceve informazioni sui risultati dell'hit test.

### <a name="return-value"></a>Valore restituito

Handle dell'elemento della visualizzazione struttura ad albero che occupa il punto specificato o NULL se nessun elemento occupa il punto.

### <a name="remarks"></a>Osservazioni

Quando questa funzione viene chiamata, il parametro *pt* specifica le coordinate del punto da testare. La funzione restituisce l'handle dell'elemento nel punto specificato o NULL se nessun elemento occupa il punto. Inoltre, il *pFlags* parametro contiene un valore che indica la posizione del punto specificato. I valori possibili sono:

|||
|-|-|
|valore|Significato|
|TVHT_ABOVE|Sopra l'area client.|
|TVHT_BELOW|Sotto l'area client.|
|TVHT_NOWHERE|Nell'area client, ma sotto l'ultimo elemento.|
|TVHT_ONITEM|Sulla bitmap o sull'etichetta associata a un elemento.|
|TVHT_ONITEMBUTTON|Sul pulsante associato a un elemento.|
|TVHT_ONITEMICON|Sulla bitmap associata a un elemento.|
|TVHT_ONITEMINDENT|Nel rientro associato a un elemento.|
|TVHT_ONITEMLABEL|Sull'etichetta (stringa) associata a un elemento.|
|TVHT_ONITEMRIGHT|Nell'area a destra di un elemento.|
|TVHT_ONITEMSTATEICON|Sull'icona dello stato per un elemento di visualizzazione ad albero che si trova in uno stato definito dall'utente.|
|TVHT_TOLEFT|A sinistra dell'area client.|
|TVHT_TORIGHT|A destra dell'area client.|
|||

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlinsertitem"></a><a name="insertitem"></a>CTreeCtrl::InsertItem

Chiamare questa funzione per inserire un nuovo elemento in un controllo di visualizzazione ad albero.

```
HTREEITEM InsertItem(LPTVINSERTSTRUCT lpInsertStruct);

HTREEITEM InsertItem(
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam,
    HTREEITEM hParent,
    HTREEITEM hInsertAfter);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);

HTREEITEM InsertItem(
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    HTREEITEM hParent = TVI_ROOT,
    HTREEITEM hInsertAfter = TVI_LAST);
```

### <a name="parameters"></a>Parametri

*lpInsertStruct (oggetto LpInsertStruct)*<br/>
Puntatore a `TVINSERTSTRUCT` un oggetto che specifica gli attributi dell'elemento della visualizzazione struttura ad albero da inserire.

*nMaschera*<br/>
Numero intero che specifica gli attributi da impostare. Vedere `TVITEM` la struttura in Windows SDK.

*lpszItem (elemento di gruppo)*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*nImmagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini del controllo di visualizzazione ad albero.

*nSelectedImage (Immagine)*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione ad albero.

*nStato*<br/>
Specifica i valori per gli stati dell'elemento. Vedere Stati degli elementi del controllo di visualizzazione ad albero in Windows SDK per un elenco degli stati appropriati.

*nStateMaschera*<br/>
Specifica quali stati devono essere impostati. Vedere `TVITEM` la struttura in Windows SDK.

*lParam*<br/>
Valore specifico dell'applicazione delle dimensioni del puntatore associato all'elemento.

*hGenitore*<br/>
Handle dell'elemento padre dell'elemento inserito.

*hInserisciDopo*<br/>
Handle dell'elemento dopo il quale deve essere inserito il nuovo elemento.

### <a name="return-value"></a>Valore restituito

Handle del nuovo elemento se ha esito positivo; in caso contrario NULL.

### <a name="remarks"></a>Osservazioni

Nell'esempio vengono illustrate le situazioni in cui √® possibile utilizzare ogni versione della funzione quando si inserisce un elemento del controllo struttura ad albero.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#27](../../mfc/reference/codesnippet/cpp/ctreectrl-class_30.cpp)]

## <a name="ctreectrlitemhaschildren"></a><a name="itemhaschildren"></a>CTreeCtrl::ItemHasChildren

Utilizzare questa funzione per determinare se l'elemento della struttura ad albero specificato da *hItem* dispone di elementi figlio.

```
BOOL ItemHasChildren(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se l'elemento della struttura ad albero specificato da *hItem* dispone di elementi figlio; 0 in caso contrario.

### <a name="remarks"></a>Osservazioni

In tal caso, √® quindi possibile utilizzare [CTreeCtrl::GetChildItem](#getchilditem) per recuperare gli elementi figlio.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetSelectedItem](#getselecteditem).

## <a name="ctreectrlmapaccidtoitem"></a><a name="mapaccidtoitem"></a>CTreeCtrl::MapAccIdToItem

Esegue il mapping dell'identificatore di accessibilit√† specificato all'handle di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente.

```
HTREEITEM MapAccIdToItem(UINT uAccId) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*uAccId (informazioni in stato inquesto e in*|[in] Identificatore di accessibilit√† per un elemento nell'elemento della visualizzazione albero.|

### <a name="return-value"></a>Valore restituito

Handle per un elemento di `HTREEITEM`visualizzazione ad albero ( ) che corrisponde al *uAccId* parametro. Per ulteriori informazioni, vedere il membro *hItem* della struttura [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)

### <a name="remarks"></a>Osservazioni

Gli strumenti di accessibilit√† sono applicazioni che aiutano le persone con disabilit√† a utilizzare i computer. Un identificatore di `IAccessible` accessibilit√† viene utilizzato dall'interfaccia per specificare in modo univoco un elemento in una finestra. Per ulteriori informazioni sugli identificatori di accessibilit√†, cercare l'argomento "Informazioni sul supporto per Active Accessibility" in [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il [messaggio TVM_MAPACCIDTOHTREEITEM,](/windows/win32/Controls/tvm-mapaccidtohtreeitem) descritto in Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito vengono utilizzati un identificatore di accessibilit√† e il metodo [CTreeCtrl::MapAccIdToItem](#mapaccidtoitem) per recuperare un handle per l'elemento della visualizzazione albero radice. Nell'esempio vengono utilizzati l'handle e il [metodo CTreeCtrl::GetItemPartRect](#getitempartrect) per disegnare un rettangolo 3D intorno a tale elemento. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. √à stato utilizzato il [CTreeCtrl::MapItemToAccID](#mapitemtoaccid) metodo per associare l'elemento di visualizzazione albero radice con un identificatore di accessibilit√†.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#5](../../mfc/reference/codesnippet/cpp/ctreectrl-class_18.cpp)]

## <a name="ctreectrlmapitemtoaccid"></a><a name="mapitemtoaccid"></a>CTreeCtrl::MapItemToAccID

Esegue il mapping dell'handle specificato di un elemento di visualizzazione ad albero nel controllo di visualizzazione ad albero corrente a un identificatore di accessibilit√†.

```
UINT MapItemToAccID(HTREEITEM hItem) const;
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle di un elemento di visualizzazione ad albero nel controllo. Per ulteriori informazioni, vedere il membro *hItem* della struttura [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="return-value"></a>Valore restituito

Identificatore di accessibilit√† che corrisponde al parametro *hItem.*

### <a name="remarks"></a>Osservazioni

Gli strumenti di accessibilit√† sono applicazioni che aiutano le persone con disabilit√† a utilizzare i computer. Un identificatore di `IAccessible` accessibilit√† viene utilizzato dall'interfaccia per specificare in modo univoco un elemento in una finestra. Per ulteriori informazioni sugli identificatori di accessibilit√†, cercare l'argomento "Informazioni sul supporto per Active Accessibility" in [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il messaggio [di TVM_MAPHTREEITEMTOACCID,](/windows/win32/Controls/tvm-maphtreeitemtoaccid) descritto in Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene ottenuto un numero di identificazione per un elemento del controllo di visualizzazione ad albero. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. In questo esempio di codice viene ottenuto un numero di identificazione univoco per il nodo del paese radice.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#2](../../mfc/reference/codesnippet/cpp/ctreectrl-class_31.cpp)]

## <a name="ctreectrlselect"></a><a name="select"></a>CTreeCtrl::Selezionare

Chiamare questa funzione per selezionare l'elemento della visualizzazione albero specificato, scorrere l'elemento nella visualizzazione o ridisegnare l'elemento nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento della selezione.

```
BOOL Select(
    HTREEITEM hItem,
    UINT nCode);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

*Ncode*<br/>
Tipo di azione da eseguire. Questo parametro pu√≤ essere uno dei seguenti valori:

- TVGN_CARET Imposta la selezione sull'elemento specificato.

- TVGN_DROPHILITE Ridisegna l'elemento specificato nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento della selezione.

- TVGN_FIRSTVISIBLE Scorre la visualizzazione struttura ad albero verticalmente in modo che l'elemento specificato sia il primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Se *nCode* contiene il valore TVGN_CARET, la finestra padre riceve i messaggi di notifica TVN_SELCHANGING e TVN_SELCHANGED. Inoltre, se l'elemento specificato √® l'elemento figlio di un elemento padre compresso, l'elenco degli elementi figlio dell'elemento padre viene espanso per visualizzare l'elemento specificato. In questo caso, la finestra padre riceve i messaggi di notifica TVN_ITEMEXPANDING e TVN_ITEMEXPANDED.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::HitTest](#hittest).

## <a name="ctreectrlselectdroptarget"></a><a name="selectdroptarget"></a>CTreeCtrl::SelectDropTarget

Chiamare questa funzione per ridisegnare l'elemento nello stile utilizzato per indicare la destinazione di un'operazione di trascinamento della selezione.

```
BOOL SelectDropTarget(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#9](../../mfc/reference/codesnippet/cpp/ctreectrl-class_9.cpp)]

## <a name="ctreectrlselectitem"></a><a name="selectitem"></a>CTreeCtrl::SelectItem

Chiamare questa funzione per selezionare l'elemento della visualizzazione albero specificato.

```
BOOL SelectItem(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle di un elemento della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Se *hItem* √® NULL, questa funzione non seleziona alcun elemento.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#26](../../mfc/reference/codesnippet/cpp/ctreectrl-class_29.cpp)]

## <a name="ctreectrlselectsetfirstvisible"></a><a name="selectsetfirstvisible"></a>CTreeCtrl::SelectSetFirstVisible

Chiamare questa funzione per scorrere la visualizzazione struttura ad albero verticalmente in modo che l'elemento specificato √® il primo elemento visibile.

```
BOOL SelectSetFirstVisible(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento della struttura ad albero da impostare come primo elemento visibile.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

La funzione invia un messaggio alla finestra con i parametri TVM_SELECTITEM e TVGN_FIRSTVISIBLE del messaggio.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#28](../../mfc/reference/codesnippet/cpp/ctreectrl-class_32.cpp)]

## <a name="ctreectrlsetautoscrollinfo"></a><a name="setautoscrollinfo"></a>CTreeCtrl::SetAutoscrollInfo

Imposta la frequenza di scorrimento automatico del controllo di visualizzazione ad albero corrente.

```
BOOL SetAutoscrollInfo(
    UINT uPixelsPerSec,
    UINT uUpdateTime);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*uPixelsPerSec*|[in] Numero di pixel al secondo di scorrimento.|
|*UUpdateTime (ora di aggiornamento)*|[in] Intervallo di tempo tra gli aggiornamenti del controllo.|

### <a name="return-value"></a>Valore restituito

Restituisce sempre TRUE.

### <a name="remarks"></a>Osservazioni

I parametri di scorrimento automatico vengono utilizzati per scorrere visualizzare un elemento che non √® attualmente visibile. Il controllo di visualizzazione ad albero deve avere lo stile TVS_EX_AUTOHSCROLL esteso, descritto in Stili estesi del [controllo Tree-View](/windows/win32/Controls/tree-view-control-window-extended-styles).

Questo metodo invia il [messaggio TVM_SETAUTOSCROLLINFO,](/windows/win32/Controls/tvm-setautoscrollinfo) descritto in Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene impostato il comportamento di scorrimento automatico del controllo di visualizzazione ad albero corrente. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. Il controllo di visualizzazione ad albero √® stato intenzionalmente restato stretto in modo che debba scorrere automaticamente per visualizzare l'elemento della struttura ad albero con lo stato attivo. Nell'esempio di codice viene impostato il controllo di visualizzazione ad albero per lo scorrimento automatico di 30 pixel al secondo ogni 5 secondi fino a quando l'elemento della struttura ad albero non √® visualizzato.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#4](../../mfc/reference/codesnippet/cpp/ctreectrl-class_33.cpp)]

## <a name="ctreectrlsetbkcolor"></a><a name="setbkcolor"></a>CTreeCtrl::SetBkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETBKCOLOR](/windows/win32/Controls/tvm-setbkcolor), come descritto in Windows SDK.

```
COLORREF SetBkColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*Clr*<br/>
Valore COLORREF che contiene il nuovo colore di sfondo. Se questo valore √® -1, il controllo torner√† a utilizzare il colore di sistema per il colore di sfondo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo corrente. Se questo valore √® -1, il controllo utilizza il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::SetTextColor](#settextcolor).

## <a name="ctreectrlsetcheck"></a><a name="setcheck"></a>CTreeCtrl::SetCheck

Chiamare questa funzione membro per impostare lo stato di controllo per un elemento del controllo struttura ad albero.

```
BOOL SetCheck(
    HTREEITEM hItem,
    BOOL fCheck = TRUE);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
HTREEITEM per ricevere la modifica dello stato del controllo.

*fControllare*<br/>
Indica se l'elemento del controllo struttura ad albero deve essere selezionato o deselezionato. Per impostazione predefinita, `SetCheck` imposta l'elemento da selezionare.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Quando l'elemento del controllo struttura ad albero √® selezionato ( *fCheck* impostato su TRUE), l'elemento viene visualizzato con un segno di spunta adiacente.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#29](../../mfc/reference/codesnippet/cpp/ctreectrl-class_34.cpp)]

### <a name="example"></a>Esempio

Per utilizzare le caselle di controllo, impostare TVS_CHECKBOXES prima di popolare il controllo struttura ad albero.

[!code-cpp[NVC_MFC_CTreeCtrl#30](../../mfc/reference/codesnippet/cpp/ctreectrl-class_35.cpp)]

## <a name="ctreectrlsetextendedstyle"></a><a name="setextendedstyle"></a>CTreeCtrl::SetExtendedStyle (combinazione di oggetti)

Imposta gli stili estesi per il controllo di visualizzazione ad albero corrente.

```
DWORD SetExtendedStyle(
    DWORD dwExMask,
    DWORD dwExStyles);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*DwExMaschera*|[in] Maschera di bit che specifica quali stili nel controllo di visualizzazione ad albero corrente sono interessati da questo metodo. Se questo parametro √® zero, viene ignorato e il valore del parametro *dwExStyles* viene assegnato al controllo di visualizzazione ad albero.<br /><br /> Specificare zero o una combinazione bit per bit (OR) degli stili descritti in Stili estesi del [controllo Tree-View](/windows/win32/Controls/tree-view-control-window-extended-styles).|
|*Stili dwEx*|[in] Maschera di bit che specifica gli stili nel controllo di visualizzazione ad albero corrente da impostare o cancellare.<br /><br /> Per impostare una combinazione di stili, specificare una combinazione bit per bit (OR) degli stili descritti in Stili estesi del [controllo Tree-View](/windows/win32/Controls/tree-view-control-window-extended-styles). Per cancellare un set di stili, specificare zero.|

### <a name="return-value"></a>Valore restituito

Valore che contiene gli stili di controllo estesi precedenti.

### <a name="remarks"></a>Osservazioni

Questo metodo cancella gli stili specificati nel parametro *dwExMask,* quindi imposta gli stili specificati nel parametro *dwExStyles.* Solo gli stili estesi che corrispondono ai bit nella modifica *di dwExMask.*

Questo metodo invia il [messaggio di TVM_SETEXTENDEDSTYLE,](/windows/win32/Controls/tvm-setextendedstyle) descritto in Windows SDK.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Esempio di codice seguente aggiunge il TVS_EX_AUTOHSCROLL stile esteso al controllo di visualizzazione ad albero corrente. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. Il controllo di visualizzazione ad albero √® stato intenzionalmente restato stretto in modo che debba scorrere automaticamente per visualizzare l'elemento della struttura ad albero con lo stato attivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#3](../../mfc/reference/codesnippet/cpp/ctreectrl-class_36.cpp)]

## <a name="ctreectrlsetimagelist"></a><a name="setimagelist"></a>CTreeCtrl::SetImageList

Chiamare questa funzione per impostare l'elenco di immagini normale o di stato per un controllo di visualizzazione ad albero e ridisegnare il controllo utilizzando le nuove immagini.

```
CImageList* SetImageList(
    CImageList* pImageList,
    int nImageListType);
```

### <a name="parameters"></a>Parametri

*pImageList (elenco immagine)*<br/>
Puntatore all'elenco immagini da assegnare. Se *pImageList* √® NULL, tutte le immagini vengono rimosse dal controllo di visualizzazione ad albero.

*nImageListType*<br/>
Tipo di elenco immagini da impostare. L'elenco immagini pu√≤ essere uno dei seguenti valori:

- TVSIL_NORMAL Imposta l'elenco di immagini normale, che contiene le immagini selezionate e non selezionate per l'elemento della vista ad albero. √à necessario utilizzare questo stato per le immagini sovrapposte.

- TVSIL_STATE Imposta l'elenco delle immagini di stato, che contiene le immagini per gli elementi della visualizzazione struttura ad albero che si trovano in uno stato definito dall'utente.

### <a name="return-value"></a>Valore restituito

Puntatore all'elenco di immagini precedente, se presente; in caso contrario NULL.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetImageList](#getimagelist).

## <a name="ctreectrlsetindent"></a><a name="setindent"></a>CTreeCtrl::SetIndent

Chiamare questa funzione per impostare la larghezza del rientro per un controllo di visualizzazione ad albero e ridisegnare il controllo per riflettere la nuova larghezza.

```cpp
void SetIndent(UINT nIndent);
```

### <a name="parameters"></a>Parametri

*nIndent*<br/>
Larghezza, in pixel, del rientro. Se *nIndent* √® minore della larghezza minima definita dal sistema, la nuova larghezza viene impostata sul valore minimo definito dal sistema.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetIndent](#getindent).

## <a name="ctreectrlsetinsertmark"></a><a name="setinsertmark"></a>CTreeCtrl::SetInsertMark

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETINSERTMARK](/windows/win32/Controls/tvm-setinsertmark), come descritto in Windows SDK.

```
BOOL SetInsertMark(
    HTREEITEM hItem,
    BOOL fAfter = TRUE);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
HTREEITEM che specifica in quale punto dell'elemento verr√† posizionato il segno di inserimento. Se questo argomento √® NULL, il segno di inserimento viene rimosso.

*fAldi*<br/>
Valore BOOL che specifica se il segno di inserimento viene posizionato prima o dopo l'elemento specificato. Se questo argomento √® diverso da zero, il segno di inserimento verr√† posizionato dopo l'elemento. Se questo argomento √® zero, il segno di inserimento verr√† posizionato prima dell'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#31](../../mfc/reference/codesnippet/cpp/ctreectrl-class_37.cpp)]

## <a name="ctreectrlsetinsertmarkcolor"></a><a name="setinsertmarkcolor"></a>CTreeCtrl::SetInsertMarkColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETINSERTMARKCOLOR](/windows/win32/Controls/tvm-setinsertmarkcolor), come descritto in Windows SDK.

```
COLORREF SetInsertMarkColor(COLORREF clrNew);
```

### <a name="parameters"></a>Parametri

*ClrNew (informazioni in base alla propriet√†*<br/>
Valore COLORREF che contiene il nuovo colore del segno di inserimento.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che contiene il colore del segno di inserimento precedente.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetInsertMarkColor](#getinsertmarkcolor).

## <a name="ctreectrlsetitem"></a><a name="setitem"></a>CTreeCtrl::SetItem

Chiamare questa funzione per impostare gli attributi dell'elemento della visualizzazione struttura ad albero specificato.

```
BOOL SetItem(TVITEM* pItem);

BOOL SetItem(
    HTREEITEM hItem,
    UINT nMask,
    LPCTSTR lpszItem,
    int nImage,
    int nSelectedImage,
    UINT nState,
    UINT nStateMask,
    LPARAM lParam);
```

### <a name="parameters"></a>Parametri

*pItem (elemento)*<br/>
Puntatore a una struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) che contiene gli attributi del nuovo elemento, come descritto in Windows SDK.

*hElemento*<br/>
Handle dell'elemento i cui attributi devono essere impostati. Vedere `hItem` il membro `TVITEM` della struttura in Windows SDK.

*nMaschera*<br/>
Numero intero che specifica gli attributi da impostare. Vedere il membro `mask` della struttura `TVITEM`.

*lpszItem (elemento di gruppo)*<br/>
Indirizzo di una stringa contenente il testo dell'elemento.

*nImmagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini del controllo di visualizzazione ad albero. Vedere il membro `iImage` della struttura `TVITEM`.

*nSelectedImage (Immagine)*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione ad albero. Vedere il membro `iSelectedImage` della struttura `TVITEM`.

*nStato*<br/>
Specifica i valori per gli stati dell'elemento. Vedere il membro `State` della struttura `TVITEM`.

*nStateMaschera*<br/>
Specifica quali stati devono essere impostati. Vedere il membro `stateMask` della struttura `TVITEM`.

*lParam*<br/>
Valore specifico dell'applicazione delle dimensioni del puntatore associato all'elemento.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Nella `TVITEM` struttura, `hItem` il membro identifica l'elemento e il `mask` membro specifica gli attributi da impostare.

Se `mask` il membro o il parametro *nMask* specifica il valore TVIF_TEXT, il `pszText` membro o *lpszItem* √® l'indirizzo di una stringa con terminazione null e il `cchTextMax` membro viene ignorato. Se `mask` (o *nMask*) specifica il `stateMask` valore TVIF_STATE, il membro o il parametro `state` *nStateMask* specifica gli stati dell'elemento da modificare e il parametro member o *nState* contiene i valori per tali stati.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#32](../../mfc/reference/codesnippet/cpp/ctreectrl-class_38.cpp)]

## <a name="ctreectrlsetitemdata"></a><a name="setitemdata"></a>CTreeCtrl::SetItemData

Chiamare questa funzione per impostare il valore specifico dell'applicazione associato all'elemento specificato.

```
BOOL SetItemData(
    HTREEITEM hItem,
    DWORD_PTR dwData);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento i cui dati devono essere recuperati.

*dwData (dati)*<br/>
Valore specifico dell'applicazione delle dimensioni del puntatore associato all'elemento specificato da *hItem*.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#33](../../mfc/reference/codesnippet/cpp/ctreectrl-class_39.cpp)]

## <a name="ctreectrlsetitemexpandedimageindex"></a><a name="setitemexpandedimageindex"></a>CTreeCtrl::SetItemExpandedImageIndex

Imposta l'indice dell'immagine da visualizzare quando l'elemento specificato del controllo di visualizzazione ad albero corrente si trova nello stato espanso.

```
BOOL SetItemExpandedImageIndex(
    HTREEITEM hItem,
    int iExpandedImage);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle a un elemento del controllo di visualizzazione ad albero.|
|*IExpandedImage (immagine espansione)*|[in] Indice dell'immagine da visualizzare quando l'elemento specificato si trova nello stato espanso.|

### <a name="return-value"></a>Valore restituito

TRUESe questo metodo ha esito positivo. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il [messaggio di TVM_SETITEM,](/windows/win32/Controls/tvm-setitem) descritto in Windows SDK. Questo metodo assegna il *iExpandedImage* parametro al `iExpandedImage` membro di un [TVITEMEX](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) struttura e quindi utilizza tale struttura nel messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

L'esempio di codice seguente √® un test semplice per determinare se il [Metodo CTreeCtrl::GetItemExpandedImageIndex](#getitemexpandedimageindex) restituisce il valore impostato dal metodo [CTreeCtrl::SetItemExpandedImageIndex.](#setitemexpandedimageindex) In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#8](../../mfc/reference/codesnippet/cpp/ctreectrl-class_40.cpp)]

## <a name="ctreectrlsetitemheight"></a><a name="setitemheight"></a>CTreeCtrl::SetItemHeight

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETITEMHEIGHT](/windows/win32/Controls/tvm-setitemheight), come descritto in Windows SDK.

```
SHORT SetItemHeight(SHORT cyHeight);
```

### <a name="parameters"></a>Parametri

*cyAltezza*<br/>
Specifica la nuova altezza di ogni elemento nella visualizzazione struttura ad albero, in pixel. Se questo argomento √® minore dell'altezza delle immagini, verr√† impostato sull'altezza delle immagini. Se questo argomento non √® pari, verr√† arrotondato per eccesso al valore pari pi√π vicino. Se questo argomento √® -1, il controllo verr√† ripristinato utilizzando l'altezza predefinita dell'elemento.

### <a name="return-value"></a>Valore restituito

Altezza precedente degli elementi, in pixel.

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetItemHeight](#getitemheight).

## <a name="ctreectrlsetitemimage"></a><a name="setitemimage"></a>CTreeCtrl::SetItemImage

Associa le immagini a un elemento.

```
BOOL SetItemImage(
    HTREEITEM hItem,
    int nImage,
    int nSelectedImage);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento la cui immagine deve essere impostata.

*nImmagine*<br/>
Indice dell'immagine dell'elemento nell'elenco di immagini del controllo di visualizzazione ad albero.

*nSelectedImage (Immagine)*<br/>
Indice dell'immagine selezionata dell'elemento nell'elenco immagini del controllo di visualizzazione ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

A ogni elemento in un controllo di visualizzazione ad albero pu√≤ essere associata una coppia di immagini bitmap. Le immagini vengono visualizzate sul lato sinistro dell'etichetta di un elemento. Un'immagine viene visualizzata quando l'elemento √® selezionato e l'altra viene visualizzata quando l'elemento non √® selezionato. Ad esempio, un elemento potrebbe visualizzare una cartella aperta quando √® selezionato e una cartella chiusa quando non √® selezionata.

Chiamare questa funzione per impostare l'indice dell'immagine dell'elemento e l'immagine selezionata all'interno dell'elenco di immagini del controllo di visualizzazione ad albero.

Per ulteriori informazioni sulle immagini, vedere [CImageList](../../mfc/reference/cimagelist-class.md).

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetItemImage](#getitemimage).

## <a name="ctreectrlsetitemstate"></a><a name="setitemstate"></a>CTreeCtrl::SetItemState

Imposta lo stato dell'elemento specificato da *hItem*.

```
BOOL SetItemState(
    HTREEITEM hItem,
    UINT nState,
    UINT nStateMask);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento il cui stato deve essere impostato.

*nStato*<br/>
Specifica nuovi stati per l'elemento.

*nStateMaschera*<br/>
Specifica quali stati devono essere modificati.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

Per informazioni sugli stati, vedere [CTreeCtrl::GetItem](#getitem).

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetItemState](#getitemstate).

## <a name="ctreectrlsetitemstateex"></a><a name="setitemstateex"></a>CTreeCtrl::SetItemStateEx

Imposta lo stato esteso dell'elemento specificato nel controllo di visualizzazione ad albero corrente.

```
BOOL SetItemStateEx(
    HTREEITEM hItem,
    UINT uStateEx);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle a un elemento del controllo di visualizzazione ad albero.|
|*uStateEx (in stato uStateEx)*|[in] Stato esteso dell'elemento. Per ulteriori informazioni, `uStateEx` vedere il membro della struttura [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="return-value"></a>Valore restituito

TRUESe questo metodo ha esito positivo. in caso contrario, FALSE.

### <a name="remarks"></a>Osservazioni

Questo metodo invia il [messaggio di TVM_SETITEM,](/windows/win32/Controls/tvm-setitem) descritto in Windows SDK. Questo metodo assegna il parametro `uStateEx` *uStateEx* al membro di una struttura [TVITEMEX,](/windows/win32/api/commctrl/ns-commctrl-tvitemexw) quindi utilizza tale struttura nel messaggio.

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene definita una variabile, `m_treeCtrl`, utilizzata per accedere al controllo di visualizzazione ad albero corrente. Nell'esempio di codice vengono inoltre definiti un intero senza segno e diverse variabili HTREEITEM. Queste variabili vengono utilizzate nell'esempio successivo.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#1](../../mfc/reference/codesnippet/cpp/ctreectrl-class_17.h)]

### <a name="example"></a>Esempio

Nell'esempio di codice riportato di seguito viene impostato un elemento di visualizzazione ad albero sullo stato disabilitato. In una sezione precedente dell'esempio di codice, che non viene illustrato, √® stata creata una visualizzazione albero costituita da un nodo radice del paese/area geografica per gli Stati Uniti, sottonodi per gli stati della Pennsylvania e Washington e elementi della struttura ad albero per le citt√† in tali stati. In questo esempio di codice il nodo Pennsylvania viene impostato sullo stato disabilitato.

[!code-cpp[NVC_MFC_CTreeCtrl_s1#7](../../mfc/reference/codesnippet/cpp/ctreectrl-class_41.cpp)]

## <a name="ctreectrlsetitemtext"></a><a name="setitemtext"></a>CTreeCtrl::SetItemText

Imposta il testo dell'elemento specificato da *hItem*.

```
BOOL SetItemText(
    HTREEITEM hItem,
    LPCTSTR lpszItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento il cui testo deve essere impostato.

*lpszItem (elemento di gruppo)*<br/>
Indirizzo di una stringa contenente il nuovo testo per l'elemento

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#34](../../mfc/reference/codesnippet/cpp/ctreectrl-class_42.cpp)]

## <a name="ctreectrlsetlinecolor"></a><a name="setlinecolor"></a>CTreeCtrl::SetLineColor

Chiamare questa funzione membro per impostare il colore della riga corrente per il controllo di visualizzazione ad albero.

```
COLORREF SetLineColor(COLORREF clrNew = CLR_DEFAULT);
```

### <a name="parameters"></a>Parametri

*ClrNew (informazioni in base alla propriet√†*<br/>
Nuovo colore della linea.

### <a name="return-value"></a>Valore restituito

Colore della linea precedente.

### <a name="remarks"></a>Osservazioni

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETLINECOLOR](/windows/win32/Controls/tvm-setlinecolor), come descritto in Windows SDK.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#35](../../mfc/reference/codesnippet/cpp/ctreectrl-class_43.cpp)]

## <a name="ctreectrlsetscrolltime"></a><a name="setscrolltime"></a>CTreeCtrl::SetScrollTime

Chiamare questa funzione membro per impostare il tempo di scorrimento massimo per il controllo di visualizzazione ad albero.

```
UINT SetScrollTime(UINT uScrollTime);
```

### <a name="parameters"></a>Parametri

*uScrollTime (Ora di scorrimento)*<br/>
Nuovo tempo di scorrimento massimo, in millisecondi. Se questo valore √® minore di 100, verr√† arrotondato per esa0.

### <a name="return-value"></a>Valore restituito

Tempo di scorrimento massimo precedente, in millisecondi.

### <a name="remarks"></a>Osservazioni

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETSCROLLTIME](/windows/win32/Controls/tvm-setscrolltime), come descritto in Windows SDK.

## <a name="ctreectrlsettextcolor"></a><a name="settextcolor"></a>CTreeCtrl::SetTextColor

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETTEXTCOLOR](/windows/win32/Controls/tvm-settextcolor), come descritto in Windows SDK.

```
COLORREF SetTextColor(COLORREF clr);
```

### <a name="parameters"></a>Parametri

*Clr*<br/>
Valore COLORREF che contiene il nuovo colore del testo. Se questo argomento √® -1, il controllo torner√† a utilizzare il colore di sistema per il colore del testo.

### <a name="return-value"></a>Valore restituito

Valore COLORREF che rappresenta il colore del testo precedente. Se questo valore √® -1, il controllo utilizzava il colore di sistema per il colore del testo.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#36](../../mfc/reference/codesnippet/cpp/ctreectrl-class_44.cpp)]

## <a name="ctreectrlsettooltips"></a><a name="settooltips"></a>CTreeCtrl::SetToolTips

Questa funzione membro implementa il comportamento del messaggio Win32 [TVM_SETTOOLTIPS](/windows/win32/Controls/tvm-settooltips), come descritto in Windows SDK.

```
CToolTipCtrl* SetToolTips(CToolTipCtrl* pWndTip);
```

### <a name="parameters"></a>Parametri

*pWndTip (suggerimento)*<br/>
Puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto che verr√† utilizzato il controllo struttura ad albero.

### <a name="return-value"></a>Valore restituito

Puntatore a un [CToolTipCtrl](../../mfc/reference/ctooltipctrl-class.md) oggetto contenente la descrizione comandi utilizzata in precedenza dal controllo o NULL se non sono state utilizzate descrizioni comandi in precedenza.

### <a name="remarks"></a>Osservazioni

Per utilizzare le descrizioni comandi, indicare lo stile TVS_NOTOOLTIPS quando si crea l'oggetto. `CTreeCtrl`

### <a name="example"></a>Esempio

  Vedere l'esempio per [CTreeCtrl::GetToolTips](#gettooltips).

## <a name="ctreectrlshowinfotip"></a><a name="showinfotip"></a>CTreeCtrl::ShowInfoTip

Visualizza l'infotip per l'elemento specificato nel controllo di visualizzazione ad albero corrente.

```cpp
void ShowInfoTip(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

|Parametro|Descrizione|
|---------------|-----------------|
|*hElemento*|[in] Handle per un elemento di visualizzazione ad albero nel controllo. Per ulteriori informazioni, `hItem` vedere il membro della struttura [TVITEMEX.](/windows/win32/api/commctrl/ns-commctrl-tvitemexw)|

### <a name="remarks"></a>Osservazioni

Per ulteriori informazioni sulla differenza tra descrizioni comandi e suggerimenti informativi, cercare l'argomento "Tooltips and Infotips" in [Microsoft Developer Network](https://go.microsoft.com/fwlink/p/?linkid=56322).

Questo metodo invia il [messaggio TVM_SHOWINFOTIP,](/windows/win32/Controls/tvm-showinfotip) descritto in Windows SDK.

## <a name="ctreectrlsortchildren"></a><a name="sortchildren"></a>CTreeCtrl::SortChildren

Chiamare questa funzione per ordinare alfabeticamente gli elementi figlio dell'elemento padre specificato in un controllo di visualizzazione ad albero.

```
BOOL SortChildren(HTREEITEM hItem);
```

### <a name="parameters"></a>Parametri

*hElemento*<br/>
Handle dell'elemento padre i cui elementi figlio devono essere ordinati. Se *hItem* √® NULL, l'ordinamento proceder√† dalla radice della struttura ad albero.

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

`SortChildren`non si ricorre attraverso l'albero; verranno ordinati solo gli elementi figlio immediati di *hItem.*

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#37](../../mfc/reference/codesnippet/cpp/ctreectrl-class_45.cpp)]

## <a name="ctreectrlsortchildrencb"></a><a name="sortchildrencb"></a>CTreeCtrl::SortChildrenCB

Chiamare questa funzione per ordinare gli elementi della visualizzazione albero utilizzando una funzione di callback definita dall'applicazione che confronta gli elementi.

```
BOOL SortChildrenCB(LPTVSORTCB pSort);
```

### <a name="parameters"></a>Parametri

*pOrdinare*<br/>
Puntatore a una struttura [TVSORTCB.](/windows/win32/api/commctrl/ns-commctrl-tvsortcb)

### <a name="return-value"></a>Valore restituito

Diverso da zero se ha esito positivo; in caso contrario 0.

### <a name="remarks"></a>Osservazioni

La funzione di confronto `lpfnCompare`della struttura, , deve restituire un valore negativo se il primo elemento deve precedere il secondo, un valore positivo se il primo elemento deve seguire il secondo oppure zero se i due elementi sono equivalenti.

I parametri *lParam1* e *lParam2* corrispondono al `lParam` membro della struttura [TVITEM](/windows/win32/api/commctrl/ns-commctrl-tvitemw) per i due elementi confrontati. Il *lParamSort* parametro `lParam` corrisponde `TV_SORTCB` al membro della struttura.

### <a name="example"></a>Esempio

[!code-cpp[NVC_MFC_CTreeCtrl#38](../../mfc/reference/codesnippet/cpp/ctreectrl-class_46.cpp)]

[!code-cpp[NVC_MFC_CTreeCtrl#39](../../mfc/reference/codesnippet/cpp/ctreectrl-class_47.cpp)]

## <a name="see-also"></a>Vedere anche

[ESEMPIO MFC CMNCTRL1](../../overview/visual-cpp-samples.md)<br/>
[Classe CWnd](../../mfc/reference/cwnd-class.md)<br/>
[Grafico delle gerarchie](../../mfc/hierarchy-chart.md)<br/>
[Classe CImageList](../../mfc/reference/cimagelist-class.md)
