---
title: Classe CMFCToolBarMenuButton | Documenti Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-mfc
ms.topic: reference
f1_keywords:
- CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CMFCToolBarMenuButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CompareWith
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CopyFrom
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateFromMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreateMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::CreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::EnableQuickCustomize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetCommands
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetImageRect
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPaletteRows
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::GetPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HasButton
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::HaveHotBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsBorder
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsClickedOnMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsDroppedDown
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsEmptyMenuAllowed
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsExclusive
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsQuickMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::IsTearOffMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnAfterCreatePopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnBeforeDrag
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCalculateSize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnCancelMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnChangeParentWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClick
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnClickMenuItem
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnContextHelp
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDraw
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OnDrawOnCustomizeList
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::OpenPopupMenu
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::ResetImageToDefault
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SaveBarState
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::Serialize
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetACCData
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuOnly
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMenuPaletteMode
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetMessageWnd
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetRadio
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::SetTearOff
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::DrawDocumentIcon
- AFXTOOLBARMENUBUTTON/CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw
dev_langs:
- C++
helpviewer_keywords:
- CMFCToolBarMenuButton [MFC], CMFCToolBarMenuButton
- CMFCToolBarMenuButton [MFC], CompareWith
- CMFCToolBarMenuButton [MFC], CopyFrom
- CMFCToolBarMenuButton [MFC], CreateFromMenu
- CMFCToolBarMenuButton [MFC], CreateMenu
- CMFCToolBarMenuButton [MFC], CreatePopupMenu
- CMFCToolBarMenuButton [MFC], EnableQuickCustomize
- CMFCToolBarMenuButton [MFC], GetCommands
- CMFCToolBarMenuButton [MFC], GetImageRect
- CMFCToolBarMenuButton [MFC], GetPaletteRows
- CMFCToolBarMenuButton [MFC], GetPopupMenu
- CMFCToolBarMenuButton [MFC], HasButton
- CMFCToolBarMenuButton [MFC], HaveHotBorder
- CMFCToolBarMenuButton [MFC], IsBorder
- CMFCToolBarMenuButton [MFC], IsClickedOnMenu
- CMFCToolBarMenuButton [MFC], IsDroppedDown
- CMFCToolBarMenuButton [MFC], IsEmptyMenuAllowed
- CMFCToolBarMenuButton [MFC], IsExclusive
- CMFCToolBarMenuButton [MFC], IsMenuPaletteMode
- CMFCToolBarMenuButton [MFC], IsQuickMode
- CMFCToolBarMenuButton [MFC], IsTearOffMenu
- CMFCToolBarMenuButton [MFC], OnAfterCreatePopupMenu
- CMFCToolBarMenuButton [MFC], OnBeforeDrag
- CMFCToolBarMenuButton [MFC], OnCalculateSize
- CMFCToolBarMenuButton [MFC], OnCancelMode
- CMFCToolBarMenuButton [MFC], OnChangeParentWnd
- CMFCToolBarMenuButton [MFC], OnClick
- CMFCToolBarMenuButton [MFC], OnClickMenuItem
- CMFCToolBarMenuButton [MFC], OnContextHelp
- CMFCToolBarMenuButton [MFC], OnDraw
- CMFCToolBarMenuButton [MFC], OnDrawOnCustomizeList
- CMFCToolBarMenuButton [MFC], OpenPopupMenu
- CMFCToolBarMenuButton [MFC], ResetImageToDefault
- CMFCToolBarMenuButton [MFC], SaveBarState
- CMFCToolBarMenuButton [MFC], Serialize
- CMFCToolBarMenuButton [MFC], SetACCData
- CMFCToolBarMenuButton [MFC], SetMenuOnly
- CMFCToolBarMenuButton [MFC], SetMenuPaletteMode
- CMFCToolBarMenuButton [MFC], SetMessageWnd
- CMFCToolBarMenuButton [MFC], SetRadio
- CMFCToolBarMenuButton [MFC], SetTearOff
- CMFCToolBarMenuButton [MFC], DrawDocumentIcon
- CMFCToolBarMenuButton [MFC], m_bAlwaysCallOwnerDraw
ms.assetid: cfa50176-7e4b-4527-9904-86a1b48fc1bc
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
ms.openlocfilehash: 7ec0fae7ceaa7b32636518f4c8a5eb5fc3836bb8
ms.sourcegitcommit: f1b051abb1de3fe96350be0563aaf4e960da13c3
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/27/2018
ms.locfileid: "37039061"
---
# <a name="cmfctoolbarmenubutton-class"></a>Classe CMFCToolBarMenuButton
Pulsante della barra degli strumenti contenente un menu di scelta rapida.  
 [!INCLUDE[cpp_fp_under_construction](../../mfc/reference/includes/cpp_fp_under_construction_md.md)]  
  
## <a name="syntax"></a>Sintassi  
  
```  
class CMFCToolBarMenuButton : public CMFCToolBarButton  
```  
  
## <a name="members"></a>Membri  
  
### <a name="public-constructors"></a>Costruttori pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::CMFCToolBarMenuButton](#cmfctoolbarmenubutton)|Costruisce un oggetto `CMFCToolBarMenuButton`.|  
  
### <a name="public-methods"></a>Metodi pubblici  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::CompareWith](#comparewith)|Confronta questa istanza con l'oggetto fornito `CMFCToolBarButton` oggetto. (Esegue l'override [CMFCToolBarButton::CompareWith](../../mfc/reference/cmfctoolbarbutton-class.md#comparewith).)|  
|[Cmfctoolbarmenubutton:: CopyFrom](#copyfrom)|Copia le proprietà di un altro pulsante della barra degli strumenti al pulsante corrente. (Esegue l'override [CMFCToolBarButton::CopyFrom](../../mfc/reference/cmfctoolbarbutton-class.md#copyfrom).)|  
|[CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu)|Inizializza il menu della barra degli strumenti da un handle di menu di Windows.|  
|[CMFCToolBarMenuButton::CreateMenu](#createmenu)|Crea un menu di Windows che include i comandi nel menu della barra degli strumenti. Restituisce un handle per il menu di Windows.|  
|[Cmfctoolbarmenubutton:: CreatePopupMenu](#createpopupmenu)|Crea un oggetto di menu di scelta rapida ( [CMFCPopupMenu classe](../../mfc/reference/cmfcpopupmenu-class.md)) per visualizzare il menu della barra degli strumenti.|  
|[CMFCToolBarMenuButton::EnableQuickCustomize](#enablequickcustomize)||  
|[CMFCToolBarMenuButton::GetCommands](#getcommands)|Offre accesso in lettura all'elenco di comandi nel menu della barra degli strumenti.|  
|[CMFCToolBarMenuButton::GetImageRect](#getimagerect)|Recupera il rettangolo di delimitazione per l'immagine del pulsante.|  
|[CMFCToolBarMenuButton::GetPaletteRows](#getpaletterows)|Restituisce il numero di righe del menu a comparsa quando il menu di scelta è in modalità tavolozza.|  
|[CMFCToolBarMenuButton::GetPopupMenu](#getpopupmenu)|Restituisce un puntatore all'oggetto associato con il pulsante di menu di scelta rapida.|  
|[CMFCToolBarMenuButton::HasButton](#hasbutton)||  
|[CMFCToolBarMenuButton::HaveHotBorder](#havehotborder)|Determina se un bordo del pulsante viene visualizzato quando un utente seleziona il pulsante. (Esegue l'override [CMFCToolBarButton::HaveHotBorder](../../mfc/reference/cmfctoolbarbutton-class.md#havehotborder).)|  
|[CMFCToolBarMenuButton::IsBorder](#isborder)||  
|[CMFCToolBarMenuButton::IsClickedOnMenu](#isclickedonmenu)||  
|[CMFCToolBarMenuButton::IsDroppedDown](#isdroppeddown)|Determina se viene visualizzato il menu a comparsa.|  
|[Cmfctoolbarmenubutton:: Isemptymenuallowed](#isemptymenuallowed)|Chiamato dal framework per determinare se un utente può aprire un sottomenu dalla voce di menu selezionata.|  
|[CMFCToolBarMenuButton::IsExclusive](#isexclusive)|Determina se il pulsante è in modalità esclusiva, vale a dire, se il menu a comparsa rimane aperto anche quando l'utente sposta il puntatore su un'altra barra degli strumenti o un pulsante.|  
|[CMFCToolBarMenuButton::IsMenuPaletteMode](#ismenupalettemode)|Determina se il menu a comparsa è in modalità tavolozza.|  
|[CMFCToolBarMenuButton::IsQuickMode](#isquickmode)||  
|[CMFCToolBarMenuButton::IsTearOffMenu](#istearoffmenu)|Determina se il menu a comparsa dispone di una barra a comparsa.|  
|[CMFCToolBarMenuButton::OnAfterCreatePopupMenu](#onaftercreatepopupmenu)||  
|[CMFCToolBarMenuButton::OnBeforeDrag](#onbeforedrag)|Specifica se è possibile trascinare il pulsante. (Esegue l'override [CMFCToolBarButton::OnBeforeDrag](../../mfc/reference/cmfctoolbarbutton-class.md#onbeforedrag).)|  
|[CMFCToolBarMenuButton::OnCalculateSize](#oncalculatesize)|Chiamato dal framework per calcolare le dimensioni del pulsante per il contesto di dispositivo specificato e lo stato di ancoraggio. (Esegue l'override [CMFCToolBarButton::OnCalculateSize](../../mfc/reference/cmfctoolbarbutton-class.md#oncalculatesize).)|  
|[CMFCToolBarMenuButton::OnCancelMode](#oncancelmode)|Chiamato dal framework per gestire il [WM_CANCELMODE](http://msdn.microsoft.com/library/windows/desktop/ms632615) messaggio. (Esegue l'override [CMFCToolBarButton::OnCancelMode](../../mfc/reference/cmfctoolbarbutton-class.md#oncancelmode).)|  
|[CMFCToolBarMenuButton::OnChangeParentWnd](#onchangeparentwnd)|Chiamato dal framework quando il pulsante viene inserito in una nuova barra degli strumenti. (Esegue l'override [CMFCToolBarButton::OnChangeParentWnd](cmfctoolbarbutton-class.md#onchangeparentwnd).)|  
|[CMFCToolBarMenuButton::OnClick](#onclick)|Chiamato dal framework quando l'utente fa clic sul pulsante del mouse. (Esegue l'override [CMFCToolBarButton::OnClick](../../mfc/reference/cmfctoolbarbutton-class.md#onclick).)|  
|[CMFCToolBarMenuButton::OnClickMenuItem](#onclickmenuitem)|Chiamato dal framework quando l'utente seleziona un elemento del menu a comparsa.|  
|[CMFCToolBarMenuButton::OnContextHelp](#oncontexthelp)|Chiamato dal framework quando la barra degli strumenti padre gestisce un messaggio WM_HELPHITTEST. (Esegue l'override [CMFCToolBarButton::OnContextHelp](../../mfc/reference/cmfctoolbarbutton-class.md#oncontexthelp).)|  
|[CMFCToolBarMenuButton::OnDraw](#ondraw)|Chiamato dal framework per disegnare il pulsante utilizzando le opzioni e gli stili specificati. (Esegue l'override [CMFCToolBarButton::OnDraw](../../mfc/reference/cmfctoolbarbutton-class.md#ondraw).)|  
|[CMFCToolBarMenuButton::OnDrawOnCustomizeList](#ondrawoncustomizelist)|Chiamato dal framework per disegnare il pulsante di **comandi** riquadro del **Personalizza** finestra di dialogo. (Esegue l'override [CMFCToolBarButton::OnDrawOnCustomizeList](../../mfc/reference/cmfctoolbarbutton-class.md#ondrawoncustomizelist).)|  
|[CMFCToolBarMenuButton::OpenPopupMenu](#openpopupmenu)|Chiamato dal framework quando l'utente apre il menu a comparsa.|  
|[CMFCToolBarMenuButton::ResetImageToDefault](#resetimagetodefault)|Imposta il valore predefinito dell'immagine associata con il pulsante. (Esegue l'override [CMFCToolBarButton::ResetImageToDefault](../../mfc/reference/cmfctoolbarbutton-class.md#resetimagetodefault).)|  
|[CMFCToolBarMenuButton::SaveBarState](#savebarstate)|Salva lo stato del pulsante della barra degli strumenti. (Esegue l'override [CMFCToolBarButton::SaveBarState](../../mfc/reference/cmfctoolbarbutton-class.md#savebarstate).)|  
|[CMFCToolBarMenuButton::Serialize](#serialize)|Legge l'oggetto da un archivio o lo scrive in un archivio. (Esegue l'override [CMFCToolBarButton::Serialize](../../mfc/reference/cmfctoolbarbutton-class.md#serialize).)|  
|[CMFCToolBarMenuButton::SetACCData](#setaccdata)|Popola l'oggetto specificato `CAccessibilityData` oggetto con dati di accessibilità dal pulsante della barra degli strumenti. (Esegue l'override [CMFCToolBarButton::SetACCData](../../mfc/reference/cmfctoolbarbutton-class.md#setaccdata).)|  
|[CMFCToolBarMenuButton::SetMenuOnly](#setmenuonly)|Specifica se il pulsante può essere aggiunta a una barra degli strumenti.|  
|[CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode)|Specifica se il menu a comparsa è in modalità tavolozza.|  
|[CMFCToolBarMenuButton::SetMessageWnd](#setmessagewnd)||  
|[CMFCToolBarMenuButton::SetRadio](#setradio)|Forza il pulsante di menu della barra degli strumenti per visualizzare un'icona che indica che sia selezionato.|  
|[CMFCToolBarMenuButton::SetTearOff](#settearoff)|Specifica un tear-off barra ID per il menu a comparsa.|  
  
### <a name="protected-methods"></a>Metodi protetti  
  
|Nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::DrawDocumentIcon](#drawdocumenticon)|Disegna un'icona sul pulsante di menu.|  
  
### <a name="data-members"></a>Membri di dati  
  
|nome|Descrizione|  
|----------|-----------------|  
|[CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw](#m_balwayscallownerdraw)|Se `TRUE`, il framework chiama sempre [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando viene disegnato un pulsante.|  
  
## <a name="remarks"></a>Note  
 Oggetto `CMFCToolBarMenuButton` può apparire come un menu, una voce di menu che presenta un sottomenu, un pulsante che esegue un comando o viene visualizzato un menu o un pulsante che consente di visualizzare un menu di scelta. Determinare il comportamento e l'aspetto del pulsante di menu specificando i parametri, ad esempio l'immagine, testo, l'handle del menu e comandi ID associato con il pulsante nel costruttore `CMFCToolbarMenuButton::CMFCToolbarMenuButton`.  
  
 Una classe personalizzata derivata dal `CMFCToolbarMenuButton` classe deve usare il [DECLARE_SERIAL](run-time-object-model-services.md#declare_serial) macro. Il [DECLARE_DYNCREATE](run-time-object-model-services.md#declare_dyncreate) macro genera un errore durante la chiusura dell'applicazione.  
  
## <a name="example"></a>Esempio  
 Nell'esempio seguente viene illustrato come configurare un `CMFCToolBarMenuButton` oggetto. Il codice viene illustrato come specificare che la casella a discesa è in modalità tavolozza, specificare l'ID per la barra a comparsa che viene creata quando l'utente trascina il pulsante di menu di fuori di una barra dei menu. Questo frammento di codice fa parte dell' [esempio di Word Pad](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_WordPad#10](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_1.cpp)]  
  
## <a name="inheritance-hierarchy"></a>Gerarchia di ereditarietà  
 [CObject](cobject-class.md)  
  
 [CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)  
  
 [CMFCToolBarMenuButton](../../mfc/reference/cmfctoolbarmenubutton-class.md)  
  
## <a name="requirements"></a>Requisiti  
 **Intestazione:** afxtoolbarmenubutton.h  
  
##  <a name="cmfctoolbarmenubutton"></a>  CMFCToolBarMenuButton::CMFCToolBarMenuButton  
 Costruisce un oggetto `CMFCToolBarMenuButton`.  
  
```  
CMFCToolBarMenuButton();
CMFCToolBarMenuButton(const CMFCToolBarMenuButton& src);

CMFCToolBarMenuButton(
    UINT uiID,  
    HMENU hMenu,  
    int iImage,  
    LPCTSTR lpszText=NULL,  
    BOOL bUserButton=FALSE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *src*  
 Un oggetto esistente `CMFCToolBarMenuButton` oggetto deve essere copiato `CMFCToolBarMenuButton` oggetto.  
  
 [in] *uiID*  
 L'ID di comando da eseguire quando un utente fa clic sul pulsante. o ( `UINT`) -1 per un pulsante di menu che non viene eseguito direttamente un comando.  
  
 [in] *hMenu*  
 Un handle a un menu; o `NULL` se il pulsante non dispone di un menu.  
  
 [in] *iImage*  
 Indice dell'immagine del pulsante; oppure -1 se questo pulsante non presenta un'icona o viene utilizzata l'icona per il comando specificato da *uiID*. L'indice è lo stesso per ogni `CMFCToolBarImages` oggetto nell'applicazione.  
  
 [in] *lpszText*  
 Il testo del pulsante di menu della barra degli strumenti.  
  
 [in] *bUserButton*  
 `TRUE` Se il pulsante Visualizza un'immagine definita dall'utente; `FALSE` se il pulsante Visualizza un'immagine predefinita associata al comando specificato da *uiID*.  
  
### <a name="remarks"></a>Note  
 Se *uiID* è un valido ID di comando, il pulsante esegue il comando quando l'utente fa clic sopra. Se *hMenu* è un handle di menu validi, il pulsante fornisce un menu a discesa quando viene visualizzata in una barra degli strumenti o un sottomenu quando viene visualizzato in un menu. Se entrambi *uiID* e *hMenu* validi, il pulsante è un pulsante di menu combinato con una parte che eseguirà il comando quando l'utente fa clic su di esso e una parte con una freccia rivolta verso il basso che verrà elenco a discesa un menu quando l'utente fa clic su di esso. Tuttavia, se *hMenu* sia valido, un utente non sarà in grado di fare clic sul pulsante per eseguire un comando quando il pulsante viene inserito in un menu.  
  
### <a name="example"></a>Esempio  
 Nell'esempio seguente viene illustrato come costruire un oggetto del `CMFCToolBarMenuButton` classe. Questo frammento di codice fa parte dell' [esempio di Word Pad](../../visual-cpp-samples.md).  
  
 [!code-cpp[NVC_MFC_WordPad#9](../../mfc/reference/codesnippet/cpp/cmfctoolbarmenubutton-class_2.cpp)]  
  
##  <a name="comparewith"></a>  CMFCToolBarMenuButton::CompareWith  

  
```  
virtual BOOL CompareWith(const CMFCToolBarButton& other) const;  
```  
  
### <a name="parameters"></a>Parametri  
 [in] *altri*  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="copyfrom"></a>  Cmfctoolbarmenubutton:: CopyFrom  

  
```  
virtual void CopyFrom(const CMFCToolBarButton& src);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *src*  
  
### <a name="remarks"></a>Note  
  
##  <a name="createfrommenu"></a>  CMFCToolBarMenuButton::CreateFromMenu  
 Inizializza il menu della barra degli strumenti da un handle di menu di Windows.  
  
```  
virtual void CreateFromMenu(HMENU hMenu);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *hMenu*  
 Un handle a un menu.  
  
### <a name="remarks"></a>Note  
 Un pulsante di menu della barra degli strumenti possa visualizzare un sottomenu del menu a discesa.  
  
 Il framework chiama questo metodo per inizializzare i comandi nel sottomenu da un menu.  
  
##  <a name="createmenu"></a>  CMFCToolBarMenuButton::CreateMenu  
 Crea un menu che include i comandi nel menu della barra degli strumenti. Restituisce un handle al menu di scelta.  
  
```  
virtual HMENU CreateMenu() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un handle per il menu se esito positivo. `NULL` Se l'elenco di comandi associati con il pulsante di menu della barra degli strumenti è vuota.  
  
### <a name="remarks"></a>Note  
 È possibile eseguire l'override di questo metodo in una classe derivata per personalizzare il modo in cui che viene generato il menu di scelta.  
  
##  <a name="createpopupmenu"></a>  Cmfctoolbarmenubutton:: CreatePopupMenu  
 Crea un `CMFCPopupMenu` oggetto per visualizzare il menu della barra degli strumenti.  
  
```  
virtual CMFCPopupMenu* CreatePopupMenu();
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore a un `CMFCPopupMenu` oggetto che consente di visualizzare il menu di scelta rapida associato al pulsante di menu della barra degli strumenti.  
  
### <a name="remarks"></a>Note  
 Questo metodo viene chiamato dal framework per preparare la visualizzazione del menu elenco a discesa associato al pulsante.  
  
 L'implementazione predefinita appena crea e restituisce un nuovo `CMFCPopupMenu` oggetto. Eseguire l'override di questo metodo se si desidera utilizzare un tipo derivato di [CMFCPopupMenu classe](cmfcpopupmenu-class.md) o per eseguire un'inizializzazione aggiuntiva.  
  
##  <a name="drawdocumenticon"></a>  CMFCToolBarMenuButton::DrawDocumentIcon  
 Disegna un'icona documento sul pulsante di menu.  
  
```  
void DrawDocumentIcon(
    CDC* pDC,  
    const CRect& rectImage,  
    HICON hIcon);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pDC*  
 Puntatore al contesto di dispositivo.  
  
 [in] *rectImage*  
 Coordinate dell'immagine del rettangolo di delimitazione.  
  
 [in] *icona*  
 Handle per l'icona.  
  
### <a name="remarks"></a>Note  
 Questo metodo accetta un'icona di documento e lo disegna nel pulsante di menu, centrato nell'area specificata da *rectImage*.  
  
##  <a name="enablequickcustomize"></a>  CMFCToolBarMenuButton::EnableQuickCustomize  

  
```  
void EnableQuickCustomize();
```  
  
### <a name="remarks"></a>Note  
  
##  <a name="hasbutton"></a>  CMFCToolBarMenuButton::HasButton  

  
```  
virtual BOOL HasButton() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="havehotborder"></a>  CMFCToolBarMenuButton::HaveHotBorder  

  
```  
virtual BOOL HaveHotBorder() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="isborder"></a>  CMFCToolBarMenuButton::IsBorder  

  
```  
virtual BOOL IsBorder() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="isclickedonmenu"></a>  CMFCToolBarMenuButton::IsClickedOnMenu  

  
```  
BOOL IsClickedOnMenu() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="isquickmode"></a>  CMFCToolBarMenuButton::IsQuickMode  

  
```  
BOOL IsQuickMode();
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="getcommands"></a>  CMFCToolBarMenuButton::GetCommands  
 Offre accesso in lettura all'elenco di comandi nel menu della barra degli strumenti.  
  
```  
const CObList& GetCommands() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un riferimento const a un [classe CObList](../../mfc/reference/coblist-class.md) oggetto, che contiene una raccolta di [CMFCToolBarButton classe](../../mfc/reference/cmfctoolbarbutton-class.md) oggetti.  
  
### <a name="remarks"></a>Note  
 Un pulsante di menu della barra degli strumenti possa visualizzare un sottomenu. È possibile fornire l'elenco di comandi nel sottomenu nel costruttore o in [CMFCToolBarMenuButton::CreateFromMenu](#createfrommenu) come handle di un menu di scelta ( `HMENU`). Il menu viene convertito in un elenco di oggetti derivati da [classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md) e archiviati in interna `CObList` oggetto. Questo elenco è possibile accedere chiamando questo metodo.  
  
##  <a name="getimagerect"></a>  CMFCToolBarMenuButton::GetImageRect  
 Recupera il rettangolo di delimitazione per l'immagine del pulsante.  
  
```  
void GetImageRect(CRect& rectImage);
```  
  
### <a name="parameters"></a>Parametri  
 [out] *rectImage*  
 Un riferimento a un `CRect` oggetto che riceve le coordinate dell'immagine del rettangolo di delimitazione.  
  
##  <a name="getpaletterows"></a>  CMFCToolBarMenuButton::GetPaletteRows  
 Restituisce il numero di righe nel menu a discesa quando il menu di scelta è in modalità tavolozza.  
  
```  
int GetPaletteRows() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Il numero di righe nella tavolozza.  
  
### <a name="remarks"></a>Note  
 Quando il pulsante di menu viene impostato sulla modalità di tavolozza, voci di menu verranno visualizzati in più colonne con solo un numero limitato di righe. Chiamare questo metodo per ottenere il numero di righe. È possibile abilitare o disabilitare la modalità di tavolozza e specificare il numero di righe utilizzando [CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode).  
  
##  <a name="getpopupmenu"></a>  CMFCToolBarMenuButton::GetPopupMenu  
 Restituisce un puntatore per il [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) oggetto che rappresenta il menu a discesa del pulsante.  
  
```  
CMFCPopupMenu* GetPopupMenu() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 Un puntatore a un [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) oggetto creato quando il framework disegnato il sottomenu del pulsante di menu della barra degli strumenti; `NULL` se non viene visualizzato alcun sottomenu.  
  
### <a name="remarks"></a>Note  
 Quando un pulsante di menu della barra degli strumenti Visualizza un menu a discesa, il pulsante per creare una [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) oggetto per rappresentare il menu di scelta. Chiamare questo metodo per ottenere un puntatore per il `CMFCPopupMenu` oggetto. È consigliabile non archiviare il puntatore restituito, poiché è temporaneo e non è più valido quando l'utente chiude il menu di scelta rapida.  
  
##  <a name="isdroppeddown"></a>  CMFCToolBarMenuButton::IsDroppedDown  
 Indica se il menu a comparsa è attualmente visualizzato.  
  
```  
virtual BOOL IsDroppedDown() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante di menu della barra degli strumenti consente di visualizzare il relativo sottomenu; in caso contrario `FALSE`.  
  
##  <a name="isemptymenuallowed"></a>  Cmfctoolbarmenubutton:: Isemptymenuallowed  
 Specifica se le voci di menu viene visualizzata vuoti sottomenu.  
  
```  
virtual BOOL IsEmptyMenuAllowed() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il framework viene aperto un sottomenu dalla voce di menu selezionato anche quando il sottomenu è vuoto. in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo quando un utente tenta di aprire i sottomenu dalla voce di menu selezionata. Se il sottomenu è vuoto e `IsEmptyMenuAllowed` restituisce `FALSE`, non sarà possibile aprire il sottomenu.  
  
 L'implementazione predefinita restituisce `FALSE`. Eseguire l'override di questo metodo per personalizzare questo comportamento.  
  
##  <a name="isexclusive"></a>  CMFCToolBarMenuButton::IsExclusive  
 Indica se il pulsante è in modalità esclusiva.  
  
```  
virtual BOOL IsExclusive() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante è in esecuzione in modalità esclusiva; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Quando un utente apre un menu di scelta rapida per un pulsante e quindi sposta il puntatore del mouse su un altro pulsante della barra degli strumenti o menu, menu di scelta rapida viene chiusa, a meno che il pulsante è in modalità esclusiva.  
  
 L'implementazione predefinita restituisce sempre `FALSE`. Eseguire l'override di questo metodo in una classe derivata se si desidera attivare la modalità esclusiva.  
  
##  <a name="ismenupalettemode"></a>  CMFCToolBarMenuButton::IsMenuPaletteMode  
 Determina se il menu di scelta rapida è in modalità tavolozza.  
  
```  
BOOL IsMenuPaletteMode() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se è abilitata la modalità di tavolozza `FALSE`.  
  
### <a name="remarks"></a>Note  
 Quando il pulsante di menu viene impostato sulla modalità di tavolozza, voci di menu vengono visualizzati in più colonne con solo un numero limitato di righe. Chiamare questo metodo per ottenere il numero di righe. È possibile abilitare o disabilitare la modalità di tavolozza chiamando [CMFCToolBarMenuButton::SetMenuPaletteMode](#setmenupalettemode).  
  
##  <a name="istearoffmenu"></a>  CMFCToolBarMenuButton::IsTearOffMenu  
 Indica se il menu a discesa dispone di una barra a comparsa.  
  
```  
virtual BOOL IsTearOffMenu() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Se il pulsante di menu della barra degli strumenti dispone di una barra a comparsa. in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Per abilitare la funzionalità tear-off e impostare il tear-off barra ID, chiamare [CMFCToolBarMenuButton::SetTearOff](#settearoff).  
  
##  <a name="m_balwayscallownerdraw"></a>  CMFCToolBarMenuButton::m_bAlwaysCallOwnerDraw  
 Specifica se il framework chiama sempre [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) quando viene disegnato un pulsante.  
  
```  
static BOOL m_bAlwaysCallOwnerDraw;  
```  
  
### <a name="remarks"></a>Note  
 Quando questa variabile è impostata su `TRUE`, il pulsante chiama sempre [CFrameWndEx::OnDrawMenuImage](../../mfc/reference/cframewndex-class.md#ondrawmenuimage) metodo per visualizzare l'immagine del pulsante. Quando si `m_bAlwaysCallOwnerDraw` è `FALSE`, il pulsante stesso Disegna l'immagine se l'immagine è già definito. In caso contrario, chiama `OnDrawMenuImage`.  
  
##  <a name="onaftercreatepopupmenu"></a>  CMFCToolBarMenuButton::OnAfterCreatePopupMenu  

  
```  
virtual void OnAfterCreatePopupMenu();
```  
  
### <a name="remarks"></a>Note  
  
##  <a name="onbeforedrag"></a>  CMFCToolBarMenuButton::OnBeforeDrag  

  
```  
virtual BOOL OnBeforeDrag() const;  
```  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="oncalculatesize"></a>  CMFCToolBarMenuButton::OnCalculateSize  

  
```  
virtual SIZE OnCalculateSize(
    CDC* pDC,  
    const CSize& sizeDefault,  
    BOOL bHorz);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pDC*  
 [in] *sizeDefault*  
 [in] *bHorz*  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="oncancelmode"></a>  CMFCToolBarMenuButton::OnCancelMode  

  
```  
virtual void OnCancelMode();
```  
  
### <a name="remarks"></a>Note  
  
##  <a name="onchangeparentwnd"></a>  CMFCToolBarMenuButton::OnChangeParentWnd  

  
```  
virtual void OnChangeParentWnd(CWnd* pWndParent);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pWndParent*  
  
### <a name="remarks"></a>Note  
  
##  <a name="onclick"></a>  CMFCToolBarMenuButton::OnClick  

  
```  
virtual BOOL OnClick(
    CWnd* pWnd,  
    BOOL bDelay = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pWnd*  
 [in] *bDelay*  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="onclickmenuitem"></a>  CMFCToolBarMenuButton::OnClickMenuItem  
 Chiamato dal framework quando l'utente seleziona un elemento nel menu a discesa.  
  
```  
virtual BOOL OnClickMenuItem();
```  
  
### <a name="return-value"></a>Valore restituito  
 `FALSE` Se il framework deve continuare il menu predefinito elemento elaborazione; in caso contrario `TRUE`. L'implementazione predefinita restituisce sempre `FALSE`.  
  
### <a name="remarks"></a>Note  
 Quando l'utente fa clic su una voce di menu, il framework esegue un comando che è associato a quell'elemento.  
  
 Per personalizzare l'elaborazione di voce di menu, eseguire l'override `OnClickMenuItem` in una classe derivata da `CMFCToolBarMenuButton` classe. È inoltre necessario eseguire l'override [CFrameWndEx::OnShowPopupMenu](../../mfc/reference/cframewndex-class.md#onshowpopupmenu) e sostituire i pulsanti di menu che richiedono un'elaborazione speciale con istanze della classe derivata.  
  
##  <a name="oncontexthelp"></a>  CMFCToolBarMenuButton::OnContextHelp  

  
```  
virtual BOOL OnContextHelp(CWnd* pWnd);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pWnd*  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="ondraw"></a>  CMFCToolBarMenuButton::OnDraw  

  
```  
virtual void OnDraw(
    CDC* pDC,  
    const CRect& rect,  
    CMFCToolBarImages* pImages,  
    BOOL bHorz = TRUE,  
    BOOL bCustomizeMode = FALSE,  
    BOOL bHighlight = FALSE,  
    BOOL bDrawBorder = TRUE,  
    BOOL bGrayDisabledButtons = TRUE);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pDC*  
 [in] *rect*  
 [in] *pImages*  
 [in] *bHorz*  
 [in] *bCustomizeMode*  
 [in] *bHighlight*  
 [in] *bDrawBorder*  
 [in] *bGrayDisabledButtons*  
  
### <a name="remarks"></a>Note  
  
##  <a name="ondrawoncustomizelist"></a>  CMFCToolBarMenuButton::OnDrawOnCustomizeList  

  
```  
virtual int OnDrawOnCustomizeList(
    CDC* pDC,  
    const CRect& rect,  
    BOOL bSelected);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pDC*  
 [in] *rect*  
 [in] *bSelected*  
  
### <a name="return-value"></a>Valore restituito  
  
### <a name="remarks"></a>Note  
  
##  <a name="openpopupmenu"></a>  CMFCToolBarMenuButton::OpenPopupMenu  
 Chiamato dal framework quando l'utente apre il menu a discesa di un pulsante di menu della barra degli strumenti.  
  
```  
virtual BOOL OpenPopupMenu(CWnd* pWnd=NULL);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pWnd*  
 Specifica la finestra che riceve i comandi di menu a discesa. Può essere `NULL` solo se il pulsante di menu della barra degli strumenti dispone di una finestra padre.  
  
### <a name="return-value"></a>Valore restituito  
 `TRUE` Quando un [classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md) oggetto è stato creato e aperto correttamente; in caso contrario `FALSE`.  
  
### <a name="remarks"></a>Note  
 Questa funzione viene chiamata dal framework quando l'utente apre un menu di scelta rapida da un pulsante di menu della barra degli strumenti.  
  
##  <a name="resetimagetodefault"></a>  CMFCToolBarMenuButton::ResetImageToDefault  

  
```  
virtual void ResetImageToDefault();
```  
  
### <a name="remarks"></a>Note  
  
##  <a name="savebarstate"></a>  CMFCToolBarMenuButton::SaveBarState  

  
```  
virtual void SaveBarState();
```  
  
### <a name="remarks"></a>Note  
 Il framework chiama questo metodo durante la creazione di un pulsante della barra degli strumenti come il risultato di un'operazione di trascinamento e rilascio. Questo metodo chiama il [CMFCPopupMenu::SaveState](../../mfc/reference/cmfcpopupmenu-class.md#savestate) metodo di primo livello menu a comparsa, in modo che il pulsante principale del menu a comparsa per ricreare il menu di scelta.  
  
##  <a name="serialize"></a>  CMFCToolBarMenuButton::Serialize  

  
```  
virtual void Serialize(CArchive& ar);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *ar*  
  
### <a name="remarks"></a>Note  
  
##  <a name="setaccdata"></a>  CMFCToolBarMenuButton::SetACCData  
 Imposta i dati di accessibilità per l'elemento della barra multifunzione.  
  
```  
virtual BOOL SetACCData(
    CWnd* pParent,  
    CAccessibilityData& data);
```  
  
### <a name="parameters"></a>Parametri  
 *pParent*  
 Finestra padre per l'elemento della barra multifunzione.  
  
 *data*  
 Dati di accessibilità per l'elemento della barra multifunzione.  
  
### <a name="return-value"></a>Valore restituito  
 Restituisce sempre `TRUE`.  
  
### <a name="remarks"></a>Note  
 Per impostazione predefinita, questo metodo imposta i dati di accessibilità per l'elemento della barra multifunzione e restituisce sempre `TRUE`. Eseguire l'override di questo metodo per impostare i dati di accessibilità e restituire un valore che indica l'esito positivo o negativo.  
  
##  <a name="setmenuonly"></a>  CMFCToolBarMenuButton::SetMenuOnly  
 Specifica se il pulsante viene disegnato come un pulsante di menu o un pulsante di menu combinato quando ha un ID di comando valido e un sottomenu.  
  
```  
void SetMenuOnly(BOOL bMenuOnly);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *bMenuOnly*  
 `TRUE` Per visualizzare questo pulsante come un pulsante di menu quando ha un ID di comando valido e un sottomenu, `FALSE` per mostrare questo pulsante come un pulsante di menu combinato, quando ha un ID di comando valido e un sottomenu.  
  
### <a name="remarks"></a>Note  
 In genere, quando un pulsante di menu della barra degli strumenti ha un sottomenu e un ID di comando, il menu di scelta sembra essere un pulsante di menu combinato con un pulsante principale e un oggetto associato pulsante freccia giù. Se si chiama questo metodo e *bMenuOnly* è `TRUE`, il pulsante viene invece visualizzato un pulsante di menu singolo con una freccia in giù del pulsante di. Quando l'utente fa clic sulla freccia in entrambe le modalità, verrà visualizzato il sottomenu e quando l'utente sceglie la parte non freccia del pulsante in entrambe le modalità il framework esegue il comando.  
  
##  <a name="setmenupalettemode"></a>  CMFCToolBarMenuButton::SetMenuPaletteMode  
 Specifica se il menu di scelta rapida è in modalità tavolozza.  
  
```  
void SetMenuPaletteMode(
    BOOL bMenuPaletteMode=TRUE,  
    int nPaletteRows=1);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *bMenuPaletteMode*  
 Specifica se il menu di scelta rapida è in modalità tavolozza.  
  
 [in] *nPaletteRows*  
 Numero di righe nella tavolozza.  
  
### <a name="remarks"></a>Note  
 Nella modalità di tavolozza, tutte le voci di menu vengono visualizzate come una tavolozza a più colonne. Specificare il numero di righe utilizzando *nPaletteRows*.  
  
##  <a name="setmessagewnd"></a>  CMFCToolBarMenuButton::SetMessageWnd  

  
```  
void SetMessageWnd(CWnd* pWndMessage);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *pWndMessage*  
  
### <a name="remarks"></a>Note  
  
##  <a name="setradio"></a>  CMFCToolBarMenuButton::SetRadio  
 Imposta il pulsante di menu della barra degli strumenti per visualizzare un'icona di stile di pulsante di opzione quando viene selezionato.  
  
```  
virtual void SetRadio();
```  
  
### <a name="remarks"></a>Note  
 Quando il pulsante di menu viene disegnato mentre l'opzione è selezionata, viene chiamato [CMFCVisualManager::OnDrawMenuCheck](../../mfc/reference/cmfcvisualmanager-class.md#ondrawmenucheck) per disegnare un'icona segno di spunta. Per impostazione predefinita, `OnDrawMenuCheck` le richieste che il gestore visualizzazione corrente disegna una casella di controllo di stile segno di spunta sul pulsante di menu. Dopo aver chiamato questo metodo, il gestore visualizzazione corrente invece consente di disegnare un segno di spunta radio stile pulsante sul pulsante di menu. Questa modifica non può essere annullata.  
  
 Quando si chiama questo metodo e il pulsante di menu è correntemente visualizzato, vengono aggiornate.  
  
##  <a name="settearoff"></a>  CMFCToolBarMenuButton::SetTearOff  
 Specifica l'ID della barra a comparsa per il menu a discesa.  
  
```  
virtual void SetTearOff(UINT uiBarID);
```  
  
### <a name="parameters"></a>Parametri  
 [in] *uiBarID*  
 Specifica un tear-off nuova barra ID.  
  
### <a name="remarks"></a>Note  
 Chiamare questo metodo per specificare l'ID per la barra a comparsa che viene creata quando l'utente trascina il pulsante di menu di fuori di una barra dei menu. Se il *uiBarID* parametro è 0, l'utente non è possibile estrarre il pulsante di menu.  
  
 Chiamare [CWinAppEx::EnableTearOffMenus](../../mfc/reference/cwinappex-class.md#enabletearoffmenus) per abilitare la funzionalità di menu a comparsa nell'applicazione.  
  
## <a name="see-also"></a>Vedere anche  
 [Grafico delle gerarchie](../../mfc/hierarchy-chart.md)   
 [Classi](../../mfc/reference/mfc-classes.md)   
 [Classe CMFCToolBarButton](../../mfc/reference/cmfctoolbarbutton-class.md)   
 [CMFCToolBar (classe)](../../mfc/reference/cmfctoolbar-class.md)   
 [Classe CMFCPopupMenu](../../mfc/reference/cmfcpopupmenu-class.md)