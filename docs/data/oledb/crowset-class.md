---
title: Classe CRowset
ms.date: 11/04/2016
f1_keywords:
- ATL.CRowset<TAccessor>
- CRowset
- ATL::CRowset
- ATL::CRowset<TAccessor>
- ATL.CRowset
- CRowset<TAccessor>.AddRefRows
- CRowset.AddRefRows
- ATL.CRowset.AddRefRows
- AddRefRows
- CRowset::AddRefRows
- CRowset<TAccessor>::AddRefRows
- ATL::CRowset::AddRefRows
- ATL.CRowset<TAccessor>.AddRefRows
- ATL::CRowset<TAccessor>::AddRefRows
- CRowset::Close
- ATL.CRowset.Close
- CRowset<TAccessor>::Close
- CRowset<TAccessor>.Close
- ATL.CRowset<TAccessor>.Close
- ATL::CRowset::Close
- ATL::CRowset<TAccessor>::Close
- CRowset.Close
- CRowset<TAccessor>.Compare
- CRowset<TAccessor>::Compare
- ATL.CRowset<TAccessor>.Compare
- ATL::CRowset<TAccessor>::Compare
- CRowset.Compare
- ATL::CRowset::Compare
- ATL.CRowset.Compare
- CRowset::Compare
- CRowset<TAccessor>::CRowset
- CRowset.CRowset
- ATL::CRowset::CRowset
- ATL::CRowset<TAccessor>::CRowset
- ATL.CRowset.CRowset
- CRowset
- CRowset<TAccessor>.CRowset
- CRowset::CRowset
- ATL.CRowset<TAccessor>.CRowset
- ATL::CRowset::Delete
- CRowset.Delete
- CRowset::Delete
- ATL.CRowset.Delete
- ATL::CRowset<TAccessor>::Delete
- CRowset<TAccessor>.Delete
- CRowset<TAccessor>::Delete
- ATL.CRowset<TAccessor>.Delete
- ATL.CRowset.FindNextRow
- CRowset<TAccessor>.FindNextRow
- ATL::CRowset::FindNextRow
- CRowset::FindNextRow
- CRowset<TAccessor>::FindNextRow
- CRowset.FindNextRow
- ATL.CRowset<TAccessor>.FindNextRow
- ATL::CRowset<TAccessor>::FindNextRow
- FindNextRow
- ATL::CRowset::GetApproximatePosition
- ATL::CRowset<TAccessor>::GetApproximatePosition
- CRowset.GetApproximatePosition
- CRowset::GetApproximatePosition
- GetApproximatePosition
- ATL.CRowset.GetApproximatePosition
- CRowset<TAccessor>::GetApproximatePosition
- CRowset<TAccessor>::GetData
- ATL::CRowset<TAccessor>::GetData
- ATL::CRowset::GetData
- ATL.CRowset<TAccessor>.GetData
- CRowset<TAccessor>.GetData
- CRowset::GetData
- CRowset.GetData
- ATL.CRowset.GetData
- CRowset<TAccessor>::GetDataHere
- CRowset<TAccessor>.GetDataHere
- CRowset.GetDataHere
- GetDataHere
- CRowset::GetDataHere
- ATL::CRowset::GetDataHere
- ATL::CRowset<TAccessor>::GetDataHere
- ATL.CRowset<TAccessor>.GetDataHere
- ATL.CRowset.GetDataHere
- ATL.CRowset<TAccessor>.GetOriginalData
- CRowset<TAccessor>::GetOriginalData
- GetOriginalData
- ATL::CRowset<TAccessor>::GetOriginalData
- ATL.CRowset.GetOriginalData
- CRowset::GetOriginalData
- ATL::CRowset::GetOriginalData
- CRowset.GetOriginalData
- CRowset.GetRowStatus
- ATL.CRowset<TAccessor>.GetRowStatus
- ATL::CRowset<TAccessor>::GetRowStatus
- CRowset::GetRowStatus
- ATL::CRowset::GetRowStatus
- CRowset<TAccessor>::GetRowStatus
- ATL.CRowset.GetRowStatus
- CRowset<TAccessor>.GetRowStatus
- GetRowStatus
- ATL.CRowset<TAccessor>.Insert
- CRowset.Insert
- CRowset<TAccessor>.Insert
- CRowset<TAccessor>::Insert
- ATL::CRowset<TAccessor>::Insert
- ATL.CRowset.Insert
- CRowset::Insert
- ATL::CRowset::Insert
- CRowset::IsSameRow
- CRowset.IsSameRow
- IsSameRow
- ATL::CRowset::IsSameRow
- ATL.CRowset.IsSameRow
- CRowset<TAccessor>::IsSameRow
- ATL.CRowset<TAccessor>.IsSameRow
- CRowset<TAccessor>.IsSameRow
- ATL::CRowset<TAccessor>::IsSameRow
- CRowset<TAccessor>::MoveFirst
- ATL::CRowset::MoveFirst
- CRowset<TAccessor>.MoveFirst
- CRowset::MoveFirst
- CRowset.MoveFirst
- ATL.CRowset.MoveFirst
- ATL.CRowset<TAccessor>.MoveFirst
- ATL::CRowset<TAccessor>::MoveFirst
- ATL::CRowset<TAccessor>::MoveLast
- CRowset<TAccessor>::MoveLast
- ATL.CRowset.MoveLast
- ATL::CRowset::MoveLast
- CRowset<TAccessor>.MoveLast
- MoveLast
- CRowset::MoveLast
- ATL.CRowset<TAccessor>.MoveLast
- CRowset.MoveLast
- ATL.CRowset<TAccessor>.MoveNext
- ATL.CRowset.MoveNext
- ATL::CRowset<TAccessor>::MoveNext
- CRowset<TAccessor>.MoveNext
- CRowset.MoveNext
- CRowset<TAccessor>::MoveNext
- CRowset::MoveNext
- ATL::CRowset::MoveNext
- CRowset<TAccessor>.MovePrev
- CRowset.MovePrev
- MovePrev
- CRowset::MovePrev
- ATL.CRowset.MovePrev
- ATL::CRowset<TAccessor>::MovePrev
- ATL::CRowset::MovePrev
- ATL.CRowset<TAccessor>.MovePrev
- CRowset<TAccessor>::MovePrev
- ATL::CRowset::MoveToBookmark
- ATL::CRowset<TAccessor>::MoveToBookmark
- ATL.CRowset.MoveToBookmark
- ATL.CRowset<TAccessor>.MoveToBookmark
- MoveToBookmark
- CRowset::MoveToBookmark
- CRowset.MoveToBookmark
- CRowset<TAccessor>::MoveToBookmark
- MoveToRatio
- CRowset<TAccessor>::MoveToRatio
- CRowset::MoveToRatio
- CRowset<TAccessor>.MoveToRatio
- ATL.CRowset.MoveToRatio
- ATL::CRowset::MoveToRatio
- CRowset.MoveToRatio
- ATL.CRowset<TAccessor>.MoveToRatio
- ATL::CRowset<TAccessor>::MoveToRatio
- ReleaseRows
- CRowset::ReleaseRows
- ATL::CRowset<TAccessor>::ReleaseRows
- CRowset<TAccessor>.ReleaseRows
- CRowset.ReleaseRows
- ATL.CRowset.ReleaseRows
- ATL.CRowset<TAccessor>.ReleaseRows
- CRowset<TAccessor>::ReleaseRows
- ATL::CRowset::ReleaseRows
- ATL.CRowset<TAccessor>.SetData
- SetData
- ATL::CRowset::SetData
- CRowset<TAccessor>.SetData
- CRowset::SetData
- ATL.CRowset.SetData
- CRowset.SetData
- CRowset<TAccessor>::SetData
- ATL::CRowset<TAccessor>::SetData
- CRowset.Undo
- ATL::CRowset<TAccessor>::Undo
- CRowset<TAccessor>::Undo
- ATL.CRowset.Undo
- ATL.CRowset<TAccessor>.Undo
- CRowset<TAccessor>.Undo
- ATL::CRowset::Undo
- CRowset::Undo
- Undo
- CRowset.Update
- ATL.CRowset.Update
- ATL.CRowset<TAccessor>.Update
- ATL::CRowset<TAccessor>::Update
- CRowset<TAccessor>::Update
- CRowset::Update
- CRowset<TAccessor>.Update
- ATL::CRowset::Update
- CRowset::UpdateAll
- ATL.CRowset.UpdateAll
- CRowset<TAccessor>.UpdateAll
- ATL.CRowset<TAccessor>.UpdateAll
- UpdateAll
- CRowset.UpdateAl
- ATL::CRowset<TAccessor>::UpdateAll
- CRowset<TAccessor>::UpdateAll
- ATL::CRowset::UpdateAll
helpviewer_keywords:
- CRowset class
- AddRefRows method
- Close method
- Compare method
- CRowset class, constructor
- Delete method
- FindNextRow method
- GetApproximatePosition method
- GetData method [OLE DB]
- GetDataHere method
- GetOriginalData method
- GetRowStatus method
- Insert method
- IsSameRow method
- MoveFirst method
- MoveLast method
- MoveNext method
- MovePrev method
- MoveToBookmark method
- MoveToRatio method
- ReleaseRows method
- SetData method
- Undo method
- Update method
- UpdateAll method
ms.assetid: b0228a90-b8dd-47cc-b397-8d4c15c1e7f4
ms.openlocfilehash: 6af7b30ef7055fbf5b3c998dba6f3b84d0129c31
ms.sourcegitcommit: 6052185696adca270bc9bdbec45a626dd89cdcdd
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 10/31/2018
ms.locfileid: "50543066"
---
# <a name="crowset-class"></a>Classe CRowset

Incapsula un oggetto set di righe OLE DB e diverse relative interfacce e fornisce metodi di modifica per i dati di set di righe.

## <a name="syntax"></a>Sintassi

```cpp
template <class TAccessor = CAccessorBase>
class CRowset
```

### <a name="parameters"></a>Parametri

*TAccessor*<br/>
Una classe di funzione di accesso. Il valore predefinito è `CAccessorBase`.

## <a name="requirements"></a>Requisiti

**Intestazione:** atldbcli.h

## <a name="members"></a>Membri

### <a name="methods"></a>Metodi

|||
|-|-|
|[AddRefRows](#addrefrows)|Incrementa il conteggio dei riferimenti associati con la riga corrente.|
|[Chiudi](#close)|Rilascia le righe e corrente `IRowset` interfaccia.|
|[Compare](#compare)|Confronta due segnalibri usando [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539).|
|[CRowset](#crowset)|Crea un nuovo `CRowset` dell'oggetto e (facoltativamente) lo associa a un `IRowset` interfaccia fornita come parametro.|
|[Eliminazione](#delete)|Elimina le righe dal set di righe utilizzando [IRowsetChange:DeleteRows](/previous-versions/windows/desktop/ms724362(v%3dvs.85)).|
|[FindNextRow](#findnextrow)|Trova la riga corrispondente successiva dopo il segnalibro specificato.|
|[GetApproximatePosition](#getapproximateposition)|Restituisce la posizione approssimativa di una riga corrispondente a un segnalibro.|
|[GetData](#getdata)|Recupera i dati dalla copia del set di righe della riga.|
|[GetDataHere](#getdatahere)|Recupera i dati dal buffer specificato.|
|[GetOriginalData](#getoriginaldata)|Recupera i dati recuperati da più di recente o trasmesso all'origine dei dati, ignorando le modifiche in sospeso.|
|[GetRowStatus](#getrowstatus)|Restituisce lo stato di tutte le righe.|
|[Inserisci](#insert)|Crea e inserisce una nuova riga utilizzando [IRowsetChange:InsertRow](/previous-versions/windows/desktop/ms716921).|
|[IsSameRow](#issamerow)|Confronta la riga specificata con la riga corrente.|
|[MoveFirst](#movefirst)|Riposiziona il percorso per il recupero successivo nella posizione iniziale.|
|[MoveLast](#movelast)|Passa all'ultimo record.|
|[Metodo MoveNext](#movenext)|Recupera i dati dalla riga successiva sequenza o un numero specificato di posizioni successive alla riga successiva.|
|[MovePrev](#moveprev)|Passa al record precedente.|
|[MoveToBookmark](#movetobookmark)|Recupera la riga contrassegnata da un segnalibro o la riga in corrispondenza di un offset specificato da questo segnalibro.|
|[MoveToRatio](#movetoratio)|Recupera le righe a partire da una posizione frazionaria nel set di righe.|
|[ReleaseRows](#releaserows)|Le chiamate [:: ReleaseRows](/previous-versions/windows/desktop/ms719771) per rilasciare l'handle di riga corrente.|
|[SetData](#setdata)|Imposta i valori dei dati in una o più colonne di una riga usando [IRowsetChange:SetData](/previous-versions/windows/desktop/ms721232).|
|[Operazione di annullamento](#undo)|Annulla le modifiche apportate a una riga dall'ultimo recupero o [Update](../../data/oledb/crowset-update.md).|
|[Aggiornamento](#update)|Consente di trasmettere le modifiche apportate alla riga corrente dall'ultima istruzione fetch o aggiornamento in sospeso.|
|[UpdateAll](#updateall)|Consente di trasmettere le modifiche apportate a tutte le righe dopo l'ultimo recupero o l'aggiornamento in sospeso.|

## <a name="remarks"></a>Note

In OLE DB, un set di righe è l'oggetto tramite cui un programma imposta e recupera i dati.

Questa classe non deve essere creata un'istanza ma piuttosto passato come parametro di modello per `CTable` oppure `CCommand` (`CRowset` è l'impostazione predefinita).

## <a name="addrefrows"></a> CRowset:: Addrefrows

Le chiamate [IRowset:: Addrefrows](/previous-versions/windows/desktop/ms719619) incremento (uno) il conteggio dei riferimenti associati con l'handle di riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT AddRefRows() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo incrementa il conteggio dei riferimenti per l'handle di riga corrente. Chiamare [ReleaseRows](../../data/oledb/crowset-releaserows.md) per diminuire il conteggio. Righe restituite dai metodi di spostamento hanno un conteggio dei riferimenti di uno.

## <a name="close"></a> CRowset:: Close

Rilascia le righe e l'oggetto corrente [IRowset](/previous-versions/windows/desktop/ms720986) interfaccia.

### <a name="syntax"></a>Sintassi

```cpp
void Close() throw();
```

### <a name="remarks"></a>Note

Questo metodo rilascia tutte le righe correntemente nel set di righe.

## <a name="compare"></a> CRowset:: compare

Confronta due segnalibri usando [IRowsetLocate::Compare](/previous-versions/windows/desktop/ms709539).

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Compare(const CBookmarkBase& bookmark1, 
   const CBookmarkBase& bookmark2, 
   DBCOMPARE* pComparison) const throw();
```

#### <a name="parameters"></a>Parametri

*Segnalibro1*<br/>
[in] Il primo segnalibro da confrontare.

*Bookmark2*<br/>
[in] Il secondo segnalibro da confrontare.

*pComparison*<br/>
[out] Puntatore al risultato del confronto.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetLocate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetLocate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

Per informazioni sull'utilizzo di segnalibri degli utenti, vedere [mediante segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="crowset"></a> CRowset:: CRowset

Crea un nuovo `CRowset` dell'oggetto e (facoltativamente) lo associa a un [IRowset](/previous-versions/windows/desktop/ms720986) interfaccia fornita come parametro.

### <a name="syntax"></a>Sintassi

```cpp
CRowset(); 

CRowset(IRowset* pRowset);
```

#### <a name="parameters"></a>Parametri

*pRowset*<br/>
[in] Puntatore a un'interfaccia `IRowset` da associare a questa classe.

## <a name="delete"></a> CRowset:: Delete

Le chiamate [IRowsetChange:: DeleteRows](/previous-versions/windows/desktop/ms724362(v%3dvs.85)) per eliminare la riga corrente dal set di righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Delete() const throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

## <a name="findnextrow"></a> CRowset:: FindNextRow

Trova la riga corrispondente successiva dopo il segnalibro specificato.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT FindNextRow(DBCOMPAREOP op, 
   BYTE* pData, 
   DBTYPE wType, 
   DBLENGTH nLength, 
   BYTE bPrecision, 
   BYTE bScale, 
   BOOL bSkipCurrent = TRUE, 
   CBookmarkBase* pBookmark = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*op*<br/>
[in] L'operazione da usare nel confronto dei valori di riga. Per i valori, vedere [irowsetfind:: FindNextRow](/previous-versions/windows/desktop/ms723091).

*pData*<br/>
[in] Puntatore al valore da ricercare.

*wType*<br/>
[in] Indica il tipo di dati della parte valore del buffer. Per informazioni sugli indicatori di tipo, vedere [tipi di dati](/previous-versions/windows/desktop/ms723969) nel *riferimento per programmatori OLE DB* nel SDK di Windows.

*nLength*<br/>
[in] La lunghezza, espressa in byte, della struttura dei dati consumer allocata per il valore dei dati. Per informazioni dettagliate, vedere la descrizione del `cbMaxLen` nelle [strutture DBBINDING](/previous-versions/windows/desktop/ms716845) nel *riferimento per programmatori OLE DB.*

*bPrecision*<br/>
[in] La precisione massima utilizzata durante il recupero dei dati. Utilizzato solo se *wType* è DBTYPE_NUMERIC. Per altre informazioni, vedere [conversioni DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714) nel *riferimento per programmatori OLE DB*.

*bScale*<br/>
[in] La scala usata durante il recupero dei dati. Utilizzato solo se *wType* è DBTYPE_NUMERIC o DBTYPE_DECIMAL. Per altre informazioni, vedere [conversioni DBTYPE_NUMERIC o DBTYPE_DECIMAL](/previous-versions/windows/desktop/ms719714) nel *riferimento per programmatori OLE DB*.

*bSkipCurrent*<br/>
[in] Il numero di righe del segnalibro da cui iniziare la ricerca.

*pBookmark*<br/>
[in] Il segnalibro per posizione in corrispondenza della quale iniziare la ricerca.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetFind`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetFind` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

Per informazioni sull'utilizzo di segnalibri degli utenti, vedere [mediante segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="getapproximateposition"></a> CRowset:: Getapproximateposition

Restituisce la posizione approssimativa di una riga corrispondente a un segnalibro.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetApproximatePosition(const CBookmarkBase* pBookmark, 
   DBCOUNTITEM* pPosition, 
   DBCOUNTITEM* pcRows) throw();
```

#### <a name="parameters"></a>Parametri

*pBookmark*<br/>
[in] Un puntatore a un segnalibro che identifica la riga la cui posizione deve essere trovato. NULL se il conteggio delle righe è necessario soltanto.

*pPosition*<br/>
[out] Un puntatore alla posizione in cui `GetApproximatePosition` restituisce la posizione della riga. NULL se la posizione non è obbligatoria.

*pcRows*<br/>
[out] Un puntatore alla posizione in cui `GetApproximatePosition` restituisce il numero totale di righe. NULL se il conteggio delle righe non è necessario.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetScroll`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetScroll` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

Per informazioni sull'utilizzo di segnalibri degli utenti, vedere [mediante segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="getdata"></a> CRowset:: GetData

Recupera i dati dalla copia del set di righe della riga.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetData() throw(); 

HRESULT GetData(int nAccessor) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
[in] Numero di indice (offset uguale a zero) della funzione di accesso da usare per accedere ai dati.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Se si specifica una funzione di accesso che non è un sia automatica o meno in [BEGIN_ACCESSOR](../../data/oledb/begin-accessor.md), usare questo metodo per ottenere in modo esplicito i dati passando il numero di funzioni di accesso.

## <a name="getdatahere"></a> CRowset:: GetDataHere

Recupera i dati dalla riga corrente e lo inserisce nel buffer specificato.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetDataHere(int nAccessor, 
   void* pBuffer) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
[in] Numero di indice della funzione di accesso da usare per accedere ai dati.

*pBuffer*<br/>
[out] Un buffer in cui inserire i dati per il record corrente.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Per un esempio di come usare questa funzione, vedere la [esempio MultiRead](../../visual-cpp-samples.md).

## <a name="getoriginaldata"></a> CRowset:: GetOriginalData

Le chiamate `IRowsetUpdate::GetOriginalData` per recuperare i dati recuperati da più di recente o trasmesso all'origine dei dati.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetOriginalData() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo recupera i dati più di recente recuperata dal o trasmesso all'origine dei dati; e non recupera i valori sulla base delle modifiche in sospeso.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetUpdate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="getrowstatus"></a> CRowset:: GetRowStatus

Restituisce lo stato di tutte le righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT GetRowStatus(DBPENDINGSTATUS* pStatus) const throw();
```

#### <a name="parameters"></a>Parametri

*pStatus*<br/>
[out] Un puntatore a una posizione in cui `GetRowStatus` restituisce il valore di stato. Vedere DBPENDINGSTATUS nel riferimento per programmatori OLE DB.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetUpdate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="insert"></a> CRowset:: Insert

Crea e Inizializza una nuova riga usando i dati dalla funzione di accesso.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Insert(int nAccessor = 0, 
   bool bGetHRow = false) throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
[in] Il numero di funzione di accesso da usare per l'inserimento di dati.

*bGetHRow*<br/>
[in] Indica se l'handle per la riga inserita verrà recuperata.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetChange`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetChange` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

Inserimento potrebbe non riuscire se una o più colonne non è accessibile in scrittura. Modificare la mappa del cursore per risolvere il problema.

### <a name="example"></a>Esempio

Nell'esempio seguente viene illustrato come accedere a un'origine dati tramite un set di righe e quindi inserire una stringa usando una tabella in tale set di righe.

Innanzitutto, creare una classe di tabella tramite l'inserimento di un nuovo oggetto ATL nel progetto. Ad esempio, fare clic sul progetto nel riquadro area di lavoro e selezionare **nuovo oggetto ATL**. Dal **DAS** categoria, seleziona **Consumer**. Creare un oggetto consumer typu **tabella**. (Selezionando **tabella** crea un set di righe direttamente dalla tabella, selezionando **comando** crea un set di righe tramite un comando SQL.) Selezionare un'origine dati, specificare una tabella tramite cui si desidera accedere a tale origine dati. Se si chiama l'oggetto consumer **CCustomerTable**, è quindi necessario implementare il codice di inserimento nel modo seguente:

[!code-cpp[NVC_OLEDB_Consumer#10](../../data/oledb/codesnippet/cpp/crowset-insert_1.cpp)]

## <a name="issamerow"></a> CRowset:: Issamerow

Confronta la riga specificata con la riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT IsSameRow(HROW hRow) const throw();
```

#### <a name="parameters"></a>Parametri

*hRow*<br/>
[in] Handle per la riga da confrontare con la riga corrente.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard. S_OK indica che le righe sono uguali. Per altri valori, vedere [IRowsetIndentity::IsSameRow](/previous-versions/windows/desktop/ms719629) nel *riferimento per programmatori OLE DB* nel SDK di Windows.

## <a name="movefirst"></a> CRowset:: MoveFirst

Sposta il cursore nella posizione iniziale e recupera la riga iniziale.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveFirst() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Le chiamate [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877) per riposizionare il percorso per il recupero successivo nella posizione iniziale (la posizione che era la posizione successiva per il recupero quando è stato creato il set di righe) e recupera la riga iniziale.

## <a name="movelast"></a> CRowset:: MoveLast

Sposta il cursore nell'ultima riga.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveLast() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Le chiamate [IRowset:: RestartPosition](/previous-versions/windows/desktop/ms712877) riposizionare il percorso per il recupero successivo all'ultimo per posizionare e recupera l'ultima riga.

Questo metodo richiede l'impostazione `DBPROP_CANSCROLLBACKWARDS` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe. (Per ottenere prestazioni migliori, è anche possibile impostare `DBPROP_QUICKRESTART` su VARIANT_TRUE.)

## <a name="movenext"></a> CRowset:: MoveNext

Sposta il cursore sul record successivo.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveNext() throw();

HRESULT MoveNext(LONG lSkip, 
   bool bForward= true) throw();
```

#### <a name="parameters"></a>Parametri

*lSkip*<br/>
[in] Il numero di righe da ignorare prima di recuperare.

*bForward*<br/>
[in] Passare **true** per spostarsi in avanti al record successivo **false** per spostarsi all'indietro.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard. Quando è stata raggiunta la fine del set di righe, restituisce DB_S_ENDOFROWSET.

### <a name="remarks"></a>Note

Recupera la riga successiva sequenza dal `CRowset` oggetto, memorizzando la posizione precedente. Facoltativamente, è possibile scegliere di ignorare *lSkip* righe o spostamento con le versioni precedenti.

Questo metodo è necessario impostare le proprietà seguenti prima di chiamare `Open` la tabella o un comando che contiene il set di righe:

- `DBPROP_CANSCROLLBACKWARDS` Se deve essere VARIANT_TRUE *lSkip* < 0

- `DBPROP_CANFETCHBACKWARDS` Se deve essere VARIANT_TRUE *bForward* = false

In caso contrario (se *lSkip* > = 0 e *bForward* = true), non è necessario impostare proprietà aggiuntive.

## <a name="moveprev"></a> CRowset:: MovePrev

Sposta il cursore al record precedente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MovePrev() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'impostazione entrambi `DBPROP_CANFETCHBACKWARDS` oppure `DBPROP_CANSCROLLBACKWARDS` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="movetobookmark"></a> CRowset:: MoveToBookmark

Recupera la riga contrassegnata da un segnalibro o la riga in corrispondenza di un offset specificato (*lSkip*) dal segnalibro.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveToBookmark(const CBookmarkBase& bookmark, 
   LONG lSkip = 0) throw();
```

#### <a name="parameters"></a>Parametri

*Segnalibro*<br/>
[in] Un segnalibro contrassegna la posizione da cui si desidera recuperare i dati.

*lSkip*<br/>
[in] Conteggio numero di righe del segnalibro nella riga di destinazione. Se *lSkip* è uguale a zero, la prima riga recuperata è la riga con segnalibro. Se *lSkip* è 1, la prima riga recuperata è la riga dopo la riga con segnalibro. Se *lSkip* è -1, la prima riga recuperata è la riga precedente alla riga con segnalibro.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetLocate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetLocate` VARIANT_TRUE e impostare `DBPROP_CANFETCHBACKWARDS` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

Per informazioni sull'utilizzo di segnalibri degli utenti, vedere [mediante segnalibri](../../data/oledb/using-bookmarks.md).

## <a name="movetoratio"></a> CRowset:: Movetoratio

Recupera le righe a partire da una posizione frazionaria nel set di righe.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT MoveToRatio(DBCOUNTITEM nNumerator, 
   DBCOUNTITEM nDenominator,bool bForward = true) throw();
```

#### <a name="parameters"></a>Parametri

*nNumerator*<br/>
[in] Il numeratore utilizzato per determinare il frazionari posizionali da cui recuperare i dati.

*nDenominator*<br/>
[in] Il denominatore consente di determinare le frazioni posizionali da cui recuperare i dati.

*bForward*<br/>
[in] Indica se deve essere spostato avanti o indietro. Il valore predefinito è in avanti.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

`MoveToRatio` Recupera le righe in base all'incirca sulla formula seguente:

`(nNumerator *  RowsetSize ) / nDenominator`

In cui `RowsetSize` è la dimensione del set di righe, misurata in righe. L'accuratezza di questa formula dipende dal provider specifico. Per informazioni dettagliate, vedere [IRowsetScroll:: GetRowsAtRatio](/previous-versions/windows/desktop/ms709602).

Questo metodo richiede l'interfaccia facoltativa `IRowsetScroll`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetScroll` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="releaserows"></a> CRowset:: ReleaseRows

Le chiamate [:: ReleaseRows](/previous-versions/windows/desktop/ms719771) per rilasciare l'handle di riga corrente.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT ReleaseRows() throw();
```

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

## <a name="setdata"></a> CRowset:: SetData

Imposta i valori dei dati in una o più colonne di una riga.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT SetData() const throw(); 

HRESULT SetData(int nAccessor) const throw();
```

#### <a name="parameters"></a>Parametri

*nAccessor*<br/>
[in] Il numero della funzione di accesso da usare per accedere ai dati.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Per il `SetData` form che accetta alcun argomento, tutte le funzioni di accesso vengono utilizzati per l'aggiornamento. In genere si chiama `SetData` per impostare i valori dei dati in colonne di una riga, quindi chiamare [Update](../../data/oledb/crowset-update.md) per trasmettere le modifiche.

Questo metodo richiede l'interfaccia facoltativa `IRowsetChange`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetChange` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

L'operazione di impostazione potrebbe non riuscire se una o più colonne non è accessibile in scrittura. Modificare la mappa del cursore per risolvere il problema.

## <a name="undo"></a> CRowset::

Annulla le modifiche apportate a una riga dall'ultimo recupero o [Update](../../data/oledb/crowset-update.md).

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Undo(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
[out] Un puntatore alla posizione in cui `Undo` restituisce il numero di righe si è tentato di annullare le modifiche necessarie.

*phRow*<br/>
[out] Un puntatore alla posizione in cui `Undo` restituisce una matrice di handle per tutte le righe il tentativo di annullare le modifiche necessarie.

*pStatus*<br/>
[out] Un puntatore alla posizione in cui `Undo` restituisce il valore di stato di riga. Se non viene restituito alcun stato *pStatus* è null.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetUpdate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="update"></a> CRowset:: Update

Trasmette le modifiche apportate alla riga corrente dall'ultimo recupero in sospeso o `Update` chiamare su di esso.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT Update(DBCOUNTITEM* pcRows = NULL, 
   HROW* phRow = NULL, 
   DBROWSTATUS* pStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
[out] Un puntatore alla posizione in cui `Update` restituisce il numero di righe si è tentato di aggiornare, se necessario.

*phRow*<br/>
[out] Un puntatore alla posizione in cui `Update` restituisce l'handle della riga di cui si è tentato di aggiornare. Se non viene restituito alcun handle *phRow* è null.

*pStatus*<br/>
[out] Un puntatore alla posizione in cui `Update` restituisce il valore di stato di riga. Se non viene restituito alcun stato *pStatus* è null.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

### <a name="remarks"></a>Note

Trasmette le modifiche apportate alla riga corrente dal momento che la riga è stata recuperata o dell'ultimo aggiornamento in sospeso (mediante `Update` oppure [UpdateAll](../../data/oledb/crowset-updateall.md)). In genere si chiama [SetData](../../data/oledb/crowset-setdata.md) per impostare i valori dei dati nelle colonne in una riga e quindi chiamare `Update` per trasmettere le modifiche.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetUpdate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

## <a name="updateall"></a> UpdateAll

Trasmette le modifiche apportate a tutte le righe dall'ultimo recupero in sospeso o `Update` chiamare su di esso.

### <a name="syntax"></a>Sintassi

```cpp
HRESULT UpdateAll(DBCOUNTITEM* pcRows = NULL, 
   HROW** pphRow = NULL, 
   DBROWSTATUS** ppStatus = NULL) throw();
```

#### <a name="parameters"></a>Parametri

*pcRows*<br/>
[out] Un puntatore alla posizione in cui `UpdateAll` restituisce il numero di righe si è tentato di aggiornare, se necessario.

*pphRow*<br/>
[out] Un puntatore alla memoria in cui `UpdateAll` restituisce l'handle della riga di cui si è tentato di aggiornare. Se non viene restituito alcun handle *pphRow* è null.

*ppStatus*<br/>
[out] Un puntatore alla posizione in cui `Update` restituisce il valore di stato di riga. Se non viene restituito alcun stato *ppStatus* è null.

### <a name="remarks"></a>Note

Trasmette le modifiche apportate a tutte le righe dopo le righe sono state ultima operazione di recupero o l'aggiornamento usando in sospeso [Update](../../data/oledb/crowset-update.md) o `UpdateAll`. `UpdateAll` aggiornerà tutte le righe che sono state modificate, indipendentemente dal fatto che comunque l'handle per la loro (vedere *pphRow*) o No.

Ad esempio, se è stata usata `Insert` per inserire cinque righe in un set di righe, è possibile chiamare `Update` cinque volte o chiamata `UpdateAll` una volta per aggiornare tutte le.

Questo metodo richiede l'interfaccia facoltativa `IRowsetUpdate`, che potrebbe non essere supportato in tutti i provider; se questo è il caso, il metodo restituisce E_NOINTERFACE. È necessario impostare anche `DBPROP_IRowsetUpdate` su VARIANT_TRUE prima di chiamare `Open` la tabella o un comando che contiene il set di righe.

### <a name="return-value"></a>Valore restituito

Un valore HRESULT standard.

## <a name="see-also"></a>Vedere anche

[Esempio DBViewer](../../visual-cpp-samples.md)<br/>
[Esempio multiRead](../../visual-cpp-samples.md)<br/>
[Attributi multiRead](../../visual-cpp-samples.md)<br/>
[Modelli Consumer OLE DB](../../data/oledb/ole-db-consumer-templates-cpp.md)<br/>
[Riferimenti ai modelli consumer OLE DB](../../data/oledb/ole-db-consumer-templates-reference.md)