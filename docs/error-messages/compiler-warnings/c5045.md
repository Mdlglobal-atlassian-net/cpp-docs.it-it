---
title: C5045 avviso del compilatore
ms.date: 06/21/2018
helpviewer_keywords:
- C5045
ms.openlocfilehash: da97c4e01f85b18ff79132f9365bf9bd282c89ce
ms.sourcegitcommit: 0ab61bc3d2b6cfbd52a16c6ab2b97a8ea1864f12
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/23/2019
ms.locfileid: "62152514"
---
# <a name="compiler-warning-c5045"></a>C5045 avviso del compilatore

> Compilatore inserirà la mitigazione Spectre per il carico di memoria se l'opzione /Qspectre specificato

## <a name="remarks"></a>Note

Avviso C5045 consente vedere i modelli nel codice che causano la mitigazione Spectre, ad esempio un LFENCE, deve essere inserito quando il [/Qspectre](../../build/reference/qspectre.md) è specificata l'opzione del compilatore. Ciò consente di identificare i file di codice interessati dal problema della protezione. Questo avviso è puramente informativo: la mitigazione non verrà inserita fino a quando non viene ricompilata usando la **/Qspectre** passare. La funzionalità di C5045 è indipendente dal **/Qspectre** passare, in modo che è possibile usarli entrambi nella stessa compilazione.

Questo avviso è stato introdotto in Visual Studio 2017 versione 15.7 ed è disattivata per impostazione predefinita. Uso [/Wall](../../build/reference/compiler-option-warning-level.md) per abilitare tutti gli avvisi che sono disattivate per impostazione predefinita, o __/w__*n*__5038__ abilitare C5045 come livello *n* avviso. Nell'IDE, il livello di avviso predefinito è **/w3** e questo avviso può essere abilitato nel progetto **pagine delle proprietà** finestra di dialogo. Open **le proprietà di configurazione** > **C/C++** > **della riga di comando** e il **opzioni aggiuntive** aggiungere */w35045*, quindi scegliere **OK**. Per altre informazioni, vedere [avvisi del compilatore disattivati per impostazione predefinita](../../preprocessor/compiler-warnings-that-are-off-by-default.md). Per informazioni su come disabilitare gli avvisi dalla versione del compilatore, vedere [gli avvisi del compilatore dalla versione del compilatore](compiler-warnings-by-compiler-version.md).

## <a name="example"></a>Esempio

Nell'esempio seguente genera l'avviso C5045 quando viene compilato da Visual Studio 2017 versione 15.7 con il **/Wall** o nella **/w35045** e **/w3** opzioni:

```cpp
// C5045.cpp
// Compile with: cl /EHsc /W3 /w35045 C5045.cpp

int G, G1, G2;

__forceinline
int * bar(int **p, int i)
{
    return p[i];
}

__forceinline
void bar1(int ** p, int i)
{
    if (i < G1) {
        auto x = p[i]; // C5045: mitigation here
        G = *x;
    }
}

__forceinline
void foo(int * p)
{
    G = *p;
}

void baz(int ** p, int i)
{
    if (i < G1) {
        foo(bar(p, i + G2));
    }
    bar1(p, i);
}

int main() { }
```

L'output del compilatore quando l'avviso è abilitato simile al seguente:

```Output
C:\Users\username\source\repos\C5045>cl /W3 /w35045 C5045.cpp
Microsoft (R) C/C++ Optimizing Compiler Version 19.14.26431 for x86
Copyright (C) Microsoft Corporation.  All rights reserved.

C5045.cpp
c:\users\username\source\repos\c5045\c5045.cpp(16) : warning C5045: Compiler will insert Spectre mitigation for memory load if /Qspectre switch specified
c:\users\username\source\repos\c5045\c5045.cpp(15) : note: index 'i' range checked by comparison on this line
c:\users\username\source\repos\c5045\c5045.cpp(17) : note: feeds memory load on this line
Microsoft (R) Incremental Linker Version 14.14.26431.0
Copyright (C) Microsoft Corporation.  All rights reserved.

/out:C5045.exe
C5045.obj
```

I messaggi di avviso mostrano che la mitigazione sarebbe stata inserita nella riga 16. Vengono inoltre indicati che la soluzione è necessaria perché l'indice i nella riga 15 attiva il carico di memoria su riga 17. La supposizione avviene tra barra e bar1 ma la mitigazione viene applicata quando viene inserita nella riga 16.

## <a name="see-also"></a>Vedere anche

[Materiale sussidiario per sviluppatori C++ - Minacce Speculative Execution Side Channel](../../security/developer-guidance-speculative-execution.md)<br/>
[/Qspectre](../../build/reference/qspectre.md)<br/>
[spectre](../../cpp/spectre.md)
